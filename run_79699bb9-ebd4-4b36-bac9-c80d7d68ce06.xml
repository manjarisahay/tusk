<?xml version="1.0" encoding="US-ASCII" standalone="yes"?>
<objectListWrapper>
    <objects>
        <objectContainer>
            <run>
                <blockSize>1</blockSize>
                <campaign>
                    <active>true</active>
                    <businessRules/>
                    <campaignMaps>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"corrupted config","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"valid_config","value":"NO","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'corrupted config' when valid_config EQ 'NO'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("valid_config", "EQ", "NO"));

    then
        $ctx.sendResultTo("corrupted config", $item);
end



# RuleOutcome.Definition={"outcomeId":"valid config","conditional":false,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[],"customConditions":[]}
rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>Config validity</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>4a2ec5c8-b57b-4142-9eb9-fa5cc9eab99b</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;

   &lt;!--
      [0100] Load configs

      changelog:
      - 2018-07-30 - 3.1.6 header comment added, integrated from "Automation: RPA DACH MW v.1.1.103.37-screen"
      - 2018-08-02 - Errors handling, Logs &amp; variables adjusted
   --&gt;



   &lt;!-- initialize logs and --&gt;
   &lt;script&gt;&lt;![CDATA[
      import java.time.LocalDateTime;

      grv_prc_log_text = "";
      if (binding.hasVariable('prc_log_text')) {
         grv_prc_log_text = prc_log_text.toString() + grv_prc_log_text;
      }

      grv_cfg_log_lvl_code = cfg_log_lvl_code.toString();
      _log = {String lvl, String text -&gt;
         if (!"DEBUG".equals(lvl) &amp;&amp; !"INFO".equals(lvl) &amp;&amp; !"WARN".equals(lvl) &amp;&amp; !"ERROR".equals(lvl)) {
            _log("ERROR", "Unknown logging level \"" + lvl + "\"");
            _log("ERROR", text);
         } else if ("DEBUG".equals(grv_cfg_log_lvl_code)
               || ("INFO".equals(grv_cfg_log_lvl_code) &amp;&amp; !"DEBUG".equals(lvl))
               || cfg_log_lvl_code.equals(lvl)
               || "ERROR".equals("lvl")) {
            grv_prc_log_text = grv_prc_log_text + LocalDateTime.now().toString() + " " + lvl + ": " + text + "\n";
            if ("DEBUG".equals(lvl)) {
               log.error("[DEUG] " + text);
            } else if ("INFO".equals(lvl)) {
               log.info(text);
            } else if ("WARN".equals(lvl)) {
               log.warn(text);
            } else if ("ERROR".equals(lvl)) {
               log.error(text);
            }
         }
      }

      _log("INFO", "[0100] Load configs -- started");
   ]]&gt;&lt;/script&gt; 



   &lt;!--
      deriving environments
   --&gt;
   &lt;script&gt;&lt;![CDATA[
      _log("DEBUG", "Deriving environment based on hosts");	  
      def grv_host = InetAddress.getLocalHost().getHostName();
	  _log("DEBUG", "Host name: " + grv_host);
      grv_sys_env_code = "Unknown";
      if (grv_host.toLowerCase().contains("dev")) {
         grv_sys_env_code = "DEV";
      }
      if (grv_host.toLowerCase().contains("prod")) {
         grv_sys_env_code = "PROD";
      }
      _log("INFO", "   " + grv_sys_env_code + " environment detected.");
   ]]&gt;&lt;/script&gt;



   &lt;!-- 
      retrieve shared drive credentials 
   --&gt;
   &lt;secure-store-get alias="${cfg_shared_drive_secstor_id}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      _log("DEBUG", "Retrieving shared drive credentials from [" + cfg_shared_drive_secstor_id.toString() + "] secure store");
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(cfg_shared_drive_secstor_id.toString());
      sharedDriveUser = obj.getKey().toString();
      sharedDrivePass = obj.getValue().toString();
      _log("INFO", "   retrieved user: " + sharedDriveUser + " and pass: " + sharedDrivePass.replaceAll(".", "*") + ".");
   ]]&gt;&lt;/script&gt; 



   &lt;!-- 
      load central config files 
   --&gt;
   &lt;script&gt;&lt;![CDATA[
      import java.io.FileOutputStream;
      import java.io.InputStream;
      import java.io.IOException;
      import java.io.File;
      import java.util.Date;

      import jcifs.smb.NtlmPasswordAuthentication;
      import jcifs.smb.SmbFile;
      import org.apache.commons.io.IOUtils;

      import java.util.function.Predicate;

	

      /**
         load JARs
      */
      _log("DEBUG", "Loading JARs:");

    /*  def custRepo = "/content/repositories/releases";

 		jar_URLs  = ["/com/dxc/pg/configs/pgconfigs/1.0/pgconfigs.jar"]
         .collect{p -&gt;
            _log("DEBUG", "   " + p);
            new URL("jar:" + new URL(cfg_nexus_uri.toString() + custRepo + p) + "!/");
         };
*/


jar_URLs  = ["pgconfigs.jar"]
         .collect{p -&gt;
            _log("DEBUG", "   " + p);
			(new File("/tmp/dach/" + p)).toURI().toURL();			       
         };


      def cl = URLClassLoader.newInstance(jar_URLs as URL[]);

      def ConfigConstants =     cl.loadClass("com.dxc.pg.configs.ConfigConstants");
      def ConfigReader =        cl.loadClass("com.dxc.pg.configs.ConfigReader");
      def ConfigUtils =         cl.loadClass("com.dxc.pg.configs.ConfigUtils");
      def ConfigCellValidator = cl.loadClass("com.dxc.pg.configs.ConfigCellValidator");



      /**
         helper functions
      */
      def copyFromSharedDriveToLocal = {String user, String password, String sourcePath, String destinationPath -&gt;
         _log("DEBUG", "[1] prepare auth");
         NtlmPasswordAuthentication auth = new NtlmPasswordAuthentication(null, user, password);
         _log("DEBUG", "[2] auth prepared");
         try {
            _log("DEBUG", "[3] before reading source");
            SmbFile source = new SmbFile(sourcePath, auth);
 			_log("DEBUG", "[4] sourcepath: " + sourcePath);
            _log("DEBUG", "[4] source: " + source.getContentLength());
            String destination = destinationPath;

            File yourFile = new File(destination);
            _log("DEBUG", "[5] before creating files");
			_log("DEBUG", "[5.1] destination: " + destination);
            boolean x = yourFile.createNewFile(); // if file already exists will do nothing 
            _log("DEBUG", "[6] file created: " + x);

            FileOutputStream fos = new FileOutputStream(destination);
            byte[] bytes = IOUtils.toByteArray(source.getInputStream());
            _log("DEBUG", "[7] before save " + bytes.length);
            fos.write(bytes);
            _log("DEBUG", "[8] after save");
            fos.close();
         } catch (Exception e) {
            _log("ERROR", "Failed to authenticate or donwload file from " + sourcePath + " to " + destinationPath + " with " + user + " credentials");
         }
      }



      /**
         reader setup
      */
      _log("DEBUG", "Setting up configuration reader.");
      def centralDestPath = cfg_temp_dir.toString() + "/" + "configs/central.xlsx"
      File directory = new File(cfg_temp_dir.toString() + "/" + "configs");
      if (! directory.exists()){
         directory.mkdirs();
      }

      def columnToConfigMap = new HashMap&lt;String, String&gt;() {{
         put("ENV","env");
         put("Market" ,"market");
         put("SOrg","sales_organization");
         put("DChl","ditribution_chl");
         put("Distribution Channel Desc","ditribution_chl_desc");
         put("LE","legal_entity");
         put("Country Desc","country_desc");
         put("Country","country");
         put("Language","language");
         put("Language Single Ch","lang_single_code");
         put("source of order","source_of_order");
         put("In process error distribution list","process_error_distribution_list");
         put("Price Comparison","price_comparison");
         put("EAN6TO13 Conv SAP","ean6to13_conv_sap");
         put("SAP-Archiving","sap_archiving");
         put("sap_credentials_secure_store_id","sap_credentials_secure_store_id");
         put("sap_bw_credentials_secure_store_id","sap_bw_credentials_secure_store_id");
         put("shared_drive_secure_store_id","shared_drive_secure_store_id");
         put("gtin_maping_xlsx_uri","gtin_maping_xlsx_uri");         
         put("email_credentials_secure_store_id","email_credentials_secure_store_id");
         put("smtp_server_host","smtp_server_host");
         put("smtp_server_port","smtp_server_port");
         put("confirmation_email_from","confirmation_email_from");
         put("confirmation_email_recipient","confirmation_email_recipient");
         put("confirmation_email_subject_prefix","confirmation_email_subject_prefix");
         put("failure_email_from","failure_email_from");
         put("failure_email_recipient","failure_email_recipient");
         put("failure_email_subject_prefix","failure_email_subject_prefix");
         put("manual_path_max_cnt","manual_path_max_cnt");
         put("debug_mode","debug_mode");
         put("test_cases_xlsx_uri","test_cases_xlsx_uri");
         put("temp_directory","temp_directory");
         put("s3_secure_store_id","s3_secure_store_id");
         put("s3_endpoint_url","s3_endpoint_url");
         put("s3_attachments_bucket","s3_attachments_bucket");
         put("cfg_bw_report_uri","cfg_bw_report_uri");
         put("cfg_bw_report_filename","cfg_bw_report_filename");
         put("cfg_nexus_uri","cfg_nexus_uri");
         put("cfg_sap_gui_exec_filename","cfg_sap_gui_exec_filename");
         put("cfg_sap_connection_name","cfg_sap_connection_name");
         put("cfg_gtin_mapping_filename","cfg_gtin_mapping_filename");
         put("cfg_email_secure_store_id","cfg_email_secure_store_id");
         put("cfg_valid_sender_list","cfg_valid_sender_list");
         put("cfg_pickup_mail","cfg_pickup_mail");
         put("cfg_attach_pdf","cfg_attach_pdf");
         put("local config","local_config");
		 put("cfg_tz_adjust_minutes_num","cfg_tz_adjust_minutes_num");
		 put("cfg_default_rdd_days_before","cfg_default_rdd_days_before");
		 put("cfg_default_rdd_days_after","cfg_default_rdd_days_after");
		 put("cfg_control_tower_endpoint","cfg_control_tower_endpoint");
		 put("cfg_po_fix_flag","cfg_po_fix_flag");
		 put("cfg_display_gtin_file_loc","cfg_display_gtin_file_loc");
		 put("cfg_gtin_customers_mapping_filename","cfg_gtin_customers_mapping_filename");
 		 put("gtin_maping_customers_xlsx_uri","gtin_maping_customers_xlsx_uri");	
		 put("cfg_max_qty","cfg_max_qty");
      }};

      def columnToValidationMap = new HashMap&lt;String, Predicate&lt;String&gt;&gt;() {{
         put("ENV", ConfigCellValidator.ENV_PREDICATE);
         put("Market", ConfigCellValidator.MARKET_PREDICATE);
         put("Country", ConfigCellValidator.TWO_CHARACTERS_PREDICATE);
         put("Language", ConfigCellValidator.TWO_CHARACTERS_PREDICATE);
         put("Language Single Ch", ConfigCellValidator.ONE_CHARACTER_PREDICATE);
         put("source of order", ConfigCellValidator.EMAIL_PREDICATE);
         put("In process error distribution list", ConfigCellValidator.EMAIL_PREDICATE);
         put("Price Comparison", ConfigCellValidator.YES_NO_PREDICATE);
         put("EAN6TO13 Conv SAP", ConfigCellValidator.YES_NO_PREDICATE);
         put("SAP-Archiving", ConfigCellValidator.YES_NO_PREDICATE);
         put("confirmation_email_from", ConfigCellValidator.EMAIL_PREDICATE);
         put("confirmation_email_recipient", ConfigCellValidator.EMAIL_PREDICATE);
         put("failure_email_from", ConfigCellValidator.EMAIL_PREDICATE);
         put("failure_email_recipient", ConfigCellValidator.EMAIL_PREDICATE);
         put("cfg_valid_sender_list", ConfigCellValidator.EMAIL_PREDICATE);
         put("cfg_pickup_mail", ConfigCellValidator.YES_NO_PREDICATE);
         put("cfg_attach_pdf", ConfigCellValidator.YES_NO_PREDICATE);
         put("smtp_server_port", ConfigCellValidator.NUMERIC_PREDICATE);
         put("manual_path_max_cnt", ConfigCellValidator.NUMERIC_PREDICATE);
         put("LE", ConfigCellValidator.NUMERIC_PREDICATE);
      }};

      def mandatoryColumns = Arrays.asList("ENV", "Market", "SOrg", "DChl");
      def supportedEnvs = Arrays.asList("PROD", "DEV");
      def supportedMarkets = Arrays.asList("DACH", "FBNL", "SE\\Iberia", "NE", "SE\\Italy");

      ConfigConstants.setMandatoryColumns(mandatoryColumns)
      ConfigConstants.setSupportedEnvs(supportedEnvs)
      ConfigConstants.setSupportedMarkets(supportedMarkets)
      ConfigConstants.setColumnToConfigMap(columnToConfigMap)

      ConfigCellValidator.setColumnToPredicateMap(columnToValidationMap)



      /**
         copying files
      */
      copyFromSharedDriveToLocal("eu\\" + sharedDriveUser,
         sharedDrivePass,
         "smb:" + cfg_central_config_uri.toString(),
         centralDestPath);



      /**
         read configs
      */
      _log("DEBUG", "Reading global config from " + centralDestPath + " for " + cfg_market_code.toString() + ".");
      def centralCfg = ConfigReader.readConfig(centralDestPath, grv_sys_env_code, cfg_market_code.toString());
      def localCfgPath = centralCfg.getEffectiveValue("local config");
      String jsonStr = "";
      def resultingCfg = centralCfg;

      if(localCfgPath != null &amp;&amp; !localCfgPath.trim().equals("")){
         _log("INFO", "Reading local config from " + localCfgPath + ".");
         def localDestPath = cfg_temp_dir.toString() + "/" + "configs/local.xlsx"
         copyFromSharedDriveToLocal("eu\\" + sharedDriveUser,
            sharedDrivePass,
            "smb:" + localCfgPath.replace("\\","/"),
            localDestPath);

         def localCfg = ConfigReader.readConfig(localDestPath, grv_sys_env_code, cfg_market_code.toString());
         resultingCfg = ConfigUtils.mergeConfigs(centralCfg, localCfg);
      }

      sys.defineVariable("grv_prc_config_valid_flag", "YES")

      if("ERROR".equals(resultingCfg.getStatus())){
         _log("ERROR", resultingCfg.getStatusMsg());
         sys.defineVariable("grv_prc_config_valid_flag", "NO")
         def body = "Error found in config files: " + resultingCfg.getStatusMsg() + " config files: " + cfg_central_config_uri.toString() + " , " + localCfgPath
         sys.defineVariable("emailBody", body)
         sys.defineVariable("emailTo", cfg_error_mail_list.toString())
         sys.defineVariable("emailSubject","[RPA][DACH] CORRUPTED CONFIGURATION FILES")
      }

      /**
         validate that all variables are defined
      */

 List&lt;String&gt; notEffectiveByDefinition = Arrays.asList("Distribution Channel Desc", "Country Desc", "SOrg", "Country", "source of order", "DChl", "LE");


            List&lt;String&gt; lackingVariables = new ArrayList&lt;String&gt;();
            for (String configKey: columnToConfigMap.keySet()) {
                if (!resultingCfg.isEffective(configKey) &amp;&amp; !notEffectiveByDefinition.contains(configKey)) {
                    lackingVariables.add(configKey);
                }
            }
      if (lackingVariables.size() &gt; 0) {
         _log("ERROR", "Following variable(s) not defined unabiguously in config files: " + lackingVariables.toString());
         sys.defineVariable("grv_prc_config_valid_flag", "NO");
         def body = "Following variable(s) not defined unabiguously in config files: " + resultingCfg.getStatusMsg() + " config files: " + cfg_central_config_uri.toString() + " , " + localCfgPath + ": " + lackingVariables.toString();
         sys.defineVariable("emailBody", body)
         sys.defineVariable("emailTo", cfg_error_mail_list.toString())
         sys.defineVariable("emailSubject","[RPA][DACH] CORRUPTED CONFIGURATION FILES")
      }

      jsonStr = ConfigUtils.toJSON(resultingCfg);
      sys.defineVariable("grv_cfg_json", jsonStr)



      /**
         print out read variables
      */

	  ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();
      for (String key: columnToConfigMap.keySet()) {
         _log("DEBUG", columnToConfigMap.get(key) + " -&gt; " + resultingCfg.getEffectiveValue(key));
		 list.add(columnToConfigMap.get(key) + "|" + resultingCfg.getEffectiveValue(key));
		 //sys.defineVariable(columnToConfigMap.get(key), resultingCfg.getEffectiveValue(key))		 
      }
	  sys.defineVariable("list", list);
   ]]&gt;&lt;/script&gt;



   &lt;!--
      send e-mail in case of errors in config
   --&gt;   
   &lt;case&gt;
      &lt;if condition="${grv_prc_config_valid_flag} == 'NO'}"&gt;
         &lt;mail smtp-host="smtpgw.pg.com"
            type="html"
            smtp-port="25"
            from="cncsoshared.im@pg.com"
            to="${cfg_error_mail_list}"
            subject="${emailSubject}"&gt;
            &lt;template&gt;&lt;![CDATA[
               ${emailBody}
            ]]&gt;&lt;/template&gt;
         &lt;/mail&gt;
      &lt;/if&gt;
   &lt;/case&gt;



	&lt;export include-original-data="true"&gt;
      &lt;single-column name="cfg_json" value="${grv_cfg_json}"/&gt;
      &lt;single-column name="prc_config_valid_flag" value="${grv_prc_config_valid_flag}"/&gt;
      &lt;single-column name="prc_log_text" value="${grv_prc_log_text}"/&gt;
      &lt;single-column name="sys_env_code" value="${grv_sys_env_code}"/&gt;
	  
	  &lt;loop empty="true" item="single_config"&gt;
        &lt;list&gt;&lt;var name="list"/&gt;&lt;/list&gt;
        &lt;body&gt;
        	&lt;script&gt;&lt;![CDATA[
        		String [] conf = single_config.toString().split("\\|")
		           if(conf.length == 2){
            			sys.defineVariable("name", conf[0])
            			sys.defineVariable("value", conf[1])
        			}
		    ]]&gt;&lt;/script&gt;
           &lt;single-column name="${name}" value="${value}"/&gt;  
        &lt;/body&gt;
    &lt;/loop&gt;       
   &lt;/export&gt;

&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>70a3e91a-bde8-4a7c-a44c-4597ce7ed7f2</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[001] Read configs32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>70a3e91a-bde8-4a7c-a44c-4597ce7ed7f2</uuid>
                                    <version>
                                        <componentUuid>c2bed9e5-f333-43be-95b2-a8bcedbd1339</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>b95a859e-7a9c-495a-8c8d-7e9a6aa0878a</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[001] Read configs32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>6b07f215-9b64-447c-aa06-34f99281a717</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>35c6cd4c-b480-4e2c-849f-d60ebee9c6a4</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>d13623d6-6eda-4bca-b8ec-59eb9a45d5af</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>1</stepIndex>
                            <stepPosition>START</stepPosition>
                            <uuid>a1f1a040-d994-460f-99da-68b61bc0e909</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"debug_mode","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'YES' when debug_mode EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("debug_mode", "EQ", "YES"));

    then
        $ctx.sendResultTo("YES", $item);
end

# RuleOutcome.Definition={"outcomeId":"NO","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"debug_mode","value":"NO","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'NO' when debug_mode EQ 'NO'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("debug_mode", "EQ", "NO"));

    then
        $ctx.sendResultTo("NO", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>isDebugging</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>4ab28451-3ee8-4bbb-aba1-36ec7dd1c952</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
   &lt;!--
      changelog:
         3.1.6 header comment added
   --&gt;
	&lt;script&gt;&lt;![CDATA[
		import java.time.LocalDateTime;
		import java.time.format.DateTimeFormatter;

		import com.freedomoss.crowdcontrol.webharvest.RunDto;
		import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

        import groovy.json.JsonBuilder
        import groovy.json.JsonOutput
        import groovy.json.JsonSlurper


		RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		rootUuid = run.getRootRunUuid(); 

		po_date_fix = LocalDateTime.now()
								.plusMinutes(Integer.valueOf(cfg_tz_adjust_minutes_num.toString()))
								.format(DateTimeFormatter.ofPattern("dd.MM.yyyy"));
		creationSortingDttm = LocalDateTime.now()
								.plusMinutes(Integer.valueOf(cfg_tz_adjust_minutes_num.toString()))
								.format(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm"));

		//set default values for rdd range		
		if (binding.hasVariable('cfg_rdd_days_after')) {
		cfg_rdd_days_after_range = cfg_rdd_days_after.toString()		
		}
		else{
	  	cfg_rdd_days_after_range = cfg_default_rdd_days_after.toString()	
		}

       if (binding.hasVariable('cfg_rdd_days_before')) {
		cfg_rdd_days_before_range = cfg_rdd_days_before.toString()		
		}
		else{
	  	cfg_rdd_days_before_range = cfg_default_rdd_days_before.toString()	
		}
    
 	    //init json variable
        def json = new JsonBuilder()
        variables = ["sales_area_id", "distribution_channel_id", "ship_to_id", "rdd_orig"]
        def dummyArray = [""]
            json {
                variables.collect {
                "${it}" {
                    "value" ""
                    "history"  dummyArray.collect {[
                         modifiedBy: "[000] initialize",
                         version: 0,
                         modifiedDate: new Date(),
                         value: ""
                   ]}
                   }
                }
            }

        variables = json.toString() 

		

		log.warn("Initialized");
	]]&gt;&lt;/script&gt;
	&lt;export include-original-data="true"&gt;
        &lt;single-column name="variables" value="${variables}" /&gt;
        &lt;single-column name="po_number" value="" /&gt;
        &lt;single-column name="order_number" value="" /&gt;
        &lt;single-column name="ship_to_name" value="" /&gt;
        &lt;single-column name="ship_to_location" value="" /&gt;
        &lt;single-column name="ship_to_postal_code" value="" /&gt;
        &lt;single-column name="ship_to_street_name" value="" /&gt;
        &lt;single-column name="rdd_orig" value="" /&gt;
        &lt;single-column name="product_code_list" value="" /&gt;
        &lt;single-column name="quantity_list" value="" /&gt;
        &lt;single-column name="creation_sorting_dttm" value="${creationSortingDttm}" /&gt;
      
		 &lt;single-column name="rdd" value="" /&gt;
        &lt;single-column name="rdt" value="" /&gt;
        &lt;single-column name="ship_to_id" value="" /&gt;
        &lt;single-column name="sold_to" value="" /&gt;
        &lt;single-column name="sales_area_id" value="" /&gt;
        &lt;single-column name="gtin_list" value="" /&gt;
     
      &lt;single-column name="cfg_rdd_days_after_range" value="${cfg_rdd_days_after_range}" /&gt;
      &lt;single-column name="cfg_rdd_days_before_range" value="${cfg_rdd_days_before_range}" /&gt;
      
		&lt;single-column name="po_date" value="${po_date_fix}" /&gt;
      	&lt;single-column name="canceled_manual_task" value="NO" /&gt;
		&lt;single-column name="beyond_repair_flag" value="NO" /&gt;
		&lt;single-column name="manual_path_cnt" value="0" /&gt;
		&lt;single-column name="order_number" value="" /&gt;
		&lt;single-column name="sap_screenshot_file_uri" value="" /&gt;
		&lt;single-column name="uuid" value="${rootUuid}" /&gt;
		&lt;single-column name="env_name" value="${env}" /&gt;
		&lt;single-column name="workspace_name" value="" /&gt;
    	&lt;single-column name="error_id_list" value="" /&gt;
    	&lt;single-column name="error_description_list" value="" /&gt;
	&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>ffafe1d0-9220-41c7-ab41-9d23d550c0ff</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[000] initialize      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>ffafe1d0-9220-41c7-ab41-9d23d550c0ff</uuid>
                                    <version>
                                        <componentUuid>05319cd9-cafd-4aa1-87cc-e64592b7f50b</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>1c69967e-3060-42ba-b393-26efb5575f43</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[000] initialize      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>974b05b9-5021-4b03-b0d2-00a8de240f51</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>3a491ccc-12c6-4e5a-98a9-823b6eea7ad8</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>5435deae-3c9d-4a40-9f5c-d4254862a2f8</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>2</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>b6fce3d7-9ff9-4157-adf4-e57db4e3d201</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"drv_mails_cnt","value":"0","operator":"GT"}],"customConditions":[]}
rule "1. Send records to 'YES' when drv_mails_cnt GT '0'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("drv_mails_cnt", "GT", "0"));

    then
        $ctx.sendResultTo("YES", $item);
end

# RuleOutcome.Definition={"outcomeId":"NO","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"drv_mails_cnt","value":"0","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'NO' when drv_mails_cnt EQ '0'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("drv_mails_cnt", "EQ", "0"));

    then
        $ctx.sendResultTo("NO", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>e-mails to process</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>35499b53-e1ac-48cc-b1af-e56f6de6a258</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

   &lt;!-- retrieve e-mail credentials --&gt;
   &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name2", "${cfg_email_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name2}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName2 = secure_store_name2.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName2);
      emailUser = obj.getKey().toString();
      emailPassword = obj.getValue().toString();
   ]]&gt;&lt;/script&gt;  

   &lt;!-- retrieve S3 credentials --&gt;
   &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name3", "${s3_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name3}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName3 = secure_store_name3.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName3);
      accessKey = obj.getKey().toString();
      secretKey = obj.getValue().toString();
   ]]&gt;&lt;/script&gt;  

   &lt;script&gt;&lt;![CDATA[
		import org.apache.commons.io.FileUtils;
		import org.apache.commons.io.IOUtils;
		import javax.mail.Flags;
		import javax.mail.Folder;
		import javax.mail.Message;
		import javax.mail.MessagingException;
		import javax.mail.Multipart;
		import javax.mail.NoSuchProviderException;
		import javax.mail.Part;
		import javax.mail.Session;
		import javax.mail.Store;
		import javax.mail.internet.MimeBodyPart;
		import javax.mail.search.FlagTerm;
		import java.security.MessageDigest;
		import java.security.NoSuchAlgorithmException;
		import java.time.LocalDateTime;
		import java.time.ZoneId;
		import java.time.format.DateTimeFormatter;
		import java.util.stream.Collectors;
		import java.util.regex.Matcher;
		import java.util.regex.Pattern;

		import com.workfusion.utils.client.AmazonUtils;
		import com.amazonaws.auth.BasicAWSCredentials;
		import com.amazonaws.services.s3.model.CannedAccessControlList;
		import com.amazonaws.services.s3.model.PutObjectRequest;

//region Classes definition
//////////////////////////////
		class Sequence {
			int i=0;
			public int next() {
				return i++;
			}
            private static Sequence instance;

            private Sequence(){}

            public static Sequence getInstance(){
                if(instance == null){
                    instance = new Sequence();
                }
                return instance;
            }	
 		}

		/**
		 * This class represents a single e-mail that can be obtained from a Message instance.
		 */
		class Email {

			String from

			String title

			String datetime

			List&lt;File&gt; attachments

			//ID is obtained by calling MD5(title + datetime)
			String id

			int sequenceNo

			Email(int sequenceNo, String from, String title, String datetime, List&lt;File&gt; attachments) {
                this.sequenceNo = sequenceNo
				this.from = from
				this.title = title
				this.datetime = datetime
				this.attachments = attachments
				this.id = MailUtils.md5(
					String.valueOf(sequenceNo) +
					title + 
					datetime + 
					((attachments.size() == 1)?(
						String.valueOf(attachments.get(0).length()) + 
                        attachments.get(0).getName()
					):"")
				);
			}

			static Email fromMessage(Message message) {
				try {
					String from = Arrays.stream(message.getFrom())
							.map { e -&gt; e.toString() }
							.reduce { a, b -&gt; b }
							.orElse { "Cannot obtain from address" }
					String title = message.getSubject()
					String formattedDateTime
					try {
						LocalDateTime dateTime = LocalDateTime.ofInstant(message.getSentDate().toInstant(), ZoneId.systemDefault())
						DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm")
						formattedDateTime = dateTime.format(formatter) //
					} catch (NullPointerException e) {
						formattedDateTime = "No sent date available"
					}
					List&lt;File&gt; attachments = attachmentsFromMessage(message)
					return new Email(Sequence.getInstance().next(), from, title, formattedDateTime, attachments)
				} catch (MessagingException e) {
					//log.error("Could not obtain object of type Email from message")
					//log.error(e)
println("Could not obtain object of type Email from message")
println(e);
					return null
				}
			}

			static List&lt;File&gt; attachmentsFromMessage(Message message) throws MessagingException {
				List&lt;File&gt; attachments = new ArrayList&lt;&gt;()

				String contentType = message.getContentType()
				int numberOfTotalAttachements=0;
				if (contentType.contains("multipart")) {
					//if here, it may contain attachments
					try {
						Multipart multiPart = (Multipart) message.getContent()
						int numberOfParts = multiPart.getCount()
						
						for (int partCount = 0; partCount &lt; numberOfParts; partCount++) {
							MimeBodyPart part = (MimeBodyPart) multiPart.getBodyPart(partCount)
							if (Part.ATTACHMENT.equalsIgnoreCase(part.getDisposition())) {
								// this part is attachment
								numberOfTotalAttachements++
								String fName = getFileName(part) //part.getFileName()
								if (isFilenamePDF(fName)) {
&#47847;									//this part is PDF attachments
									attachments.add(mimeBodyPartToFile(part))
								}
								else{
									//TODO add notificaion for not pdf attachement
									println("---not pdf attachement");
								}
							}
						
						}
					} catch (IOException e) {
						//seems like no attachment here...
						println("---EX=" + e.getMessage());
						return Collections.emptyList()
					}
				}
				if(numberOfTotalAttachements!=1) {return Collections.emptyList();}
				return attachments
			}
		}

		class MailboxReader {

			String username
			String password
			Properties connectionProperties
			Store connectedStore
			Sequence seq = new Sequence()

			MailboxReader(String username, String password, Map connectionProperties) {
				this.username = username
				this.password = password
				this.connectionProperties = connectionPropertiesFromMap(connectionProperties)
			}

			Properties connectionPropertiesFromMap(Map&lt;String, String&gt; properties) {
				Properties connectionProperties = new Properties()
				connectionProperties.putAll(properties)
				return connectionProperties
			}

			List&lt;Email&gt; getAllNotSeenEmails() {
				//log.warn("Entering getAllNotSeenEmails")
				
				try {
					Folder inbox = getInboxFolder()
					List&lt;Message&gt; unreadMessages = getUnreadMessages(inbox)
					List&lt;Email&gt; emails = unreadMessages.stream()
							.map { message -&gt; Email.fromMessage(message) }
							.filter { obj -&gt; Objects.nonNull(obj) }
					//   	.filter { email -&gt; email.attachments.size() == 1 }
							.collect(Collectors.toList())

					markMessagesAsRead(unreadMessages)
					//log.warn("UnreadMessagenges:"+unreadMessages.size())
					//log.warn("emails:"+emails.size())
					return emails

				} catch (MessagingException e) {
					//log.error("Something wrong during execution of getAllNotSeenEmailsWithOnePDFAttachment()")
					//log.error(e)
println("Something wrong during execution of getAllNotSeenEmails()")
println(e)
				}
				return Collections.emptyList()
			}
		
			private void markMessagesAsRead(List&lt;Message&gt; messages) {
				messages.forEach{markMessageAsRead(it)}
			}

			private void markMessageAsRead(Message message) {
				message.setFlag(Flags.Flag.SEEN, true)
			}

			private List&lt;Message&gt; getAllMessages(Folder folder) throws MessagingException {
				return (getReadMessages(folder) as Message[]) + (getUnreadMessages(folder) as Message[])
			}

			private List&lt;Message&gt; getReadMessages(Folder folder) throws MessagingException {
				Flags seenFlag = new Flags(Flags.Flag.SEEN)
				FlagTerm seen = new FlagTerm(seenFlag, true)
				return Arrays.asList(folder.search(seen))
			}

			private List&lt;Message&gt; getUnreadMessages(Folder folder) throws MessagingException {
				Flags seenFlag = new Flags(Flags.Flag.SEEN)
				FlagTerm notSeen = new FlagTerm(seenFlag, false)
				return Arrays.asList(folder.search(notSeen))
			}

			private Folder getInboxFolder() throws NoSuchProviderException, MessagingException {
				Store store = getConnectedStore()
				Folder inbox = store.getFolder("INBOX")
				inbox.open(Folder.READ_WRITE)
				return inbox
			}

			private synchronized Store getConnectedStore() throws NoSuchProviderException, MessagingException {
				Store store
				println "GetConnectedStore()"
				if (connectedStore == null) {
					Session session = Session.getInstance(connectionProperties)
					session.setDebug(true) // this will print information on console
					store = session.getStore(connectionProperties.getProperty("mail.store.protocol"))
					store.connect(connectionProperties.getProperty("mail.imap.host"),username, password)
					println "Store isConnected: " + store.isConnected();
					this.connectedStore = store
				}
				println "Store isConnected2: " + store.isConnected();
				return store
			}
		}

//endregion Classes definition
//////////////////////////////

    /**
     * This takes a string and returns calculated md5 hash of it.
     *
     * @param str
     * @return
     */
    String calculateMd5(String str) {
        try {
            MessageDigest md = MessageDigest.getInstance("MD5")
            md.reset() //needs to be done since it is a singleton
            md.update(str.getBytes("UTF-8"))

            byte[] md5HashedBytes = md.digest()
            BigInteger bigInt = new BigInteger(1, md5HashedBytes)
            String hashedText = bigInt.toString(16)
            // Now we need to zero pad it if you actually want the full 32 chars.
            while (hashedText.length() &lt; 32) {
                hashedText = "0" + hashedText
            }
            return hashedText
        } catch (NoSuchAlgorithmException | IOException e) {
            println("----Could not obtain md5.");
            println(e);
            //log.error("Could not obtain md5.")
            //log.error(e)
        }
        return "Could not obtain md5 from str. Random id: " + UUID.randomUUID().toString()
    }

    File mimeBodyPartToFile(MimeBodyPart part) throws MessagingException, IOException {
        String tempDir = System.getProperty("java.io.tmpdir");
        if (tempDir.charAt(tempDir.length() - 1) != File.separator){
            tempDir += File.separator;
        }
        byte[] bytes = inputStreamToByteArray(part.getInputStream())
        File attachment = new File(tempDir + "tmpMailbox" + File.separator + getFileName(part))
        FileUtils.writeByteArrayToFile(attachment, bytes)
        return attachment
    }

    byte[] inputStreamToByteArray(InputStream is) throws IOException {
        return IOUtils.toByteArray(is)
    }

    boolean isFilenamePDF(String fileName) {
        return fileName.toLowerCase().contains(".pdf")
    }

    String getFileName(Part part) throws MessagingException, UnsupportedEncodingException {
        if (!(part instanceof MimeBodyPart)) {
            return part.getFileName();
        }
        String contentType = part.getContentType();
        String ret = null;
        try {
            ret = javax.mail.internet.MimeUtility.decodeText(part.getFileName());
        }
        catch (NullPointerException ex) {
            String[] contentId = part.getHeader("Content-ID");
            if (contentId != null &amp;&amp; contentId.length &gt; 0) {
                ret = contentId[0];
            }
            if (contentId == null) {
                ret = "no-name";
            }
            ret += "."  + contentType.substring(contentType.lastIndexOf("/") + 1,contentType.length());
        }
        return ret == null ? "" : ret;
    }

		///LETS call it MAIN FUNCTION BODY:
		println "---==== START ====----";

		HashMap&lt;String, String&gt; connectionProperties = new HashMap&lt;String, String&gt;();

		connectionProperties.put("mail.store.protocol", "imaps");
		connectionProperties.put("mail.imap.ssl.enable", "true");
		connectionProperties.put("mail.imap.host", "outlook.office365.com");
		connectionProperties.put("mail.imap.port", "993");
	
		MailboxReader mailboxReader = new MailboxReader(emailUser, emailPassword, connectionProperties);
		
		List&lt;Email&gt; retrievedEmails = mailboxReader.getAllNotSeenEmails();
		
		mailsCnt = retrievedEmails.size();
		log.warn("Retrieved emails count: " + mailsCnt);

		//returns a list of hasmaps shape: {document_link: URL to uploaded file}
		uploadEmailsAttachmentsToS3 = {List&lt;Email&gt; emails -&gt;
			def attachmnentsS3URLs = [];

			awsCredentials = new BasicAWSCredentials(accessKey, secretKey);
			s3Client = AmazonUtils.createS3Client(awsCredentials, s3_endpoint_url.toString(), AmazonUtils.S3_SIGNER);

			for (Email email : emails) {
			  Matcher emailMatcher = Pattern.compile("[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+").matcher(email.from);
	
              emailSender = ""
              if(emailMatcher.find()){
                  emailSender=emailMatcher.group();
              }

              if(email.attachments.size()==1){
                log.warn("One attachement: ")
                File attachment = email.attachments.get(0);
                String pathOnS3 = "orders/" + email.id + ".pdf";

                putObjRequest = new PutObjectRequest(s3_attachments_bucket.toString(), pathOnS3, attachment).withCannedAcl(CannedAccessControlList.PublicRead);
                s3Client.putObject(putObjRequest);
                String s3FileURL =  s3Client.getResourceUrl(s3_attachments_bucket.toString(), pathOnS3);
                attachmnentsS3URLs.add(["document_link": s3FileURL, "mail_id": email.id, "sender": emailSender]);
              }
              else{
                  //log.warn("No attachments: "+ email.attachments.size())
                 attachmnentsS3URLs.add(["document_link": "", "mail_id": email.id, "sender": emailSender]);
              }
          }

			return attachmnentsS3URLs;
		}

		attachments_urls = uploadEmailsAttachmentsToS3(retrievedEmails);
	]]&gt;&lt;/script&gt;

	&lt;script&gt;&lt;![CDATA[
		log.warn("Links: " + attachments_urls)
		//println ("Links: " + attachments_urls)
		log.warn("mailsCnt: " + mailsCnt)
		//log.warn("confirmation_email_recipient: " + confirmation_email_recipient.toString())
		//log.warn("failure_email_recipient: " + failure_email_recipient.toString())
		
	]]&gt;&lt;/script&gt;
	&lt;export include-original-data="true"&gt;
    
    	&lt;single-column name="drv_mails_cnt" value="${mailsCnt}" /&gt;
		&lt;multi-column split-results="true" list="${attachments_urls}"&gt;
			&lt;put-to-column-getter property="mail_id" name="mail_id" /&gt;
			&lt;put-to-column-getter property="document_link" name="document_link" /&gt;
			&lt;put-to-column-getter property="sender" name="sender" /&gt;
		&lt;/multi-column&gt;
	&lt;/export&gt;

&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>68a68de6-e6ce-48b2-bc1b-186df0194dd9</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[010] mailbox reader</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>68a68de6-e6ce-48b2-bc1b-186df0194dd9</uuid>
                                    <version>
                                        <componentUuid>93b90599-258f-46ca-a736-55ec64b0520e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-04T13:50:27Z</lastModified>
                                        <versionUuid>49d756b8-d92d-47f6-a9e9-6ec82a35e8ce</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[010] mailbox reader</title>
                                <type>SINGLE</type>
                                <uuid>47949834-71f3-4c55-8562-0285273bbc8e</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>5292973c-ad33-479c-9bc8-1223733b6765</componentUuid>
                                    <incrementalVersion>1.2</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-04T13:50:30Z</lastModified>
                                    <versionUuid>73c83be7-fd27-4b0b-a7d9-d986c9e47b82</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>3</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>a8a05f57-0ba0-42ee-a61d-2dbd56df18a6</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_data_prepared_flag","value":"NO","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'YES' when ocr_data_prepared_flag EQ 'NO'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_data_prepared_flag", "EQ", "NO"));

    then
        $ctx.sendResultTo("YES", $item);
end

# RuleOutcome.Definition={"outcomeId":"NO","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_data_prepared_flag","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'NO' when ocr_data_prepared_flag EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_data_prepared_flag", "EQ", "YES"));

    then
        $ctx.sendResultTo("NO", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>OCR needed?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>4a6f9a79-634a-4b28-b0ec-5184c4d94312</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	
	&lt;script&gt;&lt;![CDATA[
		
	]]&gt;&lt;/script&gt;
	
	&lt;script&gt;&lt;![CDATA[
		import org.apache.poi.ss.usermodel.Cell;
		import org.apache.poi.ss.usermodel.Row;
		import org.apache.poi.ss.usermodel.Sheet;
		import org.apache.poi.ss.usermodel.Workbook;
		import org.apache.poi.ss.util.CellReference;
		import org.apache.poi.ss.usermodel.DataFormatter;
		import org.apache.poi.xssf.usermodel.XSSFWorkbook;
		import org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator;
		import org.apache.poi.xssf.usermodel.XSSFWorkbook;
		import java.io.File;
		import java.io.FileInputStream;

		def COLUMNS_MAPPING = [
			po_number: 0,
			rdd_orig: 1,
			ship_to_name: 2,
			ship_to_location: 3,
			ship_to_postal_code: 4,
			ship_to_street_name: 5,
			product_information: 6
		];

		def getExcelWorkbookFromPath = {String path -&gt;
			def file = new File(path);
			return new XSSFWorkbook(file);
		}

		def getTestDataFeedSheetFromWorkbook = {XSSFWorkbook wb -&gt;
			return wb.getSheet("test_cases");
		}
		
		def getCellValueAsString = {XSSFWorkbook wb, Cell cell -&gt; 
			return new DataFormatter().formatCellValue(cell, new XSSFFormulaEvaluator(wb));
		}
		
		def getLongOrEmptyString = {XSSFWorkbook wb, Cell cell -&gt;
			try {
				return Long.parseLong(getCellValueAsString(wb, cell), 10)
			} catch (NumberFormatException e) {
				return "";
			}
		}

		def getFinalMapping = {path -&gt;
			def wb = getExcelWorkbookFromPath(path);
			def testDataSheet = getTestDataFeedSheetFromWorkbook(wb);

			def ret = [];

			testDataSheet.rowIterator().eachWithIndex{row, i -&gt;
				if (i == 0) {
				} else {
					ret.add(
							[
								ocr_data_prepared_flag: getCellValueAsString(wb, row.getCell(7)),
								mail_id: getCellValueAsString(wb, row.getCell(8))?:("row_" + String.valueOf(i)),
								document_link: getCellValueAsString(wb, row.getCell(9)),
								expected_error_id_list: getCellValueAsString(wb, row.getCell(10)),
								po_number: getLongOrEmptyString(wb, row.getCell(0)),
								rdd_orig: getCellValueAsString(wb, row.getCell(1)),
								ship_to_name: getCellValueAsString(wb, row.getCell(2)),
								ship_to_location: getCellValueAsString(wb, row.getCell(3)),
								ship_to_postal_code: getLongOrEmptyString(wb, row.getCell(4)),
								ship_to_street_name: getCellValueAsString(wb, row.getCell(5)),
								product_information:getCellValueAsString(wb, row.getCell(6)),
			
							]);
				}
			}
			
			return ret;
		}
		toExport = getFinalMapping(test_cases_xlsx_uri.toString());
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
		&lt;multi-column list="${toExport}" split-results="true"&gt;
			&lt;put-to-column-getter name="ocr_data_prepared_flag" property="ocr_data_prepared_flag" /&gt;
			&lt;put-to-column-getter name="document_link" property="document_link" /&gt;
			&lt;put-to-column-getter name="mail_id" property="mail_id" /&gt;
			&lt;put-to-column-getter name="purchase_order" property="po_number" /&gt;
			&lt;put-to-column-getter name="request_delivery_date" property="rdd_orig" /&gt;
			&lt;put-to-column-getter name="customer_name" property="ship_to_name" /&gt;
			&lt;put-to-column-getter name="city" property="ship_to_location" /&gt;
			&lt;put-to-column-getter name="zip_code" property="ship_to_postal_code" /&gt;
			&lt;put-to-column-getter name="street_address" property="ship_to_street_name" /&gt;
			&lt;put-to-column-getter name="product_information" property="product_information" /&gt;
			&lt;put-to-column-getter name="test_case_number" property="test_case_number" /&gt;
			&lt;put-to-column-getter name="expected_error_id_list" property="expected_error_id_list" /&gt;
		&lt;/multi-column&gt;
	&lt;/export&gt;

&lt;/config&gt; 
</content>
                                    <description>wszystko do OCRa wlacznie</description>
                                    <includedConfigs/>
                                    <inclusionCode>1ac16d24-e907-4471-8f7f-c8100c21ad37</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[100] Load testcases      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>1ac16d24-e907-4471-8f7f-c8100c21ad37</uuid>
                                    <version>
                                        <componentUuid>f7799593-ccf2-4cad-ab4b-cf7e96d92ea8</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>aec65335-c10a-4723-b21c-1b1d131abd36</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[100] Load testcases      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>1739a8e1-fa38-47ab-a328-5f64ddd76136</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>57b246f1-a75f-4e36-a289-c1932be74d1d</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>3003e74f-6678-4c83-abaa-e0de54fcf2cc</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>4</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>0674b08b-6cf4-4ffd-8c4a-9eee698f28c7</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>be9fa62b-fcc2-4fc6-964f-6c411fc15bcf</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

  	&lt;!-- generic method secret storage accessing --&gt;
	&lt;script&gt;&lt;![CDATA[
		class SecureStoreMap {
			String key;
			String value;
		}

		//This is for retrievieng key-value map from secure store. Needs to be used after
		//definition of tag &lt;secure-store-get alias="some_alias"&gt;
		retrieveMapFromSecureStore = { String secureStoreName -&gt;
			Map entryMap = secureEntryMap.getWrappedObject();
			com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName);
			String key = obj.getKey();
			String val = obj.getValue();
			return new SecureStoreMap(key: key, value: val);
		}
	]]&gt;&lt;/script&gt;

	&lt;!-- generic methods for file operations --&gt;
	&lt;script&gt;&lt;![CDATA[
		import java.io.File;
		import java.io.IOException;
		import java.nio.file.Files;
		import java.nio.file.StandardCopyOption;
		import org.apache.commons.io.FileUtils;

		//helper function for deleting directory
		deleteDirectory = {File directory -&gt;
			if(directory.exists()){
				File[] files = directory.listFiles();
				if(null!=files){
					for(int i=0; i&lt;files.length; i++) {
						if(files[i].isDirectory()) {
							deleteDirectory(files[i]);
						}
						else {
							files[i].delete();
						}
					}
				}
			}
			return(directory.delete());
		}

		//helper function for creating directory
		createDirectory = {File dir -&gt;
			dir.mkdir();
		}

		copyFileFromTo = {File src, File target -&gt;
			try {
				Files.copy(src.toPath(), target.toPath(), StandardCopyOption.REPLACE_EXISTING);
			} catch (IOException e) {
				log.error("Could not copy file from: " + src.toPath() + " to: " + target.toPath())
			}
		}

		copyFolderFromTo = { File srcDir, File targetDir -&gt;
			FileUtils.copyDirectory(srcDir, targetDir);
		}
	]]&gt;&lt;/script&gt;

	&lt;!-- generic methods TMP dir operations --&gt;
	&lt;script&gt;&lt;![CDATA[
		getDownloadsDirectoryFile = {
			-&gt;
			def sysDrive = System.getenv("HOMEDRIVE");
			def sysHomePath = System.getenv("HOMEPATH");
			log.error("SysDrive: " + sysDrive);
			log.error("SysHomePath: " + sysHomePath)
			def downloadsDir = sysDrive + sysHomePath + "\\Downloads";
			return new File(downloadsDir)
		}

		getTmpDownloadsDirectoryFile = {
			-&gt;
			def tmpDownloadsDir = "C:\\tmpDownloadDir";
			return new File(tmpDownloadsDir);
		}

		copyDownloadsFolderToTmpFolder = {
			-&gt;
			def tmpDownloadsDir = getTmpDownloadsDirectoryFile();
			createDirectory(tmpDownloadsDir);
			copyFolderFromTo(getDownloadsDirectoryFile(), tmpDownloadsDir);
		}

		copyTmpFolderToDownloadsFolder = {
			-&gt;
			copyFolderFromTo(getTmpDownloadsDirectoryFile(), getDownloadsDirectoryFile());
		}

		emptyDownloadsFolder = {
			-&gt;
			def downloadsDir = getDownloadsDirectoryFile();
			deleteDirectory(downloadsDir);
			createDirectory(downloadsDir);
		}
	]]&gt;&lt;/script&gt;

	&lt;!-- generic functions to aid downloading file from browser  --&gt;
	&lt;script&gt;&lt;![CDATA[
		import java.util.Arrays;

		//Helper function for getting the most recently modified file in given directory
		getMostRecentFileInDirectory = {File dir -&gt;
			log.error("Invoked getMostRecentFileInDirectory with file: " + dir + " of name: " + dir.getName() + " and files inside: " + dir.listFiles());
			return Arrays.stream(dir.listFiles() as File[]).sorted({x, y -&gt;
				if (x.lastModified() &lt; y.lastModified()) {
					return -1;
				} else if (x.lastModified() == y.lastModified()) {
					return 0;
				} else {
					return 1;
				}
			}).reduce({a, b -&gt; b}).orElse(null);
		}

		//Helper function. Use it if you are downloading a file. It will not return until given file
		//is fully downloaded or maxWaitLoops (default 10) is achieved.
		waitForFileToDownload = {File f, int maxWaitLoops = 10 -&gt;
			log.warn("Invoked waitForFileToDownload with file: " + f +" of name: " + f.getName())
			for (int i = 0; i &lt; maxWaitLoops; i++) {
				size1 = f.length();
				// wait for 15 sec
				try {
					Thread.sleep(15000);
				} catch (InterruptedException e) {
					e.printStackTrace();
					return false;
				}
				size2 = f.length();
				if (size1 == size2) {
					break;
				}
			}
			return true;
		}
	]]&gt;&lt;/script&gt;

    &lt;!-- retrieve SAP BW credentials from secure storage --&gt;
	&lt;script&gt;&lt;![CDATA[
		secure_store_sap_bw = "${sap_bw_credentials_secure_store_id}".toString();
	]]&gt;&lt;/script&gt;
	&lt;secure-store-get alias="${secure_store_sap_bw}" /&gt;
	&lt;script&gt;&lt;![CDATA[
		def usernamePasswordMap = retrieveMapFromSecureStore(secure_store_sap_bw);
		def username = usernamePasswordMap.key
		def password = usernamePasswordMap.value
		sapBwUrl = "http://" + username.toLowerCase() + ":" + password + "@" + cfg_bw_report_uri.toString();
		
		log.error("Retrieved userName and Password for SAP BW secure store.")
	]]&gt;&lt;/script&gt;

    &lt;!-- retrieve S3 credentials from secure storage --&gt;
	&lt;script&gt;&lt;![CDATA[
		secure_store_sap_bw = "${s3_secure_store_id}".toString();
	]]&gt;&lt;/script&gt;
	&lt;secure-store-get alias="${secure_store_sap_bw}" /&gt;
	&lt;script&gt;&lt;![CDATA[
		def usernamePasswordMap = retrieveMapFromSecureStore(secure_store_sap_bw);
		accessKey = usernamePasswordMap.key
		secretKey = usernamePasswordMap.value

		log.error("Retrieved access and secret keys for S3 secure store.")
	]]&gt;&lt;/script&gt;

    &lt;!-- start downloading in Chrome --&gt;
	&lt;robotics-flow&gt;
		&lt;robot name="seleniumDriver" driver="chrome"
			close-on-completion="true" start-in-private="true"&gt;
			&lt;script&gt;&lt;![CDATA[
			// Open SAP BW and download excel file
			
				log.warn("Starting selenium script: Open SAP BW and download file")
				log.warn("System os: " + System.getProperty("os.name"))
			
				import java.util.concurrent.TimeUnit;
				import java.io.File;
				driver = seleniumDriver.getWrappedObject();
				driver.manage().timeouts().implicitlyWait(1, TimeUnit.MINUTES).pageLoadTimeout(1, TimeUnit.MINUTES);

				By exportToExcelLocator = By.xpath("/html/body/table/tbody/tr[3]/td/table/tbody/tr[1]/td/table[2]/tbody/tr[2]/td/table/tbody/tr[1]/td/table/tbody/tr/td[11]/table/tbody/tr/td/table/tbody/tr/td/a/nobr");

				//navigate to SAP BW
				driver.get(sapBwUrl);

				//select button "export to excel"
				driver.findElement(exportToExcelLocator).click();

				//wait 30 seconds to make sure downloading started
				Thread.sleep(30000);
		 ]]&gt;&lt;/script&gt;
		&lt;/robot&gt;
	&lt;/robotics-flow&gt;
	
    &lt;!-- transfer downloaded file from Windows to Linux --&gt;
	&lt;selenium-flow&gt;
		&lt;selenium name="seleniumDriver" browser="autoit"
			close-on-completion="true"&gt;
	&lt;script&gt;&lt;![CDATA[
		//Take file

		driver = seleniumDriver.getWrappedObject();

		getDownloadedFileContent = {RemoteWebDriver aDriver -&gt;
			Object res = aDriver.executeScript(
					"getMostRecentFileInDirectory = {File dir -&gt; \n"
					+ "	return Arrays.stream(dir.listFiles() as File[]).sorted({x, y -&gt; \n"
					+ "		if (x.lastModified() &lt; y.lastModified()) { \n"
					+ "			return -1; \n"
					+ "		} else if (x.lastModified() == y.lastModified()) { \n"
					+ "			return 0; \n"
					+ "		} else { \n"
					+ "			return 1; \n"
					+ "		} \n"
					+ "	}).reduce({a, b -&gt; b}).orElse(null); \n"
					+ "} \n"
					+ "def sysDrive = System.getenv('HOMEDRIVE'); \n"
					+ "def sysHomePath = System.getenv('HOMEPATH'); \n"
					+ "def downloadDir = new File(sysDrive + sysHomePath + '/Downloads'); \n"
					+ "def mostRecentFile = getMostRecentFileInDirectory(downloadDir); \n"
					+ "def bytes = mostRecentFile.bytes; \n"
					+ "return Base64.getEncoder().encodeToString(bytes);", ["GROOVY"] as String[]);

			byte[] content = Base64.getDecoder().decode(res.toString());
log.error("CYNAMONEK donloaded: " + content.length);
			return content;
		}
				try{
					log.warn("Taking sapBW file from downloads.");

					downloadedFile = getDownloadedFileContent(driver)
					sapBWReport = new File("NE_" + cfg_bw_report_filename.toString());

					try {
						fos = new FileOutputStream(sapBWReport, false)
						fos.write(downloadedFile);
					} catch (IOException e) {
						e.printStackTrace();
					} finally {
						fos.close();
					}

					log.warn("Downloaded file length: " + downloadedFile.length);

					driver.close();
				}
				catch(Exception e){
					log.warn(e.getMessage());
				}
			
			]]&gt;&lt;/script&gt;
		&lt;/selenium&gt;
	&lt;/selenium-flow&gt;
	
   &lt;!-- upload BW report to S3 --&gt;
   &lt;script&gt;&lt;![CDATA[
		//insert newly downloaded file in s3
		import com.workfusion.utils.client.AmazonUtils;
		import com.amazonaws.auth.BasicAWSCredentials;
		import com.amazonaws.services.s3.model.CannedAccessControlList;
		import com.amazonaws.services.s3.model.PutObjectRequest;

		def fileToCopy = sapBWReport

		//returns a link to the sap bw report
		uploadSapBWReportToS3 = {File file -&gt;
			awsCredentials = new BasicAWSCredentials(accessKey, secretKey);
			s3Client = AmazonUtils.createS3Client(awsCredentials, s3_endpoint_url.toString(), AmazonUtils.S3_SIGNER);
			String pathOnS3 = "temp/" + file.getName();
				
			putObjRequest = new PutObjectRequest(s3_attachments_bucket.toString(), pathOnS3, file).withCannedAcl(CannedAccessControlList.PublicRead);
			s3Client.putObject(putObjRequest);
			String s3FileURL =  s3Client.getResourceUrl(s3_attachments_bucket.toString(), pathOnS3);
			return s3FileURL;
		}
		s3Link = uploadSapBWReportToS3(fileToCopy)

		log.error("Copied file from local drive to the s3. File url" + s3Link);
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>WB report download</description>
                                    <includedConfigs/>
                                    <inclusionCode>805fec62-d678-4ca6-8af4-65af1b7c04b9</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[120] BW report download      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>805fec62-d678-4ca6-8af4-65af1b7c04b9</uuid>
                                    <version>
                                        <componentUuid>57210c86-9328-40da-bd24-3a3b2ebc011c</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>bfe0850a-48f6-4b81-9083-8ebd328bd421</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[120] BW report download      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>e9a01195-152e-4fb7-b76b-83a292e7e2ea</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>259944d4-7ebb-4444-be17-26597767f2d0</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>6c7f08bc-c30b-4f23-bb51-b8c660e97e2a</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>5</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>dc9cc266-73da-4ca2-bdd6-6ede6106bdc1</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>91e57685-7550-4a39-9f7a-c9a9e8921e38</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	&lt;script&gt;&lt;![CDATA[
import groovy.json.JsonSlurper
import groovy.json.JsonOutput

		def fix = { String str -&gt;
			return str.trim()
					.replace("l", "1")
					.replace("O", "0")
					.replace("&#214;", "0")
					.replace("Q", "0")
					.replace("D", "0")
					.replace("S", "8")
					.replace("B", "8")
					.replace("G", "6")
					.replace("b", "6")
					.replace("I", "1")
					.replace("I", "1")
					.replace("*", "")
					.replace(" ", "")
		}

		 def fixProdCode = { String str -&gt;
            def out = ""
            if (!"${str}".equals("")) {
              def  tmp = fix(str)


                    if (!tmp.matches("^\\d\\.\\d\\d\\d-\\d\\d\\d\\.\\d\$")) {
                        tmp = tmp.replace(".", "")
                    }

                    if (tmp.matches("^\\d\\d\\d\$") &amp;&amp; ship_to_name != null &amp;&amp; ship_to_name.toString().toLowerCase().contains("aldi")) {
                        tmp = "0" + tmp
                    }
                    out = tmp
                }
        }


        def handleSeparators = { qty -&gt;
            def decZeros = "^(.*)[.,]00\$"
            def thousSeps = "^(\\d+)[.,]([1-9][0-9][0-9])\$"

            if (qty.matches(decZeros)) {
                qty = qty.replaceAll(decZeros, "\$1");
            }
            if (qty.matches(thousSeps)) {
                qty = qty.replaceAll(thousSeps, "\$1\$2");
            }
            qty
        }


	product_lines_fixed = new JsonSlurper().parseText(product_lines.toString())
  log.error(product_lines.toString())
  

		product_code_mode_fix = product_lines_fixed.product_lines[0].product_code1.last.toString().length()
		product_lines_fixed.product_lines.each{

            it.product_code.ocrfixed = fixProdCode(it.product_code.last.toString())
            it.product_code.last=it.product_code.ocrfixed

 			it.product_code1.ocrfixed = fixProdCode(it.product_code1.last)
            it.product_code1.last=it.product_code1.ocrfixed
            
            it.product_code2.ocrfixed = fixProdCode(it.product_code2.last)
            it.product_code2.last=it.product_code2.ocrfixed


            it.quantity.ocrfixed = handleSeparators(fix(it.quantity.last.toString()))
            it.quantity.last=it.quantity.ocrfixed

            if(it.product_code1.last.toString().length() == 13){
                it.gtin.last=it.product_code1.last.toString()
                it.gtin.ocrfixed=it.gtin.last.toString()
            }
            else{
                it.gtin.last=it.product_code1.last.toString().replaceAll("[^|]", "")
                it.gtin.ocrfixed=it.gtin.last.toString()
            }
        }
		product_code_mode_fix = product_lines_fixed.product_lines[0].product_code1.last.toString().length()
		product_lines_json = JsonOutput.toJson(product_lines_fixed)
        product_code_list_fix_cnt=product_lines_fixed.size()

        
	]]&gt;&lt;/script&gt;
	&lt;export include-original-data="true"&gt;
		&lt;single-column name="product_lines" value="${product_lines_json}" /&gt;
		&lt;single-column name="product_code_list_cnt" value="${product_code_list_fix_cnt}" /&gt;
      &lt;single-column name="product_code_mode" value="${product_code_mode_fix}" /&gt;
	&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description>OCR transliteration fix</description>
                                    <includedConfigs/>
                                    <inclusionCode>2f98d899-669b-472c-9769-af072da0d2b5</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[110] OCR transliteration fix (prod_cod_list_fix_cnt)      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>2f98d899-669b-472c-9769-af072da0d2b5</uuid>
                                    <version>
                                        <componentUuid>6404eef7-3f05-48fc-b623-33dc07d233d2</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>22194dd5-7896-47f9-95d6-e53ac29d6456</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[110] OCR transliteration fix (prod_cod_list_fix_cnt)      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>76ad96b3-ced2-4226-94c5-8547f7e63e88</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>6ccd1193-0ae9-46ac-a1f3-1dce2dc9e40a</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>49c98bb1-7905-4e90-b2a7-3ccc78c8b593</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>6</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>2876b9fe-3bfe-43f1-b3a6-8b6e847b26cc</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>1108a40b-b5f2-46fd-8e90-cb4f78227a35</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
  &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name", "${sap_credentials_secure_store_id}") 
   ]]&gt;&lt;/script&gt;
   &lt;secure-store-get alias="${secure_store_name}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName = secure_store_name.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName);
      username = obj.getKey().toString();
      password = obj.getValue().toString();
      log.error("user: " + username);
      log.error("pass: " + password);
   ]]&gt;&lt;/script&gt;
  
    &lt;var-def name="login"&gt;
        &lt;script return="temp_login"&gt;&lt;![CDATA[
			temp_login = "$username";
		]]&gt;&lt;/script&gt;
    &lt;/var-def&gt;
    &lt;var-def name="password"&gt;
        &lt;script return="temp_password"&gt;&lt;![CDATA[
			temp_password = "$password";
		]]&gt;&lt;/script&gt;
    &lt;/var-def&gt;
    &lt;var-def name="homeDirectory"&gt;
    	&lt;script return="tempDir"&gt;&lt;![CDATA[
    		property = "java.io.tmpdir";
    		tempDir = System.getProperty(property);
    	]]&gt;&lt;/script&gt;
        &lt;!-- &lt;template&gt;C:\temp&lt;/template&gt;--&gt;
    &lt;/var-def&gt;
    
    &lt;!--&lt;var-def name="product_code_list"&gt;
     	052647|096269|072911|107934|123392|139805|183631
    &lt;/var-def&gt;--&gt;
    
    &lt;var-def name="product_codes"&gt;
 			&lt;regexp replace="true"&gt;
				&lt;regexp-pattern&gt;","&lt;/regexp-pattern&gt;
				&lt;regexp-source&gt;
					&lt;json expression="$..product_code1.last"&gt;
						&lt;var name="product_lines"/&gt;
					&lt;/json&gt;
				&lt;/regexp-source&gt;
				&lt;regexp-result&gt;
					&lt;template&gt;|&lt;/template&gt;
				&lt;/regexp-result&gt;
			&lt;/regexp&gt;   
    &lt;/var-def&gt;
    
  
	&lt;script return= "product_pipe"&gt;&lt;![CDATA[ 
		productPipeString = product_codes.toString().substring(2, product_codes.toString().length() - 2)
		productPipeArray = productPipeString.split("\\|")
		output = ""
		for (product in productPipeArray){
			if (product.toString().length() == 6){
				output = output + "|" + product.toString()
			}
		}
			if (output == ""){
				product_pipe = "empty"
			}else{
				output = output.substring(1, output.length())
				product_pipe = output
			}
	]]&gt;&lt;/script&gt;

&lt;case&gt;
&lt;if condition="${product_pipe.toString() != 'empty'}"&gt;  
&lt;selenium-flow&gt;
             &lt;selenium name="seleniumDriver" browser="autoit" close-on-completion="true"&gt;
                    &lt;script&gt;
                           &lt;![CDATA[
                                 import com.thoughtworks.selenium.*;
                                 import com.thoughtworks.selenium.webdriven.WebDriverBackedSelenium;
                                 import org.openqa.selenium.*;
                                 import org.openqa.selenium.remote.RemoteWebDriver;
                                 import org.openqa.selenium.interactions.Actions;
                                 import com.workfusion.utils.client.AmazonUtils;
                                 import com.amazonaws.auth.BasicAWSCredentials;
                                 import com.amazonaws.services.s3.model.CannedAccessControlList;
                                 import com.amazonaws.services.s3.model.PutObjectRequest;
			 					 import java.util.concurrent.TimeUnit;


                                 driver = seleniumDriver.getWrappedObject();
								 driver.manage().timeouts().setScriptTimeout(3 * 60, TimeUnit.SECONDS);

                                 final String sapPath = cfg_sap_gui_exec_filename.toString();
                                 String connectionName = cfg_sap_connection_name.toString();
                                 String ppid = "";
                                 path_screen_shot = ""; //new String("");
                                 s3FileURL = "";
                                 regexFilePattern = "[^a-zA-Z0-9_]";
                                 jpgFileName = "${uuid}-${mail_id}".replaceAll(regexFilePattern, "_") + ".jpg";
 
                                 log.warn("\r\nXXX -&gt;start seleniumn flow ");
 
                                 //set win_tmp folder and ensure it has "\" at the end
                                 String win_tmp = driver.executeScript(" return System.getenv(\"TMP\"); ", "GROOVY").toString();
                                 if(win_tmp.charAt(win_tmp.length() - 1) != "\\"){ //File.separatorChar
                                        win_tmp += "\\"; //File.separator
                                 }
                                 path_win = win_tmp + jpgFileName;
 
                                 log.warn("WIN file path=" + path_win);
 
                                 pid = java.util.UUID.randomUUID().toString();
 
                                 Boolean autoitExceptionOccured = false;
                                 try{
                                 //FROM AUTOIT After a lot of comment lines with ;;;;;;;;;;;; copy from there to bottom the replace "\" with "\\" and then "$" with "\$"
                                 //To Autoit change "\\" to "\" and "\$" to "$"
                                 ppid = driver.executeScript("""
                                     #include &lt;File.au3&gt;
                                        #include &lt;Date.au3&gt;
                                        #include &lt;ScreenCapture.au3&gt;
                                        #include &lt;StringConstants.au3&gt;
 
                                        #Region Init
                                        Local \$lSapPath = "${sapPath}" ;"C:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\\saplogon.exe"
                                        Local \$lConnectionName = "${connectionName}" ;"F6A EU SC Acc"
                                        Local \$lLogin = "${login}"; "CY2646"
                                        Local \$lPassword = "${password}"; "schWF24!"
 
                                        Local \$lSalesAreaId = "${sales_area_id}" ; "DE40" ;Sales Organization
                                        Local \$lDistributionChannelId = "${distribution_channel_id}" ;"50" ;Distribution Channel
                                       
                                        Local \$lProductCodeList = "${product_pipe}" ;"052647|096269|072911|107934|123392|139805|183631" ;"052647|096269|072911|107934|123392|139805|183631"
                                       
                                        Local \$lPathWin = "${path_win}" ;"c:\\temp\\xyz.jpg"
                                        Local \$lWinTmp = "${win_tmp}" ;"c:\\temp\\" ;path with trail "\"
                                        Local \$lPid = "${pid}" ;"xyz"
                                        #EndRegion
                                       
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 
                                 Global \$sapCon
                                 Global \$sapSession
                                 Global \$error_id
                                 Global \$error_msg
                                
                                 #Region almost like Try catch
                                 Global \$oMyError = ObjEvent("AutoIt.Error", "MyErrFunc")
                                
                                 Func MyErrFunc()
                                
                                        ;Local \$HexNumber
                                        Local \$strMsg
                                
                                        ;\$HexNumber = Hex(\$oMyError.Number, 8)
                                        ;\$strMsg = "Error Number: " &amp; \$HexNumber ;&amp; @CRLF
                                        ;\$strMsg = " WinDescription: " &amp; StringStripCR(\$oMyError.WinDescription)
                                        \$strMsg = " Script Line: " &amp; StringStripCR(\$oMyError.ScriptLine)
                                        \$strMsg &amp;= " Description: " &amp; StringReplace(StringStripCR(\$oMyError.Description), @LF, "")
                                
                                        ;MsgBox(0, "ERROR", \$strMsg)
                                        ConsoleWrite("ERROR " &amp; \$strMsg &amp; @CRLF)
                                
                                        WriteFile("", "0", \$strMsg)
                                        TakeScreenshot()
                                
                                        CloseSAP()
                                
                                        SetError(1)
                                        Exit 1
                                 EndFunc
                                 #EndRegion
                                
                                 #Region Some ScreenShot init
                                 #AutoIt3Wrapper_Res_HiDpi=Y
                                
                                 If Not (@Compiled ) Then DllCall("User32.dll","bool","SetProcessDPIAware")
                                
                                 Func TakeScreenshot()
                                    Sleep(1000)
                                    _ScreenCapture_Capture(\$lPathwin)
                                    Sleep(1000)
                                 EndFunc
                                 #EndRegion
                                
                                 #Region Help functions
                                 Func CloseSAP()
                                        If (\$sapSession.ActiveWindow.Name = "wnd[0]") Then
                                               \$sapSession.findById("wnd[0]/tbar[0]/okcd").text = "/NEX"
                                               \$sapSession.findById("wnd[0]").sendVKey(0)
                                               Sleep(1000)
                                        EndIf
                                
                                        WinClose("[CLASS:#32770]") ;"SAP")
                                 EndFunc
                                
                                 Func WriteFile(\$result, \$code, \$str)
                                        Local \$arr[3];
                                        \$arr[0] = StringReplace(StringStripCR(\$result), @LF, "")
                                        \$arr[1] = StringReplace(StringStripCR(\$code), @LF, "")
                                        If \$arr[1] &lt;&gt; "" Then
                                           \$arr[1] = "SAP-" &amp; \$arr[1]
                                     EndIf
                                        \$arr[2] = StringReplace(StringStripCR(\$str), @LF, "")
                                        \$path = \$lWinTmp &amp; \$lPid &amp; ".out" ;"c:\\temp\\pid.out"
                                        _FileWriteFromArray(\$path, \$arr)
                                        ConsoleWrite("File '" &amp; \$path &amp; "' written" &amp; @CRLF)
                                 EndFunc
                                
                                 Func SAPObjValueSet(\$sap_window_num, \$object_id, \$object_value)
                                        \$sapSession.findById("wnd[" &amp; \$sap_window_num &amp; "]/" &amp; \$object_id).text = \$object_value
                                 EndFunc
                                
                                 Func SAPObjValueGet(\$sap_window_num, \$object_id)
                                        return \$sapSession.findById("wnd[" &amp; \$sap_window_num &amp; "]/" &amp; \$object_id).text
                                 EndFunc
                                
                                 Func SAPSendEnter(\$sap_window_num)
                                        \$sapSession.findById("wnd[" &amp; \$sap_window_num &amp; "]").sendVKey(0)
                                 EndFunc
                                 #EndRegion
                                
                                 Func RunProcess()
                                    If RunSap() == 0 Then
                                        FillData()
                                        CloseSAP()
                                    EndIf
                                 EndFunc
                                
                                 Func RunSap()
                                        #Region Start SAP
                                        run(\$lSapPath)
                                
                                        WinWait("[CLASS:#32770]", "", 10)
                                        Sleep(3000)
                                        \$sapGui = ObjGet("SAPGUI")
                                        \$sapApp = \$sapGui.GetScriptingEngine
                                        \$sapCon = \$sapApp.openConnection(\$lConnectionName)
                                
                                        \$hWndSAP = WinWait("SAP", "", 10)
                                
                                        If \$hWndSAP = 0 Then
                                               WriteFile("", "1", "Error connecting to SAP")
                                               TakeScreenshot()
                                               Return -1
                                        EndIf
                                
                                        \$sapSession = \$sapCon.Children(0)
                                        #EndRegion
                                
                                        #Region Log In
                                
                                        \$sapSession = \$sapCon.Children(0)
                                
                                        SAPObjValueSet(0, "usr/txtRSYST-BNAME", \$lLogin)
                                        SAPObjValueSet(0, "usr/pwdRSYST-BCODE", \$lPassword)
                                        SAPSendEnter(0)
                                        #EndRegion
                                
                                        #Region Already logged In
                                        ;sometimes info window apears that user is already logged in.
                                        If \$sapSession.ActiveWindow.Name = "wnd[1]" Then
                                               \$sapSession.findById("wnd[1]/usr/radMULTI_LOGON_OPT2").select
                                               \$sapSession.findById("wnd[1]/usr/radMULTI_LOGON_OPT2").setFocus
                                               \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
                                               Sleep(250)
                                        EndIf
                                        #Endregion
                                
                                        Return 0
                                 EndFunc
                                
                                 Func FillData()
                                    Local \$lGtinsList = StringSplit(\$lProductCodeList, "|")
                                
                                    Local \$iMax = UBound(\$lGtinsList)
                                    Local \$resultString = "{'products':["
                                
                                    ;Local \$tc = ["50", "53", "55"];XXX
                                    For \$i = 1 To (\$iMax - 1)
                                           \$val = ""
                                           ;\$tcIndex = 0;XXX
                                
                                           \$sapSession.findById("wnd[0]/tbar[0]/okcd").text = "VB13"
                                           \$sapSession.findById("wnd[0]").sendVKey(0)
                                
                                           \$sapSession.findById("wnd[0]/usr/ctxtD000-KSCHL").text = "Z001"
                                           \$sapSession.findById("wnd[0]").sendVKey(0)
                                
                                           \$sapSession.findById("wnd[1]/usr/sub:SAPLV14A:0100/radRV130-SELKZ[11,0]").select
                                           \$sapSession.findById("wnd[1]/usr/sub:SAPLV14A:0100/radRV130-SELKZ[11,0]").setFocus
                                
                                           \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
                                           \$sapSession.findById("wnd[0]/usr/ctxtF001").text = \$lSalesAreaId ;"DE40"
                                
                                           ;While \$val = "" and \$tcIndex &lt; UBound(\$tc) ;XXX
                                                  \$sapSession.findById("wnd[0]/usr/ctxtF002").text = \$lDistributionChannelId  ;\$tc[\$tcIndex] ; "50";XXX
                                                  \$sapSession.findById("wnd[0]/usr/ctxtF003-LOW").text = "*" &amp; \$lGtinsList[\$i] ;"*52647"
                                
                                                  \$sapSession.findById("wnd[0]/tbar[1]/btn[8]").press
                                
                                                  \$val2 = \$sapSession.findById("wnd[0]/sbar").text ; Afx:52500000:8:00010003:00000010:00000000
                                
                                                  If (\$val2 = \$lGtinsList[\$i]) Or (\$val2 = "") Then
                                                        ;\$table = \$sapSession.findById("wnd[0]/usr/tblSAPMV13DTCTRL_FAST_ENTRY")
                                                        ; \$visibleRows = \$table.RowCount ;DOESNT WORK shows max visible
                                                        ; \$visibleRowsCount = \$table.visibleRowCount ;DOESNT WORK
                                                        ; ConsoleWrite("There was/is " &amp; \$visibleRows &amp; " " &amp; \$visibleRowsCount &amp; " found for gtin4=" &amp; \$lGtinsList[\$i] &amp; " and dist.ch.=" &amp; \$lDistributionChannelId &amp; " " &amp; @CRLF) ;-&gt; There was/is 14 14 found for gtin4=052647 and dist.ch.=50
                                                        ;If \$visibleRows == 1 Then
                                
                                                        ;Check if more than one row in a workaround
                                                        \$tmpVal = \$sapSession.findById("wnd[0]/usr/tblSAPMV13DTCTRL_FAST_ENTRY/ctxtKOMGD-MATWA[0,1]").text
                                                        ; \$tmpVal  "__________________" ;&lt;- 'empty' row text
                                                        ; ConsoleWrite("-X-1-'" &amp; StringStripWS(StringReplace(\$tmpVal, "_", ""), \$STR_STRIPALL) &amp; "'" &amp; @CRLF)
                                                        If StringStripWS(StringReplace(\$tmpVal, "_", ""), \$STR_STRIPALL) &lt;&gt; "" Then
                                                              ConsoleWrite("There is more than one ex.='" &amp; \$tmpVal &amp; "' found for gtin4=" &amp; \$lGtinsList[\$i] &amp; " and dist.ch.=" &amp; \$lDistributionChannelId &amp; " " &amp; @CRLF);ERROR
                                                        Else
                                                              \$val = \$sapSession.findById("wnd[0]/usr/tblSAPMV13DTCTRL_FAST_ENTRY/ctxtKOMGD-MATWA[0,0]").text
                                                              ConsoleWrite("Found '" &amp; \$val &amp; "' for gtin4=" &amp; \$lGtinsList[\$i] &amp; " and dist.ch.=" &amp; \$lDistributionChannelId &amp; " " &amp; @CRLF);ERROR
                                                        EndIf
                                
                                                  Else
                                                        ConsoleWrite("MSG '" &amp; \$val2 &amp; "' for gtin4=" &amp; \$lGtinsList[\$i] &amp; " and dist.ch.=" &amp; \$lDistributionChannelId &amp; " " &amp; @CRLF)
                                
                                                  EndIf
                                                  ;\$tcIndex = \$tcIndex + 1 ;XXX
                                           ;WEnd ;XXX
                                           \$sapSession.findById("wnd[0]/tbar[0]/btn[3]").press
                                           \$sapSession.findById("wnd[0]/tbar[0]/btn[3]").press ;....bo tak
                                           \$sapSession.findById("wnd[0]").sendVKey(0)
                                
                                           ;\$resultString = \$resultString &amp; \$val &amp; "|"
                                           \$resultString = \$resultString &amp; "{'product_code': '" &amp; \$lGtinsList[\$i] &amp; "', 'gtin':'" &amp; \$val &amp; "'},"
                                    Next
                                
                                    \$resultString  = StringTrimRight(\$resultString , 1)
                                    \$resultString  = \$resultString &amp; "]}"
                                    WriteFile(\$resultString, "", "")
                                    ConsoleWrite("Result=" &amp; \$resultString &amp; @CRLF)
                                 EndFunc
                                
                                 ;---==START==---
                                 RunProcess()
                                 Exit 0""", ["AUTOIT"] as String[]);
                           }
                           catch(Exception e){
                                 log.error("\r\n\tYYY\r\n" + e.getMessage() + "\r\n");
                                
                                 autoitExceptionOccured = true;
                           }
                          
                           log.warn("\r\nXXX &lt;-end seleniumn flow\r\n" + ppid + " \r\n");
                          
                           //read AutoIT output file
                           result = new String();
                           errorDescriptionList = new String();
                           errorIdList = new String();
 
                           linkToFile = "${win_tmp}\\${pid}.out".replaceAll("\\\\", "/");                              
                          
                           Object ofileExists = driver.executeScript("def file = new File('" + linkToFile + "');\n" +
                                 "if (file.exists()){return 1} else {return 0}", "GROOVY");
                           log.warn("\r\n\t ofileExists=" +  ofileExists.toString());
                           if (ofileExists.toString().equals("1")){
                                 Object res = driver.executeScript("return Base64.getEncoder().encodeToString(new File('${linkToFile}').bytes);",  ["GROOVY"] as String[]);
                                 result = new String(Base64.getDecoder().decode(res.toString())).split("\r\n", -1);
								 result[0] = result[0].replace("'","\"")
 
                                 log.warn("\r\n\t result[0]='" +  result[0] + "'");
 
                                 if (result.length &gt; 2){
                                        errorIdList = result[1].trim();
                                        errorDescriptionList = result[2].trim();
                                 }
                                 driver.executeScript("new File('${linkToFile}').delete();", ["GROOVY"] as String[]);
                                
                                 //save screenshot
                                 try{
                                        def winFilePath = path_win.toString().replace("\\", "\\\\")
                                        Object fileExists = driver.executeScript("def file = new File('" + winFilePath + "');\n" +
                                               "if (file.exists()){return 1} else {return 0}", "GROOVY");
                                        log.warn("\r\n\t fileExists=" +  fileExists.toString());
                                        if (fileExists.toString().equals("1")){
                                               Object screenBytes = driver.executeScript(
                                                     "def bytes = new File('" + winFilePath  + "').bytes; \n" +
                                                     "return Base64.getEncoder().encodeToString(bytes);", "GROOVY");
                                               content = Base64.getDecoder().decode(screenBytes.toString());
                                              
                                               //create local output file
                                               path_screen_shot = homeDirectory.toString();
                                               if(path_screen_shot.charAt(path_screen_shot.length() - 1) != File.separatorChar){
                                                     path_screen_shot += File.separator;
                                               }
                                               path_screen_shot += "X" + jpgFileName;
                                              
                                               imageFile = new File(path_screen_shot);
            
                                               try {
                                                     fos = new FileOutputStream(imageFile, false)
                                                     fos.write(content);
                                               } catch (IOException e) {
                                                     log.error("\r\n SC&amp;S3 (internally)\r\n" + e.getMessage() + "\r\n");
                                                     //e.printStackTrace();
                                               } finally {
                                                     fos.close();
                                               }
                                               log.warn("Downloaded file length: " + imageFile.length());
                                              
                                               //Save file To S3
                                               log.warn("S3-0:" + accessKey + ", " + secretKey);
                                               if (!accessKey.toString().trim().equals("")){
                                                     awsCredentials = new BasicAWSCredentials(accessKey, secretKey);
                                                     //awsCredentials = new BasicAWSCredentials("K5PBJV-KD8FKS5YK0UCM", "afFjMxmu42O18SjfyNoDml0h4YDRwF1Z_uzpfA==");
                                                     s3Client = AmazonUtils.createS3Client(awsCredentials, s3_endpoint_url.toString(), AmazonUtils.S3_SIGNER);
                                                     log.warn("S3-1");
                                                     String pathOnS3 = "screenshots/" + jpgFileName;
                                                     log.warn("S3-2: " + pathOnS3);
                                                     putObjRequest = new PutObjectRequest(s3_attachments_bucket.toString(), pathOnS3, imageFile).withCannedAcl(CannedAccessControlList.PublicRead);
                                                     log.warn("S3-3: " + s3_attachments_bucket.toString());
                                                      s3Client.putObject(putObjRequest);
                                                     log.warn("S3-4");
                                                     s3FileURL = s3Client.getResourceUrl(s3_attachments_bucket.toString(), pathOnS3);
                                                     log.warn("S3-5");
                                               }
                                        }
                                 }catch(Exception e){
                                        log.error("\r\nSC&amp;S3\r\n" + e.getMessage() + "\r\n");
                                        path_screen_shot = "";
                                 }
                           }
                           driver.close();
                    ]]&gt;&lt;/script&gt;
             &lt;/selenium&gt;
    &lt;/selenium-flow&gt;
  
  	&lt;script return="finalProducts"&gt;&lt;![CDATA[ 
		import org.json.JSONObject;
		import org.json.JSONArray;
		import java.util.Iterator;

		
		JSONObject product_information = new JSONObject("${product_lines}");
		JSONObject sap_products = new JSONObject("${result[0].trim()}");
				
		JSONArray arr = (JSONArray) product_information.get("product_lines");
		JSONArray arr2 = (JSONArray) sap_products.get("products");
		
		Iterator i = arr.iterator();

		while (i.hasNext()) {
			Iterator j = arr2.iterator();
			JSONObject innerObj = (JSONObject) i.next();
			JSONObject gtinJson = (JSONObject) innerObj.get("gtin");

			while (j.hasNext()){
				JSONObject innerObj2 = (JSONObject) j.next();
				if (innerObj.get("product_code1").get("last") == innerObj2.get("product_code"))  {
					gtinJson.put("rpaed", innerObj2.get("gtin").toString());
                	gtinJson.put("last", innerObj2.get("gtin").toString());              	
                	break;
				}
			}
		}
		

		finalProducts = product_information;

	]]&gt;&lt;/script&gt;
  &lt;/if&gt;
  &lt;else&gt;
    &lt;script&gt;&lt;![CDATA[
		finalProducts = "${product_lines}";
		s3FileURL = "";
	]]&gt;&lt;/script&gt;
  &lt;/else&gt;
  &lt;/case&gt;
  
    &lt;export include-original-data="true"&gt;
    	&lt;single-column name="product_lines" value="${finalProducts}"/&gt;
    	&lt;single-column name="sap_screenshot_file_uri"  value="${s3FileURL}" /&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>888b1386-c987-41af-991a-6d636a35bfe2</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[140] GTIN format fix (from 6)      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <source>
                                        <availability></availability>
                                        <batchSize>1</batchSize>
                                        <deleted>false</deleted>
                                        <description></description>
                                        <equallyDistributeLoad>false</equallyDistributeLoad>
                                        <name>one thread - rpa nodes</name>
                                        <prioritizeEarlierRuns>false</prioritizeEarlierRuns>
                                        <proxySettings>
                                            <validationEnabled>true</validationEnabled>
                                        </proxySettings>
                                        <threadCount>1</threadCount>
                                        <threadsPerNode>false</threadsPerNode>
                                        <timeZone>GMT</timeZone>
                                        <tps>0</tps>
                                        <url></url>
                                        <version>
                                            <componentUuid>017a2908-a3ed-4e22-bfa7-997618fe7693</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-02-14T14:06:05Z</lastModified>
                                            <versionUuid>8a98b5f7-71e6-4ce2-a3fd-d84b21f64c7a</versionUuid>
                                        </version>
                                    </source>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>888b1386-c987-41af-991a-6d636a35bfe2</uuid>
                                    <version>
                                        <componentUuid>fcecbcf8-6900-4d74-a4b9-50d7e3b1d570</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>cffe76ed-d8e0-4867-82cf-3308cc233002</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[140] GTIN format fix (from 6)      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>1d129388-5865-41d0-b388-c02a6aff6aa4</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>f65ca77b-6c7d-4179-8b44-4c1dfe41be67</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>2f041974-87bb-4288-96bf-7b2c440d7374</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>7</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>e17d25d9-177b-40b5-abfe-2a7a9dd1a7dc</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>bd15ed1a-c872-4813-b7d7-f3f100dee68e</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;

  &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name", "${sap_credentials_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName = secure_store_name.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName);
      username = obj.getKey().toString();
      password = obj.getValue().toString();

      //log.error("SAP user: " + username);
      //log.error("SAP  pass: " + password);
   ]]&gt;&lt;/script&gt;

  &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name", "${s3_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName = secure_store_name.toString();;
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName);
      accessKey = obj.getKey().toString();
      secretKey = obj.getValue().toString();

      //log.error("accessKey: " + accessKey);
      //log.error("secretKey: " + secretKey);
   ]]&gt;&lt;/script&gt;
   
    &lt;var-def name="tempDirectory"&gt;
        &lt;script return="tempDir"&gt;&lt;![CDATA[
    		property = "java.io.tmpdir";
    		tempDir = System.getProperty(property).toString();
			
			if (!tempDir.endsWith(File.separator)) {
    			tempDir = tempDir + File.separator;
			}

log.warn("tempDir='" + tempDir); // + "' of class=" + tempDir.getClass().getName());
    	]]&gt;&lt;/script&gt;
    &lt;/var-def&gt;
    
  	&lt;selenium-flow&gt;
		&lt;selenium name="seleniumDriver" browser="autoit" close-on-completion="true"&gt;
	&lt;script&gt;
		&lt;![CDATA[
import com.amazonaws.services.s3.*;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.services.s3.model.*;
import com.workfusion.utils.client.AmazonUtils;
import java.io.FileOutputStream; 
import org.apache.commons.io.FileUtils
import java.nio.file.Files;
import java.nio.file.Paths

/*//========================-============-============-------------------------------------------------------------------------------------
//TODO:THIS SECTION SHOULD BE COMMENTED OUT
import com.freedomoss.crowdcontrol.webharvest.RunDto;
import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

cfg_sap_connection_name = "F6A EU SC Acc"
accessKey = "RVYKLURELZ6OOGJCHOWF"; //DEV
	//"GMOMBTKPEQG9BFE0GQMH"; //PROD
secretKey = "tfjOr49TuzDVppNDtLz7HEWJSVliqzcMHr9wUw=="; //DEV
	//"LPA7yl4oUC4MLa5jjLoJnXDVpLGgizIQCK6elw=="; //PROD
s3_endpoint_url = "https://wfapp-s3-dev.workfusion.pg.com"; //DEV
	//"https://wfapp-s3.workfusion.pg.com"; //PROD
s3_attachments_bucket = "rpa-dach";
uuid = "xxxYYYxxx";

cfg_sap_gui_exec_filename =  "C:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\\saplogon.exe";

document_link = "https://wfapp-s3.workfusion.pg.com/rpa-dach/orders/d5dfefe9021853a5f5e651843a78519f.pdf";

RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
uuid = run.getRootRunUuid();
order_number = "3159829216"
sales_area_id = "DE42"

username = "RBS2COP002"
password = "CCLDACH201806"
//ENDSECTION//------------------------------------------------------------------------------------ */

private boolean saveS3FileToWinDrive(String s3_endpoint_url, accessKey, secretKey, s3_attachments_bucket, keyOnS3, pdfFile, String targetWinPath){
	result = false;
	
	log.warn("entering saveS3FileToWinDrive")
	
	try{		
		String res = "";
		lLinuxPath = tempDirectory.toString() + File.separator + pdfFile

		try {
			BasicAWSCredentials awsCredentials = new BasicAWSCredentials(accessKey, secretKey);
			s3Client = AmazonUtils.createS3Client(awsCredentials, s3_endpoint_url.toString(), AmazonUtils.S3_SIGNER);

			getObjRequest = new GetObjectRequest(s3_attachments_bucket.toString(), keyOnS3); //.withCannedAcl(CannedAccessControlList.PublicRead);
		
			File fOutput = new File(lLinuxPath);
			
			s3Client.getObject(getObjRequest, fOutput);

			/*////...
			InputStream fis = Files.newInputStream(Paths.get(lLinuxPath));
				String md5 = org.apache.commons.codec.digest.DigestUtils.md5Hex(fis);
				log.warn("linux pdf md5=" + md5 + " " + new File(lLinuxPath).length())
				fis.close();
			//...*/
					
			res = lLinuxPath; //"PDF file saved";
		} catch ( Exception e ) {
			res = e.getMessage();
		}
		log.warn("File saved as='" + res + "'");
		
		driver = seleniumDriver.getWrappedObject();
		
		vDir = tempDirectory.toString().replace("\\", "\\\\");
		
		log.warn("1")
		
		//set win_tmp folder and ensure it has "\" at the end
		String win_tmp = driver.executeScript(" return System.getenv(\"TMP\"); ", "GROOVY").toString();
		if(win_tmp.charAt(win_tmp.length() - 1) != "\\"){ //File.separator
			win_tmp += "\\"; //File.separator
		}

		strWinTmp = win_tmp.toString().replace("\\", "\\\\")

		log.warn("strWinTmp='" + strWinTmp + "'")

		//encode pfd  file
		File file = new File(lLinuxPath);
		byte[] encodedBytes = org.apache.commons.codec.binary.Base64.encodeBase64(FileUtils.readFileToByteArray(file));
		String encoded = new String(encodedBytes);

		//Fight the "String too long. The given string is LENGTTH Unicode code units long, but only a maximum of 65535 is allowed"
		int encodedLen = encoded.length()
		
		int partSize = 65535
		int iParts = encodedLen / partSize + 1;
		log.warn("parts=" + iParts);
		
		//first copy encoded parts to temporary file with decoded pdf
		for (int i = 0; i &lt; iParts; i++){
			
			int leftBound = i * partSize
			int rightBound = (i + 1) * partSize
			String encodedPart = encoded.substring(leftBound, Math.min(rightBound, encodedLen));
			String append = (i == 0 ? "false" : "true");
			
			String strOutput = driver.executeScript("""
				import org.apache.commons.io.FileUtils

				String res = "";

				fOutputName = "$strWinTmp" + "encoded$pdfFile"
				try {
					File file = new File(fOutputName);
					
					FileUtils.writeStringToFile(file, "$encodedPart", $append)
					
					res = Boolean.TRUE.toString() //"part of encoded pdf file saved on windows";
				}catch ( Exception e ) {
					res += e.getMessage();
					//log.error("EXCEPTION:" + e.printStackTrace());
				}
			""", ["GROOVY"] as String[]);
				
			log.warn("wRes for " + leftBound + " to " + rightBound + " '" + strOutput.toString() + "'");

			result = (strOutput.toString() == Boolean.TRUE.toString()) //(lWinPath == strOutput.toString()); //?
			
			if (!result){
				break;
			}
		}
		
		//then encode this decoded pdf file to real pdf
		if (result){
			String strOutput = driver.executeScript("""
				import org.apache.commons.io.FileUtils
				import java.util.Base64;
				import java.nio.file.Files;
				import java.nio.file.Paths;
 

				String res = "";
				
				fInputName = "$strWinTmp" + "encoded$pdfFile"
				fOutputName = "$strWinTmp" + "$pdfFile"
				try {
					File inFile = new File(fInputName);
					File outFile = new File(fOutputName);
					
					encodedPdf = FileUtils.readFileToString(inFile)
					
					byte[] decoded = Base64.getDecoder().decode(encodedPdf);
					
					FileUtils.writeByteArrayToFile(outFile, decoded, false)
					
					/*///....
					InputStream fis = Files.newInputStream(Paths.get(fOutputName));
						String md5 = org.apache.commons.codec.digest.DigestUtils.md5Hex(fis);
						res = md5 + " " + outFile.length();
						fis.close();
					//... */
					
					res += Boolean.TRUE.toString() //"pdf file saved on windows";
				}catch ( Exception e ) {
					res += e.getMessage();
					//log.error("EXCEPTION:" + e.printStackTrace());
				}
			""", ["GROOVY"] as String[]);

			log.warn("wRES='" + strOutput.toString() + "'");
			
			result = (strOutput.toString() == Boolean.TRUE.toString())
		}
			
	    
	} catch ( Exception e ) {
		log.error("EXCEPTION in saveS3FileToWinDrive:" + e.getMessage()); //e.printStackTrace());
		result = false;
	}

	return result;
}

private boolean storeVbsToWin(win_tmp, threadNumber, pdfFile){
	result = false;
	
	vbsDirectory = win_tmp.toString().replace("\\","\\\\");
	sapExeFileName = cfg_sap_gui_exec_filename.toString().replace("\\","\\\\");
	
	lVBScriptText = """
Option Explicit

Dim SapGuiAuto, application, connection, session, WshShell, sapWindowFound, storingFilesWindow
Dim strSapConnectionName, strDirectory, strThreadNumber, strPdfFile, orderNumber, userName, password
Dim regionIndex, salesOrg, strSapExe

Set WshShell = WScript.CreateObject("WScript.Shell")

'A place to set up values=====================================
strSapExe = "$sapExeFileName"
strSapConnectionName = "$cfg_sap_connection_name"
strDirectory = "$vbsDirectory"
strThreadNumber = "$threadNumber"
strPdfFile = "$pdfFile"
orderNumber = "$order_number"
salesOrg = "$sales_area_id"
userName = "$username"
password = "$password"
'=====================================

StartWithErrCatch()

Sub StartWithErrCatch()
    Dim Res, CurrentStep

    On Error Resume Next

    CurrentStep = 0

    Res = StartProcess(CurrentStep)
    If Err.Number &lt;&gt; 0 Then
        Wscript.Echo "ErrStep " &amp; CurrentStep &amp; " " &amp; Err.Number &amp; " '" &amp; Err.Description &amp; "'"

        'CaptureScreenShot strDirectory
        'If Err.Number &lt;&gt; 0 Then
        '    Wscript.Echo "ErrStep CaptureScreenShot " &amp; Err.Number &amp; " '" &amp; Err.Description &amp; "'"
        'End IF

        'CloseSAP()
    End If
End Sub

'START:
Function StartProcess(CurrentStep)
    Wscript.Echo "Staring at " &amp; now()
    Init true

    Wscript.Echo "After init..." &amp; now()
	CurrentStep = 1
    session.findById("wnd[0]").resizeWorkingPane 116,25,false
    session.findById("wnd[0]/usr/txtRSYST-BNAME").text = userName
    session.findById("wnd[0]/usr/pwdRSYST-BCODE").text = password
    'session.findById("wnd[0]/usr/txtRSYST-LANGU").text = "EN"
    'session.findById("wnd[0]/usr/txtRSYST-LANGU").setFocus
    'session.findById("wnd[0]/usr/txtRSYST-LANGU").caretPosition = 2
    session.findById("wnd[0]").sendVKey 0

	CurrentStep = CurrentStep + 1 '2
    if session.ActiveWindow.Name = "wnd[1]" then
        Dim winText
        winText = session.ActiveWindow.Text
        if (winText = "System Messages") or (winText = "Information") or (winText = "Copyright") then
            session.findById("wnd[1]").sendVKey 0
            'Sleep(250)
        else
            session.findById("wnd[1]/usr/radMULTI_LOGON_OPT2").select
            session.findById("wnd[1]/usr/radMULTI_LOGON_OPT2").setFocus
            session.findById("wnd[1]/tbar[0]/btn[0]").press
            'Sleep(2000)
        end If
    end if

    CurrentStep = CurrentStep + 1 '3
    session.findById("wnd[0]/tbar[0]/okcd").text = "VA03"
    session.findById("wnd[0]").sendVKey 0
    session.findById("wnd[0]/usr/ctxtVBAK-VBELN").text = orderNumber
    session.findById("wnd[0]/usr/ctxtVBAK-VBELN").caretPosition = 10
    session.findById("wnd[0]").sendVKey 0
    session.findById("wnd[0]/titl/shellcont/shell").pressButton "%GOS_TOOLBOX"
    session.findById("wnd[0]/shellcont/shell").pressContextButton "CREATE_ATTA"
    session.findById("wnd[0]/shellcont/shell").selectContextMenuItem "ARL_LINK"
    session.findById("wnd[1]/usr/ssubSUB110:SAPLALINK_DRAG_AND_DROP:0110/cntlSPLITTER/shellcont/shellcont/shell/shellcont[0]/shell").hierarchyHeaderWidth = 390

    CurrentStep = CurrentStep + 1 '4
    'calculate which item to hit
    regionIndex = "" ' or "0000000013" by default?
    If (salesOrg = "AT40") or (salesOrg = "AT42") Then
        regionIndex = "0000000012"
    ElseIf (salesOrg = "CH40") or (salesOrg = "CH42") Then
        regionIndex = "0000000014"
    ElseIf (salesOrg = "DE40") or (salesOrg = "DE42") Then
        regionIndex = "0000000013"
    Else
        Wscript.Echo  " Unkwown salesOrg:" &amp; salesOrg
    End If
    session.findById("wnd[1]/usr/ssubSUB110:SAPLALINK_DRAG_AND_DROP:0110/cntlSPLITTER/shellcont/shellcont/shell/shellcont[0]/shell").selectItem regionIndex,"HITLIST"
    session.findById("wnd[1]/usr/ssubSUB110:SAPLALINK_DRAG_AND_DROP:0110/cntlSPLITTER/shellcont/shellcont/shell/shellcont[0]/shell").ensureVisibleHorizontalItem regionIndex,"HITLIST"
    session.findById("wnd[1]/usr/ssubSUB110:SAPLALINK_DRAG_AND_DROP:0110/cntlSPLITTER/shellcont/shellcont/shell/shellcont[0]/shell").topNode = "0000000004"

    'CaptureScreenShot strDirectory
    Wscript.Echo "Starting 'Thread' at " &amp; now()
    strPdfFile = Replace(strPdfFile, chr(92) + chr(92), chr(92)) ' Problematic -&gt; "\\", "\")
    CreateVBScriptThread strThreadNumber, strPdfFile

    CurrentStep = CurrentStep + 1 '5
    session.findById("wnd[1]/usr/ssubSUB110:SAPLALINK_DRAG_AND_DROP:0110/cntlSPLITTER/shellcont/shellcont/shell/shellcont[0]/shell").doubleClickItem regionIndex,"HITLIST"

	WScript.Sleep 100
    wscript.echo "Info after sending file:'" &amp; session.findById("wnd[1]/usr/ssubSUB110:SAPLALINK_DRAG_AND_DROP:0110/cntlSPLITTER/shellcont/shellcont/shell/shellcont[1]/shell").text &amp; "'"
    ''---===parse if successed.
    Wscript.Echo "After Thread :) " &amp; now() 'Timer

    'CaptureScreenShot strDirectory

    session.findById("wnd[1]/tbar[0]/btn[0]").press
    session.findById("wnd[0]/shellcont").close
    Wscript.Sleep 500
    
    CurrentStep = CurrentStep + 1 '5
    CloseSAP()

    Wscript.Echo "Happy END :) " &amp; now()

    StartProcess = 0
End Function

Sub CloseSAP()
    'zamykamy  
    session.findById("wnd[0]/tbar[0]/okcd").text = "/NEX"
    session.findById("wnd[0]").sendVKey(0)
    Wscript.Sleep 500

    'Close SAP? - If we open then we should close. Other way leave it open.
    'bWindowFound = WshShell.AppActivate("SAP Logon")
    'if bWindowFound then
    'WshShell.appActivate "SAP Logon"
        'WScript.Sleep 200
        'WshShell.sendkeys "%{F4}"
    'WScript.Sleep 200    
    'end if
End Sub

'TODO: DOESNT WORK :(
Function CaptureScreenShot(ScreenshotPath)
    Dim strImgFileName, strImgFile, objPic, ExecutionStatus
    'Generate Name of the Image
    strImgFileName = strDirectory &amp; "Img" &amp; Day(Date)&amp; Month(Date) &amp; Year(Date) &amp; Hour(Now) &amp; Minute(Now) &amp; Second(Now) &amp; ".jpg"
    strImgFile = ScreenshotPath &amp; strImgFileName
    'Capture failure Screen shot
    Set objPic = Sys.Desktop.Picture
    'Save captured Screen shot
    ExecutionStatus = objPic.SaveToFile(strImgFile)
    'Return Captured image name
    CaptureScreenShot = ".\" &amp; strimgFileName
End Function

Sub Init(StartNewConnection)
    Dim intReturn

    ' Assume saplogon is already running...
    Wscript.Echo "-0 " &amp; now()
    intReturn =  WshShell.Run(chr(34) + strSapExe + chr(34), 1, FALSE)
	wscript.Sleep 4000 '4s - is it enough?
    Wscript.Echo "-1 " &amp; now()

    If Not IsObject(application) Then
        Set SapGuiAuto  = GetObject("SAPGUI")
        Set application = SapGuiAuto.GetScriptingEngine
    End If
    If Not IsObject(connection) Then
        If StartNewConnection Then
            Set connection = application.Openconnection(strSapConnectionName, true)
        Else
            Set connection = application.Children(0)
        End If
    End If
    If Not IsObject(session) Then
        Set session = connection.Children(0)
    End If
    If IsObject(WScript) Then
        WScript.ConnectObject session, "on"
        WScript.ConnectObject application, "on"
    End If
    
    If StartNewConnection Then
        'on error goto next
        do
            WScript.Sleep 1000
            sapWindowFound = WshShell.AppActivate("SAP")
        loop Until sapWindowFound
        'on error goto -1
    End If
End Sub

Sub CreateVBScriptThread(threadNr, uploadFileName)
    Dim s, strFile, sFileName, objFSO, objFolder, objFile, objTextFile, wsh
    '---Copy parameters to VBscript---
    's = s &amp; "startTime = Timer" &amp; vbCrLf
    s = s &amp; "Dim storingFilesWindow" &amp; vbCrLf

    s = s &amp; "Set WshShell = WScript.CreateObject(""WScript.Shell"")" &amp; vbCrLf
    s = s &amp; "storingFilesWindow = 0" &amp; vbCrLf
    s = s &amp; "do" &amp; vbCrLf
    s = s &amp; "'Set storingFilesWindow = WshShell.AppActivate(""Storing Files in Documents"")" &amp; vbCrLf

    s = s &amp; "Set Processes = GetObject(""winmgmts:"").InstancesOf(""Win32_Process"")" &amp; vbCrLf

    s = s &amp; "For Each Process In Processes" &amp; vbCrLf
    s = s &amp; "If StrComp(Process.Name, ""saplogon.exe"", vbTextCompare) = 0 Then" &amp; vbCrLf

    s = s &amp; "storingFilesWindow = 1" &amp; vbCrLf
    s = s &amp; "WScript.Sleep 1000" &amp; vbCrLf

    s = s &amp; "' Activate the window using its process ID..." &amp; vbCrLf
    s = s &amp; "With CreateObject(""WScript.Shell"")" &amp; vbCrLf
    s = s &amp; ".AppActivate Process.ProcessId" &amp; vbCrLf
    's = s &amp; "'.SendKeys ""%{F4}"" " &amp; vbCrLf
    s = s &amp; "End With" &amp; vbCrLf

    s = s &amp; "' We found our process. No more iteration required..." &amp; vbCrLf
    s = s &amp; "Exit For" &amp; vbCrLf

    s = s &amp; "End If" &amp; vbCrLf
    s = s &amp; "Next" &amp; vbCrLf
   
    s = s &amp; "WScript.Sleep 500" &amp; vbCrLf

    s = s &amp; "loop Until storingFilesWindow = 1" &amp; vbCrLf

    s = s &amp; "if (storingFilesWindow) then" &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    s = s &amp; "WshShell.Sendkeys ""{TAB}"" " &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    s = s &amp; "WshShell.Sendkeys ""{TAB}"" " &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    s = s &amp; "WshShell.Sendkeys ""{TAB}"" " &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    s = s &amp; "WshShell.Sendkeys ""{TAB}"" " &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    s = s &amp; "WshShell.Sendkeys ""{TAB}"" " &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    
    ' s/([{}~])/{\1}/g 
	uploadFileName = Replace(uploadFileName, "~", "{~}")
	uploadFileName = Replace(uploadFileName, "+", "{+}")
	uploadFileName = Replace(uploadFileName, "^", "{^}")
	uploadFileName = Replace(uploadFileName, "%", "{%}")
	uploadFileName = Replace(uploadFileName, "(", "{(}")
	uploadFileName = Replace(uploadFileName, ")", "{)}")
	uploadFileName = Replace(uploadFileName, "[", "{[}")
	uploadFileName = Replace(uploadFileName, "]", "{]}")
	'commented out because it produced something like:
	' WFOFFI{{{}}~{}}1.IM(..)
	'uploadFileName = Replace(uploadFileName, "{", "{{}") 
	'uploadFileName = Replace(uploadFileName, "}", "{}}") 'komentarz
    s = s &amp; "WshShell.Sendkeys " &amp; chr(34) &amp; uploadFileName &amp; chr(34) &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    s = s &amp; "WshShell.Sendkeys ""{ENTER}"" " &amp; vbCrLf
    s = s &amp; "WScript.Sleep 100" &amp; vbCrLf
    s = s &amp; "end if" &amp; vbCrLf
    's = s &amp; "WScript.Sleep 1000" &amp; vbCrLf
    
    '---Save the VBscript file---
    strFile = "Thread_" &amp; threadNr &amp; ".vbs"
    sFileName = strDirectory &amp; strFile

    ' Create the File System Object
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    If objFSO.FileExists(sFileName) Then
        Set objFolder = objFSO.GetFolder(strDirectory) 'NOP
    Else
        Set objFile = objFSO.CreateTextFile(sFileName)
    End If
    set objFile = nothing
    set objFolder = nothing

    ' OpenTextFile Method needs a Const value
    ' ForAppending = 8 ForReading = 1, ForWriting = 2
    Const ForAppending = 8
    Const ForWriting = 2
    
    Set objTextFile = objFSO.OpenTextFile (sFileName, ForWriting, True)

    ' Writes strText every time you run this VBScript
    objTextFile.WriteLine(s)
    objTextFile.Close

    '---Execute the VBscript file asynchronously---
    Set wsh = WScript.CreateObject("WScript.Shell")
    wsh.Run sFileName
    Set wsh = Nothing
End Sub

'Pozdrawiam / Best regards,
'Mateusz Somysz
""";
	
	//Store the vbs file to local windows disk
	//---------------------------------------------------------------------------------------------------
	lResultFilePath = win_tmp + uuid +".vbs";
	
	log.warn("lResultFilePath=" + lResultFilePath);
	log.error("Try to save script:\r\n" + lVBScriptText);
	
	vbsFile = lResultFilePath.toString().replace("\\", "\\\\")
	
	result = false;
	try{
	    Object strOutput = driver.executeScript("""
	      String res = "";
	      BufferedWriter output = null;
	      try {
	        File file = new File("$vbsFile");
	        output = new BufferedWriter(new FileWriter(file));
	        output.write(""" + (char)34 + (char)34 + (char)34 + lVBScriptText + (char)34 + (char)34 + (char)34 + """);
	        res += "vbs file saved";
	      } catch ( Exception e ) {
	        res += e.getMessage();
	      } finally {
	          if (output != null) {
	              output.close();
	          }
	      }
	        res += " Ended first part.";
	    """, ["GROOVY"] as String[]);
	    log.error("strOutput='" + strOutput.toString() + "'");
	    result = true;
	} catch ( Exception e ) {
		log.error("EXCEPTION WIN0:" + e.getMessage()); //e.printStackTrace());
		result = false;
	}
	
	return result;
}

private boolean runTheVbsScript(win_tmp, vbsFilePath){

	log.error("runTheVbsScript win_tmp='" + win_tmp + "' vbsFilePath='" + vbsFilePath + "'")
	
	tryToMakeScreenShot = false;

	vbsDirectory = win_tmp.toString().replace("\\", "\\\\");
	jpgOutput = tempDirectory.toString() + uuid.toString() + "out.jpg";
	
	//Run the VBS script
	try{
	Object strOutput = driver.executeScript("""
		String res= "";
		//Sys.Desktop.Picture.SaveToFile "screenshot.png"
	
	  Runtime r = Runtime.getRuntime();
	  Process p = r.exec("cscript $vbsFilePath /B ");
	  p.waitFor();
	  BufferedReader b = new BufferedReader(new InputStreamReader(p.getInputStream()));
	  String line = "";
	  //List&lt;String&gt; vbsOutput = new ArrayList&lt;String&gt;();
	
	  while ((line = b.readLine()) != null) {
	    //System.out.println(line);
	    //vbsOutput.add(line);
		res += System.lineSeparator() + line;
	  }
	
	  b.close();
	
		res += System.lineSeparator() + "Ended second part.";
	""", ["GROOVY"] as String[]);
	
		log.error("strOutput='" + strOutput.toString() + "'");
		
		indE = strOutput.indexOf("ErrStep ");
		if (indE &gt; 0){
			tryToMakeScreenShot = true;
			errorId = "1";
			errorDescription = strOutput.substring(indE, strOutput.indexOf("Ended second part."));
		}
	}
	catch ( Exception e ) {
		tryToMakeScreenShot = true;
		log.error("EXCEPTION WIN1:" + e.getMessage()); //e.printStackTrace());
	}

 	//tryToMakeScreenShot = true;
	if (tryToMakeScreenShot) {
		jpgFilePath = vbsDirectory + uuid + ".jpg";
        try{
			strOutput = driver.executeScript("""
              import javax.imageio.ImageIO;
              import java.awt.Rectangle;
              import java.awt.Robot;
              import java.awt.Toolkit;
              import java.awt.image.BufferedImage;

              Rectangle screenRect = new Rectangle(Toolkit.getDefaultToolkit().getScreenSize());
              BufferedImage capture = new Robot().createScreenCapture(screenRect);
              jpgFile = new File("$jpgFilePath");
              ImageIO.write(capture, "jpg", jpgFile);
              def bytes = jpgFile.bytes;
              return Base64.getEncoder().encodeToString(bytes)
            """, ["GROOVY"] as String[]);
              
            //log.error("1-1)" + strOutput.toString());
            byte[] content = Base64.getDecoder().decode(strOutput.toString());
			
			FileOutputStream fos = null;
			File imageFile = new File(jpgOutput);
			try {
				fos = new FileOutputStream(imageFile, false)
				fos.write(content);
			}
			catch (IOException e1) {
				log.error("e1=" + e1.getMessage()); //rintStackTrace());
			}
			finally {
				if (fos != null){
					fos.close();
				}
			}
			log.warn("Downloaded file length: " + imageFile.length());
			
			//Save file To S3
			//log.warn("S3-0:" + accessKey + ", " + secretKey);
			//It requires a valid certificcate on 
			if (!accessKey.toString().trim().equals("")){
				awsCredentials = new BasicAWSCredentials(accessKey.toString(), secretKey.toString());
				s3Client = AmazonUtils.createS3Client(awsCredentials, s3_endpoint_url.toString(), AmazonUtils.S3_SIGNER);

				def x = jpgOutput.split("\\\\") as String[];
				fName = x[x.length - 1];

				log.error("fName='" + fName + "'");
				String pathOnS3 = "screenshots/" + fName; //jpgFileName;
				putObjRequest = new PutObjectRequest(s3_attachments_bucket.toString(), pathOnS3, imageFile).withCannedAcl(CannedAccessControlList.PublicRead);
				log.warn("S3-1: '" + s3_attachments_bucket.toString() + "' '"+ pathOnS3 + "'");
				s3Client.putObject(putObjRequest);
				s3path = s3Client.getResourceUrl(s3_attachments_bucket.toString(), pathOnS3);
				if (s3FileURLs.trim().equals("")){
					s3FileURLs = s3path;
				}else{
					s3FileURLs = s3FileURLs + "|" + s3path;
				}
				log.warn("S3-2 " + s3FileURLs);
			}
      	}
      	catch ( Exception e1 ) {
			log.error("EXCEPTION WIN1-1:" + e1.getMessage());
      	}
	}
}

//==================================================================

vbsFile = ""

threadNumber = uuid;
s3FileURLs = "";
errorId = 0;
errorDescription = "";

//extract filename from document_link
keyOnS3 = "";
pdfFile = "";
sepInd = document_link.toString().lastIndexOf('/');
if (sepInd &gt; 0){
	pdfFile = document_link.toString().substring(sepInd + 1);
	
	sepInd = document_link.toString().lastIndexOf('/', sepInd - 1);
	if (sepInd &gt; 0){
		keyOnS3 = document_link.toString().substring(sepInd + 1);
	}
}

lResultPdfFilePath = tempDirectory.toString() + pdfFile;

log.warn("pdfFile=" + pdfFile);

// First get windows local directory.
driver = seleniumDriver.getWrappedObject();
//set win_tmp folder and ensure it has "\" at the end
String win_tmp = driver.executeScript(" return System.getenv(\"TMP\"); ", "GROOVY").toString();
if(win_tmp.charAt(win_tmp.length() - 1) != "\\"){ //File.separator
	win_tmp += "\\"; //File.separator
}

log.warn("win_tmp=" + win_tmp);
	
pdfWinPath = (win_tmp.toString() + pdfFile.toString()).replace("\\","\\\\");
log.warn("pdfWinPath='" + pdfWinPath + "'")

errorWhileSaving  = !saveS3FileToWinDrive(s3_endpoint_url.toString(), accessKey.toString(), secretKey.toString(), s3_attachments_bucket.toString(), keyOnS3.toString(), pdfFile, pdfWinPath.toString())
//saveS3FileToWinDrive(document_link.toString(), pdfWinPath.toString())

log.warn("errorWhileSaving=" + errorWhileSaving);

if (!errorWhileSaving){
	// File downloaded :)
	// now try to store it to SAP order

	errorWhileSaving = !storeVbsToWin(win_tmp, threadNumber, pdfWinPath);
	
	log.warn("errorWhileSaving2=" + errorWhileSaving);
	
	if (!errorWhileSaving){
		log.warn("before runing VBS file");
		
		runTheVbsScript(win_tmp, vbsFile);
		
		log.warn("after runing VBS file");
	}
}
]]&gt;
			&lt;/script&gt;
		&lt;/selenium&gt;
	&lt;/selenium-flow&gt;
  
	&lt;export include-original-data="true"&gt;
		&lt;!--&lt;single-column name="order_number" value="${orderNumber}"/&gt;--&gt;
		&lt;single-column name="sap_archiving_screenshot_file_uri"  value="${s3FileURLs}" /&gt;
		&lt;single-column name="error_archiving_id" value="${errorId}"/&gt;
    	&lt;single-column name="error_archiving_description"  value="${errorDescription}" /&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>88dd2ff4-93c3-48e1-931b-5e98d8d0c4b5</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[200] Archiving      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>88dd2ff4-93c3-48e1-931b-5e98d8d0c4b5</uuid>
                                    <version>
                                        <componentUuid>e5f0c0ef-6783-4194-885c-6725160016c5</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>14b8360d-30a4-47a3-9d05-c71fbb1ed97f</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[200] Archiving      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>a162d27c-19a2-4ab6-8302-bbe140ffd1e8</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>b7ad458a-c944-4ea2-9f0d-c1d294a470b0</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>49701704-9ea5-4849-ac5d-09287a5d4d7f</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>8</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>8f898522-bab8-4615-bee8-da8238617533</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>ba7196b4-e90c-44dd-a208-b9df2d2522ef</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

    &lt;script&gt;&lt;![CDATA[
	  import javax.imageio.ImageIO
	  import java.awt.Color
	  import java.awt.image.BufferedImage
	  import groovy.json.JsonSlurper;
	  
	   String htmlVarTemplate = "&lt;style type=\"text/css\"&gt;\n" +
                ".tg  {border-collapse:collapse;border-spacing:0;border-color:#999;}\n" +
                ".tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#999;color:#444;background-color:#F7FDFA;}\n" +
                ".tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#999;color:#fff;background-color:#26ADE4;}\n" +
                ".tg .tg-baqh{text-align:center;vertical-align:top}\n" +
                ".tg .tg-r215{color:#fd6864;text-align:center;vertical-align:top}\n" +
                ".tg .tg-6k2t{background-color:#D2E4FC;vertical-align:top}\n" +
                ".tg .tg-yw4l{vertical-align:top}\n" +
                "&lt;/style&gt;\n" +
                "&lt;table class=\"tg\" style=\"undefined;table-layout: fixed; width: 100%\"&gt;\n" +
                "&lt;colgroup&gt;\n" +
                "&lt;col style=\"width: 100%\"&gt;\n" +
                "&lt;col style=\"width: 100%\"&gt;\n" +
                "&lt;col style=\"width: 100%\"&gt;\n" +
                "&lt;/colgroup&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;th class=\"tg-baqh\"&gt;&lt;span style=\"font-weight:bold\"&gt;PARAMETER&lt;/span&gt;&lt;/th&gt;\n" +
                "    &lt;th class=\"tg-baqh\"&gt;&lt;span style=\"font-weight:bold\"&gt;INITIAL VALUE AFTER OCR&lt;/span&gt;&lt;/th&gt;\n" +
                "    &lt;th class=\"tg-r215\"&gt;&lt;span style=\"font-weight:bold;color:rgb(255, 255, 255)\"&gt;FINAL VALUE&lt;/span&gt;&lt;/th&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;Customer Name &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;initCustName&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalCustName&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;Customer Street &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initCustStr&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalCustStr&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;Customer Zipcode &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;initCustZip&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalCustZip&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;Customer City &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initCustCity&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalCustCity&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;Sales Area&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;initSalesArea&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalSalesArea&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;Distribution Channel&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initDChl&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalDChl&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;Shipto&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;intShipTo&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalShipTo&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
              /*  "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;Soldto&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initSoldTo&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalSoldTo&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;RDD &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;initRDD&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalRDD&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;RDD Time &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initRTime&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalRTime&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;PO number &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;initPONumber&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalPONumber&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;Net Total Price &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initPrice&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalPrice&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "&lt;/table&gt;";*/

                "    &lt;td class=\"tg-yw4l\"&gt;RDD &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initRDD&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalRDD&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;RDD Time &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;initRTime&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalRTime&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;PO number &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;initPONumber&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-yw4l\"&gt;finalPONumber&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;Net Total Price &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;initPrice&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-6k2t\"&gt;finalPrice&lt;/td&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "&lt;/table&gt;";

        String htmlPCInitTemplate = "&lt;style type=\"text/css\"&gt;\n" +
                ".tg  {border-collapse:collapse;border-spacing:0;}\n" +
                ".tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}\n" +
                ".tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}\n" +
                ".tg .tg-puuk{background-color:#26ade4;border-color:inherit;text-align:center}\n" +
                ".tg .tg-4ljg{background-color:#d2e4fc;text-align:center;vertical-align:top}\n" +
                ".tg .tg-l711{border-color:inherit;text-align:center}\n" +
                ".tg .tg-uys7{border-color:inherit;text-align:center}\n" +
                ".tg .tg-3fty{font-size:15px;font-family:\"Arial Black\", Gadget, sans-serif !important;;background-color:#3166ff;border-color:inherit;text-align:center}\n" +
                ".tg .tg-getu{background-color:#26ade4;border-color:inherit;text-align:center}\n" +
                ".tg .tg-oksl{background-color:#d2e4fc;text-align:center}\n" +
                "&lt;/style&gt;\n" +
                "&lt;table class=\"tg\" width = \"100%\"&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;th class=\"tg-3fty\" colspan=\"3\"&gt;&lt;span style=\"font-weight:bold;color:rgb(255, 255, 255)\"&gt;PRODUCTS&lt;/span&gt;&lt;/th&gt;\n" +
                "  &lt;/tr&gt;\n" +
                "  &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-puuk\"&gt;&lt;span style=\"font-weight:bold;color:rgb(255, 255, 255)\"&gt;No.&lt;/span&gt;&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-getu\"&gt;&lt;span style=\"font-weight:bold;color:rgb(255, 255, 255)\"&gt;INITIAL VALUE &lt;/span&gt;&lt;br&gt;&lt;span style=\"font-weight:bold;color:rgb(255, 255, 255)\"&gt;AFTER OCR&lt;/span&gt;&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-getu\"&gt;&lt;span style=\"font-weight:bold;color:rgb(255, 255, 255)\"&gt;FINAL VALUE&lt;/span&gt;&lt;/td&gt;\n" +
                "  &lt;/tr&gt;";

        String htmlPCWhiteRowTemplate = " &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-l711\"&gt;index&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-uys7\"&gt;PC1: &lt;br&gt;PC2: &lt;br&gt;Qty1: &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-uys7\"&gt;ME:&lt;br&gt;CMC:&lt;br&gt;Qty2: &lt;/td&gt;\n" +
                "  &lt;/tr&gt;";

        String htmlPCBlueRowTemplate = " &lt;tr&gt;\n" +
                "    &lt;td class=\"tg-oksl\"&gt;index&lt;/td&gt;\n" +
                "    &lt;td class=\"tg-4ljg\"&gt;PC1: &lt;br&gt;PC2: &lt;br&gt;Qty1: &lt;/td&gt;\n" +
                "    &lt;td class=\"tg-4ljg\"&gt;ME:&lt;br&gt;CMC:&lt;br&gt;Qty2: &lt;/td&gt;\n" +
                "  &lt;/tr&gt;";

        String tableEnd = "&lt;/table&gt;";
	  
	   class Size{
        int height;
        int width;
        Size(int width, int height) {
            this.height = height
            this.width = width
        }
        int getHeight() {
            return height
        }
        int getWidth() {
            return width
        }
        boolean equals(o) {
            if (this.is(o)) return true
            if (getClass() != o.class) return false

            Size size = (Size) o

            if (height != size.height) return false
            if (width != size.width) return false

            return true
        }

        int hashCode() {
            int result
            result = height
            result = 31 * result + width
            return result
        }
    }

    boolean checkIfImageIsExpanded(BufferedImage image){
        int height = image.getHeight();
        int width = image.getWidth();
        int intervalHorizontal = width/10;
        int intervalVertical = height/10;
        int stepHorizontal = 5;
        int stepVertical = 5;
        int horizontalLimit = width * 0.8;
        int verticalLimit = height * 0.8;
        int blackRGB = Color.BLACK.getRGB();

        for(int currentPixY = height-1; currentPixY &gt; 0 ; currentPixY-=intervalVertical) {
            for (int currentPixX = width-1; currentPixX &gt; horizontalLimit; currentPixX -= stepHorizontal) {
                if (image.getRGB(currentPixX, currentPixY) != blackRGB){
                    return false;
                }
            }
        }

        for (int currentPixX = width -1 ; currentPixX &gt; 0; currentPixX -= intervalHorizontal) {
            for(int currentPixY = height - 1; currentPixY &gt; verticalLimit ; currentPixY-=stepVertical) {
                if (image.getRGB(currentPixX, currentPixY) != blackRGB){
                    return false;
                }
            }
        }

        return true;
    }

    int checkSize(BufferedImage image){
        ArrayList&lt;Size&gt; allowedSizes = Arrays.asList(new Size(1920, 1080),
                new Size(1600, 900), new Size(1366, 768), new Size(1280, 1024),
                new Size(1280, 720), new Size(1024, 768), new Size(800, 600))
        int height = image.getHeight();
        int width = image.getWidth();
        if(allowedSizes.contains(new Size(width, height))){
            return 0;
        }
        else if(width&gt;allowedSizes.get(0).width || height&gt;allowedSizes.get(0).height){
            return 1;
        }
        else{
            return -1
        }
    }

    public String buildImageInfo(boolean expandendResult, int sizeResult, int width, int height){
        StringBuilder strBuilder = new StringBuilder(" (");
        strBuilder.append("Captured image of size: ").append(width).append("x").append(height);
        if(expandendResult == false &amp;&amp; sizeResult == 0){
            return ""
        }
        else if(expandendResult == false &amp;&amp; sizeResult == 1){
            strBuilder.append(" seems to be fuzzy")
        }
        else if(expandendResult == false &amp;&amp; sizeResult == -1){
            strBuilder.append(" seems to be cut.")
        }
        else if(expandendResult == true){
            strBuilder.append(" seems to by expanded.")
        }
        return strBuilder.toString() + ")";

    }

		public enum MailCase {
			DATA_FAILED_CANCELED, // beyond_repair_flag=YES &amp; manual_path_cnt &lt;= manual_path_max_cnt
			DATA_FAILED_ABANDONED, // beyond_repair_flag=YES &amp; manual_path_cnt &gt; manual_path_max_cnt
			SUCCEEDED, // sap_validity_flag=YES
			SAP_FAILED, // sap_validity_flag=NO
			UNPREDICTED;
		}

		def esc = {
			x -&gt;
			if (x != null) {
				x.replace("&amp;", "&amp;amp;").replace("&lt;", "&amp;lt;").replace("&gt;", "&amp;gt;");
				//.replace("\"", "&amp;quot;").replace("'", "&amp;apos;");	
			} else {
				x;
			}
		}

		def poNum = null;
		if (po_number != null) {
			if (!po_number.toString().equals("")) {
				poNum = po_number.toString();
			}
		}

		def sapOrder = null;
		if (order_number != null) {
			if (!order_number.toString().equals("")) {
				sapOrder = order_number.toString();
			}
		}

		def shipToName = null;
		if (ship_to_name != null) {
			if (!ship_to_name.toString().equals("")) {
				shipToName = ship_to_name.toString();
			}
		}

		def shipToLocation = null;
		if (ship_to_location != null) {
			if (!ship_to_location.toString().equals("")) {
				shipToLocation = ship_to_location.toString();
			}
		}
		
		def shipToPostal = null;
		if (ship_to_postal_code != null) {
			if (!ship_to_postal_code.toString().equals("")) {
				shipToPostal = ship_to_postal_code.toString();
			}
		}

		def shipToStreet = null;
		if (ship_to_street_name != null) {
			if (!ship_to_street_name.toString().equals("")) {
				shipToStreet = ship_to_street_name.toString();
			}
		}
		
		def netTotalPrice = null;
		if (net_total_price != null) {
			if (!net_total_price.toString().equals("")) {
				netTotalPrice = net_total_price.toString();
			}
		}

		def mailCase = MailCase.UNPREDICTED;

		if (("YES".equals(beyond_repair_flag.toString()) &amp;&amp; Integer.valueOf(manual_path_cnt.toString()) &lt;= Integer.valueOf(manual_path_max_cnt.toString()))
                   || "YES".equals(canceled_manual_task.toString())) {
			mailCase = MailCase.DATA_FAILED_CANCELED;
		} else if ("YES".equals(beyond_repair_flag.toString()) &amp;&amp; Integer.valueOf(manual_path_cnt.toString()) &gt; Integer.valueOf(manual_path_max_cnt.toString())) {
			mailCase = MailCase.DATA_FAILED_ABANDONED;
		} else if ("YES".equals(sap_validity_flag.toString())) {
			mailCase = MailCase.SUCCEEDED;
		} else if ("NO".equals(sap_validity_flag.toString())) {
			mailCase = MailCase.SAP_FAILED;
		}

		emailFrom = "";
		emailTo = "";
		emailSubject = "";
		emailBody = "";
		
	variablesJson =  new JsonSlurper().parseText(variables.toString())
		rdd_orig= variablesJson.rdd_orig.history.find{it.version==1}.value


		//rdd=variablesJson.rdd_orig.value
		rddSummary = rdd_orig.toString().equals(rdd.toString())?(rdd.toString().equals("&lt;b&gt;&lt;i&gt;none&lt;/i&gt;&lt;/b&gt;")?:"&lt;b&gt;${rdd}&lt;/b&gt;"):((rdd.toString().equals("")?"&lt;b&gt;&lt;i&gt;underived&lt;/i&gt;&lt;/b&gt;":"&lt;b&gt;${rdd}&lt;/b&gt; derived")+" from &lt;b&gt;${rdd_orig}&lt;/b&gt;");
		poNumberSummary = poNum==null?"&lt;i&gt;none&lt;/i&gt;":esc(poNum);
		netTotalPriceSummary = netTotalPrice==null?"&lt;i&gt;none&lt;/i&gt;":esc(netTotalPrice);
		shipToIdSummary = variablesJson.ship_to_id.value.equals("")?"&lt;i&gt;none&lt;/i&gt;":variablesJson.ship_to_id.value;
		salesAreaIdSummary = variablesJson.sales_area_id.value.equals("")?"&lt;i&gt;none&lt;/i&gt;":variablesJson.sales_area_id.value;
		distrChannelIdSummary = variablesJson.distribution_channel_id.value.equals("")?"&lt;i&gt;none&lt;/i&gt;":variablesJson.distribution_channel_id.value;
		errorsSummary = "&lt;ul&gt;&lt;li&gt;" + error_description_list.toString().replaceAll("\\|", "&lt;/li&gt;&lt;li&gt;") + "&lt;/li&gt;&lt;/ul&gt;";
      warningsSummary = "";

      if (error_id_list != null) {
         if (!error_id_list.toString().trim().equals("")) {
            warningsSummary = "Following warings occured during the process: \n" + errorsSummary + "\n";
         }
      }
      screenshotSummary = "";

	  String[] sap_screenshot_file_uris = sap_screenshot_file_uri.toString().split("\\|")    
      if (sap_screenshot_file_uri != null) {
         if (!sap_screenshot_file_uri.toString().trim().equals("")) {	
         screenshotSummary = "Please refer to the screenshots:";
         for(int i = 0; i&lt; sap_screenshot_file_uris.length; i++){         	
            BufferedImage image = ImageIO.read(new URL(sap_screenshot_file_uris[i]));
      	  	boolean expandedResult = checkIfImageIsExpanded(image)
      	  	int sizeResult = checkSize(image);
      	  	int height = image.getHeight();
      	  	int width = image.getWidth();
      	  	sap_screenshot_file_validation_result = buildImageInfo(expandedResult, sizeResult, width, height)
         	screenshotSummary+= "&lt;a href=\""+sap_screenshot_file_uris[i].toString() + "\"&gt;screenshot&lt;/a&gt;" +
         	sap_screenshot_file_validation_result + ","
         }
		 screenshotSummary = screenshotSummary.replaceAll(",\$", "");

         screenshotSummary +="&lt;br/&gt;&lt;br/&gt;\n";            
			  
         }
      }


		shipToNameSummary = esc(shipToName)?:"&lt;i&gt;none&lt;/i&gt;";
		shipToLocationSummary = esc(shipToLocation)?:"&lt;i&gt;none&lt;/i&gt;";
		shipToPostalSummary = esc(shipToPostal)?:"&lt;i&gt;none&lt;/i&gt;";
		shipToStreetSummary = esc(shipToStreet)?:"&lt;i&gt;none&lt;/i&gt;";
		netTotalPriceSummary  = esc(netTotalPrice)?:"&lt;i&gt;none&lt;/i&gt;";

		productCnt = product_code_list.toString().chars().filter{ch -&gt; ch == '|'}.count()+1;
		gtinCnt = gtin_list.toString().chars().filter{ch -&gt; ch == '|'}.count()+1;
		quantityCnt = quantity_list.toString().chars().filter{ch -&gt; ch == '|'}.count()+1;

		def product_information = new JsonSlurper().parseText(product_lines.toString()).product_lines
	orderedProductSummary = "&lt;table border=\"1\"&gt;&lt;tr&gt;&lt;th&gt;product code 1&lt;/th&gt;&lt;th&gt;product code 2&lt;/th&gt;&lt;th&gt;GTIN&lt;/th&gt;&lt;th&gt;quantity&lt;/th&gt;&lt;/tr&gt;";
		product_information.each { 
			product = it.product_code1.last.toString();
			product = esc(product)?:"&lt;i&gt;none&lt;/i&gt;";
			product2 = it.product_code2.last.toString();
			product2 = esc(product2)?:"&lt;i&gt;none&lt;/i&gt;";
			gtin = it.gtin.last.toString();
			gtin = esc(gtin)?:"&lt;i&gt;none&lt;/i&gt;";
			quantity = it.quantity.last.toString();
			quantity = esc(quantity)?:"&lt;i&gt;none&lt;/i&gt;";
			orderedProductSummary += "&lt;tr&gt;&lt;td&gt;${product}&lt;/td&gt;&lt;td&gt;${product2}&lt;/td&gt;&lt;td&gt;${gtin}&lt;/td&gt;&lt;td&gt;${quantity}&lt;/td&gt;&lt;/tr&gt;";
		}
		orderedProductSummary += "&lt;/table&gt;";
		
		/**
		* Building info table 
		*/
		
		String varsHtml = htmlVarTemplate;
		varsHtml = varsHtml.replace("initCustName", customer_name_ocr.toString());
		varsHtml = varsHtml.replace("initCustCity", city_ocr.toString());
		varsHtml = varsHtml.replace("initCustZip", zip_code_ocr.toString());
		varsHtml = varsHtml.replace("initCustStr", street_address_ocr.toString());
		varsHtml = varsHtml.replace("initRDD", request_delivery_date_ocr.toString());
		varsHtml = varsHtml.replace("initPONumber", purchase_order_ocr.toString());
		varsHtml = varsHtml.replace("intShipTo","na");
//varsHtml = varsHtml.replace("initSoldTo","na");
varsHtml = varsHtml.replace("initDChl","na");
varsHtml = varsHtml.replace("initSalesArea","na");
varsHtml = varsHtml.replace("initRTime",rdd_time_ocr.toString());
varsHtml = varsHtml.replace("initPrice",net_total_price_ocr.toString());

		varsHtml = varsHtml.replace("finalCustName", customer_name.toString());
		varsHtml = varsHtml.replace("finalCustCity", city.toString());
		varsHtml = varsHtml.replace("finalCustZip", zip_code.toString());
		varsHtml = varsHtml.replace("finalCustStr", street_address.toString());
		varsHtml = varsHtml.replace("finalRDD", request_delivery_date.toString());
		varsHtml = varsHtml.replace("finalPONumber", purchase_order.toString());
		varsHtml = varsHtml.replace("finalShipTo",ship_to_name.toString());
//varsHtml = varsHtml.replace("finalSoldTo","na");
varsHtml = varsHtml.replace("finalDChl",distribution_channel_id.toString());
varsHtml = varsHtml.replace("finalSalesArea",sales_area_id.toString());
varsHtml = varsHtml.replace("finalRTime",rdd_time.toString());
varsHtml = varsHtml.replace("finalPrice",net_total_price.toString());

		
		StringBuilder htmlBuilder = new StringBuilder(htmlPCInitTemplate);
        int index = 1;
        String row = "";
		
		product_information.each { 
		
		
			if(index%2 == 0){
                row = htmlPCBlueRowTemplate;
            }
            else{
                row = htmlPCWhiteRowTemplate;
            }
            row = row.replace("index", String.valueOf(index));
            row = row.replace("PC1:", "PC1: " + it.product_code1.ocred.toString());
            row = row.replace("PC2:", "PC2: " +  it.product_code2.ocred.toString());
            row = row.replace("Qty1:", "QTY: " + it.quantity.last.toString());
            row = row.replace("ME:", "Material Entered: " + it.product_code1.last.toString());
            row = row.replace("CMC:", "Customer Material Code: " + it.gtin.last.toString());
            row = row.replace("Qty2:", "QTY: " + it.quantity.last.toString());
            htmlBuilder.append(row);
            index ++;
		
			
		}
		 htmlBuilder.append(tableEnd);
		 
		 String prodsHtml = htmlBuilder.toString();
		
		/*****************/

		id = "[${uuid}-${mail_id}]";
		
		fieldsSummary = "Fields provided in test data (&lt;i&gt;no order document information&lt;/i&gt;):&lt;/br&gt;";
		if (document_link != null) {
			if (!document_link.toString().trim().equals("")) {
				fieldsSummary = "Fields recognized during tagging &lt;a href=\"${document_link}\"&gt;an order document&lt;/a&gt;:&lt;/br&gt;";
			}
		}
		
		if (mailCase == MailCase.SUCCEEDED) {
			emailFrom = confirmation_email_from.toString();
			emailTo = confirmation_email_recipient.toString();
			emailSubject = (confirmation_email_subject_prefix.toString() + " " +
						 ((debug_mode.toString().equals("YES"))?(id + " "):"") +  
						 "SAP order " + sapOrder +
						 " for " + shipToName +
						 (poNum?("(PO: " + poNum + ")"):"") +
						 " from " + shipToName).replaceAll("[\n\r]+", "");
  			emailBody = """
              Dear team,&lt;/br&gt;
              &lt;/br&gt;
			  &lt;a href="${cfg_control_tower_endpoint}/workfusion/secure/business-process/edit/${uuid}?actTab=RESULTS"&gt;RPA process&lt;/a&gt; has &lt;font color="#00ff00"&gt;&lt;b&gt;SUCCEEDED&lt;/b&gt;&lt;/font&gt; to put a SAP order &lt;b&gt;${sapOrder}&lt;/b&gt;&lt;/br&gt;&lt;/br&gt;
           ${warningsSummary}
           ${screenshotSummary}
			  ${fieldsSummary}
              Purchase order number: &lt;b&gt;${poNumberSummary}&lt;/b&gt;&lt;/br&gt;
			  Net total price: &lt;b&gt; ${netTotalPriceSummary}&lt;/b&gt;&lt;/br&gt;
              Request delivery date: ${rddSummary}&lt;/br&gt;
              Ship to party: &lt;b&gt;${shipToIdSummary}&lt;/b&gt;&lt;/br&gt;
              &amp;nbsp;&amp;nbsp;and Sales Area: &lt;b&gt;${salesAreaIdSummary}&lt;/b&gt;&lt;/br&gt;
              &amp;nbsp;&amp;nbsp;and Distribution Channel: &lt;b&gt;${distrChannelIdSummary}&lt;/b&gt;&lt;/br&gt; based on:
                  &lt;ul&gt;&lt;li&gt;Ship to name: &lt;b&gt;${shipToNameSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to location: &lt;b&gt;${shipToLocationSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to postal code: &lt;b&gt;${shipToPostalSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to street name: &lt;b&gt;${shipToStreetSummary}&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;

			  Ordered products:&lt;/br&gt;
              ${orderedProductSummary}
              &lt;/br&gt;
			  Should you have any questions or comments, please &lt;a href="https://pgglobalenterprise.service-now.com/ITSM_Portal/catalog-item.do?sysparm_document_key=sc_cat_item_producer%2C99bc0d3bdb25134047a3f1041d9619c1"&gt;contact support team&lt;/a&gt; referring following details
			  &lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			  &lt;/table&gt;
			""";
		} else if (mailCase == MailCase.SAP_FAILED) {
			emailFrom = failure_email_from.toString();
			emailTo = failure_email_recipient.toString();
			emailSubject = (failure_email_subject_prefix.toString() + " " +
						 ((debug_mode.toString().equals("YES"))?(id + " "):"") +  
						 (poNum?("purchase order " + poNum):"order") +
						 " from " +
						 (shipToName?:"unknown customer")).replaceAll("[\n\r]+", "");
			emailBody = """
              Dear team,&lt;/br&gt;
              &lt;/br&gt;
			  &lt;a href="${cfg_control_tower_endpoint}/workfusion/secure/business-process/edit/${uuid}?actTab=RESULTS"&gt;RPA process&lt;/a&gt; has &lt;font color="#ff0000"&gt;&lt;b&gt;FAILED&lt;/b&gt;&lt;/font&gt; due to one of the following error(s):${errorsSummary}&lt;/br&gt;
              
           ${screenshotSummary}
			  ${fieldsSummary}
              Purchase order number: &lt;b&gt;${poNumberSummary}&lt;/b&gt;&lt;/br&gt;
			  Net total price: &lt;b&gt; ${netTotalPriceSummary}&lt;/b&gt;&lt;/br&gt;
              Request delivery date: ${rddSummary}&lt;/br&gt;
              Ship to party: &lt;b&gt;${shipToIdSummary}&lt;/b&gt;&lt;/br&gt;
              &amp;nbsp;&amp;nbsp;and Sales Area: &lt;b&gt;${salesAreaIdSummary}&lt;/b&gt;&lt;/br&gt;
              &amp;nbsp;&amp;nbsp;and Distribution Channel: &lt;b&gt;${distrChannelIdSummary}&lt;/b&gt;&lt;/br&gt; based on:
                  &lt;ul&gt;&lt;li&gt;Ship to name: &lt;b&gt;${shipToNameSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to location: &lt;b&gt;${shipToLocationSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to postal code: &lt;b&gt;${shipToPostalSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to street name: &lt;b&gt;${shipToStreetSummary}&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;

			  Ordered products:&lt;/br&gt;
              ${orderedProductSummary}
              &lt;/br&gt;
			  Should you have any questions or comments, please &lt;a href="https://pgglobalenterprise.service-now.com/ITSM_Portal/catalog-item.do?sysparm_document_key=sc_cat_item_producer%2C99bc0d3bdb25134047a3f1041d9619c1"&gt;contact support team&lt;/a&gt; referring following details
			  &lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			  &lt;/table&gt;
			""";
		} else if (mailCase == MailCase.DATA_FAILED_CANCELED) {
			emailFrom = failure_email_from.toString();
			emailTo = failure_email_recipient.toString();
			emailSubject = ("[RPA][NE] RPA processing canceled for " +
						 ((debug_mode.toString().equals("YES"))?(id + " "):"") +  
						 uuid + "-" + mail_id).replaceAll("[\n\r]+", "");
			emailBody = """
              Dear team,&lt;/br&gt;
              &lt;/br&gt;
			  &lt;a href="${cfg_control_tower_endpoint}/workfusion/secure/business-process/edit/${uuid}?actTab=RESULTS"&gt;RPA process&lt;/a&gt; was &lt;font color="#ff0000"&gt;&lt;b&gt;CANCELED by operator&lt;/b&gt;&lt;/font&gt;.&lt;/br&gt;
              
			 Should you have any questions or comments, please &lt;a href="https://pgglobalenterprise.service-now.com/ITSM_Portal/catalog-item.do?sysparm_document_key=sc_cat_item_producer%2C99bc0d3bdb25134047a3f1041d9619c1"&gt;contact support team&lt;/a&gt; referring following details
			  &lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			  &lt;/table&gt;
			""";
		} else {
			emailFrom = failure_email_from.toString();
			emailTo = failure_email_recipient.toString();
			emailSubject = (failure_email_subject_prefix.toString() + " " +
						 ((debug_mode.toString().equals("YES"))?(id + " "):"") +  
						 (poNum?("purchase order " + poNum):"order") +
						 " from " +
						 (shipToName?:"unknown customer")).replaceAll("[\n\r]+", "");
			emailBody = """
              Dear team,&lt;/br&gt;
              &lt;/br&gt;
			  &lt;a href="${cfg_control_tower_endpoint}/workfusion/secure/business-process/edit/${uuid}?actTab=RESULTS"&gt;RPA process&lt;/a&gt; has &lt;font color="#ff0000"&gt;&lt;b&gt;FAILED&lt;/b&gt;&lt;/font&gt; due to one of the following error(s):${errorsSummary}&lt;/br&gt;
              
           ${screenshotSummary}
			  ${fieldsSummary}
              Purchase order number: &lt;b&gt;${poNumberSummary}&lt;/b&gt;&lt;/br&gt;
			  Net total price: &lt;b&gt; ${netTotalPriceSummary}&lt;/b&gt;&lt;/br&gt;
              Request delivery date: ${rddSummary}&lt;/br&gt;
              Ship to party: &lt;b&gt;${shipToIdSummary}&lt;/b&gt;&lt;/br&gt;
              &amp;nbsp;&amp;nbsp;and Sales Area: &lt;b&gt;${salesAreaIdSummary}&lt;/b&gt;&lt;/br&gt;
              &amp;nbsp;&amp;nbsp;and Distribution Channel: &lt;b&gt;${distrChannelIdSummary}&lt;/b&gt;&lt;/br&gt; based on:
                  &lt;ul&gt;&lt;li&gt;Ship to name: &lt;b&gt;${shipToNameSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to location: &lt;b&gt;${shipToLocationSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to postal code: &lt;b&gt;${shipToPostalSummary}&lt;/b&gt;&lt;/li&gt;
                  &lt;li&gt;Ship to street name: &lt;b&gt;${shipToStreetSummary}&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;

			  Ordered products:&lt;/br&gt;
              ${orderedProductSummary}
              &lt;/br&gt;
			  Should you have any questions or comments, please &lt;a href="https://pgglobalenterprise.service-now.com/ITSM_Portal/catalog-item.do?sysparm_document_key=sc_cat_item_producer%2C99bc0d3bdb25134047a3f1041d9619c1"&gt;contact support team&lt;/a&gt; referring following details
			  &lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			  &lt;/table&gt;
			""";
		}
		emailBody = emailBody + "&lt;/br&gt;&lt;/br&gt;MODIFICATIONS DURING PROCESS &lt;/br&gt;&lt;/br&gt;" + varsHtml + "&lt;/br&gt;" + prodsHtml;
		sys.defineVariable("attName", "order" + (shipToName == null ? "" : ("_" + shipToName)) + (poNum == null ? "" : ("_" + poNum)));
	]]&gt;&lt;/script&gt;


	&lt;mail smtp-host="${smtp_server_host}" type="html" smtp-port="${smtp_server_port}" from="${emailFrom}"
		to="${emailTo}" subject="${emailSubject}"&gt;
		&lt;template&gt;&lt;![CDATA[
			${emailBody}
		]]&gt;&lt;/template&gt;
      	&lt;case&gt;
	        &lt;if condition="${cfg_attach_pdf.toString() == 'YES'}"&gt;
	            &lt;mail-attach name="${attName}.pdf"&gt;
	        		&lt;http-extended url="${document_link}" method="GET"/&gt;
	    		&lt;/mail-attach&gt;
	        &lt;/if&gt;
    	&lt;/case&gt;
	&lt;/mail&gt;

	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;

&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>01a0aaf9-b0c8-4d3a-a7fd-f02057f23c47</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[210] summary email      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>01a0aaf9-b0c8-4d3a-a7fd-f02057f23c47</uuid>
                                    <version>
                                        <componentUuid>8452e002-6208-4a63-9e71-f921777b582e</componentUuid>
                                        <incrementalVersion>1.2</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-05T09:28:28Z</lastModified>
                                        <versionUuid>5c129df4-34b0-436b-ace9-1cbc57d512f8</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[210] summary email      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>79646ecf-537c-44cb-8aef-6c8ffc28eeb9</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>d6d67182-5fb8-409b-817c-65a2b8160be9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-05T09:28:32Z</lastModified>
                                    <versionUuid>6bdaf37f-b3da-48f0-9041-6a4485ff62bd</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>9</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>2931c8d1-6e9c-455e-b6ca-767ee7fc68e0</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"yes","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"data_validity_flag","value":"YES","operator":"EQ"},{"fieldName":"beyond_repair_flag","value":"NO","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'yes' when data_validity_flag EQ 'YES' AND beyond_repair_flag EQ 'NO'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("data_validity_flag", "EQ", "YES"));
        eval($item.checkValue("beyond_repair_flag", "EQ", "NO"));

    then
        $ctx.sendResultTo("yes", $item);
end

# RuleOutcome.Definition={"outcomeId":"no and no hope","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"beyond_repair_flag","value":"YES","operator":"EQ"},{"fieldName":"data_validity_flag","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'no and no hope' when beyond_repair_flag EQ 'YES' AND data_validity_flag EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("beyond_repair_flag", "EQ", "YES"));
        eval($item.checkValue("data_validity_flag", "EQ", "YES"));

    then
        $ctx.sendResultTo("no and no hope", $item);
end

# RuleOutcome.Definition={"outcomeId":"no but hope","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"data_validity_flag","value":"NO","operator":"EQ"},{"fieldName":"beyond_repair_flag","value":"NO","operator":"EQ"}],"customConditions":[]}
rule "3. Send records to 'no but hope' when data_validity_flag EQ 'NO' AND beyond_repair_flag EQ 'NO'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("data_validity_flag", "EQ", "NO"));
        eval($item.checkValue("beyond_repair_flag", "EQ", "NO"));

    then
        $ctx.sendResultTo("no but hope", $item);
end

# RuleOutcome.Definition={"outcomeId":"no and no hope 2","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"data_validity_flag","value":"NO","operator":"EQ"},{"fieldName":"beyond_repair_flag","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "4. Send records to 'no and no hope 2' when data_validity_flag EQ 'NO' AND beyond_repair_flag EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("data_validity_flag", "EQ", "NO"));
        eval($item.checkValue("beyond_repair_flag", "EQ", "YES"));

    then
        $ctx.sendResultTo("no and no hope 2", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>isValid</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>05e085ff-ba24-4663-ab57-4547309d8d61</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
   &lt;!--
      changelog:
         3.1.6 RDD asap added
   --&gt;

	&lt;script&gt;&lt;![CDATA[
		log.warn("po_date=" + po_date);
		log.warn("po_number=" + po_number);
		log.warn("product_lines=" + product_lines);
		log.warn("product_code_mode=" + product_code_mode);
		log.warn("sap_credentials_secure_store_id=" + sap_credentials_secure_store_id);
		log.warn("sap_bw_credentials_secure_store_id=" + sap_bw_credentials_secure_store_id);
		log.warn("shared_drive_secure_store_id=" + shared_drive_secure_store_id);
		log.warn("gtin_maping_xlsx_uri=" + gtin_maping_xlsx_uri);		
		log.warn("email_credentials_secure_store_id=" + email_credentials_secure_store_id);

		manualPathCnt = Long.valueOf("${manual_path_cnt}".toString())+1;

		oldErrIdList = ""; //"${error_id_list}".toString();
		oldErrDescList = ""; //"${error_description_list}".toString();
		errIdList = "";
		errDescList = "";
		beyondRepair = "${beyond_repair_flag}".toString();
	]]&gt;&lt;/script&gt;

	&lt;script&gt;&lt;![CDATA[
		nonNullValidator = [
			validate: {obj -&gt; obj != null},
			invalidMessage: {String obj, String type -&gt;
				type + " is null. \n"
			}
		]

		nonEmptyValidator = [
			validate: {obj -&gt; obj != "";},
			invalidMessage: {String obj, String type -&gt;
				type + " is empty. \n"
			}
		]

		regexpValidatorMaker = {String regexp -&gt;
			return [
				validate: {String obj -&gt;
					return obj == null ? false : obj.matches(regexp);
				},
				invalidMessage: {String obj, String type -&gt;
					type + " does not match following regexp: '" + regexp + "'. Instead it is equal to + " + obj + ".\n"
				}
			]
		}

		integerValidator = regexpValidatorMaker("^ ?\\d+ ?(\\| ?\\d+ ?)*\$");
		doubleValidator = regexpValidatorMaker("^ ?\\d+(\\.\\d+)? ?(\\| ?\\d+(\\.\\d+)? ?)*\$");
		rddAsapValidator = regexpValidatorMaker("(?i)asap");
		productCodeModeValidator = regexpValidatorMaker("^4|6|11|13\$");
	]]&gt;&lt;/script&gt;

	&lt;script&gt;&lt;![CDATA[
		import groovy.json.JsonParserType
		import groovy.json.JsonSlurper		
		import java.math.BigDecimal;
		import java.text.DecimalFormat
		import java.text.DecimalFormatSymbols




		//Validation phase
		def validate = {String obj, String type, List validators -&gt;
			boolean isValid = true;
			for (validator in validators) {
				if (!validator.validate(obj)) {
					isValid = false;
				}
			}
			return isValid;
		}

		variablesJson =  new JsonSlurper().parseText(variables.toString())

		if (!validate(variablesJson.ship_to_id.value, "ship_to_id", [nonNullValidator, nonEmptyValidator, integerValidator])) {
        	errIdList += "|DATA-04";
        	errDescList += "|Ship to party wasn't derived based on OCR-ed ship to details";
		}

		if (!validate(variablesJson.distribution_channel_id.value, "distribution_channel_id", [nonNullValidator, nonEmptyValidator])) {
        	errIdList += "|DATA-04-1";
        	errDescList += "|Distribution channel wasn't derived based on OCR-ed ship to details";
		}

		def rdd_orig=variablesJson.rdd_orig.value 
		if (!validate(rdd_orig, "rdd", [rddAsapValidator])) {
          if (!validate(rdd_orig, "rdd", [nonNullValidator, nonEmptyValidator])) {
              errIdList += "|DATA-05";
              errDescList += "|Request delivery date wasn't derived due to date out of range or unknown format: ${rdd_orig}";
          }
        }

	    def badQuantity = ""
        def badProductCode=""
        def badGtin=""
		log.warn("Before parsing:"+product_lines.toString())
		listOfProducts2 = new JsonSlurper().parseText(product_lines.toString()).product_lines
		log.warn("listOfProducts2:"+ listOfProducts2)
		Set&lt;String&gt; product_code_modes = new HashSet&lt;String&gt;()
        DecimalFormatSymbols symbols = new DecimalFormatSymbols();
        char groupingSep = ',';
        char decimalSep = '.';
        symbols.setGroupingSeparator(groupingSep);
        symbols.setDecimalSeparator(decimalSep);
        String pattern = "#,##0.0#";
        DecimalFormat decimalFormat = new DecimalFormat(pattern, symbols);
        decimalFormat.setParseBigDecimal(true);
        
        listOfProducts2.each{
            if (!it.quantity.last.matches("^\\d+\$")) {
                badQuantity += ", " +(it.quantity.last?:"&lt;i&gt;none&lt;/i&gt;")
            }
            if (it.quantity.last.matches('[\\.,]000\\s*$')) {
                errDescList += "|Decimal zeros found at the end of some quantities";
                errIdList += "|DATA-10"
            }   
            if (!it.product_code1.last.matches("^ ?[0-9.-]+\$")) {
                badProductCode += ", " +(it.product_code1.last?:"&lt;i&gt;none&lt;/i&gt;")
            }
			if (!it.product_code2.last.matches("^ ?[0-9.-]+\$")) {
                badProductCode += ", " +(it.product_code2.last?:"&lt;i&gt;none&lt;/i&gt;")
            }		
            if (!it.gtin.last.matches("^\\d{13}\$")) {
                badGtin += ", " +(it.gtin.last?:"&lt;i&gt;none&lt;/i&gt;")
            }
      	
			if (it.gtin.display_gtin.length() &gt; 1) {
                errDescList += "|Display/BOM detected";
                errIdList += "|DATA-12"
            }
            BigDecimal numericQty =  (BigDecimal) decimalFormat.parse(it.quantity.last);
            BigDecimal thresholdQty = new BigDecimal(cfg_max_qty.toString());
            log.error("QTY check: qty: " + numericQty.toString() + " max allowed: " + thresholdQty.toString())
            if (numericQty.compareTo(thresholdQty)&gt;0) {
                errDescList += "|Quantity of product: " + it.product_code1.last + " exceeded the threshold value of " + thresholdQty;
                errIdList += "|DATA-10"
                   log.error("entered qty if")
            }
            product_code_modes.add(it.product_code1.last.toString().length())
        }
        if(!badQuantity.isEmpty()) {
            errDescList += "|Some GTINs (${badGtin.length()==0?"":badGtin.drop(2)}) are in wrong format"
            errIdList += "|DATA-06"}
        if(!badQuantity.isEmpty()) {
            errDescList += "|Some quantities (${badQuantity.length()==0?"":badQuantity.drop(2)}) are not numbers"
            errIdList += "|DATA-07"}
        if(!badProductCode.isEmpty()) {
            errIdList += "|DATA-08"
            errDescList += "|Some product codes (${badProductCode.length() == 0 ? "":badProductCode.drop(2)}) do not follow the format (numbers with dashes and periods)"}



		/*if (!validate(product_code_mode.toString(), "product_code_mode", [productCodeModeValidator])) {
            errIdList += "|DATA-09";
            errDescList += "|product codes are of unxpeced format (${product_code_mode} characters)";
			gtin_list = gtin_list.toString().replaceAll("[^|]", "");
		}*/

		boolean wrongPCFound = false;
        Set&lt;String&gt; wrong_modes = new HashSet&lt;String&gt;()
        for(String mode: product_code_modes) {
            if (!validate(mode.toString(), "product_code_mode", [productCodeModeValidator])) {
                wrong_modes.add(mode);
                wrongPCFound = true;
            }
        }
        /*if(wrongPCFound) {
            errIdList += "|DATA-09";
            errDescList += "|product codes are of unxpeced format of " + String.join(",", wrong_modes) + " characters)";
        }*/

	
	

	
	]]&gt;&lt;/script&gt;

	&lt;script&gt;&lt;![CDATA[


isValid = "YES";

        if (errIdList != null) {
			if (errIdList.trim().length() &gt; 0) {
				isValid = "NO";

                // do not route to manual task in debug mode
				/*if (debug_mode.toString().equals("YES")) {
					  beyondRepair = "YES";
				}*/
			} else {
				isValid = "YES";
			}
        }

		// avoid endless loops
		if (Long.valueOf("${manual_path_cnt}".toString()) &gt; Long.valueOf("${manual_path_max_cnt}".toString())) {
			beyondRepair = "YES";
		}

		/*
		oldProductCodeListCnt = Integer.valueOf("${product_code_list_cnt}");


		newProductCodeListCnt = listOfProducts2.size()
		if (newProductCodeListCnt != oldProductCodeListCnt) {
            errIdList += "|DATA-11";
            errDescList += "|The number of product lines has changed from original ${oldProductCodeListCnt} to ${newProductCodeListCnt} after human intervention (manual task)";
		}*/

		errIdList = (oldErrIdList + errIdList).replaceAll("^\\|", "");
		errDescList = (oldErrDescList + errDescList).replaceAll("^\\|", "");
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
		&lt;single-column name="manual_path_cnt" value="${manualPathCnt}" /&gt;
		&lt;single-column name="beyond_repair_flag" value="${beyondRepair}" /&gt;
    	&lt;single-column name="error_id_list" value="${errIdList}" /&gt;
    	&lt;single-column name="error_description_list" value="${errDescList}" /&gt;
    	&lt;single-column name="data_validity_flag" value="${isValid}" /&gt;
        &lt;single-column name="sap_attempts_cnt" value="3" /&gt;   
	&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>9e338003-eff2-4cfb-9d7f-2316f4a36408</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[170] validation      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e338003-eff2-4cfb-9d7f-2316f4a36408</uuid>
                                    <version>
                                        <componentUuid>ee925020-5e20-48e2-80b3-dba1ed72c972</componentUuid>
                                        <incrementalVersion>1.4</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-04T01:30:39Z</lastModified>
                                        <versionUuid>a3bf4891-3223-4c6f-95cb-1614bc129c5e</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[170] validation      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>74501339-b44c-409b-8fb9-ad8954ed0b9b</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>07f20f99-7f1e-4f47-9362-1cfab65e3d63</componentUuid>
                                    <incrementalVersion>1.3</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-04T01:30:41Z</lastModified>
                                    <versionUuid>1f32f348-9ab2-47b3-bde8-d1328c829bf1</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>10</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>06b49056-7b3d-45e9-86af-0f355cc660e5</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>3c4a5b00-1007-4903-9820-02c2f0d5326d</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
   &lt;!--
      changelog:
         3.1.6 RDD asap added
   --&gt;
	&lt;script&gt;&lt;![CDATA[
import groovy.json.JsonBuilder
import groovy.json.JsonOutput
import groovy.json.JsonSlurper

        def rddOrig = "${rdd_orig}".toString();
		
		rddOrig = rddOrig.replace("-",".");

 		/*jar_URLs  = [cfg_nexus_uri.toString() + "/content/repositories/releases/com/dxc/pg/rpa/dach/AnyDateParser/4.0/AnyDateParser-4.0.jar"]
                .collect{
                   p -&gt; new URL("jar:" + new URL(p) + "!/")
                };
*/

 		jar_URLs  = ["AnyDateParser-4.0.jar"]
                .collect{
                   p -&gt; (new File("/tmp/dach/" + p)).toURI().toURL()	
                };

      jar_URLs.each{
         p -&gt; println p.getPath()
         this.getClass().classLoader.addURL(p)
      }

        def adp = Class.forName("com.dxc.pg.rpa.anyDateParser.AnyDateParser").newInstance()
			
		
		adp.setDaysInFuture(Integer.parseInt(cfg_rdd_days_after_range.toString()));	
		adp.setDaysInHistory(Integer.parseInt(cfg_rdd_days_before_range.toString()));
	
		
		// remove default -30 -- +120 days threshold
		if (debug_mode.toString().equals("YES")) {
			adp.setDaysInFuture(1000);
			adp.setDaysInHistory(1000);
		}

		
		
		  List&lt;String&gt; patterns = ["D*M*Y", "Y*M*D"]
     

		variables2 =  new JsonSlurper().parseText(variables.toString())



		String res;
		if (variables2.rdd_orig.value.matches("(?i)^.*asap.*\$")) {
			res = "ASAP";
		} else {
 			res = adp.parseToString(variables2.rdd_orig.value, "dd.MM.YYYY", patterns, false);
		}

        variables2.rdd_orig.value= res
        variables2.rdd_orig.history &lt;&lt; [modifiedBy:"[160] RDD format fix",
                                               version: variables2.rdd_orig.history.version.max() + 1,
                                               value: variables2.rdd_orig.value,
                                               modifiedDate: new Date()]
        variablesJson =    JsonOutput.toJson(variables2)
		

		log.warn("translated rdd '${variables2}' ");


	]]&gt;&lt;/script&gt;

    &lt;export include-original-data="true"&gt;
      &lt;single-column name="variables" value="${variablesJson}"/&gt; 
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>db2096b9-8433-450a-ab49-d1e287303964</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[160] RDD format fix      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>db2096b9-8433-450a-ab49-d1e287303964</uuid>
                                    <version>
                                        <componentUuid>0b994804-48e3-4b7a-bc6b-ce57488cd1bc</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-03T11:38:47Z</lastModified>
                                        <versionUuid>e8b6e18f-0ef0-4aca-9adf-d93c3700d5d0</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[160] RDD format fix      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>9b92ad53-00d4-4e92-979b-7c367c2d2b7c</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>e64552f1-7a09-4969-b9ec-a1fe8cc0bfc1</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-03T11:38:48Z</lastModified>
                                    <versionUuid>d38eaf96-e8ed-4870-8e67-4039493dc17a</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>11</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>177e305b-bb16-497b-8d46-c5d6b6db885b</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"No","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"error_fixable_id_list","operator":"IS_EMPTY"}],"customConditions":[]}
rule "1. Send records to 'No' when error_fixable_id_list IS_EMPTY ''"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("error_fixable_id_list", "IS_EMPTY", ""));

    then
        $ctx.sendResultTo("No", $item);
end

# RuleOutcome.Definition={"outcomeId":"Yes","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"error_fixable_id_list","operator":"IS_NOT_EMPTY"}],"customConditions":[]}
rule "2. Send records to 'Yes' when error_fixable_id_list IS_NOT_EMPTY ''"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("error_fixable_id_list", "IS_NOT_EMPTY", ""));

    then
        $ctx.sendResultTo("Yes", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>Has fixable errors?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>b283dd45-06c4-41ec-a633-575115621c30</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
   &lt;!--
      changelog:
         3.1.6 RDD asap added
		3.2 BRD-38, 60
		SAVED?
   --&gt;
  
  &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name", "${sap_credentials_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName = secure_store_name.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName);
      username = obj.getKey().toString();
      password = obj.getValue().toString();
      //log.error("user: " + username);
      //log.error("pass: " + password);
   ]]&gt;&lt;/script&gt;

  &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name2", "${s3_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name2}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName2 = secure_store_name2.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName2);
      accessKey = obj.getKey().toString();
      secretKey = obj.getValue().toString();
   ]]&gt;&lt;/script&gt;
  
    &lt;var-def name="login"&gt;
        &lt;script return="temp_login"&gt;&lt;![CDATA[
			temp_login = "$username";
		]]&gt;&lt;/script&gt;
    &lt;/var-def&gt;

    &lt;var-def name="password"&gt;
        &lt;script return="temp_password"&gt;&lt;![CDATA[
			temp_password = "$password";
		]]&gt;&lt;/script&gt;
    &lt;/var-def&gt;
  
    &lt;var-def name="homeDirectory"&gt;
        &lt;script return="tempDir"&gt;&lt;![CDATA[
    		property = "java.io.tmpdir";
    		tempDir = System.getProperty(property);
    	]]&gt;&lt;/script&gt;
    &lt;/var-def&gt;
  
	&lt;var-def name="case_id"&gt;
        &lt;template&gt;VA01&lt;/template&gt;
    &lt;/var-def&gt;

    &lt;var-def name="order_type"&gt;
        &lt;template&gt;Z001&lt;/template&gt;
    &lt;/var-def&gt;

    &lt;var-def name="division"&gt;
        &lt;template&gt;01&lt;/template&gt;
    &lt;/var-def&gt;
  
	&lt;selenium-flow&gt;
		&lt;selenium name="seleniumDriver" browser="autoit" close-on-completion="true"&gt;
			&lt;script&gt;
				&lt;![CDATA[
					import com.thoughtworks.selenium.*;
					import com.thoughtworks.selenium.webdriven.WebDriverBackedSelenium;
					import org.openqa.selenium.*;
					import org.openqa.selenium.remote.RemoteWebDriver;
					import org.openqa.selenium.interactions.Actions;
					import com.workfusion.utils.client.AmazonUtils;
					import com.amazonaws.auth.BasicAWSCredentials;
					import com.amazonaws.services.s3.model.CannedAccessControlList;
					import com.amazonaws.services.s3.model.PutObjectRequest; 
					import java.util.concurrent.TimeUnit;
					import javax.imageio.ImageIO
					import java.awt.Color
					import java.awt.image.BufferedImage
					import groovy.json.JsonSlurper;
					import java.text.SimpleDateFormat;
					
					class Size{
				        int height;
				        int width;
				        Size(int width, int height) {
				            this.height = height
				            this.width = width
				        }
				        int getHeight() {
				            return height
				        }
				        int getWidth() {
				            return width
				        }
				        boolean equals(o) {
				            if (this.is(o)) return true
				            if (getClass() != o.class) return false
				
				            Size size = (Size) o
				
				            if (height != size.height) return false
				            if (width != size.width) return false
				
				            return true
				        }
				
				        int hashCode() {
				            int result
				            result = height
				            result = 31 * result + width
				            return result
				        }
				    }
				
				    boolean checkIfImageIsExpanded(BufferedImage image){
				        int height = image.getHeight();
				        int width = image.getWidth();
				        int intervalHorizontal = width/10;
				        int intervalVertical = height/10;
				        int stepHorizontal = 5;
				        int stepVertical = 5;
				        int horizontalLimit = width * 0.8;
				        int verticalLimit = height * 0.8;
				        int blackRGB = Color.BLACK.getRGB();
				
				        for(int currentPixY = height-1; currentPixY &gt; 0 ; currentPixY-=intervalVertical) {
				            for (int currentPixX = width-1; currentPixX &gt; horizontalLimit; currentPixX -= stepHorizontal) {
				                if (image.getRGB(currentPixX, currentPixY) != blackRGB){
				                    return false;
				                }
				            }
				        }
				
				        for (int currentPixX = width -1 ; currentPixX &gt; 0; currentPixX -= intervalHorizontal) {
				            for(int currentPixY = height - 1; currentPixY &gt; verticalLimit ; currentPixY-=stepVertical) {
				                if (image.getRGB(currentPixX, currentPixY) != blackRGB){
				                    return false;
				                }
				            }
				        }
				
				        return true;
				
				    }
				
				     void adjustImageToCorrectResolution(String imgPath){
				         ArrayList&lt;Size&gt; allowedSizes = Arrays.asList(new Size(1920, 1080), new Size(1600, 900),
				                 new Size(1366, 768), new Size(1280, 1024),
				                 new Size(1280, 720), new Size(1024, 768), new Size(800, 600))
				
				         try {
				             File f = new File(imgPath);
				             BufferedImage image = ImageIO.read(f);
				             for(Size size: allowedSizes){
								if ((image.getWidth() &gt;= size.width) &amp;&amp; (image.getHeight() &gt;= size.height)){
					                 BufferedImage correctedImage = image.getSubimage(0, 0, size.width, size.height);
					                 if(!checkIfImageIsExpanded(correctedImage)) {
					                     ImageIO.write(correctedImage, "jpg", new File(imgPath));
					                     break;
					                 }
								}
				             }
 				         }catch (IOException e){
				             e.printStackTrace()
				         }			
				    }

					//rdd "ASAP"
					 rdd = rdd.toString().toUpperCase()
					variablesJson =  new JsonSlurper().parseText(variables.toString())
					sales_area_id = variablesJson.sales_area_id.value
					distribution_channel_id = variablesJson.distribution_channel_id.value
					ship_to_id = variablesJson.ship_to_id.value
               /* rdd = variablesJson.rdd_orig.value
               if (rdd.equals("ASAP")) {                  
                  rdd = new SimpleDateFormat("dd.MM.YYYY").format(new Date());
               } */

					s3FileURLs = "";
					regexFilePattern = "[^a-zA-Z0-9_]";
					jpgFileName = "${uuid}-${mail_id}".replaceAll(regexFilePattern, "_") + ".jpg";
					
					driver = seleniumDriver.getWrappedObject();
					driver.manage().timeouts().setScriptTimeout(3 * 60, TimeUnit.SECONDS);
				
					//set win_tmp folder and ensure it has "\" at the end
					String win_tmp = driver.executeScript(" return System.getenv(\"TMP\"); ", "GROOVY").toString();
					if(win_tmp.charAt(win_tmp.length() - 1) != "\\"){ //File.separatorChar
						win_tmp += "\\"; //File.separator
					}
					path_win = win_tmp + jpgFileName;

					log.warn("WIN file path=" + path_win);


					
					def product_information_orginal = new JsonSlurper().parseText("${product_lines}".toString()).product_lines
					
					gtinsListSize = product_information_orginal.size()
					quantitiesListSize = gtinsListSize
					gtinsRawListSize = gtinsListSize
					productCode2ListSize = gtinsListSize
					netTotalPrice = net_total_price.toString();

					gtinsUglyList = "["
					quantitiesUglyList = "["
					gtinsRawUglyList = "["
					productCode2UglyList = "["
					product_information_orginal.each
						{
							gtinsUglyList += "\"" +it.gtin.last +"\", "
							quantitiesUglyList +=  "\"" + it.quantity.last +"\", "
							gtinsRawUglyList +=  "\"" +it.product_code1.last +"\", "
							productCode2UglyList +=  "\"" +it.product_code2.last +"\", "

						}
					gtinsUglyList = gtinsUglyList[0..-3] + "]"
					quantitiesUglyList = quantitiesUglyList[0..-3]+ "]"
					gtinsRawUglyList = gtinsRawUglyList[0..-3]+"]"
					productCode2UglyList = productCode2UglyList[0..-3]+"]"

	
					log.warn("\r\n XXX -&gt;start seleniumn flow\r\n"); // + gtinsListSize + " " + quantitiesListSize + " " + gtinsRawListSize + "\r\n");

					path_screen_shot = "";
					pid = java.util.UUID.randomUUID().toString();
					log.warn("\r\n PID -&gt; " + pid.toString())

					try{
					//FROM AUTOIT After a lot of comment lines with ;;;;;;;;;;;; copy from there to bottom the replace "\" with "\\" and then "$" with "\$"
					//To Autoit change "\\" to "\" and "\$" to "$"
					String scriptText = """
						#include &lt;File.au3&gt;
						#include &lt;Date.au3&gt;
						#include &lt;ScreenCapture.au3&gt;

						#Region Init
						
						;Escape left side dolars with backslash. Right side dolars should NOT be escaped with backslash
						Local \$lPathWin = "${path_win}" ;"c:\\temp\\xyz.jpg"
						Local \$lSapPath = "${cfg_sap_gui_exec_filename}" ;"C:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\\saplogon.exe"
						Local \$lConnectionName = "${cfg_sap_connection_name}" ;"F6A EU SC Acc"
						Local \$lLogin = "${login}"
						Local \$lPassword = "${password}"
						
						Local \$lOrderType = "${order_type}" ;Order Type
						Local \$lSalesAreaId = "${sales_area_id}"	;Sales Organization
						Local \$lDistributionChannelId = "${distribution_channel_id}"	;Distribution Channel
						Local \$lDivision = "${division}"	;Division
						
						Local \$lSoldToId = "${sold_to}" ;If not Empty means it returned from SoldToMT
						Local \$lShipToId = "${ship_to_id}"
						Local \$lPoNumber = "${po_number}"
						Local \$lPoDate = "${po_date}"
						Local \$lRdd = "${rdd}"
						Local \$lRdt = "${rdd_time}"
						Local \$lNetTotalPrice = "${netTotalPrice}"
						
						Local \$lGtinsListSize = ${gtinsListSize}
						Local \$lGtinsUglyList = ${gtinsUglyList}
						Local \$lQuantitiesListSize = ${quantitiesListSize}
						Local \$lQuantitiesUglyList = ${quantitiesUglyList}
						Local \$lGtinsRawListSize = ${gtinsRawListSize}
						Local \$lGtinsRawUglyList = ${gtinsRawUglyList}
						Local \$lProductCode2ListSize = ${productCode2ListSize}
						Local \$lProductCode2UglyList  = ${productCode2UglyList}
						
						Local \$lWinTmp = "${win_tmp}" ;path with trail "\\" like "c:\\temp\\"
						Local \$lPid = "${pid}" ; "XYz"
						#Endregion

						;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
						;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
						;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
						;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Global \$sapCon
Global \$sapSession
Global \$error_ids
Global \$error_msgs
Global \$screenShots
Global \$error_data


Global \$new_rdd
Global \$flag = "false"
Global \$varASAP = "ASAP"
Global \$varasap = "asap"
Global \$newRdd

#Region almost like Try catch
Global \$oMyError = ObjEvent("AutoIt.Error", "MyErrFunc")

Func MyErrFunc()

   ;Local \$HexNumber
   Local \$strMsg

   ;\$HexNumber = Hex(\$oMyError.Number, 8)
   ;\$strMsg = "Error Number: " &amp; \$HexNumber ;&amp; @CRLF
   ;\$strMsg = " WinDescription: " &amp; StringReplace(StringStripCR(\$oMyError.WinDescription), @LF, "")
   \$strMsg = " Script Line: " &amp; StringStripCR(\$oMyError.ScriptLine)
   \$strMsg &amp;= " Description: " &amp; StringReplace(StringStripCR(\$oMyError.Description), @LF, "")

   ;MsgBox(0, "ERROR", \$strMsg)
   ConsoleWrite("ERROR '" &amp; \$strMsg &amp; "'" &amp; @CRLF)
   ReportError("0", \$strMsg)
   WriteFileError()

   CloseSAP()

   SetError(1)
   Exit 1
EndFunc

Func MyNopErrFunc()

   Local \$strMsg = " Script Line: " &amp; StringStripCR(\$oMyError.ScriptLine)
   \$strMsg &amp;= " Description: " &amp; StringReplace(StringStripCR(\$oMyError.Description), @LF, "")

   ConsoleWrite("NOP ERROR ='" &amp; \$strMsg &amp; "'" &amp; @CRLF)

   SetError(333)
EndFunc
#EndRegion

#Region Some ScreenShot init
#AutoIt3Wrapper_Res_HiDpi=Y

If Not (@Compiled ) Then DllCall("User32.dll","bool","SetProcessDPIAware")

Func TakeScreenshot(\$error_code)
   Sleep(1000)
   \$FileName = \$lPathWin
   \$ind = 0
   Local \$aStrs = StringSplit(\$FileName, ".")
   \$ext = ""
   If \$aStrs[0] &gt; 0 Then
          \$ext = \$aStrs[\$aStrs[0]]
   EndIf
   \$filePathPartWithoutExt = StringLeft(\$FileName, StringLen(\$FileName) - StringLen(\$ext) - 1)
   ConsoleWrite("Ext. of file '" &amp; \$FileName &amp; "'  is '" &amp; \$ext &amp; "'" &amp; @CRLF)
   \$FileName = \$filePathPartWithoutExt &amp; "_" &amp; \$ind &amp; "_" &amp; \$error_code &amp; "." &amp; \$ext

   While FileExists(\$FileName)
          \$ind = \$ind + 1
          \$FileName = \$filePathPartWithoutExt &amp; "_" &amp; \$ind &amp; "_" &amp; \$error_code &amp; "." &amp; \$ext
          ConsoleWrite("--check if file '" &amp; \$FileName &amp; "'" &amp; @CRLF)
   Wend
   ConsoleWrite("Saving scrrenshot as '" &amp; \$FileName &amp; "'...")
   _ScreenCapture_Capture(\$FileName)
   If @error Then
          ConsoleWrite(@CRLF &amp; "-=&lt;X ERROR SAVING FILE X&gt;=-" &amp; @error &amp; @CRLF)
   Else
          ConsoleWrite("Saved scrrenshot." &amp; @CRLF)
   EndIf

   If \$screenShots == "Null" Then
\$screenShots = \$FileName
EndIf

If StringInStr(\$screenShots,\$error_code) Then

Else
   \$screenShots = \$screenShots &amp; "|" &amp; \$FileName
EndIf
   Sleep(2000)

EndFunc
#EndRegion

RunProcess()

Func RunProcess()
   If RunSap() == 0 Then
	  FillTransactionData()

	  FillOrderData()

	  FillData()


	  If \$flag == "true" Then
		 FillData()
	  EndIf
CloseSAP()
   EndIf
EndFunc

Func RunSap()
   #Region Start SAP
   run(\$lSapPath)

   Local \$hWnd = WinWait("[CLASS:#32770]", "", 10)
   ;Sleep(4000);instead of
   Local \$res, \$c
   Do
	  Sleep(1000)
	  ;\$res = ControlGetHandle(\$hWnd, "", "[ID:1091]")
	  \$res = ControlCommand(\$hWnd, "", "[ID:1091]", "IsVisible", "")
	  \$c += 1
	  If \$c = 10 then
		 \$c = 0
		 exitloop
	  EndIf

   Until \$res = 1 ;@error == 0 ;&lt;&gt; 1

   Sleep(1000)

   \$sapGui = ObjGet("SAPGUI")
   \$sapApp = \$sapGui.GetScriptingEngine
   \$sapCon = \$sapApp.openConnection(\$lConnectionName)

   \$hWndSAP = WinWait("SAP", "", 10)

   If \$hWndSAP = 0 Then
	 ReportError("0", "Error connecting to SAP")
		  WriteFileError()
		  Return -1
   EndIf

   \$sapSession = \$sapCon.Children(0)
   #EndRegion

   #Region Log In

   \$sapSession = \$sapCon.Children(0)

   SAPObjValueSet(0, "usr/txtRSYST-BNAME", \$lLogin)
   Sleep(100)
   SAPObjValueSet(0, "usr/pwdRSYST-BCODE", \$lPassword)
   Sleep(100)
   SAPSendEnter(0)
   #EndRegion

   \$val = SAPErrGet("sbar")
   ConsoleWrite("-SAP-0:'" &amp; \$val &amp; "'" &amp; @CRLF)
   If \$val = "Password logon no longer possible - too many failed attempts" Then
	  ReportError("0", \$val)
	  WriteFileError()
	  Return 1
   ElseIf \$val = "Fill in all required entry fields" Then
	  ReportError("0", \$val)
	  WriteFileError()
	  Return 2
   ElseIf \$val &lt;&gt; "" Then ;Unknown error. Try to bypass it
	  ReportError("0", \$val)
	  SAPSendEnter(0)
   EndIf

   #Region Already logged In
   ;sometimes info window apears that user is already logged in.
   If \$sapSession.ActiveWindow.Name = "wnd[1]" Then
	  \$text = \$sapSession.ActiveWindow.Text
	  if (\$text = "System Messages") or (\$text = "Information") or (\$text = "Copyright")Then
		 SAPSendEnter(0)
		 Sleep(250)
	  Else
		 \$sapSession.findById("wnd[1]/usr/radMULTI_LOGON_OPT2").select
		 \$sapSession.findById("wnd[1]/usr/radMULTI_LOGON_OPT2").setFocus
		 \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
		 Sleep(250)
	  EndIF
   EndIf
   #Endregion

   Return 0
EndFunc


Func FillTransactionData()
   SAPObjValueSet(0, "tbar[0]/okcd", "VA01")
   SAPSendEnter(0)
  
EndFunc

Func FillOrderData()
   SAPObjValueSet(0, "usr/ctxtVBAK-AUART", \$lOrderType)    ;Order Type
   SAPObjValueSet(0, "usr/ctxtVBAK-VKORG", \$lSalesAreaId) ;Sales Organization
   SAPObjValueSet(0, "usr/ctxtVBAK-VTWEG", \$lDistributionChannelId)        ;Distribution Channel
   SAPObjValueSet(0, "usr/ctxtVBAK-SPART", \$lDivision)     ;Division
   SAPObjValueSet(0, "usr/ctxtVBAK-VKBUR", "")     ;Sales Office
   SAPObjValueSet(0, "usr/ctxtVBAK-VKGRP", "")     ;Sales Group
   SAPSendEnter(0)

   ;N1
   \$val = SAPErrGet("sbar")
   If ((\$val = "For sales org. " &amp; \$lSalesAreaId &amp; " distribution channel " &amp; \$lDistributionChannelId &amp; " is not allowed") Or (\$val = "Sales area " &amp; \$lSalesAreaId &amp; " " &amp; \$lDistributionChannelId &amp; " " &amp; \$lDivision &amp;" does not exist")) Then
	  ReportError("1", \$val)
	  WriteFileError()
	  Return
   EndIf

EndFunc


Func FillData()
   #Region Put data
   ;Initial screen
   

   ;-&gt;Overview
   ;SOLD To
   If (\$lSoldToId &lt;&gt; "") Then
	  ;TODO:SET SOLD TO
	  \$sapSession.findById("wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/subPART-SUB:SAPMV45A:4701/ctxtKUAGV-KUNNR").text = \$lSoldToId ;Sold-To Party
	  SAPSendEnter(0)
	  ;Sleep(1000)

	  If SAPWinExists("Sales area for customer") Then ;//

		 ;SET temporarly "NEW error handler
		 Global \$sMyErrorSav = ObjEvent("AutoIt.Error") ; Save the old handler
		 Global \$oMyError = ObjEvent("AutoIt.Error", "MyNopErrFunc") ;Ignore error

		 Local \$ind = 0
		 Local \$cont = 1
		 While 1 ;\$cont = 1
			\$currInd = 3 + \$ind
			\$ctrlName = "wnd[1]/usr/lbl[1," &amp; \$currInd &amp; "]"
			ConsoleWrite("-=check: " &amp; \$ctrlName &amp; @CRLF)
			\$Lsorg = StringStripWS(StringReplace(StringStripCR(\$sapSession.findById(\$ctrlName).text), @LF, ""), \$STR_STRIPALL)
			If @error Then ExitLoop

			ConsoleWrite(" is'" &amp; \$Lsorg &amp; "'" &amp; @CRLF)
			If \$lSalesAreaId = \$Lsorg Then
			   \$sapSession.findById(\$ctrlName).setFocus
			   \$sapSession.findById(\$ctrlName).caretPosition = 1
			   ExitLoop
			EndIf

			\$ind = \$ind + 1
		 WEnd
		 \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
		 Sleep(1000)

		 Global \$oMyError = ObjEvent("AutoIt.Error", \$sMyErrorSav)
		 ;error handler set to 'default one'

		 If SAPWinExists("Information") Then
			\$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
			Sleep(250)
		 EndIf
		EndIf
		 If SAPWinExists("Partner selection") Then
			;SET temporarly "NEW error handler
			\$sMyErrorSav = ObjEvent("AutoIt.Error") ; Save the old handler
			\$oMyError = ObjEvent("AutoIt.Error", "MyNopErrFunc") ;Ignore error
			;...[4,5 + i]=gtin [15,5 + i]=name
			Local \$ind = 0
			Local \$cont = 1
			While 1 ;\$cont = 1
			   \$currInd = 5 + \$ind
			   \$ctrlName = "wnd[1]/usr/lbl[4," &amp; \$currInd &amp; "]"
			   ConsoleWrite("-=Look into: " &amp; \$ctrlName &amp; @CRLF)
			   \$Lshipto = \$sapSession.findById(\$ctrlName).text
			   If @error Then ExitLoop

			   ConsoleWrite(" s='" &amp; \$Lshipto &amp; "'" &amp; @CRLF)
			   If \$Lshipto = \$lShipToId Then
				  \$sapSession.findById(\$ctrlName).setFocus
				  \$sapSession.findById(\$ctrlName).caretPosition = 5
				  ExitLoop
			   EndIf
			   \$ind = \$ind + 1
			WEnd
			Global \$oMyError = ObjEvent("AutoIt.Error", \$sMyErrorSav)
			;error handler set to 'default one'

			SAPSendEnter(1)
		 EndIf
	  

	  ;....Check for blocking error
	  \$val = SAPErrGet("sbar")
	  If \$val = "No pricing procedure could be determined" Then
		 ReportError("2", \$val)
		 WriteFileError()
		 Return
	  EndIf
   Else
	  ;Ship To
	  \$sapSession.findById("wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/subPART-SUB:SAPMV45A:4701/ctxtKUWEV-KUNNR").text = \$lShipToId ;Ship-To Party
	  SAPSendEnter(0)
	  ;Sleep(1000)
   EndIF

   ;If \$sapSession.ActiveWindow.Name = "wnd[1]" Then
   If SAPWinExists("Information") Then
	   \$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
	   \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
	   Sleep(1000)
   EndIf

   ;N2
   If SAPWinExists("Partner selection") Then

	  ;SET temporarly "NEW error handler
	  Global \$sMyErrorSav = ObjEvent("AutoIt.Error") ; Save the old handler
	  Global \$oMyError = ObjEvent("AutoIt.Error", "MyNopErrFunc") ;Ignore error
	  ;...[4,5 + i]=gtin [15,5 + i]=name
	  Local \$ind = 0
	  Local \$cont = 1
	  While 1 ;\$cont = 1
		 \$currInd = 5 + \$ind
		 ConsoleWrite("-=Try with: wnd[1]/usr/lbl[4," &amp; \$currInd &amp; "]" &amp; @CRLF)
		 \$Lshipto = \$sapSession.findById("wnd[1]/usr/lbl[4," &amp; \$currInd &amp; "]").text
		 If @error Then ExitLoop
		 \$LName = \$sapSession.findById("wnd[1]/usr/lbl[15," &amp; \$currInd &amp; "]").text
		 If @error Then ExitLoop

		 ConsoleWrite(" L '" &amp; \$Lshipto &amp; "' '" &amp; \$LName &amp; "'" &amp; @CRLF)
		 \$error_data = \$error_data &amp; \$Lshipto &amp; ";" &amp; \$LName &amp; "|"
		 \$ind = \$ind + 1
	  WEnd
	  Global \$oMyError = ObjEvent("AutoIt.Error", \$sMyErrorSav)
	  ;error handler set to 'default one'

	  SAPSendEnter(1)

	  ReportError("2", "Customer ship to number which is linked to multiple sold to number")
	  WriteFileError()
	  Return
   EndIf

   If \$sapSession.ActiveWindow.Name = "wnd[1]" Then
	  If (\$sapSession.ActiveWindow.text = "Sales Note (pop-up)") Then
			\$sText = \$sapSession.findById("wnd[1]/usr/cntlZ_TEXT_EDIT_CONTROL/shellcont/shell").text
			ReportError("18", \$sText)
	  EndIf
	  ConsoleWrite("-V1-'" &amp; \$sapSession.ActiveWindow.text &amp; "'" &amp; @CRLF);
	  ;\$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
	  \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
	  SAPSendEnter(0)
	  Sleep(500)
   EndIf

   ;N3, N4,
   \$val = SAPErrGet("sbar")
   If (\$val &lt;&gt; "") Then
	   If (\$val = "Customer " &amp; \$lShipToId &amp; " has been assigned order block:") Then
			ReportError("3", \$val)
			WriteFileError()
			Return
		ElseIf (\$val = "Ship-to party " &amp; \$lShipToId &amp; " is not assigned to a sold-to party") Then
			ReportError("4", \$val)
			WriteFileError()
			Return
		ElseIf (\$val = "Customer " &amp; \$lShipToId &amp; " has delivery block: CustServ Action Req.") Then
			ReportError("13", \$val)
			WriteFileError()
			Return
	   EndIf
   EndIf

   ;Enter Request Delivery Date* (RDD) in the proper format (DD.MM.YYYY)
   ;\$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/ssubHEADER_FRAME:SAPMV45A:4440/ctxtRV45A-KETDAT").text = \$lRdd
   ;SAPSendEnter(0)
   
   
   if \$varASAP == \$lRdd or \$varasap == \$lRdd Then
   	Local \$day=_DateToDayValue(@YEAR,@MON,@MDAY),\$Y, \$M, \$D ; calculating current date
			Local \$today=_DayValueToDate(\$day +1, \$Y, \$M, \$D)
			\$new_rdd= StringFormat("%02i.%02i.%04i", \$D,  \$M,  \$Y)
			\$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/ssubHEADER_FRAME:SAPMV45A:4440/ctxtRV45A-KETDAT").text = \$new_rdd
   ElseIf(StringRegExp(\$lRdd,("\\d{2}\\.\\d{2}\\.\\d{4}\$"))==1) Then
			\$newRdd = \$lRdd
			\$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/ssubHEADER_FRAME:SAPMV45A:4440/ctxtRV45A-KETDAT").text = \$new_rdd
		EndIf
   
   if(\$newRdd &lt;&gt; "") Then
   \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/ssubHEADER_FRAME:SAPMV45A:4440/ctxtRV45A-KETDAT").text = \$newRdd
   
	  EndIf
   

   \$val = SAPErrGet("sbar")
   \$feasStr = "You entered an unfeasible dlv dt. Earliest feasible dlv dt for order is ";
   \$nextPossibleStr = "The next possible date is: ";
   ConsoleWrite("-A-'" &amp; \$val &amp; "'" &amp; @CRLF);

   If ((StringStartsWith(\$val, "You entered an unfeasible dlv dt. Earliest feasible dlv dt for order is ") = 1) Or (\$val = "Date is in the past: Please check")) Then
	  ReportError("7", \$val)
	  SAPSendEnter(0)
   EndIf

  \$val = SAPErrGet("sbar")
	ConsoleWrite("-A1-'" &amp; \$val &amp; "'" &amp; @CRLF);
   ;"No goods accepted on 28.01.2018. The next possible date is: 29.01.2018"
   if (StringRegExp(\$val, "^No goods accepted on \\d{2}\\.\\d{2}\\.\\d{4}\\. The next possible date is: \\d{2}\\.\\d{2}\\.\\d{4}\$") == 1) Then
	  ReportError("14", \$val)
	  SAPSendEnter(0)

	  \$pos = StringInStr(\$val, \$nextPossibleStr)
	  \$newRdd = StringRight(\$val, StringLen(\$val) - StringLen(\$nextPossibleStr) - \$pos + 1)
	  ConsoleWrite("-X0-0-:'" &amp; \$newRdd &amp; "'" &amp; @CRLF);
	  If \$sapSession.ActiveWindow.Name = "wnd[1]" Then
	   \$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
	   ;\$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
	   ConsoleWrite("--X0-1-:'" &amp; \$sText &amp; "'" &amp; @CRLF);
	   SAPSendEnter(0)
	   Sleep(500)
	  EndIf
	  \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/ssubHEADER_FRAME:SAPMV45A:4440/ctxtRV45A-KETDAT").text = \$newRdd
	  SAPSendEnter(0)
	  SAPSendEnter(0)
   ElseIf (StringRegExp(\$val, "^Date \\d{2}\\.\\d{2}\\.\\d{4} is after the end of factory calendar DQ") == 1) Then
	  ReportError("7", \$val)
	  WriteFileError()
	  Return
   Else
	  ConsoleWrite("-A2-'" &amp; \$val &amp; "'" &amp; @CRLF);
   EndIf
   If \$sapSession.ActiveWindow.Name = "wnd[1]" Then
	  \$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
	  ;\$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
	  If (StringStartsWith(\$sText, "Change in invoice date: The billing date is") == 1) Then
		 ReportError("20", \$sText)
	  EndIf
	  ConsoleWrite("-Y-'" &amp; \$sText &amp; "'" &amp; @CRLF);
	  SAPSendEnter(0)
	  Sleep(500)
   EndIf

   ;enter "PO Number"
   \$sapSession.findById("wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/txtVBKD-BSTKD").text = \$lPoNumber

   ;ENTER today? date into ?O date?field in the DD.MM.YYYY format  '"02.12.2017"
   \$sapSession.findById("wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/ctxtVBKD-BSTDK").text = \$lPoDate ;_NowDate()

Local \$lGtinsList[\$lGtinsListSize] = \$lGtinsUglyList
   Local \$lQuantitiesList[\$lQuantitiesListSize] = \$lQuantitiesUglyList
   Local \$lGtinsRawList[\$lGtinsRawListSize] = \$lGtinsRawUglyList
   Local \$lProductCode2List[\$lProductCode2ListSize] = \$lProductCode2UglyList
 
   ;ConsoleWrite("-&gt;&lt;=" &amp; \$sapSession.ActiveWindow.Name &amp; @CRLF)
 
   ;ENTER the "Material" (GTIN number)* and "quantity"
   \$table = \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG")
   \$visibleRows = \$table.RowCount
   \$activeHwnd = \$sapSession.ActiveWindow.Handle
   ConsoleWrite("----visibleRows=" &amp; \$visibleRows &amp; " activeHwnd=" &amp; \$activeHwnd &amp; " ActiveWindow.Name='" &amp; \$sapSession.ActiveWindow.Name &amp; "'" &amp; @CRLF)
 
   \$rowIndex = 0
   For \$i = 0 To (UBound(\$lGtinsList) - 1)
      \$rowIndex = GetSAPTableLength("X")
      ConsoleWrite("-&gt;i:" &amp; \$i &amp; " '" &amp; \$lGtinsList[\$i] &amp; "' L=" &amp; \$rowIndex  &amp; @CRLF)
 
      Local \$localGtin = \$lGtinsList[\$i]
    \$localGtin = StringStripWS(StringReplace(StringStripCR(\$localGtin), @LF, ""), \$STR_STRIPALL)
    If \$localGtin = "n/a" or \$localGtin = ""  then
       \$localGtin = \$lGtinsRawList[\$i]
    EndIf
          $sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/ctxtRV45A-MABNR[1," &amp; \$rowIndex &amp; "]").text = StringStripWS(\$localGtin, \$STR_STRIPALL)
    )
 
      \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/txtRV45A-KWMENG[2," &amp; \$rowIndex &amp; "]").text = StringStripWS(\$lQuantitiesList[\$i], \$STR_STRIPALL)
 
      ;Special Case: ALDI ?provide also 4 digit material number from ALDI order into Customer Material Number column
      ;       *Karcher ?provide also 11 digit
      If (\$i &lt; \$lGtinsRawListSize) Then
            ;If ((StringLen(\$lGtinsRawList[\$i]) = 4) or (StringLen(\$lGtinsRawList[\$i]) = 11)) Then
                    \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/ctxtVBAP-KDMAT[7," &amp; \$rowIndex &amp; "]").text = StringStripWS(\$lGtinsRawList[\$i], \$STR_STRIPALL) &amp; StringStripWS(\$lProductCode2List[\$i], \$STR_STRIPALL)
            ;EndIf
      EndIf

	  SAPSendEnter(0)
	  Sleep(500)
	  ; then errorsssssss here -&gt;
	  #Region grid errorsssssss here
	  While  \$sapSession.ActiveWindow.Name = "wnd[1]" 
		 \$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
		 \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press

		 If (StringRegExp(\$sText, "Material (\\d+) is marked for deletion") = 1) Then
			ReportError("16", \$sText)
			WriteFileError()
			Return
		 ElseIf (StringStartsWith(\$sText, "New pricing carried out") == 1) Then
			ReportError("19", \$sText)
		ElseIf (StringRegExp(\$sText, "Material (\\d+) has status: Remnant") = 1) Then
			   ReportError("15", \$sText)
			   If \$sapSession.ActiveWindow.Name = "wnd[1]" Then
				  SAPSendEnter(1)
			   EndIf
		 Else
			ReportError("99", \$sText) ;unknown
			SAPSendEnter(0)
		 EndIf
	  WEnd

	  \$val = SAPErrGet("sbar")

	  ;"Duplicate PO for SP 2002549795 and SH 2002549795"
	  If (StringRegExp(\$val, "Duplicate PO for SP (\\d+) and SH (\\d+)") = 1) Then
			ReportError("6", \$val)
			SAPSendEnter(0)
	  ElseIf (StringRegExp(\$val, "Material (\\d+) is not defined for sales org.*") = 1) Then
		 ReportError("8", \$val)
		 WriteFileError()
		 Return
	  ;Material 81515921 has status: Remnant
	  ElseIf (StringRegExp(\$val, "Material (\\d+) has status: Remnant") = 1) Then
		 ReportError("15", \$val)
		 SAPSendEnter(0)
		 ;WriteFileError()
		 ;Return
	  ElseIf (StringRegExp(\$val, "Material (\\d+) has status: Pre-Active") = 1) Then
		 ReportError("17", \$val)
		 SAPSendEnter(0)
	  ;"^.*Order (\\\\d+) has.*\$" "Historical" "Inactive" "Planned"
	  ElseIf (StringRegExp(\$val, "Material (\\d+) has status: .*") = 1) Then
		 ReportError("16", \$val)
		 WriteFileError()
		 Return
	  EndIf
	  #EndRegion

	  ;\$rowIndex = 1 ;becuaseee so
   Next

	;Press HEADER button
   \$sapSession.findById("wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/btnBT_HEAD").press

   ;Goto Tab "Order Data"
   \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\10").select
   \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\10/ssubSUBSCREEN_BODY:SAPMV45A:4351/ctxtVBKD-BSARK").text = "FOCR"

   ;Goto Tab "Addidional Data B"
   \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\13").select

   If \$lRdt &lt;&gt; "" Then
	  \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\13/ssubSUBSCREEN_BODY:SAPMV45A:4312/ssub8309:SAPMV45A:8309/ctxtVBAK-ZZCOSREQTIM1").text = \$lRdt
   EndIf
   
   \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\13/ssubSUBSCREEN_BODY:SAPMV45A:4312/ssub8309:SAPMV45A:8309/btnZZ_GET_DDCA_PLANT").press
   Sleep(500)

   If SAPWinExists("Adjust items") Then
	  \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
	  Sleep(2000)
   EndIf

   If SAPWinExists("Adjust items") Then
   ;If \$sapSession.ActiveWindow.Name == "wnd[1]" Then
	   ConsoleWrite("Adjust found" &amp; @CRLF)
	   \$sapSession.findById("wnd[1]/usr/btnBUTTON_1").press
	   SAPSendEnter(0) ;?
	   Sleep(500)
   EndIF

   IF SAPWinExists("Adjust items") Then
   ;If \$sapSession.ActiveWindow.Name == "wnd[1]" Then
	   ConsoleWrite("Adjust2 found" &amp; @CRLF)
	   \$sapSession.findById("wnd[1]/usr/btnBUTTON_1").press
	   SAPSendEnter(0) ;?
   EndIf

   Local \$c = 0
   While SAPWinExists("Information")
	   ConsoleWrite("-=Info " &amp; \$c &amp; @CRLF)
	   SAPSendEnter(0) ;?
	   \$c = \$c + 1
   WEnd
   
   
	  \$tempTotalPrice = \$sapSession.findById("wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/txtVBAK-NETWR").text
	  \$tempNetTotalPrice = StringReplace(\$lNetTotalPrice, " ", "")

	  IF Not StringCompare(\$tempNetTotalPrice, StringReplace(\$tempTotalPrice, " ", "")) = 0  Then
		 \$val = "The net value does not match. In pdf the net value is " &amp; \$lNetTotalPrice &amp; ", in the SAP the net value is " &amp; \$tempTotalPrice
		 ReportError("26", \$val)
	  EndIf

   ;press SAVE button
   \$sapSession.findById("wnd[0]/tbar[0]/btn[11]").press
   If \$sapSession.ActiveWindow.Name == "wnd[1]" Then
		InformationPopupErrorsCheck()
		  ;\$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
		  \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
   EndIf
   
   
   
   \$nextFeasibleDate = "Earliest feasible dlv dt for order is ";
    \$val = SAPErrGet("sbar")
	;\$val = "You entered an unfeasible dlv dt. Earliest feasible dlv dt for order is 12.11.2018"
	ConsoleWrite("-A1-'" &amp; \$val &amp; "'" &amp; @CRLF);
	;\$lRdd = "08.06.2018"	
	if \$lRdd == "ASAP" Or \$lRdd == "asap" Then
	
       ;"Earliest feasible dlv dt for order is"
   if (StringRegExp(\$val, "^You entered an unfeasible dlv dt. Earliest feasible dlv dt for order is \\d{2}\\.\\d{2}\\.\\d{4}\$") == 1) Then
	  \$pos = StringInStr(\$val, \$nextFeasibleDate)
	  \$newRdd = StringRight(\$val, StringLen(\$val) - StringLen(\$nextFeasibleDate) - \$pos + 1)
	  ConsoleWrite("-X0-2-:'" &amp; \$newRdd &amp; "'" &amp; @CRLF);
	  Sleep(2000);
	  \$flag = "true"
		Sleep(2000)
	\$sapSession.findById("wnd[0]/tbar[0]/btn[12]").press
		Sleep(2000)
	IF SAPWinExists("Cancel Order Processing") Then
 
	   ConsoleWrite("Adjust2 found" &amp; @CRLF)
	   \$sapSession.findById("wnd[1]/usr/btnSPOP-OPTION1").press
	   Sleep(2000)
	   SAPSendEnter(0) ;?
   EndIf
	EndIf
	EndIf
	
   
   
   
   
   
   
   
   
   
   
   
   
   \$val = \$sapSession.findById("wnd[0]/sbar").text

   \$feasStr = "You entered an unfeasible dlv dt. Earliest feasible dlv dt for order is ";
   If ((StringStartsWith(\$val, \$feasStr) == 1) Or (\$val == "Date is in the past: Please check")) Then
          ReportError("7", \$val)
          SAPSendEnter(0)
          If \$sapSession.ActiveWindow.Name == "wnd[1]" Then
				InformationPopupErrorsCheck()
                 ;\$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
                 \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
          EndIf
          \$val = \$sapSession.findById("wnd[0]/sbar").text
   EndIF

   If (StringStartsWith(\$val, "Order is below the minimum order value") == 1) Then
          ReportError("9", \$val)
          SAPSendEnter(0)
          If \$sapSession.ActiveWindow.Name == "wnd[1]" Then
				InformationPopupErrorsCheck()
                 \$sText = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
                 ConsoleWrite("---text='" &amp; \$sText &amp; "'" &amp; @CRLF )
                 If (StringStartsWith(\$sText, "Credit user check 2 unsuccessful") == 1) Then
                        ReportError("12", \$sText)
                 EndIF
                 \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
          EndIf
          \$val = \$sapSession.findById("wnd[0]/sbar").text
   EndIf

   If \$sapSession.ActiveWindow.Name == "wnd[1]" Then
	  InformationPopupErrorsCheck()
	  \$sapSession.findById("wnd[1]/tbar[0]/btn[0]").press
   EndIf

   WriteFile(\$val)

   ConsoleWrite("-&gt;After... val='" &amp; \$val &amp; "' " &amp; @CRLF &amp; " errIds=" &amp; \$error_ids &amp; @CRLF &amp; " errorMsgs='" &amp; \$error_msgs &amp; "'" &amp; @CRLF)
   #EndRegion
EndFunc

#Region Help functions
Func CloseSAP()
   ;RETURN
   ConsoleWrite("-&gt;Close" &amp; @CRLF)
   If (\$sapSession.ActiveWindow.Name = "wnd[0]") Then
		  \$sapSession.findById("wnd[0]/tbar[0]/okcd").text = "/NEX"
		  \$sapSession.findById("wnd[0]").sendVKey(0)
		  Sleep(1000)
   EndIf

   WinClose("[CLASS:#32770]") ;"SAP")
   Sleep(250)
EndFunc

;Report Error - ZglosBlad
Func ReportError(\$error_code, \$error_str)
   \$error_code = StringReplace(StringStripCR(\$error_code), @LF, "")
   If \$error_ids == "Null" Then
   \$error_ids = "SAP-" &amp; \$error_code
EndIf
If StringInStr(\$error_ids,\$error_code) Then
Else
   \$error_ids = \$error_ids &amp; "|SAP-" &amp; \$error_code
   EndIf

   \$error_str = StringReplace(StringStripCR(\$error_str), @LF, "")
   If \$error_msgs == "Null" Then
   \$error_msgs = \$error_str
   EndIf

If StringInStr(\$error_msgs,\$error_str) Then

Else
   \$error_msgs = \$error_msgs &amp; "|" &amp; \$error_str
   EndIf
TakeScreenshot(\$error_code) ;??
EndFunc

;Report Error and exit - ZglosBladIKoncz ?
Func ReportErrorAndExit(\$error_code, \$error_str)
   ReportError(\$error_code, \$error_str)
EndFunc

Func WriteFile(\$order_number)
   Local \$arr[6];
   \$arr[0] = \$order_number
   \$arr[1] = \$error_ids
   \$arr[2] = \$error_msgs
   \$arr[3] = \$screenShots
   \$arr[4] = \$error_data
   \$arr[5] = \$newRdd

   ConsoleWrite("order_number=" &amp; \$order_number &amp; @CRLF)
   \$path = \$lWinTmp &amp; \$lPid &amp; ".out" ;"c:\\temp\\pid.out"
   _FileWriteFromArray(\$path, \$arr)
   ConsoleWrite("File '" &amp; \$path &amp; "' written" &amp; @CRLF)
EndFunc

Func WriteFileError()
   WriteFile("")
EndFunc

Func SAPObjValueSet(\$sap_window_num, \$object_id, \$object_value)
        \$sapSession.findById("wnd[" &amp; \$sap_window_num &amp; "]/" &amp; \$object_id).text = \$object_value
EndFunc

Func SAPObjValueGet(\$sap_window_num, \$object_id)
        return \$sapSession.findById("wnd[" &amp; \$sap_window_num &amp; "]/" &amp; \$object_id).text
EndFunc

Func SAPSendEnter(\$sap_window_num)
        \$sapSession.findById("wnd[" &amp; \$sap_window_num &amp; "]").sendVKey(0)
EndFunc

Func SAPWinExists(\$win_title)
        ; Check each session for the sap_title
        For \$sap_sess_num = 0 to (\$sapCon.Sessions.Count - 1)
                \$sap_sess = \$sapCon.Children(\$sap_sess_num)

                ; Check each window in each session for the sap_title
                For \$sap_window_num_tmp = 0 to (\$sap_sess.Children.Count - 1)
                        If StringRegExp(\$sap_sess.findById("wnd[" &amp; \$sap_window_num_tmp &amp; "]").Text, ".*" &amp; \$win_title &amp; ".*") = 1 Then
                                Return True
                        EndIf
                Next
        Next

        Return False
EndFunc

Func SAPErrGet(\$object_id)
   If \$sapSession.findById("wnd[0]/" &amp; \$object_id).messagetype = "E" Or \$sapSession.findById("wnd[0]/" &amp; \$object_id).messagetype = "W" Then
	  Return \$sapSession.findById("wnd[0]/" &amp; \$object_id).Text
   Else
	  Return \$sapSession.findById("wnd[0]/" &amp; \$object_id).Text
   EndIf
EndFunc

Func GetSAPTableLength(\$tableName)
   \$table = \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG")
   \$tmpVal = ""
   \$ind = 0
   \$visibleRowsCount = \$table.visibleRowCount
   While (\$ind &lt; \$visibleRowsCount)
          \$tmpVal = \$sapSession.findById("wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/ctxtRV45A-MABNR[1," &amp; \$ind &amp;"]").text
          ; \$tmpVal  "__________________" ;&lt;- 'empty' row text
          ;     ConsoleWrite("\\t-X-1-" &amp;\$ind &amp; "'" &amp; StringStripWS(StringReplace(\$tmpVal, "_", ""), \$STR_STRIPALL) &amp; "'" &amp; @CRLF)
          \$tmpVal = StringStripWS(StringReplace(\$tmpVal, "_", ""), \$STR_STRIPALL)
          If (\$tmpVal == "") Then ExitLoop
          \$ind = \$ind + 1
   WEnd
   Return \$ind
EndFunc

Func StringStartsWith(\$string, \$start, \$case = 0)
        If StringLen(\$start) &gt; StringLen(\$string) Then Return -1
        If \$case &gt; 0 Then
                If StringLeft(\$string, StringLen(\$start)) == \$start Then Return 1
        Else
                If StringLeft(\$string, StringLen(\$start)) = \$start Then Return 1
        EndIf
        Return 0
EndFunc

Func InformationPopupErrorsCheck()
   If SAPWinExists("Information") Then
	  Sleep(500)
	  \$messageTxt = \$sapSession.findById("wnd[1]/usr/txtMESSTXT1").text
	  ConsoleWrite("--Information Popup Errors Check: " &amp; \$messageTxt)
	  If (StringStartsWith(\$messageTxt, "The plant is missing for BOM") == 1) Then
		 ReportError("25", \$messageTxt)
	  EndIf
   EndIf
EndFunc

#EndRegion

Exit 0""";

					log.warn("scriptText=" + scriptText);

					ppid = driver.executeScript(scriptText, ["AUTOIT"] as String[]);
				}
				catch(Exception e){
					log.error("\r\nYYY\r\n" + e.getMessage() + "\r\n");
				}
				
				log.warn("\r\n XXX &lt;-end seleniumn flow\r\n");
				
				//read AutoIT output file
				result = new String();
				orderNumber = new String();
				
				errorDescriptionList = new String();
				errorIdList = new String();
				screenShots = new String();
				errorData = new String();
rdd_date = new String();

				String linkToFile = win_tmp.toString().replace("\\", "\\\\") + pid.toString() + ".out";

				Object ofileExists = driver.executeScript("def file = new File('" + linkToFile + "');\n" + 
					"if (file.exists()){return 1} else {return 0}", "GROOVY");
				log.warn("\r\n\t output file '" + linkToFile + "' exists=" +  ofileExists.toString());
				if (ofileExists.toString().equals("1")){
					Object res = driver.executeScript(" return Base64.getEncoder().encodeToString(new File('${linkToFile}').bytes); ", ["GROOVY"] as String[]);
					result = new String(Base64.getDecoder().decode(res.toString())).split("\r\n", -1);
					driver.executeScript("new File('${linkToFile}').delete();", ["GROOVY"] as String[]);

					//check result for error. If so append to error_list
					log.warn("\r\n result.length=" + result.length);

					if (result.length &gt;= 3){
						//log.warn("\r\n result[0]='" + result[0]. + "' " + result[0].getClass());
						//SUCCESS: "P&amp;G Standard Order 3159216340 has been saved"
						if (result[0].trim().matches("^.*Order \\d+ has been.*")){
							orderNumber = result[0].trim().replaceAll("^.*Order (\\d+) has.*\$", "\$1").trim() as String; 
							path_screen_shot = "";
						}else{
							log.warn("\r\n result0 doesnt match RegExp");
						}
						log.warn("\r\n orderNumber=" + orderNumber);
						if (errorIdList.toString().trim().equals("")){
							errorIdList = result[1].trim();
						}else{
							errorIdList += "|" + result[1].trim();
						}
						if (errorDescriptionList.toString().trim().equals("")){ 
							errorDescriptionList = result[2].trim();
						}else{
							errorDescriptionList += "|" + result[2].trim();
						}
						
						if (error_id_list.toString().contains("SAP-2")){
							log.warn("error_id_list:*********"+error_id_list)
							error_id_list = error_id_list.toString().replace("SAP-2", "")
							error_description_list = error_description_list.toString().replace("Customer ship to number which is linked to multiple sold to number", "")
							log.warn("error_description_list:******"+error_description_list)
						}
						
						
						
						
						if (result.length &gt;= 4){
							screenShots = result[3].trim();
						}
						if (result.length &gt;= 5){
							//error_data handling
	                        errorData = result[4].trim();
	                        log.warn("errorData=" + errorData)
						}
						if(result.length&gt;=6 &amp;&amp; !result[5].trim().equals(""))
						{
						
						rdd_date=result[5].trim();						
						
						}
else
						{
						rdd_date = rdd.toString().toUpperCase();
						}
					}else {
						if (errorIdList.toString().trim().equals("")){
							errorIdList = "SAP-0";
						}else{
							errorIdList += "|SAP-0";
						}
						if (errorDescriptionList.toString().trim().equals("")){
							errorDescriptionList = "UNKNOWN_ERROR";
						}else{
							errorDescriptionList += "|UNKNOWN_ERROR";
						}
					}

					//save screenshot
					try{
						def filePaths = "" 
						if (!screenShots.trim().equals("")){
							filePaths = screenShots.trim();
							log.warn("screenShot " + filePaths);
						}
						else {
							filePaths = path_win.toString();
						}
						
						fileArray = filePaths.split("\\|");
						log.warn("screenShot files count=" + fileArray.length);
						for(f in fileArray){
							def winFilePath = f.replace("\\", "\\\\")
							Object fileExists = driver.executeScript("def file = new File('" + winFilePath + "');\n" + 
								"if (file.exists()){return 1} else {return 0}", "GROOVY");
							log.warn("\r\n\t file '" + winFilePath + "' exists=" +  fileExists.toString());
							if (fileExists.toString().equals("1")){
								Object screenBytes = driver.executeScript(
									"def bytes = new File('" + winFilePath + "').bytes; \n" +
									"return Base64.getEncoder().encodeToString(bytes);", "GROOVY");
								content = Base64.getDecoder().decode(screenBytes.toString());
								driver.executeScript("new File('" + winFilePath + "').delete();", ["GROOVY"] as String[]);
								
								//create local output file
								def x = f.split("\\\\") as String[]; //new File(f).
								fName = x[x.length - 1];

								log.error("\r\n  fName='" + fName + "'"); 
								path_screen_shot = homeDirectory.toString();
								if(path_screen_shot.charAt(path_screen_shot.length()-1) != File.separatorChar){
									path_screen_shot += File.separator;
								}
								path_screen_shot += "X" + fName;
	
								imageFile = new File(path_screen_shot);
	
								try {
									fos = new FileOutputStream(imageFile, false)
									fos.write(content);
								} catch (IOException e) {
									log.error("\r\n SC&amp;S3 (Internally)\r\n" + e.getMessage() + "\r\n");
								} finally {
									fos.close();
								}

  								try{
                                  adjustImageToCorrectResolution(path_screen_shot)
								}catch(Exception exx){
									log.error("\r\n SC&amp;S3 (Internally screenshot adjustment)\r\n" + exx.getMessage() + "\r\n");
                                }

								log.warn("Downloaded file length: " + imageFile.length());
	
								//Save file To S3
								log.warn("S3-0:" + accessKey + ", " + secretKey);
								if (!accessKey.toString().trim().equals("")){
									awsCredentials = new BasicAWSCredentials(accessKey.toString(), secretKey.toString());
									s3Client = AmazonUtils.createS3Client(awsCredentials, s3_endpoint_url.toString(), AmazonUtils.S3_SIGNER);

									String pathOnS3 = "screenshots/" + fName; //jpgFileName;
									putObjRequest = new PutObjectRequest(s3_attachments_bucket.toString(), pathOnS3, imageFile).withCannedAcl(CannedAccessControlList.PublicRead);
									log.warn("S3-1: '" + s3_attachments_bucket.toString() + "' '"+ pathOnS3 + "'");
									s3Client.putObject(putObjRequest);
									s3path = s3Client.getResourceUrl(s3_attachments_bucket.toString(), pathOnS3);
									if (s3FileURLs.trim().equals("")){
										s3FileURLs = s3path;
									}else{
										s3FileURLs = s3FileURLs + "|" + s3path;
									}
									log.warn("S3-2");
								}
							}
						}
					}catch(Exception e){
						log.error("\r\nSC&amp;S3\r\n'" + e.getMessage() + "'\r\n" + e.getStackTrace());
					}
				}
				driver.close();
				
				//log.warn("\r\n\t orderNumber=" + orderNumber + "\r\n\t s3FileURLs=" + s3FileURLs + "\r\n\t errorIdList=" + errorIdList + "\r\n\t errorDescriptionList=" + errorDescriptionList);
				log.warn("orderNumber=" + orderNumber);
                log.warn("s3FileURLs=" + s3FileURLs);
                log.warn("errorIdList=" + errorIdList);
                log.warn("errorDescriptionList=" + errorDescriptionList); 
                log.warn("errorData=" + errorData);

				errIdList = (error_id_list.toString() + "|" + errorIdList).replaceAll("^\\|", "");
				errDescList = (error_description_list.toString() + "|" + errorDescriptionList).replaceAll("^\\|", "");

			]]&gt;&lt;/script&gt;
		&lt;/selenium&gt;
	&lt;/selenium-flow&gt;
  
	&lt;export include-original-data="true"&gt;
		&lt;single-column name="order_number" value="${orderNumber}"/&gt;
    	&lt;single-column name="sap_screenshot_file_uri"  value="${s3FileURLs}" /&gt;
		&lt;single-column name="error_id_list" value="${errIdList}"/&gt;
    	&lt;single-column name="error_description_list"  value="${errDescList}" /&gt;
		&lt;single-column name="error_data" value="${errorData}"/&gt;
		&lt;single-column name="rdd" value="${rdd_date}"/&gt;
    &lt;/export&gt;

&lt;/config&gt;

</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>11c4d01d-4bec-4940-968b-892af608b3eb</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[180] wite to SAP</name>
                                    <machineConfigOptions/>
                                    <source>
                                        <availability></availability>
                                        <batchSize>1</batchSize>
                                        <deleted>false</deleted>
                                        <description></description>
                                        <equallyDistributeLoad>false</equallyDistributeLoad>
                                        <name>one thread - rpa nodes</name>
                                        <prioritizeEarlierRuns>false</prioritizeEarlierRuns>
                                        <proxySettings>
                                            <validationEnabled>true</validationEnabled>
                                        </proxySettings>
                                        <threadCount>1</threadCount>
                                        <threadsPerNode>false</threadsPerNode>
                                        <timeZone>GMT</timeZone>
                                        <tps>0</tps>
                                        <url></url>
                                        <version>
                                            <componentUuid>017a2908-a3ed-4e22-bfa7-997618fe7693</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-02-14T14:06:05Z</lastModified>
                                            <versionUuid>8a98b5f7-71e6-4ce2-a3fd-d84b21f64c7a</versionUuid>
                                        </version>
                                    </source>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>11c4d01d-4bec-4940-968b-892af608b3eb</uuid>
                                    <version>
                                        <componentUuid>6a983326-d694-4064-8919-64bb9da4ae7e</componentUuid>
                                        <incrementalVersion>1.8</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-04T15:10:42Z</lastModified>
                                        <versionUuid>b7f58425-4a93-412b-9ed8-9ae2edc5ab21</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[180] wite to SAP</title>
                                <type>SINGLE</type>
                                <uuid>bb3adf79-5921-4e26-857e-6deca025829d</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>48dfef3c-7b92-4d30-afdc-234863cabaef</componentUuid>
                                    <incrementalVersion>1.6</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-04T15:10:45Z</lastModified>
                                    <versionUuid>d800f6b3-15d1-4e21-9be7-45da1e8f203a</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>12</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>dba8e761-0ff8-432b-a97f-dd7b4d9d67f1</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ship_to_id","value":"lala","operator":"IS_NOT_EMPTY"},{"fieldName":"sales_area_id","value":"lala","operator":"IS_NOT_EMPTY"},{"fieldName":"distribution_channel_id","value":"lala","operator":"IS_NOT_EMPTY"}],"customConditions":[]}
rule "1. Send records to 'YES' when ship_to_id IS_NOT_EMPTY 'lala' AND sales_area_id IS_NOT_EMPTY 'lala' AND distribution_channel_id IS_NOT_EMPTY 'lala'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ship_to_id", "IS_NOT_EMPTY", "lala"));
        eval($item.checkValue("sales_area_id", "IS_NOT_EMPTY", "lala"));
        eval($item.checkValue("distribution_channel_id", "IS_NOT_EMPTY", "lala"));

    then
        $ctx.sendResultTo("YES", $item);
end



# RuleOutcome.Definition={"outcomeId":"NO","conditional":false,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[],"customConditions":[]}
rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>is shipTo Valid</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>68efbed7-37be-4595-81b3-8e6e138889a8</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;

   &lt;!-- retrieve S3 credentials --&gt;
   &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name2", "${s3_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name2}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName2 = secure_store_name2.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName2);
      accessKey = obj.getKey().toString();
      secretKey = obj.getValue().toString();
   ]]&gt;&lt;/script&gt;  

   &lt;!-- derive ShipTo, SalesArea, DistributionChannel directly from S3 --&gt;
   &lt;script&gt;&lt;![CDATA[
      import com.workfusion.utils.client.AmazonUtils;
      import com.amazonaws.auth.BasicAWSCredentials;
      import com.amazonaws.services.s3.AmazonS3;
      import com.amazonaws.services.s3.model.S3Object;
      import com.amazonaws.services.s3.model.GetObjectRequest

      import groovy.json.JsonBuilder
      import groovy.json.JsonOutput
      import groovy.json.JsonSlurper
      
      def String endpointUrl = s3_endpoint_url.toString()
      def String bucketName = s3_attachments_bucket.toString()
      def String pathToFile = "temp/NE_" + cfg_bw_report_filename.toString()
      
      def BasicAWSCredentials awsCredentials = new BasicAWSCredentials(accessKey, secretKey);
      def AmazonS3 s3Client = AmazonUtils.createS3Client(awsCredentials, endpointUrl, AmazonUtils.S3_SIGNER);
      def S3Object object = s3Client.getObject(new GetObjectRequest(bucketName, pathToFile));
      def InputStream s3InStream = object.getObjectContent();

        shipTo = "";
        salesArea = "";
        distributionChannel = "";

 		/*jar_URLs  = [cfg_nexus_uri.toString() + "/content/repositories/releases/com/dxc/pg/rpa/dach/FuzzyMatcher/5.4/FuzzyMatcher-5.4.jar",
					 cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar",
                	 cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/poi/poi/3.17/poi-3.17.jar",
					 cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/poi/poi-ooxml/3.17/poi-ooxml-3.17.jar",
					 cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/poi/poi-ooxml-schemas/3.17/poi-ooxml-schemas-3.17.jar",
					 cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/xmlbeans/xmlbeans/2.6.0/xmlbeans-2.6.0.jar"]

                .collect{
                   p -&gt; new URL("jar:" + new URL(p) + "!/")
                };
*/

 		jar_URLs  = ["FuzzyMatcher-5.4.jar",
					 "commons-collections4-4.1.jar",
                	 "poi-3.17.jar",
					 "poi-ooxml-3.17.jar",
					 "poi-ooxml-schemas-3.17.jar",
					 "xmlbeans-2.6.0.jar"]

                .collect{
                   p -&gt; (new File("/tmp/dach/" + p)).toURI().toURL()	
                };

      jar_URLs.each{
         p -&gt; println p.getPath()
         this.getClass().classLoader.addURL(p)
      }

        try {
			def fm = Class.forName("com.dxc.rpa.FuzzyMatcher").newInstance();
			fm.loadDictionary(s3InStream);
            s3InStream.close();
			log.warn(fm.getLoadingSummary());
            log.warn("in:" + prepareQuery());
			def resMap = fm.match(prepareQuery(), false);

			if (resMap != null) {
				shipTo = resMap.get("Customer Ship To CODE");
				salesArea = resMap.get("Sales Organization CODE");
				distributionChannel = resMap.get("Distribution Channel CODE");
			}

				variables2 =  new JsonSlurper().parseText(variables.toString())
       			variables2.ship_to_id.value= shipTo
        		variables2.ship_to_id.history &lt;&lt; [modifiedBy:"[130] shipTo derivation ",
                                               version: variables2.ship_to_id.history.version.max() + 1,
                                               value: variables2.ship_to_id.value,
                                               modifiedDate: new Date()]
       			
       			variables2.sales_area_id.value= salesArea
        		variables2.sales_area_id.history &lt;&lt; [modifiedBy:"[130] shipTo derivation ",
                                               version: variables2.sales_area_id.history.version.max() + 1,
                                               value: variables2.sales_area_id.value,
                                               modifiedDate: new Date()]


       			variables2.distribution_channel_id.value= distributionChannel
        		variables2.distribution_channel_id.history &lt;&lt; [modifiedBy:"[130] shipTo derivation ",
                                               version: variables2.distribution_channel_id.history.version.max() + 1,
                                               value: variables2.distribution_channel_id.value,
                                               modifiedDate: new Date()]


 				variablesJson =    JsonOutput.toJson(variables2)
			
				log.warn("matching result: " + resMap);
        } catch (IOException e) {
            e.printStackTrace();
        } 

      def prepareQuery() {
         Map&lt;String, String&gt; query = new HashMap&lt;String, String&gt;();
         if (ship_to_name != null) {
           query.put("Customer Ship To NAME", ship_to_name.toString());
         }
         if (ship_to_location != null) {
           query.put("Customer Ship To LOCATION", ship_to_location.toString());
         }
         if (ship_to_postal_code != null) {
           query.put("Customer Ship To POSTAL_CODE", ship_to_postal_code.toString());
         }
         if (ship_to_street_name != null) {
           query.put("Customer Ship To STREET_NAME", ship_to_street_name.toString());
         }
         query;
      }

   ]]&gt;&lt;/script&gt;
  
	&lt;export include-original-data="true"&gt;
      &lt;single-column name="variables" value="${variablesJson}"/&gt;
    	&lt;single-column name="ship_to_id" value="${shipTo}"/&gt;
    	&lt;single-column name="sales_area_id" value="${salesArea}"/&gt;
    	&lt;single-column name="distribution_channel_id" value="${distributionChannel}"/&gt;      
	&lt;/export&gt;  
&lt;/config&gt;
</content>
                                    <description>ShipTo derivation</description>
                                    <includedConfigs/>
                                    <inclusionCode>9344d9e9-dd55-4513-a36b-2f44e29d81a9</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[130] shipTo derivation      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9344d9e9-dd55-4513-a36b-2f44e29d81a9</uuid>
                                    <version>
                                        <componentUuid>c42baf67-8926-4a6a-8d88-105b7324ac97</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>d64ab740-6d13-4cc1-85f7-9a324a3da9cf</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[130] shipTo derivation      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>8d79794f-eaad-41e9-938b-517addfc3b20</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>0e7ba771-d0d7-42ed-95f8-fcfbe8dd66d2</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>d01c9ff9-36bc-490b-94c2-3734fba8a027</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>13</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>f7b32e18-f4fe-42e2-9a86-9cde24f61d03</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"convert","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ean6to13_conv_sap","value":"N","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'convert' when ean6to13_conv_sap EQ 'N'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ean6to13_conv_sap", "EQ", "N"));

    then
        $ctx.sendResultTo("convert", $item);
end

# RuleOutcome.Definition={"outcomeId":"skip conversion","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ean6to13_conv_sap","value":"Y","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'skip conversion' when ean6to13_conv_sap EQ 'Y'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ean6to13_conv_sap", "EQ", "Y"));

    then
        $ctx.sendResultTo("skip conversion", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>ean conversion</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>7f94d88b-4064-4b8b-9e2b-0e7d79ac3b02</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;

   &lt;!-- retrieve shared drive credentials --&gt;
   &lt;!--script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name2", "${shared_drive_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name2}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName2 = secure_store_name2.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName2);
      sharedDriveUser = obj.getKey().toString();
      sharedDrivePass = obj.getValue().toString();
   ]]&gt;&lt;/script--&gt;  
  
   &lt;!-- download report from shared drive to local --&gt;
       &lt;!--script&gt;&lt;![CDATA[
             import java.io.FileOutputStream;
             import java.io.InputStream;
             import java.io.IOException;

             import jcifs.smb.NtlmPasswordAuthentication;
             import jcifs.smb.SmbFile;
             import org.apache.commons.io.IOUtils;

             def inputStreamToByteArray = {InputStream is -&gt;
                    return IOUtils.toByteArray(is);
             }

             def copyFromSharedDriveToLocal = {String user, String password, String sourcePath, String destinationPath -&gt;
                    NtlmPasswordAuthentication auth = new NtlmPasswordAuthentication(null, user, password);

                    try {
                           SmbFile source = new SmbFile(sourcePath, auth);
                           String destination = destinationPath + "/" + source.getName();
                           FileOutputStream fos = new FileOutputStream(destination);
                           byte[] bytes = inputStreamToByteArray(source.getInputStream());
                           fos.write(bytes);
                           fos.close();
                    } catch (Exception e) {
                           System.out.println(e.getMessage());
                    }
             }

             copyFromSharedDriveToLocal("eu\\" + sharedDriveUser.toString(),
                           sharedDrivePass.toString(),
                           gtin_maping_xlsx_uri.toString(),
                           temp_directory.toString());
       ]]&gt;&lt;/script--&gt;
  
  	&lt;var-def name="products"&gt;
		&lt;json expression="$..product_code1.last"&gt;
			&lt;var name="product_lines"/&gt;
		&lt;/json&gt;
	&lt;/var-def&gt;
  
  	&lt;var-def name="sorg"&gt;
		&lt;script return="sorg"&gt;&lt;![CDATA[ 		
			sorg = "${sales_area_id}".toString().findAll(/\d+/ )*.toInteger();	
		]]&gt;&lt;/script&gt;
	&lt;/var-def&gt;
 
	&lt;script&gt;&lt;![CDATA[

        def shipTo = "${ship_to_id}"
        def prodCodes = "${products}"
		def salesOrg = "${sorg}"
		def distChannel = "${distribution_channel_id}"
		
		def path = temp_directory.toString();
		
    /*  jar_URLs  = [cfg_nexus_uri.toString() + "/content/repositories/releases/com/dxc/pg/rpa/dach/GTINObtainer/2.1/GTINObtainer-2.1.jar",
				   cfg_nexus_uri.toString() + "/content/repositories/thirdparty/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar",
                   cfg_nexus_uri.toString() + "/content/repositories/thirdparty/org/apache/poi/poi/3.17/poi-3.17.jar",
				   cfg_nexus_uri.toString() + "/content/repositories/thirdparty/org/apache/poi/poi-ooxml/3.17/poi-ooxml-3.17.jar",
				   cfg_nexus_uri.toString() + "/content/repositories/thirdparty/org/apache/poi/poi-ooxml-schemas/3.17/poi-ooxml-schemas-3.17.jar",
				   cfg_nexus_uri.toString() + "/content/repositories/thirdparty/org/apache/xmlbeans/xmlbeans/2.6.0/xmlbeans-2.6.0.jar",
				   cfg_nexus_uri.toString() + "/content/repositories/releases/com/dxc/pg/rpa/3rdParty/JSONOrg/20180130/JSONOrg-20180130.jar"]
                .collect{
                   p -&gt; new URL("jar:" + new URL(p) + "!/")
                };
*/

jar_URLs  = ["GTINObtainer-2.1.jar",
				   "commons-collections4-4.1.jar",
                   "poi-3.17.jar",
				   "poi-ooxml-3.17.jar",
				   "poi-ooxml-schemas-3.17.jar",
				   "xmlbeans-2.6.0.jar",
				   "JSONOrg-20180130.jar"]
                .collect{
                   p -&gt; (new File("/tmp/dach/" + p)).toURI().toURL()	
                };

		def cl = URLClassLoader.newInstance(jar_URLs as URL[]);

		// Here creating object...
		def GtinObtainer = cl.loadClass("com.dxc.pg.dach.obtngtn.GtinObtainer");
		def constructorParams = [File.class, File.class, String.class, String.class, String.class, String.class] as Class[]
		def GtinObtainerConstructor = GtinObtainer.getConstructor(constructorParams)
		def gtinObtainer = GtinObtainerConstructor.newInstance(
				new File(path + "/" + cfg_gtin_customers_mapping_filename.toString()),
				new File(path + "/" + cfg_gtin_mapping_filename.toString()),
                shipTo.toString(),
                prodCodes.toString(),
				salesOrg.toString(),
				distChannel.toString());

        gtinList = gtinObtainer.obtainGtinsPiped();
        def errors = gtinObtainer.getProductCodeErrors();
        if (errors.size() &gt; 0) {
			gtinErrorList = "";
			for (String errGtin:gtinObtainer.getProductCodeErrors()) {
				gtinErrorList += ", " + errGtin?:"&lt;i&gt;none&lt;/i&gt;";
			}
			gtinErrorList = gtinErrorList.substring(2);
			if (error_description_list.toString().equals("")) {
				error_description_list = "Some product codes (${gtinErrorList}) could not be translated into GTINs";
				error_id_list = "DATA-03";
			} else {
				error_description_list = error_description_list.toString() + "|Some product codes (${gtinErrorList}) could not be translated into GTINs";
				error_id_list = error_id_list.toString() + "|DATA-03";
			}
        } else {
        	gtinErrorList = ""
        }
		
		log.warn("Gtin list: " + gtinList.toString());
		log.warn(gtinErrorList);

	]]&gt;&lt;/script&gt;
  
  	&lt;script&gt;&lt;![CDATA[
	 
		import groovy.json.JsonSlurper;
		import groovy.json.JsonBuilder

        def json = "${gtinList}".toString();
	
		def jsonSlurper = new JsonSlurper();
		def products = jsonSlurper.parseText(json).Products;
		def rpafixedProducts = new JsonBuilder()
        def product_information_fixed = new JsonSlurper().parseText(product_lines.toString()).product_lines
        rpafixedProducts {
           product_lines product_information_fixed.withIndex().collect { element, index -&gt;
                {
                    -&gt;
                    product_code(last: product_information_fixed[index].product_code1.last, ocred: product_information_fixed[index].product_code1.ocred , mtfixed: product_information_fixed[index].product_code1.mtfixed, ocrfixed: product_information_fixed[index].product_code1.ocrfixed)
                    product_code1(last: product_information_fixed[index].product_code1.last, ocred: product_information_fixed[index].product_code1.ocred , mtfixed: product_information_fixed[index].product_code1.mtfixed, ocrfixed: product_information_fixed[index].product_code1.ocrfixed)
                    product_code2(last: product_information_fixed[index].product_code2.last, ocred: product_information_fixed[index].product_code2.ocred , mtfixed: product_information_fixed[index].product_code2.mtfixed, ocrfixed: product_information_fixed[index].product_code2.ocrfixed)
                    
					
					quantity(last: product_information_fixed[index].quantity.last, ocred: product_information_fixed[index].quantity.ocred , mtfixed: product_information_fixed[index].quantity.mtfixed, ocrfixed: product_information_fixed[index].quantity.ocrfixed )
                    gtin(last: products[index].gtin, rpaed: products[index].gtin, mtfixed: product_information_fixed[index].gtin.mtfixed)
                    position(index + 1)
                }
            }

        }
        product_lines_after_rpa = rpafixedProducts.toString()
	
	]]&gt;&lt;/script&gt;
  
    &lt;export include-original-data="true"&gt;
    	&lt;single-column name="product_lines" value="${product_lines_after_rpa}" /&gt;
    &lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>dd4a4d12-248c-4f68-b1e5-e0dd15158fff</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[150] GTIN format fix (from 4,11)      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>dd4a4d12-248c-4f68-b1e5-e0dd15158fff</uuid>
                                    <version>
                                        <componentUuid>e1c21071-658d-4828-91e8-ea4072117dba</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>17b5bf5b-d453-4f50-9102-64517e5b36cc</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[150] GTIN format fix (from 4,11)      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>de17bf2e-5419-4e45-b26d-0eea5509a0d4</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>2700dba2-4ab3-4afa-a936-289518081788</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>1d768b86-b2d3-46bc-afe1-11467b39fe16</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>14</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>d4c28020-7eeb-4393-b0a2-6a4e840d9080</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"yes","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"sap_validity_flag","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'yes' when sap_validity_flag EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("sap_validity_flag", "EQ", "YES"));

    then
        $ctx.sendResultTo("yes", $item);
end

# RuleOutcome.Definition={"outcomeId":"no","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"sap_validity_flag","value":"NO","operator":"EQ"},{"fieldName":"error_description_list","value":"Script line","operator":"NOT_CONTAINS"}],"customConditions":[]}
rule "2. Send records to 'no' when sap_validity_flag EQ 'NO' AND error_description_list NOT_CONTAINS 'Script line'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("sap_validity_flag", "EQ", "NO"));
        eval($item.checkValue("error_description_list", "NOT_CONTAINS", "Script line"));

    then
        $ctx.sendResultTo("no", $item);
end

# RuleOutcome.Definition={"outcomeId":"logging issues","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"error_description_list","value":"Script Line","operator":"CONTAINS"},{"fieldName":"sap_attempts_cnt","value":"0","operator":"GT"}],"customConditions":[]}
rule "3. Send records to 'logging issues' when error_description_list CONTAINS 'Script Line' AND sap_attempts_cnt GT '0'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("error_description_list", "CONTAINS", "Script Line"));
        eval($item.checkValue("sap_attempts_cnt", "GT", "0"));

    then
        $ctx.sendResultTo("logging issues", $item);
end

# RuleOutcome.Definition={"outcomeId":"another no","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"sap_attempts_cnt","value":"0","operator":"LE"}],"customConditions":[]}
rule "4. Send records to 'another no' when sap_attempts_cnt LE '0'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("sap_attempts_cnt", "LE", "0"));

    then
        $ctx.sendResultTo("another no", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>succeeded</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>20b2fdda-0b6e-45d7-96f0-601bbe02ad55</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8" scriptlang="groovy"&gt;
  
	&lt;script&gt;&lt;![CDATA[
  		isValid = "YES";
		errIdList = error_id_list.toString();
		gotoSoldtoSelection = "NO";
		errDescList = error_description_list.toString();
		orderNumber = order_number.toString();
		screenshotUri = sap_screenshot_file_uri.toString();

		if (orderNumber != null) {
			if (orderNumber.matches("^\\d{10,11}\$")) {
				isValid = "YES";
			} else {
				isValid = "NO";
				if (!errIdList.contains("SAP")) {
					errIdList += "|SAP-000";
					errDescList += "|Unhandled SAP exception";
					if (screenshotUri != null) {
						if (!screenshotUri.equals("")) {
							errDescList += ", please see &lt;a href=\"${sap_screenshot_file_uri}\"&gt;the screenshot&lt;/a&gt; taken";
						}
					}
				}
			}
		} else {
			isValid = "NO";
		}
		if (errIdList.contains("SAP-2")) {
			//if (sold_to.trim().equals("")){
			if (sold_to.toString().equals("")){
				gotoSoldtoSelection = "YES";
			}
		} 
		errIdList = errIdList.replaceAll("^\\|", "");
		errDescList = errDescList.replaceAll("^\\|", "");

log.warn("errIdList=" + errIdList);
log.warn("error_description_list=" + error_description_list);
log.warn("isValid=" + isValid);
log.warn("gotoSoldtoSelection=" + gotoSoldtoSelection);

	]]&gt;&lt;/script&gt;
  
	&lt;export include-original-data="true"&gt;
    	&lt;single-column name="error_id_list" value="${errIdList}" /&gt;
    	&lt;single-column name="error_description_list" value="${errDescList}" /&gt;
    	&lt;single-column name="sap_validity_flag" value="${isValid}" /&gt;
    	      	&lt;single-column name="goto_soldto_selection" value="${gotoSoldtoSelection}" /&gt; 
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>fd950cd6-171e-4d1a-9a7b-dfce55c4745e</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[190] post-SAP validation  32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>fd950cd6-171e-4d1a-9a7b-dfce55c4745e</uuid>
                                    <version>
                                        <componentUuid>f3b186b6-1f41-4162-a8dc-122b74f10117</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>2db444a3-06a7-4b8c-9c8a-88043db166f9</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[190] post-SAP validation  32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>3bcc8647-8549-4d60-9c98-d873fa15931c</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>3102f7ed-939b-40a2-8361-a97461118450</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>f702edb7-4121-41ee-8d09-03a16d3c9707</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>15</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>4593bf94-197d-4b61-ae08-2a87b1212c96</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>2e2714cc-9a52-4c50-9062-d44d4dea628d</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	&lt;script&gt;&lt;![CDATA[
		import groovy.json.JsonOutput;
		import java.text.SimpleDateFormat;
		import groovy.json.JsonBuilder
		import groovy.json.JsonSlurper
	
  		def error_list = [];

		def errors = Arrays.asList("${error_description_list}".split("\\|"));

		log.error("error_description_list: "+ error_description_list.toString())
		
		for (int i = 0; i &lt; errors.size(); i++) {
			error_list.add([error: errors.get(i)]);
		}

tabl = '&lt;table style="border: 1px solid black;"&gt;&lt;tr&gt;&lt;th&gt;Error row&lt;/th&gt;&lt;th&gt;Error description&lt;/th&gt;&lt;/tr&gt;';
	for (int i = 0; i &lt; errors.size(); i++) {
			tabl += '&lt;tr style="border: 1px solid black;"&gt;&lt;td style="border: 1px solid black;"&gt;'+i+'&lt;/td&gt;&lt;td&gt;'+errors.get(i)+'&lt;/td&gt;&lt;/tr&gt;';

		}
tabl += '&lt;/table&gt;';
log.error(tabl)	;	
		error_list_json = JsonOutput.toJson([error_list_json: error_list]);
		log.error("error_list_json" + error_list_json)
		manualTaskCreationDate = new SimpleDateFormat("dd.MM.yyyy").format(new Date());
		
		variables2 =  new JsonSlurper().parseText(variables.toString())
		rdd=variables2.rdd_orig.value;
		manualTaskRdd = rdd

		if (rdd != null &amp;&amp; !rdd.trim().equals("") &amp;&amp; !rdd.equalsIgnoreCase("ASAP")) {
			orderSortingDate = rdd.substring(6,10) + "-" + rdd.substring(3,5) + "-" + rdd.substring(0,2);
		} else {
			orderSortingDate = creation_sorting_dttm.toString().substring(0, 10);
		}

        def builder = new JsonBuilder()
        def listOfProducts = new JsonSlurper().parseText(product_lines.toString()).product_lines
        builder {

             product_information listOfProducts.collect {
                [
                    "product_code": it.product_code.last,
					 "product_code1": it.product_code1.last,
					"product_code2": it.product_code2.last,
                    "quantity": it.quantity.last,
                    "gtin": it.gtin.last,
					"display_gtin": it.gtin.display_gtin

            ]
        }}
        products_json = builder.toString()
	    
		variables2 =  new JsonSlurper().parseText(variables.toString())
		
		rdd_orig_value= variables2.rdd_orig.history.find{it.version==1}.value
        log.warn("rdd_orig:"+rdd_orig)

ship_to_id = variables2.ship_to_id.value
distribution_channel_id = variables2.distribution_channel_id.value
sales_area_id = variables2.sales_area_id.value


	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
        &lt;single-column name="products_json" value="${products_json}" /&gt;
		&lt;single-column name="error_list_json" value="${error_list_json}" /&gt;
		&lt;single-column name="order_sorting_date" value="${orderSortingDate}" /&gt;
      &lt;single-column name="rdd_orig" value="${rdd_orig_value}" /&gt;
      &lt;single-column name="ship_to_id" value="${ship_to_id}" /&gt;
      &lt;single-column name="distribution_channel_id" value="${distribution_channel_id}" /&gt;
      &lt;single-column name="sales_area_id" value="${sales_area_id}" /&gt;
      &lt;single-column name="error_table" value="${tabl}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>df6d08ca-66ba-4f4a-b43b-15723374dded</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[174] create products JSON and  error_list JSON      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>df6d08ca-66ba-4f4a-b43b-15723374dded</uuid>
                                    <version>
                                        <componentUuid>fbc6b61d-d523-40cb-bebe-75eb98eec146</componentUuid>
                                        <incrementalVersion>1.3</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-04T02:25:07Z</lastModified>
                                        <versionUuid>7a042b8b-5422-4d62-9ad5-8204bd0db4cf</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[174] create products JSON and  error_list JSON      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>4df9a2dd-84b8-4247-87c8-0648cf37b252</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>3191a136-788f-4362-be3c-8da025b49d51</componentUuid>
                                    <incrementalVersion>1.3</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-04T02:25:09Z</lastModified>
                                    <versionUuid>2f1012a8-6eb4-43b9-8eb9-3d79022d92ca</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>16</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>b1ec2644-3add-476a-ba86-57cb2e064130</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>bf692641-bf66-47e2-a50e-694868b98c56</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	
	
	
	&lt;script&gt;&lt;![CDATA[
import groovy.json.JsonBuilder
import groovy.json.JsonOutput
import groovy.json.JsonSlurper


        def json = "${products_json}".toString();
	
		def jsonSlurper = new JsonSlurper();
		def products = jsonSlurper.parseText(json).products_json;
		def mtfixedProducts = new JsonBuilder()
        def product_information_fixed = new JsonSlurper().parseText(product_lines.toString()).product_lines
          Map&lt;String, String&gt; codeToGtinMap = new HashMap&lt;String, String&gt;();
    Map&lt;String, String&gt; codeToQtyMap = new HashMap&lt;String, String&gt;();
    products.each{ element -&gt;
        codeToGtinMap.put(element.product_code1, element.gtin)
        codeToQtyMap.put(element.product_code1, element.quantity)
    }
product_information_fixed = product_information_fixed.findAll {codeToGtinMap.keySet().contains(it.product_code1.last) }
	product_information_fixed = product_information_fixed.findAll {codeToGtinMap.keySet().contains(it.product_code1.last) }
    mtfixedProducts {
        product_lines product_information_fixed.withIndex().collect { element, index -&gt;
            {
                -&gt;
                //use a child closure to generate JSON data for each product in the collection
                //"position" index + 1
                product_code(last: product_information_fixed[index].product_code.last, ocred: product_information_fixed[index].product_code.ocred , mtfixed: products[index].product_code, ocrfixed: product_information_fixed[index].product_code.ocrfixed)
                product_code1(last: product_information_fixed[index].product_code1.last, ocred: product_information_fixed[index].product_code1.ocred , mtfixed: products[index].product_code1, ocrfixed: product_information_fixed[index].product_code1.ocrfixed)
				product_code2(last: product_information_fixed[index].product_code2.last, ocred: product_information_fixed[index].product_code2.ocred , mtfixed: products[index].product_code2, ocrfixed: product_information_fixed[index].product_code2.ocrfixed)
				quantity(last: codeToQtyMap.get(product_information_fixed[index].product_code1.last), ocred: product_information_fixed[index].quantity.ocred , mtfixed: products[index].quantity, ocrfixed: product_information_fixed[index].quantity.ocrfixed )
                gtin(last: codeToGtinMap.get(product_information_fixed[index].product_code1.last), rpaed: product_information_fixed[index].gtin.rpaed, mtfixed: products[index].gtin, display_gtin: product_information_fixed[index].gtin.display_gtin)
                position(index + 1)
            }
        }

    }
        product_lines_after_mt = mtfixedProducts.toString()



 def dist = "${distribution_channel_id}".toString();


   		variables2 =  new JsonSlurper().parseText(variables.toString())
  log.warn("1 variables2:"+variables2)

        variables2.distribution_channel_id.value= dist
        variables2.distribution_channel_id.history &lt;&lt; [modifiedBy:"[176] product JSON flatenization",
                                               version: variables2.distribution_channel_id.history.version.max() + 1,
                                               value: variables2.distribution_channel_id.value,
                                               modifiedDate: new Date()]
      
  log.warn("2 variables2:"+variables2)

 def sales = "${sales_area_id}".toString();


        variables2.sales_area_id.value= sales
        variables2.sales_area_id.history &lt;&lt; [modifiedBy:"[176] product JSON flatenization",
                                               version: variables2.sales_area_id.history.version.max() + 1,
                                               value: variables2.sales_area_id.value,
                                               modifiedDate: new Date()]
  log.warn("3 variables2:"+variables2)

def ship = "${ship_to_id}".toString();
        variables2.ship_to_id.value= ship
        variables2.ship_to_id.history &lt;&lt; [modifiedBy:"[176] product JSON flatenization",
                                               version: variables2.ship_to_id.history.version.max() + 1,
                                               value: variables2.ship_to_id.value,
                                               modifiedDate: new Date()]


def rdd_fixed = "${rdd}".toString();
        variables2.rdd_orig.value= rdd_fixed
        variables2.rdd_orig.history &lt;&lt; [modifiedBy:"[176] product JSON flatenization",
                                               version: variables2.rdd_orig.history.version.max() + 1,
                                               value: variables2.rdd_orig.value,
                                               modifiedDate: new Date()]

  log.warn("4 variables2:"+variables2)
variablesJson =    JsonOutput.toJson(variables2)


		
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
	&lt;single-column name="product_lines" value="${product_lines_after_mt}" /&gt;	
        &lt;single-column name="variables" value="${variablesJson}"/&gt; 
	&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>dc788dbf-681a-4f3c-ac22-82a3602429a0</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[176] product JSON flatenization      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>dc788dbf-681a-4f3c-ac22-82a3602429a0</uuid>
                                    <version>
                                        <componentUuid>bb23ffda-1ccf-4d1b-a92a-4007f3b1d6f4</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>7e25c580-1b0b-49ed-8489-0b627b43d2f1</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[176] product JSON flatenization      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>bddcfa22-d64a-42d4-9bbc-ecb23f3125c7</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>1307025f-4259-4271-a05c-d1131262626e</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>ef837fcd-90c8-47ca-abb3-e9391d741959</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>17</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>afd376bf-8596-4916-96cd-0bb1275d3042</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>8538601b-d1c4-4ef6-a79a-2db5e5c478a1</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
	

  
  
  
  &lt;script&gt;&lt;![CDATA[
        import groovy.json.JsonSlurper
		import groovy.json.JsonBuilder
		import groovy.json.JsonOutput
        
        ship_to_name2 = customer_name.toString()
        ship_to_location2 = city.toString()
        ship_to_postal_code2 = zip_code.toString()
        ship_to_street_name2 = street_address.toString()
        po_number2 = purchase_order.toString()
        
     
 		variables2 =  new JsonSlurper().parseText(variables.toString())
        variables2.rdd_orig.value= request_delivery_date.toString()
        variables2.rdd_orig.history &lt;&lt; [modifiedBy:"export vector alignment",
                                               version: variables2.rdd_orig.history.version.max() + 1,
                                               value: variables2.rdd_orig.value,
                                               modifiedDate: new Date()]
        variablesJson =    JsonOutput.toJson(variables2)

		
 		def products = new JsonSlurper().parseText(product_information.toString()).product_information
  		
		def builder = new JsonBuilder()
        builder {
            product_lines products.withIndex().collect { element, index -&gt;
                {
                    -&gt;
                    //use a child closure to generate JSON data for each product in the collection
                    "position" index + 1
                    product_code(last: element.productcode1, ocred: element.productcode1, mtfixed: "", ocrfixed: "")
					product_code1(last: element.productcode1, ocred: element.productcode1, mtfixed: "", ocrfixed: "")
                    product_code2(last: element.productcode2, ocred: element.productcode2, mtfixed: "", ocrfixed: "")
                    quantity(last: element.quantity, ocred: element.quantity, mtfixed: "" , ocrfixed: "")
                    gtin(last: "", rpaed: "", mtfixed: "")
                }
            }

        }
                jsonProducts = builder.toString()

	]]&gt;&lt;/script&gt;
  
	&lt;export include-original-data="true"&gt;
	&lt;single-column name="variables" value="${variablesJson}" /&gt;	
      &lt;single-column name="ship_to_name" value="${ship_to_name2}" /&gt;
		&lt;single-column name="ship_to_location" value="${ship_to_location2}" /&gt;
		&lt;single-column name="ship_to_postal_code" value="${ship_to_postal_code2}" /&gt;
		&lt;single-column name="ship_to_street_name" value="${ship_to_street_name2}" /&gt;
		&lt;single-column name="po_number" value="${po_number2}" /&gt;
        &lt;single-column name="product_lines" value="${jsonProducts}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;

</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>6f953654-6921-4484-8d6f-336974ea5956</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>export vector alignment      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>6f953654-6921-4484-8d6f-336974ea5956</uuid>
                                    <version>
                                        <componentUuid>43f44558-1989-4e52-a8f7-de3721ac83b3</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>47b0a7b0-7b36-4c96-aa74-318567a8957b</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>export vector alignment      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>5118dd5a-201f-405a-8c7c-060f0972a0b7</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>f975b0f8-1ac1-45c7-bef4-c89cf5e38440</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>346337d9-8af7-4861-b8ab-4c314a1c9068</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>18</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>46f87e09-a9b7-4109-b97a-bd228a208013</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"should_download_bw_report","value":"true","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'YES' when should_download_bw_report EQ 'true'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("should_download_bw_report", "EQ", "true"));

    then
        $ctx.sendResultTo("YES", $item);
end

# RuleOutcome.Definition={"outcomeId":"NO","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"should_download_bw_report","value":"false","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'NO' when should_download_bw_report EQ 'false'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("should_download_bw_report", "EQ", "false"));

    then
        $ctx.sendResultTo("NO", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>Should download BW report</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>dbcdd926-c14c-4f75-ac8a-844c063e1c20</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
   &lt;!-- retrieve S3 credentials --&gt;
   &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name2", "${s3_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name2}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName2 = secure_store_name2.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName2);
      accessKey = obj.getKey().toString();
      secretKey = obj.getValue().toString();
   ]]&gt;&lt;/script&gt;  
  
   &lt;script&gt;&lt;![CDATA[
		import com.workfusion.utils.client.AmazonUtils;
		import com.amazonaws.auth.BasicAWSCredentials;
		import com.amazonaws.services.s3.model.CannedAccessControlList;
		import com.amazonaws.services.s3.model.PutObjectRequest
		import com.amazonaws.services.s3.model.S3ObjectSummary
		import com.amazonaws.services.s3.model.ObjectMetadata

		import java.time.Instant;

		class SapBwS3Cache {
			private String accessKey
			private String secretKey
			private String endpointUrl
			private String bucket
			private String pathToFile
			private int fileExpirationDateMinutes

			private s3Client

			SapBwS3Cache(String accessKey, String secretKey, String endpointUrl, String bucket, String pathToFile, int fileExpirationDateMinutes) {
				this.accessKey = accessKey
				this.secretKey = secretKey
				this.endpointUrl = endpointUrl
				this.bucket = bucket
				this.pathToFile = pathToFile
				this.fileExpirationDateMinutes = fileExpirationDateMinutes
				this.initialize()
			}

			boolean shouldDownloadAgain() {
				if (!doesFileExists() || isFileExpired()) {
					return true
				}
				return false
			}

			boolean isFileExpired() {
				if (!doesFileExists()) {
					return true
				}
				ObjectMetadata obj = s3Client.getObjectMetadata(bucket, pathToFile)
				// if today - expiration date is AFTER file creation date, that means that file is older than we allow it to be
				return Instant.now().minusSeconds(fileExpirationDateMinutes * 60).isAfter(getFileCreationDate(obj))
			}

			private void initialize() {
				def awsCredentials = new BasicAWSCredentials(accessKey, secretKey);
				this.s3Client = AmazonUtils.createS3Client(awsCredentials, endpointUrl, AmazonUtils.S3_SIGNER);
			}

			private boolean doesFileExists() {
				return s3Client.doesObjectExist(bucket, pathToFile)
			}

			private Instant getFileCreationDate(ObjectMetadata obj) {
				return obj.getLastModified().toInstant();
			}

			private void deleteFile() {
				s3Client.deleteObject(bucket, pathToFile)
			}
		}

		def cache = new SapBwS3Cache(accessKey, secretKey, s3_endpoint_url.toString(),
				s3_attachments_bucket.toString(), "temp/NE_SapBW_report_NE.xls", 1*24*60);

		should_download_bw_report = cache.shouldDownloadAgain()

		if (should_download_bw_report == true) {
			cache.deleteFile()
		}
	]]&gt;&lt;/script&gt;
	&lt;export include-original-data="true"&gt;
  		&lt;single-column name="should_download_bw_report" value="${should_download_bw_report}" /&gt;
  	&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>e29675fa-9d58-410a-b851-990785ee2891</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[115] Check S3 BW Report Cache      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>e29675fa-9d58-410a-b851-990785ee2891</uuid>
                                    <version>
                                        <componentUuid>43f62a58-bc99-4ab2-85e3-08aa48d58b48</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>6b439024-b944-4f3a-9cf3-7b912088a6ca</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[115] Check S3 BW Report Cache      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>fcbcd118-ae9a-4de9-a04a-28938e6c9f08</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>7e5991da-cf2e-48be-b87b-64501340c949</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>c0f5f704-ef06-45b3-b5a8-47e67359fd2f</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>19</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>9b645492-be31-4032-a3ae-8ee154d69b76</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>bd9ebab9-bdad-4a9e-bd57-3791f937247f</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
   &lt;!-- retrieve shared drive credentials --&gt;
   &lt;script&gt;&lt;![CDATA[
      sys.defineVariable("secure_store_name2", "${shared_drive_secure_store_id}") 
   ]]&gt;&lt;/script&gt;

   &lt;secure-store-get alias="${secure_store_name2}"/&gt;
   &lt;script&gt;&lt;![CDATA[
      String secureStoreName2 = secure_store_name2.toString();
      Map entryMap = secureEntryMap.getWrappedObject();
      com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName2);
      sharedDriveUser = obj.getKey().toString();
      sharedDrivePass = obj.getValue().toString();
   ]]&gt;&lt;/script&gt;  

   &lt;script&gt;&lt;![CDATA[
		import java.io.FileOutputStream;
		import java.io.InputStream;
		import java.io.IOException;
		import java.io.File;
		import java.util.Date;

		import jcifs.smb.NtlmPasswordAuthentication;
		import jcifs.smb.SmbFile;
		import org.apache.commons.io.IOUtils;

		def inputStreamToByteArray = {InputStream is -&gt;
			return IOUtils.toByteArray(is);
		}
		
		def milisToHours = {long milis -&gt;
			return milis / 1000 / 60 / 60;
		}
		
		def milisToMinutes = {long milis -&gt;
			return milis / 1000 / 60;
		}

		//This returns true if file on local drive does not exist or is older 
		//(in terms of last modified date) than one hour//a day.
		def shouldCopyFromSharedDrive = { String sourcePath -&gt;
			File source = new File(sourcePath);
			long lastModified = milisToHours(source.lastModified());
			
			//if file doesnt exist
			if (lastModified == 0) {
				return true;
			}
			
			long timeNow = milisToHours(new Date().getTime());
			
			// if older than a day
			if (timeNow - lastModified &gt; 1) { //was "&gt; 24"
				return true;
			}
			
			return false;
		}

		def copyFromSharedDriveToLocal = {String user, String password, String sourcePath, String destinationPath -&gt;
			NtlmPasswordAuthentication auth = new NtlmPasswordAuthentication(null, user, password);

			try {
            log.error("user:'" + user + "' password:'" + password + "'");
				SmbFile source = new SmbFile(sourcePath, auth);
				String destination = destinationPath;// + "/" + source.getName();
            log.error("input:'" + sourcePath + "' target:'" + destination + "'");
				
				File yourFile = new File(destination);
				yourFile.createNewFile(); // if file already exists will do nothing 

				FileOutputStream fos = new FileOutputStream(destination);
				byte[] bytes = inputStreamToByteArray(source.getInputStream());
				fos.write(bytes);
				fos.close();
			} catch (Exception e) {
				//System.out.println(e.getMessage());
            log.error("Copying error:" + e.getMessage());
			}
		}
		
		def shouldCopy = shouldCopyFromSharedDrive(temp_directory.toString() + "/" + cfg_gtin_mapping_filename.toString())

		//if (shouldCopy == true) {
		//customer codes excel
			copyFromSharedDriveToLocal("eu\\" + sharedDriveUser,
				sharedDrivePass,
				gtin_maping_xlsx_uri.toString(),
				temp_directory.toString() + "/" + cfg_gtin_mapping_filename.toString());

		//customers excel

		shouldCopy = shouldCopyFromSharedDrive(temp_directory.toString() + "/" + cfg_gtin_customers_mapping_filename.toString())

			copyFromSharedDriveToLocal("eu\\" + sharedDriveUser,
				sharedDrivePass,
				gtin_maping_customers_xlsx_uri.toString(),
				temp_directory.toString() + "/" + cfg_gtin_customers_mapping_filename.toString());


		//}
	]]&gt;&lt;/script&gt;
  
	&lt;export include-original-data="true"&gt;&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>0a1c497d-9e71-48a8-9609-d68fd12353a3</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Customer Codes cache      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>0a1c497d-9e71-48a8-9609-d68fd12353a3</uuid>
                                    <version>
                                        <componentUuid>48a8fb94-3b66-4f0d-9368-0f2b031b26a8</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>6b9f152a-08ec-426a-8757-5a808c7be46d</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Customer Codes cache      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>1d9edabe-202e-4ad5-a249-326b570b6d0f</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9335a208-2ed4-442b-99f0-21d7c3f72749</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>8e105215-2eea-478e-a41d-68c7319cdbab</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>20</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>b3d51958-d38f-4e28-8b7f-10c4b7570f9b</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>bc1dbf97-f64c-4b18-9463-19548323c2a8</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <description>Miscellaneous Tasks</description>
                                <executingType>HUMAN</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <question>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Sales Organization</answer>
                                            <answerCode>sales_area_id</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['sales_area_id']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Distribution channel ID:</answer>
                                            <answerCode>distribution_channel_id</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['distribution_channel_id']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Ship to ID</answer>
                                            <answerCode>ship_to_id</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['ship_to_id']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Products:</answer>
                                            <answerCode>products_json</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                <code>GRID</code>
                                                <description>Grid</description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Grid</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['products_json']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>products</htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Product code 1</answer>
                                            <answerCode>product_code1</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>5</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Product code 2</answer>
                                            <answerCode>product_code2</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>6</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>gtin</answer>
                                            <answerCode>gtin</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-04T00:13:22Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>7</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>quantity</answer>
                                            <answerCode>quantity</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>8</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>GTIN correction</answer>
                                            <answerCode>gtin_correction</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>9</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Quantity correction</answer>
                                            <answerCode>quantity_correction</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>10</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Comment</answer>
                                            <answerCode>display_gtin</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>11</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Request delivery date (OCR-ed)</answer>
                                            <answerCode>rdd_orig</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['rdd_orig']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>disabledField</htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>12</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Request delivery date (final, to be used for SAP entry):</answer>
                                            <answerCode>rdd</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['rdd']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>13</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                            <answerCode>beyond_repair_flag</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>NO</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>no=NO|yes=YES</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>14</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>daysinfuture</answer>
                                            <answerCode>daysinfuture</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['cfg_rdd_days_after_range']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>hide</htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>15</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>daysinpast</answer>
                                            <answerCode>daysinpast</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['cfg_rdd_days_before_range']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>hide</htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>16</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <assignmentDuration>1800000</assignmentDuration>
                                    <assignmentLimit>1</assignmentLimit>
                                    <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                                    <autoApprovalDelay>432000000</autoApprovalDelay>
                                    <automaticallyProcessed>0</automaticallyProcessed>
                                    <blockSize>1</blockSize>
                                    <constQualifiedWorkers>false</constQualifiedWorkers>
                                    <currency>USD</currency>
                                    <description>Miscellaneous Tasks</description>
                                    <dynamicTaskRenderingDisabled>false</dynamicTaskRenderingDisabled>
                                    <expiredTime>2592000000</expiredTime>
                                    <faqItems/>
                                    <frameHeight>2500</frameHeight>
                                    <geolocationEnabled>false</geolocationEnabled>
                                    <instructionItems/>
                                    <keywords>Miscellaneous Tasks</keywords>
                                    <maxAssignments>1</maxAssignments>
                                    <moderation>false</moderation>
                                    <moderationFlag>false</moderationFlag>
                                    <origination>CREATED_MANUALLY</origination>
                                    <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                                    <qualificationInstruction></qualificationInstruction>
                                    <qualificationRequirements/>
                                    <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                                    <qualificationTasks>20</qualificationTasks>
                                    <qualificationTraining>false</qualificationTraining>
                                    <questionRuleMaps>
                                        <questionRuleMap>
                                            <businessRule>
                                                <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                <name>Start with one assignment 1+0 pay all</name>
                                                <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                                <ruleType>DROOLS</ruleType>
                                                <ruleTypeUI>Adjudication</ruleTypeUI>
                                                <template>
                                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                    <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                                    <name>Start with 1 assignment X+0 rule (pay all)</name>
                                                    <params>
                                                        <param>
                                                            <code>MAJORITY_VALUE</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Number of correct answers</description>
                                                            <name>Majority value</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>70</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                            <name>Worst accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                            <name>Worst accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>95</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                            <name>Super accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>80</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                            <name>Normal accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAX_ASSIGNMENT_LIMIT</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Maximum number of assignments</description>
                                                            <name>Max assignments limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                            <name>Super accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Normal accuracy level lower limit in percents inclusive</description>
                                                            <name>Normal accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>CHECK_EVERY</code>
                                                            <defaultValue>5</defaultValue>
                                                            <description>Check every i-th gold question when evaluating qualification score</description>
                                                            <name>Check every i-th gold question</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAJORITY_HIT_THRESHOLD</code>
                                                            <defaultValue>100</defaultValue>
                                                            <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                            <name>Percent of correct answers</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Normal accuracy level upper limit in percents exclusive</description>
                                                            <name>Normal accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                    </params>
                                                </template>
                                                <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                                            </businessRule>
                                        </questionRuleMap>
                                    </questionRuleMaps>
                                    <radiusSelector>ExactLocation</radiusSelector>
                                    <randomizeAnswers>false</randomizeAnswers>
                                    <recursiveThreshold>1</recursiveThreshold>
                                    <restrictedCountries/>
                                    <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                                    <templates>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  
  &lt;style&gt;
      .valid {
        font-weight: bold;
        color: green;
    }

    .not-valid {
        font-weight: bold;
        color: red;
    }
    
    /*.products td:first-child {
      cursor: not-allowed;
      background-color:#eeeeee;
      pointer-events:none;
    }*/
    
    td input {
      background-color: red; 
    }
    
    #err_placeholder table {
    border-collapse: collapse;
}

#err_placeholder table,#err_placeholder th,#err_placeholder td {
    border: 1px solid black;
}
    
  &lt;/style&gt;
  
&lt;@instructions title="&lt;h2&gt;RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             &lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;               
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;&lt;br&gt;&lt;strong&gt;Document link:&amp;nbsp;&lt;a href="https://wfapp-dev.workfusion.pg.com/workfusion/secure/business-process/edit/$%7Bquestion.data['document_link']%7D" target="_blank" data-mce-href="$%7Bquestion.data['document_link']%7D"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;&lt;/strong&gt;&lt;table style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;" border="2" width="604" data-mce-style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;"&gt;&lt;caption&gt;&amp;nbsp;&lt;/caption&gt;&lt;tbody&gt;&lt;tr style="height: 17.6px;" data-mce-style="height: 17.6px;"&gt;&lt;td style="width: 146.8px; text-align: center; height: 17.6px;" data-mce-style="width: 146.8px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Customer name&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Address&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;City&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Zip code&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 17px;" data-mce-style="height: 17px;"&gt;&lt;td style="width: 146.8px; height: 17px;" data-mce-style="width: 146.8px; height: 17px;"&gt;${question.data['ship_to_name']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_street_name']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_location']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_postal_code']}&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 71.5999984741211px; height: 4px; width: 864px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 71.5999984741211px; height: 4px; width: 864px; " data-row="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 92.5999984741211px; height: 4px; width: 864px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 92.5999984741211px; height: 4px; width: 864px; " data-row="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 193.40000915527344px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 193.40000915527344px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 426.20001220703125px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 426.20001220703125px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 632.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 632.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="2"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 862.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 862.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="3"&gt;&lt;/div&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;!--div id="err_placeholder"&gt;&lt;/div--&gt;
                  &lt;div id="error_div"&gt; ${question.data['error_table']}&lt;/div&gt;
                 &lt;br&gt;&lt;br&gt;
                 &lt;@answers question=question/&gt;
                 &lt;script&gt;
                   $(document).ready(function() {

                     $('input[name*="beyond_repair_flag"]').change(function()&#160;{
&#160;&#160;&#160;					&#160;if&#160;(this.value&#160;==&#160;'YES')&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;			
						for (var i = 0; i &lt; GRID.Main.originalColumnConfiguration().length; i++) {
						var item = GRID.Main.originalColumnConfiguration()[i];
						if (item["required"] == "true") {
							GRID.Main.originalColumnConfiguration()[i]["required"] = "false";
						}
					}

&#160;&#160;&#160;&#160;			}
&#160;&#160;&#160;&#160;			else&#160;if&#160;(this.value&#160;==&#160;'NO')&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;				for (var i = 0; i &lt; GRID.Main.originalColumnConfiguration().length; i++) {
						   var item = GRID.Main.originalColumnConfiguration()[i];
						   if (item["required"] == "false") {
							  GRID.Main.originalColumnConfiguration()[i]["required"] = "true";
						   }
					   }&#160;
				&#160;&#160;&#160;&#160;}
				});
                  
                      function _getTable(tableId) {
                           const tableDivParent = $("[id*='" + tableId + "']");
                           
                           return tableDivParent.find("table");
                      }
                      
                      function _makeReadOnly(obj) {
                          obj.css('cursor', "not-allowed");
                          obj.css('background-color', "#eeeeee");
                          obj.css('pointer-events', 'none');
                      }
                      
                      // index of n is 0-based
                      function makeNthColumnReadOnly(tableId, n) {
                          const table = _getTable(tableId);
                  		  
                          return () =&gt; {
                            console.log("nth read only " + tableId + " " + n);
                          	table.find("tr").each(function() {
                              	const cell = $(this).find("td:eq(" + n + ")");
                              	//to get the innerText: cell.context.innerText 
                              	_makeReadOnly(cell);
                          	});
                      	  };
                      }
                  
                      window.setInterval(makeNthColumnReadOnly("products", 0), 1500);
                      window.setInterval(makeNthColumnReadOnly("products", 1), 1500);
                      window.setInterval(makeNthColumnReadOnly("products", 2), 1500);
                      window.setInterval(makeNthColumnReadOnly("products", 5), 1500);
                     
                      //window.setInterval(makeNthColumnReadOnly("error", 0), 1500);
                   
                      $(".disabledField input").prop(&#160;"disabled",&#160;true&#160;);
                     
                      //makeTitle();
                    /* var jsonErr =  ${question.data['error_list_json']}.error_list_json;
                     var tabl = '&lt;table&gt;&lt;tr&gt;&lt;th&gt;Error row&lt;/th&gt;&lt;th&gt;Error description&lt;/th&gt;&lt;/tr&gt;';
                     
                     for(var i = 0; i&lt; jsonErr.length;i++){
                       var rowErr = jsonErr[i];
                       tabl += '&lt;tr&gt;&lt;td&gt;'+i+'&lt;/td&gt;&lt;td&gt;'+jsonErr[i].error+'&lt;/td&gt;&lt;/tr&gt;';
                     }
                     
                     tabl += '&lt;/table&gt;';
                     
                     $("#err_placeholder").html(tabl);*/
                     
                  });
                 &lt;/script&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;
  
   &lt;script&gt;
  $(document).ready(function(){

  $("input[id$='rdd']").addClass( "rddDateFormat" ); 
  });
    
 $(".disabledField input").prop(&#160;"disabled",&#160;true&#160;);

 $.validator.addMethod(
    "rddDateFormat",
    function(value, element) {
        var re = /^\d{1,2}.\d{1,2}.\d{4}$/;

      if(value.trim().toLowerCase()==='asap' || value.trim().toLowerCase()==='a.s.a.p.') return true;
      if((this.optional(element) &amp;&amp; value=="") || !re.test(value) ) return false;
      
var past=$("input[id*='daysinpast']").val();    
var future=$("input[id*='daysinfuture']").val();
 


      var today = new Date();
      var dateInFuture = new Date();
dateInFuture.setDate(today.getDate()+parseInt(future));

 
 var dateInPast = new Date();
 dateInPast.setDate(today.getDate()-parseInt(past));
      
     
var parts = value.split(".");
var testDate = new Date(parseInt(parts[2], 10),
                  parseInt(parts[1], 10) - 1,
                  parseInt(parts[0], 10));

      if(testDate &gt;= dateInPast &amp;&amp; testDate&lt;=dateInFuture ){
        return true
}    else{
    return false
}
      
   // },"Please provide valid RDD in given range or ASAP value. Proper format dd.MM.YYYY not earlier then "+ future+ " days and not later then "+ past+" days"
    }, function(param, element) {
     
      var past=$("input[id*='daysinpast']").val();
	 var future=$("input[id*='daysinfuture']").val();
      
      

      
       var today = new Date();
      var dateInFuture = new Date();
dateInFuture.setDate(today.getDate()+parseInt(future));

 
 var dateInPast = new Date();
 dateInPast.setDate(today.getDate()-parseInt(past));  
      
      return "Please provide date in format dd.MM.YYYY, after "+ dateInPast.getDate()+"."+(dateInPast.getMonth()+1)+"."+dateInPast.getFullYear()+ " and till "+ dateInFuture.getDate()+"."+(dateInFuture.getMonth()+1)+"."+dateInFuture.getFullYear()+ " or asap";
     }
);
   
    
    
var rules = {};
$("input[name*='rdd']").each(function(v,i) {
   rules[v.name] = {
        required: true,
        maxlength: 1,
           messages: {
            required: "Required input",
            minlength: jQuery.format("At least {0} characters are necessary")
        }
   };
});    
    
$('#mainform').validate({
  rules: rules
});   
    
&lt;/script&gt;</content>
                                            <name>RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             </name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>TASK</type>
                                            <uuid>57922775-31ac-4a87-9fa7-585d68d68c18</uuid>
                                            <version>
                                                <componentUuid>7eb5ead5-8db3-4067-8336-d9fd6811226c</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <versionUuid>26abde49-d996-48ed-abb9-8ac9d140a33a</versionUuid>
                                            </version>
                                        </template>
                                    </templates>
                                    <title>RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             </title>
                                    <useCommonHitCoordinates>false</useCommonHitCoordinates>
                                    <uuid>c3d05721-7dc1-48a3-8b2d-d921936c692b</uuid>
                                    <version>
                                        <componentUuid>020e56e3-0b86-41ed-a919-e140c6302214</componentUuid>
                                        <incrementalVersion>1.3</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-04T00:13:24Z</lastModified>
                                        <versionUuid>aaa444ba-9529-45a7-9f18-1ab0c2ca4920</versionUuid>
                                    </version>
                                    <workSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>HUMAN</executingType>
                                            <name>RPA</name>
                                            <private>false</private>
                                            <publicId>87f6ce2c-9f18-43ca-a652-e7e038dfd6cd</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Deriviation fix</name>
                                        <publicId>4685dd2b-82ca-4cae-99be-14cf2aea9489</publicId>
                                        <version>
                                            <componentUuid>d7d96182-424e-4644-833a-e8358203131a</componentUuid>
                                            <incrementalVersion>1.1</incrementalVersion>
                                            <lastInChain>false</lastInChain>
                                            <lastModified>2018-05-15T07:01:14Z</lastModified>
                                            <versionUuid>c01e4dbb-1604-491f-a38c-1772be368782</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to name</answer>
                                                <answerCode>ship_to_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_name']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to location</answer>
                                                <answerCode>ship_to_location</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_location']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to postal code</answer>
                                                <answerCode>ship_to_postal_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_postal_code']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to street name</answer>
                                                <answerCode>ship_to_street_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_street_name']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Sales area ID</answer>
                                                <answerCode>sales_area_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['sales_area_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Distribution channel ID:</answer>
                                                <answerCode>distribution_channel_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['distribution_channel_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to ID</answer>
                                                <answerCode>ship_to_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product code</answer>
                                                <answerCode>product_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>9</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>gtin</answer>
                                                <answerCode>gtin</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>quantity</answer>
                                                <answerCode>quantity</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>11</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request delivery date (OCR-ed)</answer>
                                                <answerCode>rdd_orig</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['rdd_orig']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>12</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request delivery date (manually-fixed):</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['rdd']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>13</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                                <answerCode>beyond_repair_flag</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>NO</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>no=NO|yes=YES</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>14</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <businessRules/>
                                        <isPrivate>false</isPrivate>
                                        <items>
                                            <item>
                                                <type>AUTOMATICALLY_APPROVED</type>
                                                <value>2592000000</value>
                                            </item>
                                            <item>
                                                <type>HIT_EXPIRES_IN</type>
                                                <value>31536000000</value>
                                            </item>
                                            <item>
                                                <type>RECURSIVE_THRESHOLD</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>FRAME_HEIGHT</type>
                                                <value>2500</value>
                                            </item>
                                            <item>
                                                <type>KEYWORDS</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>TIME_PER_ASSIGNMENT</type>
                                                <value>900000</value>
                                            </item>
                                            <item>
                                                <type>LIMIT_NUMBER_ASSIGNMENTS</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_PROCESSED</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>PENDING_ASSIGNMENTS_LIMIT</type>
                                                <value>10</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENTS_PER_HIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>BLOCK_SIZE</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENT_LIMIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>DESCRIPTION</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATION_REQUIREMENTS</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>EXTERNAL_URL</type>
                                                <value>https://wfapp.workfusion.pg.com/workfusion/public/HTMLRenderer</value>
                                            </item>
                                            <item>
                                                <type>RESTRICTED_COUNTRIES</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>REQUIRED_FOR_PREVIEW</type>
                                                <value>false</value>
                                            </item>
                                            <item>
                                                <type>ADJUDICATION_RULE</type>
                                                <value>3</value>
                                            </item>
                                        </items>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="Extract data from Excel"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Email:&amp;nbsp;&lt;a href="${question.data['eml_file_location']}" data-mce-href="${question.data['eml_file_location']}"&gt;${question.data['eml_file_location']}&lt;br&gt;&lt;/a&gt;Order:&amp;nbsp;&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;Error message/List of multi-sheet order:&amp;nbsp;${question.data['error_message']}&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Miscellaneous Tasks (Blank)</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE</type>
                                            <uuid>6778197e-5123-4587-9bfd-0fe361b1ac23</uuid>
                                            <version>
                                                <componentUuid>b440737a-1966-46d2-953d-e1fef74fd055</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2017-09-13T22:42:01Z</lastModified>
                                                <versionUuid>a26c02b9-0130-4b3c-9f8e-0bddd14f8819</versionUuid>
                                            </version>
                                        </template>
                                    </workSetting>
                                    <workSpacePreviewData>[{"name":"created","value":"${question.data['creation_sorting_dttm']}"},{"name":"customer","value":"${question.data['ship_to_name']}"},{"name":"city","value":"${question.data['ship_to_location']}"},{"name":"rdd","value":"${question.data['order_sorting_date']}"},{"name":"po_number","value":"${question.data['po_number']}"},{"name":"id","value":"${question.data['uuid']}-${question.data['mail_id']}"}]</workSpacePreviewData>
                                    <workSpacePreviewScheme>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Created</answer>
                                                <answerCode>created</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:48Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Customer</answer>
                                                <answerCode>customer</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>City</answer>
                                                <answerCode>city</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:26Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>RDD</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:20Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>PO number</answer>
                                                <answerCode>po_number</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:47Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Id</answer>
                                                <answerCode>id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:01Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <description></description>
                                        <id>144</id>
                                        <name>DACH - manual task sorting for RPA fix 0.5 v.2</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <uuid>6d272ab0-6c38-4a67-8d36-ed159e8773e8</uuid>
                                    </workSpacePreviewScheme>
                                </question>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>777a0cbb-40c3-4cb0-b5b4-00ad1cc843fa</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>bba07551-edd0-4d12-ad6d-5593ae5ca66f</componentUuid>
                                    <incrementalVersion>1.3</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-04T00:13:24Z</lastModified>
                                    <versionUuid>e42ffe8e-2644-4485-8b7a-57419d321650</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>21</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>cd12c91b-c505-4831-b1d5-d760197b7429</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>6da90d7c-8d4e-47f7-b36e-9e5f56747c25</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
	&lt;script&gt;&lt;![CDATA[
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
		import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

		def poNum = null;
		if (po_number.toString() != null) {
			if (!po_number.toString().equals("")) {
				poNum = po_number.toString();
			}
		}

		def shipToName = null;
		if (ship_to_name.toString() != null) {
			if (!ship_to_name.toString().equals("")) {
				shipToName = ship_to_name.toString();
			}
		}

		id = "[${uuid}-${mail_id}]";

		RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		sandbox = run.isSandbox()?"Sandbox":"Production";

		emailFrom = confirmation_email_from.toString();
		emailTo = confirmation_email_recipient.toString();

  		emailSubject = "[RPA][NE][action required] " +
            "RPA &gt; Derivation fix task for " + 
			(poNum?("purchase order " + poNum):"order") +
			" from " +
			((shipToName?:"unknown customer")).replaceAll("[\n\r]+", "");

		emailBody = """
			Dear team,&lt;br/&gt;
			&lt;br/&gt;
   			There was a &lt;b&gt;RPA Derivation fix v.0.5&lt;/b&gt; manual task generated for you.&lt;/br&gt;
   			Please navigate to &lt;a href="https://wfapp-dev.workfusion.pg.com/workspace/"&gt;Workfusion Workspace&lt;/a&gt;&lt;br/&gt;
			Should you have any questions or comments, please contact &lt;a href="mailto:dachrpa@hpe.com"&gt;DevOps team&lt;/a&gt; referring following details
			&lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order pickup server datetime&lt;/td&gt;&lt;td&gt;${creation_sorting_dttm}&lt;/td&gt;&lt;/tr&gt;
    			&lt;tr&gt;&lt;td&gt;environment&lt;/td&gt;&lt;td&gt;${sandbox}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
		""";
	]]&gt;&lt;/script&gt;

	&lt;mail smtp-host="${smtp_server_host}" type="html" smtp-port="${smtp_server_port}" from="${emailFrom}"
		to="${emailTo}" subject="${emailSubject}"&gt;
		&lt;template&gt;&lt;![CDATA[
			${emailBody}
		]]&gt;&lt;/template&gt;
	&lt;/mail&gt;

	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>ef3f224a-fbf8-4ca7-9419-7acbed711a99</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[175] Notify on manual task      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>ef3f224a-fbf8-4ca7-9419-7acbed711a99</uuid>
                                    <version>
                                        <componentUuid>c29eee64-9871-483c-8de9-18848ed35da1</componentUuid>
                                        <incrementalVersion>1.4</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-05T09:28:28Z</lastModified>
                                        <versionUuid>15fba616-40d9-4de8-9d17-528f99017c46</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[175] Notify on manual task      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>6312de5d-46f2-4bd3-bf27-52d116c59c43</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>3901664b-6a06-4a1f-88ee-cbaab534ab25</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-05T09:28:32Z</lastModified>
                                    <versionUuid>430ab582-8697-4c58-b415-c76d8e8e3f4e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>22</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>38e0dda0-a2a9-40d6-bbd0-eadf752c006a</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>b0fb810d-def9-4252-8838-66cd873530a3</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
	&lt;script&gt;&lt;![CDATA[
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
		import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

		id = "[${uuid}-${mail_id}]";

		RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		sandbox = run.isSandbox()?"Sandbox":"Production";

		emailFrom = confirmation_email_from.toString();
		emailTo = confirmation_email_recipient.toString();

  		emailSubject = ("[NE][DACH][info] " +
            "order picked up " + id).replaceAll("[\n\r]+", "");

		emailBody = """
			Dear team,&lt;br/&gt;
			&lt;br/&gt;
			Just an order pick-up notification -- no action required.
			&lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order pickup server datetime&lt;/td&gt;&lt;td&gt;${creation_sorting_dttm}&lt;/td&gt;&lt;/tr&gt;
    			&lt;tr&gt;&lt;td&gt;environment&lt;/td&gt;&lt;td&gt;${sandbox}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
		""";
	]]&gt;&lt;/script&gt;

	&lt;mail smtp-host="${smtp_server_host}" type="html" smtp-port="${smtp_server_port}" from="${emailFrom}"
		to="${emailTo}" subject="${emailSubject}"&gt;
		&lt;template&gt;&lt;![CDATA[
			${emailBody}
		]]&gt;&lt;/template&gt;
	&lt;/mail&gt;

	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>7bf569f8-97f6-4bad-af3a-b119c0571dc4</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[011] info notification      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>7bf569f8-97f6-4bad-af3a-b119c0571dc4</uuid>
                                    <version>
                                        <componentUuid>efe94c80-fc7c-4630-b364-2fc2b802d6c1</componentUuid>
                                        <incrementalVersion>1.5</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-05T09:28:28Z</lastModified>
                                        <versionUuid>aabdfd8e-5b3b-4350-9b5d-57a11fdd3284</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[011] info notification      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>7ccbda1f-f4c1-4f1b-9205-0d7c7809089c</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>4732005a-3693-4e31-ae80-bbb48aac506d</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-05T09:28:32Z</lastModified>
                                    <versionUuid>ce089eeb-a29d-4173-9d60-b816ab419819</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>23</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>0985e6f5-ce26-41a8-9db3-472a900da2dd</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>fa8008d1-0e95-461c-b8ef-d535eba3a74c</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
	&lt;script&gt;&lt;![CDATA[
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
		import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

		log.warn("failure_email_recipient: " + failure_email_recipient.toString())
		log.warn("message: " + message.toString())

		id = "[${uuid}-${mail_id}]";
		
		
		RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		sandbox = run.isSandbox()?"Sandbox":"Production";

		emailFrom = confirmation_email_from.toString();
		emailTo = failure_email_recipient.toString();

  		emailSubject = ("[RPA][NE][error] " +
            "order not picked up " + id).replaceAll("[\n\r]+", "");

		emailBody = """
			Dear team,&lt;br/&gt;
			&lt;br/&gt;
			We couldn&#8217;t process your request due to: ${message}
			&lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order pickup server datetime&lt;/td&gt;&lt;td&gt;${creation_sorting_dttm}&lt;/td&gt;&lt;/tr&gt;
    			&lt;tr&gt;&lt;td&gt;environment&lt;/td&gt;&lt;td&gt;${sandbox}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
		""";
	]]&gt;&lt;/script&gt;

	&lt;mail smtp-host="${smtp_server_host}" type="html" smtp-port="${smtp_server_port}" from="${emailFrom}"
		to="${emailTo}" subject="${emailSubject}"&gt;
		&lt;template&gt;&lt;![CDATA[
			${emailBody}
		]]&gt;&lt;/template&gt;
	&lt;/mail&gt;

	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>712c6f9a-295c-4cdc-bb39-946bfe3b6e2e</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>error notification      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>712c6f9a-295c-4cdc-bb39-946bfe3b6e2e</uuid>
                                    <version>
                                        <componentUuid>3becd807-2e9f-46da-8174-62289017eaec</componentUuid>
                                        <incrementalVersion>1.7</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-05T09:28:28Z</lastModified>
                                        <versionUuid>e4027300-80b9-4f52-8ea7-25305db73973</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>error notification      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>46cb7cd6-b82c-4e1a-ad9d-a4eb9728e60a</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>63957085-0b4d-4c5b-912c-b7b48313c306</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-05T09:28:32Z</lastModified>
                                    <versionUuid>557ac464-b8ca-47b0-b1a9-f40db9d8e752</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>24</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>43191204-e7bc-4eb7-a1db-cb14ccc3cdb1</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES(MSG)","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"drv_valid_to_process_flag","value":"YES","operator":"EQ"},{"fieldName":"cfg_pickup_mail","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'YES(MSG)' when drv_valid_to_process_flag EQ 'YES' AND cfg_pickup_mail EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("drv_valid_to_process_flag", "EQ", "YES"));
        eval($item.checkValue("cfg_pickup_mail", "EQ", "YES"));

    then
        $ctx.sendResultTo("YES(MSG)", $item);
end

# RuleOutcome.Definition={"outcomeId":"NO","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"drv_valid_to_process_flag","value":"NO","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'NO' when drv_valid_to_process_flag EQ 'NO'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("drv_valid_to_process_flag", "EQ", "NO"));

    then
        $ctx.sendResultTo("NO", $item);
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"cfg_pickup_mail","value":"NO","operator":"EQ"},{"fieldName":"drv_valid_to_process_flag","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "3. Send records to 'YES' when cfg_pickup_mail EQ 'NO' AND drv_valid_to_process_flag EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("cfg_pickup_mail", "EQ", "NO"));
        eval($item.checkValue("drv_valid_to_process_flag", "EQ", "YES"));

    then
        $ctx.sendResultTo("YES", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>email valid?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>30fb75f7-1821-42b2-9488-7542b65c468d</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
   &lt;script&gt;&lt;![CDATA[
     	message=""
     	validToProcess="YES";
    	//check sender
    	if(cfg_valid_sender_list==null || !cfg_valid_sender_list.toString().contains(sender.toString()))
    	{
    	validToProcess="NO";
    	message="Email address not present on whitelist"
    	}
    	
   		 //check attachement
     	if(document_link==null || document_link.toString().isEmpty())
    	{
    	validToProcess="NO";
    	message="Email should contain one valid pdf attachement"
    	}

      //change recepient for email			
      if(confirmation_email_recipient!=null &amp;&amp; !confirmation_email_recipient.toString().isEmpty()){
      sys.defineVariable("confirmation_email_recipient", sender.toString()+","+confirmation_email_recipient.toString()) 
      }
      else {
      sys.defineVariable("confirmation_email_recipient", sender.toString()) 
      }

      if(failure_email_recipient!=null &amp;&amp; !failure_email_recipient.toString().isEmpty()){
       sys.defineVariable("failure_email_recipient", sender.toString()+","+failure_email_recipient.toString()) 
      }
      else {
       sys.defineVariable("failure_email_recipient", sender.toString()) 
      }    
   ]]&gt;&lt;/script&gt;  

	&lt;script&gt;&lt;![CDATA[
		log.warn("validToProcess: " + validToProcess)
		log.warn("message: " + message.toString())
        log.warn("confirmation_email_recipient: " + confirmation_email_recipient)
        log.warn("failure_email_recipient: " + failure_email_recipient)
	]]&gt;&lt;/script&gt;
		&lt;export include-original-data="true"&gt;
		&lt;single-column name="confirmation_email_recipient" value="${confirmation_email_recipient}" /&gt;
		&lt;single-column name="failure_email_recipient" value="${failure_email_recipient}" /&gt;
    	&lt;single-column name="drv_valid_to_process_flag" value="${validToProcess}" /&gt;
    	&lt;single-column name="message" value="${message}" /&gt;
	&lt;/export&gt;

&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>36257d5e-e88a-4523-be3b-b560ec3104ab</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Validate email      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>36257d5e-e88a-4523-be3b-b560ec3104ab</uuid>
                                    <version>
                                        <componentUuid>e90052b9-539c-4b66-8c0e-663ffdc3f992</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>fa1bcb03-3b58-4a34-b5c9-79a5541b0517</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Validate email      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>b77d4466-fed1-4e26-b7a6-87ef4e0d040d</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>3be55dcb-8ea7-4e10-8ee3-2b6a4a2e678e</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>72c92635-2603-49f1-9309-cbc671843bef</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>25</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>defb0e3c-324a-4c45-87ab-06721e7a6dc0</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>b4de2232-abbe-4cae-ba38-b5c28b6bd968</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
	&lt;script&gt;&lt;![CDATA[
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
		import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

		def poNum = null;
		if (po_number.toString() != null) {
			if (!po_number.toString().equals("")) {
				poNum = po_number.toString();
			}
		}

		def shipToName = null;
		if (ship_to_name.toString() != null) {
			if (!ship_to_name.toString().equals("")) {
				shipToName = ship_to_name.toString();
			}
		}

		id = "[${uuid}-${mail_id}]";

		RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		sandbox = run.isSandbox()?"Sandbox":"Production";

		emailFrom = confirmation_email_from.toString();
		emailTo = confirmation_email_recipient.toString();

  		emailSubject = "[RPA][NE][action required] " +
            "RPA &gt; ShipTo Derivation fix task for " + 
			(poNum?("purchase order " + poNum):"order") +
			" from " +
			((shipToName?:"unknown customer")).replaceAll("[\n\r]+", "");

		emailBody = """
			Dear team,&lt;br/&gt;
			&lt;br/&gt;
   			There was a &lt;b&gt;Ship to data fix&lt;/b&gt; manual task generated for you.&lt;/br&gt;
   			Please navigate to &lt;a href="https://wfapp-dev.workfusion.pg.com/workspace/"&gt;Workfusion Workspace&lt;/a&gt;&lt;br/&gt;
			Should you have any questions or comments, please contact &lt;a href="mailto:dachrpa@hpe.com"&gt;DevOps team&lt;/a&gt; referring following details
			&lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order pickup server datetime&lt;/td&gt;&lt;td&gt;${creation_sorting_dttm}&lt;/td&gt;&lt;/tr&gt;
    			&lt;tr&gt;&lt;td&gt;environment&lt;/td&gt;&lt;td&gt;${sandbox}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
		""";
	]]&gt;&lt;/script&gt;

	&lt;mail smtp-host="${smtp_server_host}" type="html" smtp-port="${smtp_server_port}" from="${emailFrom}"
		to="${emailTo}" subject="${emailSubject}"&gt;
		&lt;template&gt;&lt;![CDATA[
			${emailBody}
		]]&gt;&lt;/template&gt;
	&lt;/mail&gt;

	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>6a6054f3-08e8-4a40-b5f2-7f6e6015ecfd</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Notify on manual task - shipTo      32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>6a6054f3-08e8-4a40-b5f2-7f6e6015ecfd</uuid>
                                    <version>
                                        <componentUuid>b5c67adb-f0bb-4c27-91d2-d9bc972d28ed</componentUuid>
                                        <incrementalVersion>1.6</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-05T09:28:28Z</lastModified>
                                        <versionUuid>30892d50-d59e-4c05-88eb-992f380d8b51</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Notify on manual task - shipTo      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>386af1fd-31f1-459f-a7a2-4620e2a50536</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>628572e8-7a6c-4dee-8384-05b70ff2d723</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-05T09:28:32Z</lastModified>
                                    <versionUuid>ae85e3ee-795e-4038-84ba-e2b3abf5015f</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>26</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>9db529ed-81cf-4e8e-bc27-b091fff65a36</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>3061b6e1-8249-4448-987d-c3eb84278fc5</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>HUMAN</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <question>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Sales Organization</answer>
                                            <answerCode>sales_area_id</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['sales_area_id']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Distribution channel ID:</answer>
                                            <answerCode>distribution_channel_id</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['distribution_channel_id']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Ship-to Number</answer>
                                            <answerCode>ship_to_id</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['ship_to_id']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                            <answerCode>beyond_repair_flag</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>NO</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>no=NO|yes=YES</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <assignmentDuration>900000</assignmentDuration>
                                    <assignmentLimit>1</assignmentLimit>
                                    <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                                    <autoApprovalDelay>2592000000</autoApprovalDelay>
                                    <automaticallyProcessed>0</automaticallyProcessed>
                                    <blockSize>1</blockSize>
                                    <constQualifiedWorkers>false</constQualifiedWorkers>
                                    <currency>USD</currency>
                                    <description>Miscellaneous Tasks</description>
                                    <dynamicTaskRenderingDisabled>true</dynamicTaskRenderingDisabled>
                                    <expiredTime>31536000000</expiredTime>
                                    <faqItems/>
                                    <frameHeight>2500</frameHeight>
                                    <geolocationEnabled>false</geolocationEnabled>
                                    <instructionItems/>
                                    <keywords>Miscellaneous Tasks</keywords>
                                    <maxAssignments>1</maxAssignments>
                                    <moderation>false</moderation>
                                    <moderationFlag>false</moderationFlag>
                                    <origination>CREATED_MANUALLY</origination>
                                    <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                                    <qualificationInstruction></qualificationInstruction>
                                    <qualificationRequirements/>
                                    <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                                    <qualificationTasks>20</qualificationTasks>
                                    <qualificationTraining>false</qualificationTraining>
                                    <questionRuleMaps>
                                        <questionRuleMap>
                                            <businessRule>
                                                <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                <name>Start with one assignment 1+0 pay all</name>
                                                <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                                <ruleType>DROOLS</ruleType>
                                                <ruleTypeUI>Adjudication</ruleTypeUI>
                                                <template>
                                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                    <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                                    <name>Start with 1 assignment X+0 rule (pay all)</name>
                                                    <params>
                                                        <param>
                                                            <code>MAJORITY_VALUE</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Number of correct answers</description>
                                                            <name>Majority value</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>70</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                            <name>Worst accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                            <name>Worst accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>95</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                            <name>Super accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>80</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                            <name>Normal accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAX_ASSIGNMENT_LIMIT</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Maximum number of assignments</description>
                                                            <name>Max assignments limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                            <name>Super accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Normal accuracy level lower limit in percents inclusive</description>
                                                            <name>Normal accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>CHECK_EVERY</code>
                                                            <defaultValue>5</defaultValue>
                                                            <description>Check every i-th gold question when evaluating qualification score</description>
                                                            <name>Check every i-th gold question</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAJORITY_HIT_THRESHOLD</code>
                                                            <defaultValue>100</defaultValue>
                                                            <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                            <name>Percent of correct answers</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Normal accuracy level upper limit in percents exclusive</description>
                                                            <name>Normal accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                    </params>
                                                </template>
                                                <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                                            </businessRule>
                                        </questionRuleMap>
                                    </questionRuleMaps>
                                    <radiusSelector>ExactLocation</radiusSelector>
                                    <randomizeAnswers>false</randomizeAnswers>
                                    <recursiveThreshold>1</recursiveThreshold>
                                    <restrictedCountries/>
                                    <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                                    <templates>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="&lt;h2&gt;Ship to data fix      32 [2018-08-09 10:22:56]                                             &lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Order: &lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;${question.data['document_link']}&lt;/a&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Ship to data fix      32 [2018-08-09 10:22:56]                                             </name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>TASK</type>
                                            <uuid>ac370905-bc03-495d-af06-14f6acce4924</uuid>
                                            <version>
                                                <componentUuid>cae2504a-310a-40c5-9f90-efb5375f20e2</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <versionUuid>5a5c8e7a-d1b6-417b-8382-c82e8cbb8640</versionUuid>
                                            </version>
                                        </template>
                                    </templates>
                                    <title>Ship to data fix      32 [2018-08-09 10:22:56]                                             </title>
                                    <useCommonHitCoordinates>false</useCommonHitCoordinates>
                                    <uuid>3a00429a-f9a8-4ccd-92f9-5336749ab4bb</uuid>
                                    <version>
                                        <componentUuid>7a9f4e70-31aa-4b02-8747-eac139fee404</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>2879817c-2edf-421c-95f1-b2f3ab066149</versionUuid>
                                    </version>
                                    <workSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>HUMAN</executingType>
                                            <name>RPA</name>
                                            <private>false</private>
                                            <publicId>87f6ce2c-9f18-43ca-a652-e7e038dfd6cd</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Deriviation fix</name>
                                        <publicId>7cf6f01c-056d-454e-8d4a-a81241c9e7ee</publicId>
                                        <version>
                                            <componentUuid>d7d96182-424e-4644-833a-e8358203131a</componentUuid>
                                            <incrementalVersion>1.1</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-06-18T07:49:53Z</lastModified>
                                            <versionUuid>d0109f75-0e43-4a53-ada8-194bdb2e2eea</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to name</answer>
                                                <answerCode>ship_to_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_name']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to location</answer>
                                                <answerCode>ship_to_location</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_location']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to postal code</answer>
                                                <answerCode>ship_to_postal_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_postal_code']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to street name</answer>
                                                <answerCode>ship_to_street_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_street_name']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Sales area ID</answer>
                                                <answerCode>sales_area_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['sales_area_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Distribution channel ID:</answer>
                                                <answerCode>distribution_channel_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['distribution_channel_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to ID</answer>
                                                <answerCode>ship_to_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product code</answer>
                                                <answerCode>product_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>9</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>gtin</answer>
                                                <answerCode>gtin</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>quantity</answer>
                                                <answerCode>quantity</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>11</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request delivery date (OCR-ed)</answer>
                                                <answerCode>rdd_orig</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['rdd_orig']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>12</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request delivery date (manually-fixed):</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['rdd']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>13</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                                <answerCode>beyond_repair_flag</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>NO</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-06-18T07:46:58Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>no=NO|yes=YES</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>14</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <businessRules/>
                                        <isPrivate>false</isPrivate>
                                        <items>
                                            <item>
                                                <type>AUTOMATICALLY_APPROVED</type>
                                                <value>2592000000</value>
                                            </item>
                                            <item>
                                                <type>HIT_EXPIRES_IN</type>
                                                <value>31536000000</value>
                                            </item>
                                            <item>
                                                <type>RECURSIVE_THRESHOLD</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>FRAME_HEIGHT</type>
                                                <value>2500</value>
                                            </item>
                                            <item>
                                                <type>KEYWORDS</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>TIME_PER_ASSIGNMENT</type>
                                                <value>900000</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_PROCESSED</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>LIMIT_NUMBER_ASSIGNMENTS</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>PENDING_ASSIGNMENTS_LIMIT</type>
                                                <value>10</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENTS_PER_HIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENT_LIMIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>BLOCK_SIZE</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>DESCRIPTION</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATION_REQUIREMENTS</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>EXTERNAL_URL</type>
                                                <value>https://wfapp.workfusion.pg.com/workfusion/public/HTMLRenderer</value>
                                            </item>
                                            <item>
                                                <type>RESTRICTED_COUNTRIES</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>REQUIRED_FOR_PREVIEW</type>
                                                <value>false</value>
                                            </item>
                                            <item>
                                                <type>ADJUDICATION_RULE</type>
                                                <value>3</value>
                                            </item>
                                        </items>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="Extract data from Excel"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Email:&amp;nbsp;&lt;a href="${question.data['eml_file_location']}" data-mce-href="${question.data['eml_file_location']}"&gt;${question.data['eml_file_location']}&lt;br&gt;&lt;/a&gt;Order:&amp;nbsp;&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;Error message/List of multi-sheet order:&amp;nbsp;${question.data['error_message']}&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Miscellaneous Tasks (Blank)</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE</type>
                                            <uuid>6778197e-5123-4587-9bfd-0fe361b1ac23</uuid>
                                            <version>
                                                <componentUuid>b440737a-1966-46d2-953d-e1fef74fd055</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2017-09-13T22:42:01Z</lastModified>
                                                <versionUuid>a26c02b9-0130-4b3c-9f8e-0bddd14f8819</versionUuid>
                                            </version>
                                        </template>
                                    </workSetting>
                                    <workSpacePreviewData>[{"name":"created","value":"${question.data['creation_sorting_dttm']}"},{"name":"customer","value":"${question.data['ship_to_name']}"},{"name":"city","value":"${question.data['ship_to_location']}"},{"name":"rdd","value":"${question.data['rdd_orig']}"},{"name":"po_number","value":"${question.data['po_number']}"},{"name":"id","value":"${question.data['uuid']}-${question.data['mail_id']}"}]</workSpacePreviewData>
                                    <workSpacePreviewScheme>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Created</answer>
                                                <answerCode>created</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:48Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Customer</answer>
                                                <answerCode>customer</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>City</answer>
                                                <answerCode>city</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:26Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>RDD</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:20Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>PO number</answer>
                                                <answerCode>po_number</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:47Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Id</answer>
                                                <answerCode>id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:01Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <description></description>
                                        <id>176</id>
                                        <name>DACH - manual task sorting for RPA fix 0.5 v.2</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <uuid>4a666baf-f4a4-4b50-b84e-235a736b6d8f</uuid>
                                    </workSpacePreviewScheme>
                                </question>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Ship to data fix      32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>141516f7-51a9-4983-ab17-5cdfed8142ae</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9210b805-19e4-4bc4-9283-856bf74c8e5e</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>86067dc0-610a-49e3-9c46-0a7013a54f86</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>27</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>959d8bc5-9e9c-4770-adb1-cb4ad178c870</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>a95aaeda-2eda-4778-8998-4be1269be3ff</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

	&lt;script&gt;&lt;![CDATA[
		cnt = Integer.valueOf(sap_attempts_cnt.toString()) - 1;
		log.warn("cnt=" + cnt);
	]]&gt;&lt;/script&gt;
  
	&lt;export include-original-data="true"&gt;
        &lt;single-column name="sap_attempts_cnt" value="${cnt}"/&gt;
	&lt;/export&gt;
&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>013429a4-7be1-459d-9e22-14a6510c5943</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>sapAttemptsCnt decrement  32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>013429a4-7be1-459d-9e22-14a6510c5943</uuid>
                                    <version>
                                        <componentUuid>b2b0b997-3442-4172-986d-8c24f381b1f7</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>bf20a308-024a-4c57-900f-dff7a6af55aa</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>sapAttemptsCnt decrement  32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>d0015e91-2274-47a4-9a25-bd0ea27f1693</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>d597260e-98bc-4a98-b9ed-61949620a7f7</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>9c12b920-fd40-48b9-8236-de05108418e5</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>28</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>2486884b-6a29-4d31-9fe8-b460348ce290</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>d62b6441-97d8-420d-89ba-f7cfb6f206d9</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
  
	&lt;var-def name="final_products"/&gt;
	&lt;var-def name="err_desc"/&gt;
	&lt;var-def name="err_id"/&gt;

	&lt;script&gt;&lt;![CDATA[ 
		import org.json.JSONObject;
		import org.json.JSONArray;
		import java.util.Iterator;
		
		JSONObject product_information = new JSONObject("${product_lines}");
		
		JSONArray arr = (JSONArray) product_information.get("product_lines");

		Iterator i = arr.iterator();
		
		gtinErrorList = "";
		
		while (i.hasNext()) {
			JSONObject innerObj = (JSONObject) i.next();
			JSONObject gtin_Json = (JSONObject) innerObj.get("gtin");
			JSONObject product_code_Json = (JSONObject) innerObj.get("product_code");

			if (gtin_Json.get("last").toString() == "")  {
				if(product_code_Json.get("last").toString().length() == 13 ||
				(product_code_Json.get("last").toString().length() == 14 &amp;&amp; product_code_Json.get("last").toString().startsWith("0"))
				){
					gtin_Json.put("rpaed", product_code_Json.get("last").toString());
	                gtin_Json.put("last", product_code_Json.get("last").toString());
				}else{
					gtinErrorList += ", " + product_code_Json.get("last");
				}		
			}
		}
		
if (gtinErrorList != ""){
		gtinErrorList = gtinErrorList.substring(2);
		
		if (error_description_list.toString().equals("")) {
				error_description_list = "Some product codes (${gtinErrorList}) could not be translated into GTINs";
				error_id_list = "DATA-03";
			} else {
				error_description_list = error_description_list.toString() + "|Some product codes (${gtinErrorList}) could not be translated into GTINs";
				error_id_list = error_id_list.toString() + "|DATA-03";
			}
	}

		sys.defineVariable("final_products", product_information);
		sys.defineVariable("err_desc", error_description_list);
		sys.defineVariable("err_id", error_id_list);
		
	]]&gt;&lt;/script&gt;
	
	
    &lt;export include-original-data="true"&gt;
      	&lt;single-column name="product_lines" value="${final_products}"/&gt;
    	&lt;single-column name="error_description_list" value="${err_desc}"/&gt;
    	&lt;single-column name="error_id_list" value="${err_id}"/&gt;
    &lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>54f19fa2-b729-479c-a68d-b21f208d5362</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Validate gtins  32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>54f19fa2-b729-479c-a68d-b21f208d5362</uuid>
                                    <version>
                                        <componentUuid>6ab0d824-d86a-423a-ba15-b52ed95f6245</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>d254f06a-0f89-4029-9457-6ed5a8b79f65</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Validate gtins  32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>c163e910-7aee-4938-a9f0-bb85f9b10afe</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>c0af86d0-0647-4a5a-94be-e18c02ea3c9f</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>e4d83926-7863-41a5-90a7-717c999f3499</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>29</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>ba013cb9-a726-4179-a59e-293090859c28</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>97a11dff-92c6-4c90-8356-6fc6c9a50f64</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	
	
	
	&lt;script&gt;&lt;![CDATA[
import groovy.json.JsonBuilder
import groovy.json.JsonOutput
import groovy.json.JsonSlurper


 def dist = "${distribution_channel_id}".toString();


   		variables2 =  new JsonSlurper().parseText(variables.toString())
        variables2.rdd_orig.value= dist
        variables2.rdd_orig.history &lt;&lt; [modifiedBy:"export vector alignment",
                                               version: variables2.rdd_orig.history.version.max() + 1,
                                               value: variables2.rdd_orig.value,
                                               modifiedDate: new Date()]
      
  
 def sales = "${sales_area_id}".toString();

        variables2.sales_area_id.value= sales
        variables2.sales_area_id.history &lt;&lt; [modifiedBy:"export vector alignment",
                                               version: variables2.sales_area_id.history.version.max() + 1,
                                               value: variables2.sales_area_id.value,
                                               modifiedDate: new Date()]


def ship = "${ship_to_id}".toString();

        variables2.ship_to_id.value= ship
        variables2.ship_to_id.history &lt;&lt; [modifiedBy:"export vector alignment",
                                               version: variables2.ship_to_id.history.version.max() + 1,
                                               value: variables2.ship_to_id.value,
                                               modifiedDate: new Date()]

variables =    JsonOutput.toJson(variables2)
		
		
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
 		 &lt;single-column name="variables" value="${variables}"/&gt;  
	&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>4e70bf50-0052-417d-a4ce-6d4e58e792bb</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Update data 32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>4e70bf50-0052-417d-a4ce-6d4e58e792bb</uuid>
                                    <version>
                                        <componentUuid>ea987711-2a2d-4c23-aa6c-f74b205b3ef0</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>5bc884cd-a468-4b67-90ed-dec38a84fdbc</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Update data 32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>18ee5075-8b43-4df6-88eb-4231a3410456</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>8c395711-2730-447a-b072-32524af8cc58</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>1d50fd7c-8392-4a1f-a12f-f58e4fe2602f</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>30</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>792993dd-0633-4a9c-aa5b-619c651048e0</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>f1e4c909-2888-4e8b-9c08-bee0034b17d6</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
   &lt;!--
      changelog:
         3.1.6 integrated from BP: "PO fix KD"
   --&gt;

	&lt;script&gt;&lt;![CDATA[
		import java.text.SimpleDateFormat;	
	 	
		oldErrIdList = "${error_id_list}".toString();
		oldErrDescList = "${error_description_list}".toString();
		errIdList = "";
		errDescList = "";
		poOrig = "${po_number}".toString().trim();
		def shipTo = "${ship_to_id}".toString();
		def poFixFlag = "${cfg_po_fix_flag}"
		def today = new Date();
		SimpleDateFormat dateFormat = new SimpleDateFormat("hhmmss");		
		
		if  (poFixFlag.toString().equalsIgnoreCase("yes")){
			if (poOrig == null || poOrig == ""){
				poOrig = shipTo.substring(shipTo.length() - 5, shipTo.length()) + dateFormat.format(today); 
				errIdList += "|DATA-12";
            	errDescList += "|PO number generated with 5 last digits of ship-to number: ${ship_to_id} and current timestamp";
			}
		}
		errIdList = (oldErrIdList + errIdList).replaceAll("^\\|", "");
		errDescList = (oldErrDescList + errDescList).replaceAll("^\\|", "");
	]]&gt;&lt;/script&gt;

    &lt;export include-original-data="true"&gt;
    	&lt;single-column name="po_number" value="${poOrig}"/&gt;
        &lt;single-column name="error_id_list" value="${errIdList}" /&gt;
    	&lt;single-column name="error_description_list" value="${errDescList}" /&gt;
    &lt;/export&gt;

&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>a15cfaa3-d8cc-44fb-916d-fb029c50c874</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[135] generate PO if empty32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>a15cfaa3-d8cc-44fb-916d-fb029c50c874</uuid>
                                    <version>
                                        <componentUuid>99b2cd39-0f66-4e66-9654-b54dcdae8ef1</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>0ae46717-be08-4efa-b7a3-800acbec6356</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[135] generate PO if empty32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>06adc65d-80c4-4146-96ea-1a1226323eb5</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>6fb303ad-8289-49e7-aac9-7b506c81db3c</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>565294d1-ef29-4667-b55a-f996fb19be25</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>31</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>f1af2d98-736d-4057-af8e-a5b96620efcb</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>9f098db7-119c-49ce-adb7-1c8fc23ee288</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
   &lt;!--  changelog:
         3.1.6 comment header added, integrated from "Automation: RPA DACH MASTER v.1.1.106 rel 95 NE BRD-106"
   --&gt;
	
	&lt;var-def name="fixable_ds_name"&gt;&lt;template&gt;${fixable_ds_name}&lt;/template&gt;&lt;/var-def&gt;
	
	&lt;var-def name="fixable_errors_uuid"&gt;&lt;template&gt;${fixable_errors_uuid}&lt;/template&gt;&lt;/var-def&gt;
	&lt;var-def name="fixable_errors_count"&gt;&lt;template&gt;${fixable_errors_count}&lt;/template&gt;&lt;/var-def&gt;
	
	&lt;var-def name="count"&gt;1&lt;/var-def&gt;
	
	&lt;while condition='${count.toInt() &amp;lt; fixable_errors_count.toInt()}'&gt;
	
		&lt;script&gt;&lt;![CDATA[  Thread.sleep(10000);  ]]&gt;&lt;/script&gt;
	
		&lt;var-def name='count'&gt;
			&lt;xpath expression='row/num/text()'&gt;
				&lt;datastore name='${fixable_ds_name}'&gt;
					&lt;template&gt;select count(*) as num from @this where fixable_errors_uuid='${fixable_errors_uuid}'&lt;/template&gt;
				&lt;/datastore&gt;
			&lt;/xpath&gt;
		&lt;/var-def&gt;
		
	&lt;/while&gt;
	
	&lt;export include-original-data="true"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>33ed0013-5366-4b1b-8122-f4a4b6fa3087</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[183] Wait for all records32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>33ed0013-5366-4b1b-8122-f4a4b6fa3087</uuid>
                                    <version>
                                        <componentUuid>3907c9f6-bb12-42b5-9f33-9c696a0f5079</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>87150990-ff23-4a72-9b89-2721adf845c1</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[183] Wait for all records32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>cfc851b9-34b5-470f-9258-b81e9152d1fa</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>2d8af8cd-0228-4081-82bd-0811dd2ce270</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>afcda4aa-6169-457c-ae9c-5b905e5f0622</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>32</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>2c21c409-e4e3-44ed-9707-ae7247167547</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>7f89ba69-6254-4b41-bca2-726880c53e1b</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
&lt;!--      changelog:
         3.1.6 comment header added, integrated from "Automation: RPA DACH MASTER v.1.1.106 rel 95 NE BRD-106"
   --&gt;
	
	&lt;var-def name="fixable_ds_name"&gt;&lt;template&gt;${fixable_ds_name}&lt;/template&gt;&lt;/var-def&gt;
	
	&lt;var-def name="fixable_errors_uuid"&gt;&lt;template&gt;${fixable_errors_uuid}&lt;/template&gt;&lt;/var-def&gt;

    &lt;var-def name="datastoreColumns"&gt;		
        fixable_errors_uuid,error_values,error_code,product_code_fixable_error
	&lt;/var-def&gt;
  
	&lt;script&gt;&lt;![CDATA[
      String[] outputColumns = org.apache.commons.lang.StringUtils.split(datastoreColumns.toString(), ",");
      exportItems = [];
	  
	  sys.defineVariable('outputColumns', outputColumns);
    ]]&gt;&lt;/script&gt;
  
  	&lt;loop item="row"&gt;
	     &lt;list&gt;
	         &lt;datastore name="${fixable_ds_name}"&gt;
                  &lt;template&gt;
                      select * from @this where fixable_errors_uuid='${fixable_errors_uuid.toString()}';
                  &lt;/template&gt;
              &lt;/datastore&gt;
	     &lt;/list&gt;
	     &lt;body&gt;	     	
           &lt;script&gt;&lt;![CDATA[
              Map exportItem = new HashMap();        
              for (String column : outputColumns) {
                exportItem.put(column, row.get(column).toString());
              }             
              exportItems &lt;&lt; exportItem      										
		   ]]&gt;&lt;/script&gt;
	     &lt;/body&gt;
     &lt;/loop&gt;

	&lt;script&gt;&lt;![CDATA[ 
		import com.google.gson.Gson;
      	import com.google.gson.GsonBuilder;     
      	import java.lang.reflect.Type; 
      	import com.google.gson.reflect.TypeToken;
      	import java.util.List;
		import java.util.Arrays;

		def products = product_code_list.toString();
		def quantities = quantity_list.toString();
		def gtins = gtin_list.toString();

		exportItems.each {
		exportItem = it;	
		if(exportItem.error_code.equals("SAP-106")) {
	        Gson gson = new GsonBuilder().create();
	        Type listType = new TypeToken&lt;Object&gt;() {}.getType();
			Map target = gson.fromJson(exportItem.error_values, listType);	
			
			material_fixed = target.fixed_errors.material_fixed.toString();
			quantity_fixed = target.fixed_errors.quantity_fixed.toString();
			gtin_fixed = target.fixed_errors.gtin_fixed.toString();
			
			List&lt;String&gt; productList = Arrays.asList(products.split("\\|"));
			List&lt;String&gt; quantityList = Arrays.asList(quantities.split("\\|"));
			List&lt;String&gt; gtinList = Arrays.asList(gtins.split("\\|"));
			
			for(int i = 0; i &lt; productList.size(); i++) {
				if(productList.get(i).equals(exportItem.product_code_fixable_error.toString())) {
					productList.set(i, material_fixed.substring(1, material_fixed.length() - 1));
					quantityList.set(i, quantity_fixed.substring(1, quantity_fixed.length() - 1));
					gtinList.set(i, gtin_fixed.substring(1, gtin_fixed.length() - 1));
				}
			}
			
			products = String.join("|", productList);
			quantities = String.join("|", quantityList);
			gtins = String.join("|", gtinList);
		}
	}
		sys.defineVariable("products", products);
		sys.defineVariable("quantities", quantities);
		sys.defineVariable("gtins", gtins);
	]]&gt;&lt;/script&gt;

    &lt;export include-original-data="true"&gt;
    	&lt;single-column name="product_code_list" value="${products}"/&gt;
    	&lt;single-column name="quantity_list" value="${quantities}"/&gt;
    	&lt;single-column name="gtin_list" value="${gtins}"/&gt;
    &lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>328548ef-2204-471c-b30b-0291262127e0</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[184] Merge data32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>328548ef-2204-471c-b30b-0291262127e0</uuid>
                                    <version>
                                        <componentUuid>2cf0e3ba-1582-4358-8e84-439d336d1426</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>25814085-3533-49fc-9c7c-6fffe8c95250</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[184] Merge data32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>f06b4009-f80e-4718-986e-a2d6d91b5457</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>d6ef770c-e07a-448a-a141-85b35c0ffdbb</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>981c3430-78d6-4529-b1e8-e4e7264903d6</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>33</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>49dfb6c0-4ff4-4101-bf8b-220ea50df27d</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>60643efd-cfeb-4625-bbdc-788bbd965ee2</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
      changelog:
         3.1.6 comment header added, integrated from "Automation: RPA DACH MASTER v.1.1.106 rel 95 NE BRD-106"
   --&gt;


  
	&lt;script&gt;&lt;![CDATA[ 
		import java.util.List;
		import java.util.Arrays;
		
        error = error_values.toString();
        List&lt;String&gt; valueList = Arrays.asList(error.substring(error.indexOf("=[") + 2, error.indexOf("]")).trim().split(", "));
        description = error.substring(error.indexOf("on=") + 3, error.indexOf("}")).trim();

        product_code = valueList.get(0);
        quantity = valueList.get(1);
        gtin = valueList.get(2);        
	
	]]&gt;&lt;/script&gt;
 
    &lt;export include-original-data="true"&gt;
    	&lt;single-column name="product_code_fixable_error" value="${product_code}"/&gt;
    	&lt;single-column name="quantity_fixable_error" value="${quantity}"/&gt;
    	&lt;single-column name="gtin_fixable_error" value="${gtin}"/&gt;
    	&lt;single-column name="description_fixable_error" value="${description}"/&gt;  	
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>a0b93b07-dc16-4bf1-a1ec-3ab194b154e9</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[182] Get values32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>a0b93b07-dc16-4bf1-a1ec-3ab194b154e9</uuid>
                                    <version>
                                        <componentUuid>4fb89b25-dd6e-4595-91db-a2886432b079</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>556f7354-3b63-4c6e-984b-26937439cb3a</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[182] Get values32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>fa6810ce-1e14-4a47-b581-1a341c10b27e</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9501c5de-b77f-4bb9-b346-4b3bac1b152e</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>f8f3e4db-6f5c-40d0-8004-f1aba2f80d97</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>34</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>4e80c45c-d5a5-44cf-a7f1-1a4ef24478a1</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>d79dfc5a-8c79-4b76-af52-9e714e59f4e5</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <description>Miscellaneous Tasks</description>
                                <executingType>HUMAN</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <question>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Products:</answer>
                                            <answerCode>fixed_errors</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                <code>GRID</code>
                                                <description>Grid</description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Grid</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['fixed_errors']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>products</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>material</answer>
                                            <answerCode>material_fixed</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>fixed_errors</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['fixed_errors']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>order quantity</answer>
                                            <answerCode>quantity_fixed</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>fixed_errors</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['fixed_errors']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>gtin</answer>
                                            <answerCode>gtin_fixed</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>fixed_errors</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['fixed_errors']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <assignmentDuration>1800000</assignmentDuration>
                                    <assignmentLimit>1</assignmentLimit>
                                    <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                                    <autoApprovalDelay>432000000</autoApprovalDelay>
                                    <automaticallyProcessed>0</automaticallyProcessed>
                                    <blockSize>1</blockSize>
                                    <constQualifiedWorkers>false</constQualifiedWorkers>
                                    <currency>USD</currency>
                                    <description>Miscellaneous Tasks</description>
                                    <dynamicTaskRenderingDisabled>false</dynamicTaskRenderingDisabled>
                                    <expiredTime>2592000000</expiredTime>
                                    <faqItems/>
                                    <frameHeight>2500</frameHeight>
                                    <geolocationEnabled>false</geolocationEnabled>
                                    <instructionItems/>
                                    <keywords>Miscellaneous Tasks</keywords>
                                    <maxAssignments>1</maxAssignments>
                                    <moderation>false</moderation>
                                    <moderationFlag>false</moderationFlag>
                                    <origination>CREATED_MANUALLY</origination>
                                    <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                                    <qualificationInstruction></qualificationInstruction>
                                    <qualificationRequirements/>
                                    <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                                    <qualificationTasks>20</qualificationTasks>
                                    <qualificationTraining>false</qualificationTraining>
                                    <questionRuleMaps>
                                        <questionRuleMap>
                                            <businessRule>
                                                <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                <name>Start with one assignment 1+0 pay all</name>
                                                <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                                <ruleType>DROOLS</ruleType>
                                                <ruleTypeUI>Adjudication</ruleTypeUI>
                                                <template>
                                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                    <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                                    <name>Start with 1 assignment X+0 rule (pay all)</name>
                                                    <params>
                                                        <param>
                                                            <code>MAJORITY_VALUE</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Number of correct answers</description>
                                                            <name>Majority value</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>70</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                            <name>Worst accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                            <name>Worst accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>95</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                            <name>Super accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>80</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                            <name>Normal accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAX_ASSIGNMENT_LIMIT</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Maximum number of assignments</description>
                                                            <name>Max assignments limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                            <name>Super accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Normal accuracy level lower limit in percents inclusive</description>
                                                            <name>Normal accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>CHECK_EVERY</code>
                                                            <defaultValue>5</defaultValue>
                                                            <description>Check every i-th gold question when evaluating qualification score</description>
                                                            <name>Check every i-th gold question</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAJORITY_HIT_THRESHOLD</code>
                                                            <defaultValue>100</defaultValue>
                                                            <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                            <name>Percent of correct answers</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Normal accuracy level upper limit in percents exclusive</description>
                                                            <name>Normal accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                    </params>
                                                </template>
                                                <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                                            </businessRule>
                                        </questionRuleMap>
                                    </questionRuleMaps>
                                    <radiusSelector>ExactLocation</radiusSelector>
                                    <randomizeAnswers>false</randomizeAnswers>
                                    <recursiveThreshold>1</recursiveThreshold>
                                    <restrictedCountries/>
                                    <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                                    <templates>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  
  &lt;style&gt;
    
    
    /*.products td:first-child {
      cursor: not-allowed;
      background-color:#eeeeee;
      pointer-events:none;
    }*/
    
    td input {
      background-color: red; 
    }
    
    #err_placeholder table {
    border-collapse: collapse;
}

#err_placeholder table,#err_placeholder th,#err_placeholder td {
    border: 1px solid black;
}
    
  &lt;/style&gt;
  
&lt;@instructions title="&lt;h2&gt;Fix SAP-106 32 [2018-08-09 10:22:56]                                             &lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;               
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;&lt;br&gt;&lt;strong&gt;Document link:&amp;nbsp;&lt;a href="https://wfapp-dev.workfusion.pg.com/workfusion/secure/business-process/edit/$%7Bquestion.data['document_link']%7D" target="_blank" data-mce-href="$%7Bquestion.data['document_link']%7D"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;&lt;/strong&gt;&lt;table style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;" border="2" width="604" data-mce-style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;" data-mce-selected="1"&gt;&lt;caption&gt;&amp;nbsp;&lt;br&gt;&lt;br&gt;&lt;/caption&gt;&lt;tbody&gt;&lt;tr style="height: 17.6px;" data-mce-style="height: 17.6px;"&gt;&lt;td style="width: 146.8px; text-align: center; height: 17.6px;" data-mce-style="width: 146.8px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Error desription&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Material&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Order Quantity&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Gtin&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 17px;" data-mce-style="height: 17px;"&gt;&lt;td style="width: 146.8px; height: 17px;" data-mce-style="width: 146.8px; height: 17px;"&gt;${question.data['description_fixable_error']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['product_code_fixable_error']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['quantity_fixable_error']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['gtin_fixable_error']}&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 85.00000762939453px; top: 88.00000762939453px; height: 4px; width: 1020px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 85.00000762939453px; top: 88.00000762939453px; height: 4px; width: 1020px; " data-row="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 85.00000762939453px; top: 107.00000762939453px; height: 4px; width: 1020px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 85.00000762939453px; top: 107.00000762939453px; height: 4px; width: 1020px; " data-row="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 348.5555725097656px; top: 35.55555725097656px; height: 74px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 348.5555725097656px; top: 35.55555725097656px; height: 74px; width: 4px; " data-col="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 629.6666870117188px; top: 35.55555725097656px; height: 74px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 629.6666870117188px; top: 35.55555725097656px; height: 74px; width: 4px; " data-col="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 878.5556030273438px; top: 35.55555725097656px; height: 74px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 878.5556030273438px; top: 35.55555725097656px; height: 74px; width: 4px; " data-col="2"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 1101.5556030273438px; top: 35.55555725097656px; height: 74px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 1101.5556030273438px; top: 35.55555725097656px; height: 74px; width: 4px; " data-col="3"&gt;&lt;/div&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;div id="err_placeholder"&gt;&lt;/div&gt;
                 &lt;br&gt;&lt;br&gt;
                 &lt;@answers question=question/&gt;
                 &lt;script&gt;
                   $(document).ready(function() {
                  
                      function _getTable(tableId) {
                           const tableDivParent = $("[id*='" + tableId + "']");
                           
                           return tableDivParent.find("table");
                      }
                      
                      function _makeReadOnly(obj) {
                          obj.css('cursor', "not-allowed");
                          obj.css('background-color', "#eeeeee");
                          obj.css('pointer-events', 'none');
                      }
                      
                      // index of n is 0-based
                      function makeNthColumnReadOnly(tableId, n) {
                          const table = _getTable(tableId);
                  		  
                          return () =&gt; {
                            console.log("nth read only " + tableId + " " + n);
                          	table.find("tr").each(function() {
                              	const cell = $(this).find("td:eq(" + n + ")");
                              	//to get the innerText: cell.context.innerText 
                              	_makeReadOnly(cell);
                          	});
                      	  };
                      }
                  
                      window.setInterval(makeNthColumnReadOnly("products", 0), 1500);
                      
                      window.setInterval(makeNthColumnReadOnly("products", 2), 1500);
                     
                      //window.setInterval(makeNthColumnReadOnly("error", 0), 1500);
                   
                      $(".disabledField input").prop(&#160;"disabled",&#160;true&#160;);     
                     
                  });
                 &lt;/script&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Fix SAP-106 32 [2018-08-09 10:22:56]                                             </name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>TASK</type>
                                            <uuid>7bd95706-25ec-41dc-8a66-f5ba8e866997</uuid>
                                            <version>
                                                <componentUuid>d5ce00d3-cf4a-43ed-a5a6-b08e49675e90</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <versionUuid>b32be2aa-d619-4bd1-ae49-df36d55daca9</versionUuid>
                                            </version>
                                        </template>
                                    </templates>
                                    <title>Fix SAP-106 32 [2018-08-09 10:22:56]                                             </title>
                                    <useCommonHitCoordinates>false</useCommonHitCoordinates>
                                    <uuid>8d211fa8-cedd-4840-b8ae-285d53f66938</uuid>
                                    <version>
                                        <componentUuid>939de944-e521-4a98-be57-a10a0c7a4ebd</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>bba9303b-7b3b-44f5-b811-007cba0eff8c</versionUuid>
                                    </version>
                                    <workSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>HUMAN</executingType>
                                            <name>RPA</name>
                                            <private>false</private>
                                            <publicId>87f6ce2c-9f18-43ca-a652-e7e038dfd6cd</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Deriviation fix</name>
                                        <publicId>4685dd2b-82ca-4cae-99be-14cf2aea9489</publicId>
                                        <version>
                                            <componentUuid>d7d96182-424e-4644-833a-e8358203131a</componentUuid>
                                            <incrementalVersion>1.1</incrementalVersion>
                                            <lastInChain>false</lastInChain>
                                            <lastModified>2018-05-15T07:01:14Z</lastModified>
                                            <versionUuid>c01e4dbb-1604-491f-a38c-1772be368782</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to name</answer>
                                                <answerCode>ship_to_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_name']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to location</answer>
                                                <answerCode>ship_to_location</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_location']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to postal code</answer>
                                                <answerCode>ship_to_postal_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_postal_code']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to street name</answer>
                                                <answerCode>ship_to_street_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_street_name']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Sales area ID</answer>
                                                <answerCode>sales_area_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['sales_area_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Distribution channel ID:</answer>
                                                <answerCode>distribution_channel_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['distribution_channel_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Ship to ID</answer>
                                                <answerCode>ship_to_id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ship_to_id']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Products:</answer>
                                                <answerCode>products_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['products_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>products</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product code</answer>
                                                <answerCode>product_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>9</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>gtin</answer>
                                                <answerCode>gtin</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>quantity</answer>
                                                <answerCode>quantity</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Products:</answer>
                                                    <answerCode>products_json</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GRID</code>
                                                        <description>Grid</description>
                                                        <optionsAvailable>false</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Grid</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>products</htmlClasses>
                                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>8</sequenceNumber>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>11</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request delivery date (OCR-ed)</answer>
                                                <answerCode>rdd_orig</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['rdd_orig']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>disabledField</htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>12</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request delivery date (manually-fixed):</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['rdd']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>13</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                                <answerCode>beyond_repair_flag</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>NO</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-07T13:28:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>no=NO|yes=YES</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>14</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <businessRules/>
                                        <isPrivate>false</isPrivate>
                                        <items>
                                            <item>
                                                <type>AUTOMATICALLY_APPROVED</type>
                                                <value>2592000000</value>
                                            </item>
                                            <item>
                                                <type>HIT_EXPIRES_IN</type>
                                                <value>31536000000</value>
                                            </item>
                                            <item>
                                                <type>RECURSIVE_THRESHOLD</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>FRAME_HEIGHT</type>
                                                <value>2500</value>
                                            </item>
                                            <item>
                                                <type>KEYWORDS</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>TIME_PER_ASSIGNMENT</type>
                                                <value>900000</value>
                                            </item>
                                            <item>
                                                <type>LIMIT_NUMBER_ASSIGNMENTS</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_PROCESSED</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>PENDING_ASSIGNMENTS_LIMIT</type>
                                                <value>10</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENTS_PER_HIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>BLOCK_SIZE</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENT_LIMIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>DESCRIPTION</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATION_REQUIREMENTS</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>EXTERNAL_URL</type>
                                                <value>https://wfapp.workfusion.pg.com/workfusion/public/HTMLRenderer</value>
                                            </item>
                                            <item>
                                                <type>RESTRICTED_COUNTRIES</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>REQUIRED_FOR_PREVIEW</type>
                                                <value>false</value>
                                            </item>
                                            <item>
                                                <type>ADJUDICATION_RULE</type>
                                                <value>3</value>
                                            </item>
                                        </items>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="Extract data from Excel"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Email:&amp;nbsp;&lt;a href="${question.data['eml_file_location']}" data-mce-href="${question.data['eml_file_location']}"&gt;${question.data['eml_file_location']}&lt;br&gt;&lt;/a&gt;Order:&amp;nbsp;&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;Error message/List of multi-sheet order:&amp;nbsp;${question.data['error_message']}&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Miscellaneous Tasks (Blank)</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE</type>
                                            <uuid>6778197e-5123-4587-9bfd-0fe361b1ac23</uuid>
                                            <version>
                                                <componentUuid>b440737a-1966-46d2-953d-e1fef74fd055</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2017-09-13T22:42:01Z</lastModified>
                                                <versionUuid>a26c02b9-0130-4b3c-9f8e-0bddd14f8819</versionUuid>
                                            </version>
                                        </template>
                                    </workSetting>
                                    <workSpacePreviewData>[{"name":"created","value":"${question.data['creation_sorting_dttm']}"},{"name":"customer","value":"${question.data['ship_to_name']}"},{"name":"city","value":"${question.data['ship_to_location']}"},{"name":"rdd","value":"${question.data['order_sorting_date']}"},{"name":"po_number","value":"${question.data['po_number']}"},{"name":"id","value":"${question.data['uuid']}-${question.data['mail_id']}"}]</workSpacePreviewData>
                                    <workSpacePreviewScheme>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Created</answer>
                                                <answerCode>created</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:48Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Customer</answer>
                                                <answerCode>customer</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>City</answer>
                                                <answerCode>city</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:26Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>RDD</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:20Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>PO number</answer>
                                                <answerCode>po_number</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:47Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Id</answer>
                                                <answerCode>id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:01Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <description></description>
                                        <id>144</id>
                                        <name>DACH - manual task sorting for RPA fix 0.5 v.2</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <uuid>6d272ab0-6c38-4a67-8d36-ed159e8773e8</uuid>
                                    </workSpacePreviewScheme>
                                </question>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Fix SAP-106 32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>59feef8c-68dd-4545-bbed-9c6a8a9bfbf1</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>fe3dd923-8bc9-408e-bdd0-38d306299c67</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>3dd7ecce-b61d-4afa-a347-90cd587b98d5</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>35</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>7c6165de-83ca-4b16-bdbd-db70bde2babb</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"first_item","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"error_item","value":"0","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'first_item' when error_item EQ '0'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("error_item", "EQ", "0"));

    then
        $ctx.sendResultTo("first_item", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>Is first item?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>d43df0ff-c022-4dfb-9230-6c76ddf74d68</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
&lt;!--      changelog:
         3.1.6 comment header added, integrated from "Automation: RPA DACH MASTER v.1.1.106 rel 95 NE BRD-106"
   --&gt;
    
    &lt;var-def name="ds_name"&gt;Split Fixable Errors&lt;/var-def&gt;
    
    &lt;script&gt;&lt;![CDATA[
    	import java.util.List;
    	import java.lang.reflect.Type;
		import com.google.gson.reflect.TypeToken; 
    	import com.google.gson.Gson;
        import com.google.gson.GsonBuilder;
    
        json = fixed_errors.toString();
        error_code = error_code.toString();
        
        Map originalData = new HashMap();
        
		Gson gson = new GsonBuilder().create();

		originalData.put('error_code', error_code);
	    originalData.put('error_values', json);
		originalData.put('fixable_errors_uuid', fixable_errors_uuid.toString());
		originalData.put('product_code_fixable_error', product_code_fixable_error.toString());
	    originalDataJson = gson.toJson(originalData); 
	       
	    sys.defineVariable("originalDataJson", originalDataJson);    
    ]]&gt;&lt;/script&gt;
    
    &lt;create-datastore name="${ds_name}"&gt;
		&lt;datastore-column name="fixable_errors_uuid"/&gt;
	&lt;/create-datastore&gt;
	
	&lt;insert-datastore datastore-name="${ds_name}" json-value-map="${originalDataJson}" create="true"/&gt;
  
    &lt;export include-original-data="true"&gt;
      &lt;single-column name="fixable_ds_name" value="${ds_name}"/&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>2e236923-5b97-4942-857d-bf6d9f91761a</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[182.5] Save to DS32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>2e236923-5b97-4942-857d-bf6d9f91761a</uuid>
                                    <version>
                                        <componentUuid>3008d1e6-2deb-4044-a1a1-ae014a17f542</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>c75dcfb7-09c3-4d98-815b-ab5b51b925b8</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[182.5] Save to DS32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>40e30452-d791-4b73-b57b-2d939bfcc2ba</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>2b391a75-76ec-4efc-82b0-7c01bf77af74</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>d4198f28-9907-4671-8bff-05f8c35d0224</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>36</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>8c810f0a-d380-476d-acc2-d81b20a1eab4</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"SAP-106","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"error_code","value":"SAP-106","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'SAP-106' when error_code EQ 'SAP-106'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("error_code", "EQ", "SAP-106"));

    then
        $ctx.sendResultTo("SAP-106", $item);
end



# RuleOutcome.Definition={"outcomeId":"rerun SAP","conditional":false,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[],"customConditions":[]}
rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>choose manual task</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>4967a979-1630-4789-b086-b521b0c385a2</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
   &lt;!--
      changelog:
         3.1.6 comment header added
   --&gt;

	&lt;script&gt;&lt;![CDATA[ 
		import java.util.List;
		import java.util.Arrays;
		        
        List&lt;String&gt; errorList = Arrays.asList(error_fixable_id_list.toString().split("\\|"));
        List&lt;String&gt;  errorDescriptionList = Arrays.asList(error_fixable_description_list.toString().split("\\|"));
        List&lt;String&gt;  valuesList = Arrays.asList(fixable_values.toString().split("\\|"));
        
        recordsToExport = new ArrayList();
		String fixable_errors_uuid = java.util.UUID.randomUUID().toString();
        
        int size = errorList.size();
        if (size != 0) {
            for (int i = 0; i &lt; size; i++) {
                String errorCode = errorList.get(i);
                    resultMap = [:];
                    jsonBody = [];
                    
					Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();
                    map.put("description", errorDescriptionList.get(i));
                    map.put("values", Arrays.asList(valuesList.get(i).split(";")));
                    jsonBody &lt;&lt; map;

                    resultMap.put(errorCode, true);
                    resultMap.put('error_code', errorCode);
                    resultMap.put('error_values', jsonBody);
					resultMap.put('item', i);
					resultMap.put('fixable_errors_uuid', fixable_errors_uuid);
                    recordsToExport.add(resultMap);
             }
        }

       sys.defineVariable("recordsToExport", recordsToExport);
       sys.defineVariable("fixable_errors_count", recordsToExport.size());
	]]&gt;&lt;/script&gt;

   &lt;export include-original-data="true"&gt;
     	&lt;single-column name="fixable_errors_count" value="${fixable_errors_count}" /&gt;
     	&lt;single-column name="error_fixable_id_list" value="" /&gt;
        &lt;multi-column list="${recordsToExport}" split-results="true"&gt;
        	&lt;put-to-column-getter name="error_code" property="error_code" /&gt;
        	&lt;put-to-column-getter name="error_values" property="error_values" /&gt;
        	&lt;put-to-column-getter name="error_item" property="item" /&gt;
            &lt;put-to-column-getter name="fixable_errors_uuid" property="fixable_errors_uuid" /&gt;
        &lt;/multi-column&gt;
    &lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>9591ad63-cfd1-43a2-8a5e-070b596a41cf</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[181] Split fixable errors32 [2018-08-09 10:22:56]                                             </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9591ad63-cfd1-43a2-8a5e-070b596a41cf</uuid>
                                    <version>
                                        <componentUuid>92316908-9f6e-42bc-a784-0d3b6d16347e</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>e6f2a3fc-d243-4361-a204-67414aa4dbed</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[181] Split fixable errors32 [2018-08-09 10:22:56]                                             </title>
                                <type>SINGLE</type>
                                <uuid>ab5d929e-4b73-4e0a-b155-62acdff40beb</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9f9fea01-e0b0-48c8-8a61-ffc3d5f6a2ff</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>b00730b9-e438-450d-9864-b4d56d694ba7</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>37</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>66486812-72da-4266-97ef-ce07bd1852b3</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>559c8527-b9a5-43bc-8b2e-0f96dc6efe00</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	
   &lt;!-- initialize logs --&gt;
   &lt;script&gt;&lt;![CDATA[
      import java.time.LocalDateTime;

      grv_prc_log_text = "";
      if (binding.hasVariable('prc_log_text')) {
         grv_prc_log_text = prc_log_text.toString() + grv_prc_log_text;
      }

      grv_cfg_log_lvl_code = cfg_log_lvl_code.toString();
      _log = {String lvl, String text -&gt;
         if (!"DEBUG".equals(lvl) &amp;&amp; !"INFO".equals(lvl) &amp;&amp; !"WARN".equals(lvl) &amp;&amp; !"ERROR".equals(lvl)) {
            _log("ERROR", "Unknown logging level \"" + lvl + "\"");
            _log("ERROR", text);
         } else if ("DEBUG".equals(grv_cfg_log_lvl_code)
               || ("INFO".equals(grv_cfg_log_lvl_code) &amp;&amp; !"DEBUG".equals(lvl))
               || cfg_log_lvl_code.equals(lvl)
               || "ERROR".equals("lvl")) {
            grv_prc_log_text = grv_prc_log_text + LocalDateTime.now().toString() + " " + lvl + ": " + text + "\n";
            if ("DEBUG".equals(lvl)) {
               log.error("[DEUG] " + text);
            } else if ("INFO".equals(lvl)) {
               log.info(text);
            } else if ("WARN".equals(lvl)) {
               log.warn(text);
            } else if ("ERROR".equals(lvl)) {
               log.error(text);
            }
         }
      }

      _log("INFO", "Display GTINs matching    -- started");
   ]]&gt;&lt;/script&gt; 

	&lt;!-- retrieve shared drive credentials --&gt;
	 &lt;script&gt;&lt;![CDATA[ sys.defineVariable("secure_store_name2", "${shared_drive_secure_store_id}") 
		]]&gt;&lt;/script&gt;
		
		 &lt;secure-store-get alias="${secure_store_name2}"/&gt; 
		 &lt;script&gt;&lt;![CDATA[ 
		String secureStoreName2 = secure_store_name2.toString(); Map entryMap = secureEntryMap.getWrappedObject(); 
		com.freedomoss.crowdcontrol.webharvest.web.dto.SecureEntryDTO obj = entryMap.get(secureStoreName2); 
		sharedDriveUser = obj.getKey().toString(); sharedDrivePass = obj.getValue().toString(); 
		]]&gt;&lt;/script&gt;  

	&lt;script&gt;&lt;![CDATA[
		import groovy.json.JsonSlurper;
		import groovy.json.JsonOutput;
		import org.apache.poi.ss.usermodel.DataFormatter;
		import org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator;
		import org.apache.poi.xssf.usermodel.XSSFCell;
		import org.apache.poi.xssf.usermodel.XSSFRow;
		import org.apache.poi.ss.usermodel.Row;
		import org.apache.poi.ss.usermodel.Cell;
		import org.apache.poi.xssf.usermodel.XSSFSheet;
        import org.apache.poi.xssf.usermodel.XSSFWorkbook;
        import java.io.FileOutputStream;
		import java.io.FileInputStream;
		import java.io.InputStream;
		import java.io.IOException;
		import java.io.File;
		import java.util.Date;
		import org.apache.poi.ss.usermodel.Workbook;
		import java.util.Iterator;
		
        import jcifs.smb.NtlmPasswordAuthentication;
		import jcifs.smb.SmbFile;
		import org.apache.commons.io.IOUtils;
		
        
		def inputStreamToByteArray = {InputStream is -&gt;
			return IOUtils.toByteArray(is);
		}

		def milisToHours = {long milis -&gt;
			return milis / 1000 / 60 / 60;
		}

		def milisToMinutes = {long milis -&gt;
			return milis / 1000 / 60;
		}

/*        	jar_URLs  = [
				cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/poi/poi/3.17/poi-3.17.jar",
				cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/poi/poi-ooxml/3.17/poi-ooxml-3.17.jar",
				cfg_nexus_uri.toString() + "/content/repositories/central/org/apache/poi/poi-ooxml-schemas/3.17/poi-ooxml-schemas-3.17.jar"
			]
			.collect{ p -&gt;
				new URL("jar:" + new URL(p) + "!/")
			};
*/

        	jar_URLs  = [
				"poi-3.17.jar",
				"poi-ooxml-3.17.jar",
				"poi-ooxml-schemas-3.17.jar"
			]
			.collect{ p -&gt;
				(new File("/tmp/dach/" + p)).toURI().toURL()	
			};

			jar_URLs.each{ p -&gt;
				println p.getPath()
				this.getClass().classLoader.addURL(p)
			}

			def cl = URLClassLoader.newInstance(jar_URLs as URL[]);
			
			
       
		def copyFromSharedDriveToLocal = {String sourcePath, String destinationPath -&gt;
			

			try {				
                 NtlmPasswordAuthentication auth = new NtlmPasswordAuthentication(null, "eu\\" +sharedDriveUser, sharedDrivePass);
                   SmbFile source = new SmbFile(sourcePath,auth);
				String destination = destinationPath;
				File yourFile = new File(destination);
				yourFile.createNewFile(); // if file already exists will do nothing
				FileOutputStream fos = new FileOutputStream(destination);
				byte[] bytes = inputStreamToByteArray(source.getInputStream());
				fos.write(bytes);
				fos.close();				
				
			} catch (Exception e) {				
				log.error("Copying error:" + e.getMessage());
			}
		}
		
		
		

		//Read Excel file data 
    public static List&lt;String&gt; getDisplayGtinsFromExcel(String fileLoc) throws Exception{
        List&lt;String&gt; displayGtin = new ArrayList();
        XSSFWorkbook workbook = new XSSFWorkbook(new FileInputStream(new File(fileLoc)));
        XSSFSheet sheet = workbook.getSheetAt(0);
        XSSFRow row = null;
        DataFormatter formatter = new DataFormatter();
        XSSFFormulaEvaluator formulaEvaluator = new XSSFFormulaEvaluator(workbook);
        for (int rowIndex = 2; rowIndex &lt;= sheet.getLastRowNum(); rowIndex++) {
            row = sheet.getRow(rowIndex);
            if (row != null) {
                XSSFCell cell = row.getCell(1);
                if(cell!=null){
                    String cellValue = formatter.formatCellValue(cell, formulaEvaluator).trim();
                    if(!"".equals(cellValue)) {
                        displayGtin.add(cellValue);
                    }
                }
            }
        }
        return displayGtin;
    }



		String destPath = temp_directory.toString() + "/displaygtins.xlsx";
		copyFromSharedDriveToLocal(cfg_display_gtin_file_loc.toString(), destPath);
		List&lt;String&gt; displayGtins = getDisplayGtinsFromExcel(destPath);
		log.error("xls: " + displayGtins.toString())
		
	    listOfProducts2 = new JsonSlurper().parseText(product_lines.toString()).product_lines		
		gtin_matched = "false";
		listOfProducts2.each{ 
		log.error("gtin: " + it.gtin.last );
			  if(it.gtin.last!="" &amp;&amp; displayGtins.contains(it.gtin.last)){				     
					gtin_matched = "true";
					it.gtin &lt;&lt; [display_gtin: "Found matching display gtin"]
					}
			  else{
				  it.gtin &lt;&lt; [display_gtin: ""]
			  }
            }     

		json = JsonOutput.toJson(listOfProducts2);
		json = "{\"product_lines\":" + json + "}";
		log.error("json" + json);
		
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
	   &lt;single-column name="prc_log_text" value="${grv_prc_log_text}"/&gt;
	   &lt;single-column name="gtin_matched" value="${gtin_matched}"/&gt;	   
	   &lt;single-column name="product_lines" value="${json}"/&gt;	
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>376c21c2-fd16-48a9-b1f2-4588235b37ce</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Display GTINs matching                        </name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>376c21c2-fd16-48a9-b1f2-4588235b37ce</uuid>
                                    <version>
                                        <componentUuid>aa7bf5e8-d241-4c63-9c2a-79456954bdfa</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>d20588b5-09c7-49f3-881b-a5c3f47f1739</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Display GTINs matching                        </title>
                                <type>SINGLE</type>
                                <uuid>d89ad653-bbcb-4621-b0bc-271036ffeea1</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>5f089d81-d397-4bd0-9a03-e2049a6b5663</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>1831646c-3fbc-493d-a2ab-1ad38d3fc611</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>38</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>d97b5a1e-7a50-41ac-87b5-f6fbb0724a9f</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>6a38c147-2900-4ce8-bd8e-b5e80edec98f</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to get OCR result JSON and update it for comfortable using after.
--&gt;

&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

	&lt;script&gt;&lt;![CDATA[
		import groovy.json.JsonSlurper;

		List&lt;Map&gt; cached_ocr_result_list = new JsonSlurper().parseText(cached_ocr_json.toString());
		sys.defineVariable("cached_ocr_result_list", cached_ocr_result_list);
		
		List&lt;Map&gt; ocr_result_list = new ArrayList();
		if( sys.isVariableDefined("ocr_json")) {
			ocr_result_list = new JsonSlurper().parseText(ocr_json.toString());
		}
		sys.defineVariable("ocr_result_list", ocr_result_list);

		Map&lt;String,Map&lt;String, String&gt;&gt; update_ocr_result_map = new HashMap();
		sys.defineVariable("update_ocr_result_map", update_ocr_result_map);
	]]&gt;&lt;/script&gt;
      
  	&lt;loop item="map"&gt;
		&lt;list&gt;
			&lt;var name="cached_ocr_result_list" /&gt;
		&lt;/list&gt;
		&lt;body&gt;
			&lt;script&gt;&lt;![CDATA[
				String ocr_export_format = map.getWrappedObject().get("ocr_export_format").toString();
				
				map.getWrappedObject().remove("original_document_name");
				map.getWrappedObject().remove("ocr_document_name");
				map.getWrappedObject().remove("ocr_raw_processed_document_name");
				map.getWrappedObject().remove("ocr_tood_document_name");
				
				update_ocr_result_map.getWrappedObject().put(ocr_export_format, map.getWrappedObject());
			]]&gt;&lt;/script&gt;
		&lt;/body&gt;
	&lt;/loop&gt;
  
	&lt;loop item="map"&gt;
		&lt;list&gt;
			&lt;var name="ocr_result_list" /&gt;
		&lt;/list&gt;
		&lt;body&gt;
			&lt;script&gt;&lt;![CDATA[
				String ocr_export_format = map.getWrappedObject().get("ocr_export_format").toString();
				
				map.getWrappedObject().remove("original_document_name");
				map.getWrappedObject().remove("ocr_document_name");
				map.getWrappedObject().remove("ocr_raw_processed_document_name");
				map.getWrappedObject().remove("ocr_tood_document_name");
				
				update_ocr_result_map.getWrappedObject().put(ocr_export_format, map.getWrappedObject());
			]]&gt;&lt;/script&gt;
		&lt;/body&gt;
	&lt;/loop&gt;

	&lt;script&gt;&lt;![CDATA[
		import com.google.gson.Gson;

		Gson gson = new Gson();
		String result_json = gson.toJson(update_ocr_result_map.getWrappedObject());
		sys.defineVariable("ocr_json", result_json);
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
		&lt;single-column name="ocr_json" value="${ocr_json}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>28c99f2c-1240-4320-b63a-b59a43a826fa</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE Result JSON processing</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>28c99f2c-1240-4320-b63a-b59a43a826fa</uuid>
                                    <version>
                                        <componentUuid>5871348a-16df-4ab6-80f9-fb678f5489b6</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>05f60888-2a04-40b7-b5ff-52ca0402417d</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE Result JSON processing</title>
                                <type>SINGLE</type>
                                <uuid>ca363c0e-f18f-431a-a8e5-7342e2fb087d</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>374bce23-9305-40e1-bf67-b828a6a60ec4</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>8507dd08-18d3-4afb-a946-cf3b2fe44684</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>39</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>1ef47732-2504-40a5-8d37-3bd16d62b4bd</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"TOOD","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_type","value":"tood","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'TOOD' when ocr_type EQ 'tood'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_type", "EQ", "tood"));

    then
        $ctx.sendResultTo("TOOD", $item);
end

# RuleOutcome.Definition={"outcomeId":"Standard","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_type","value":"standard","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'Standard' when ocr_type EQ 'standard'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_type", "EQ", "standard"));

    then
        $ctx.sendResultTo("Standard", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>OCR Type</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>8f99729a-5bbd-494f-b1bc-bce889b4a9ad</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to make row processing for all OCR result documents with "xml" format from previous step, also put updated documents on S3 and update OCR JSON.
--&gt;

&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

	&lt;script&gt;&lt;![CDATA[
		import groovy.json.JsonSlurper;

		List&lt;Map&gt; ocr_result_list = new JsonSlurper().parseText(ocr_json.toString());
		sys.defineVariable("ocr_result_list", ocr_result_list);

		List&lt;Map&gt; update_ocr_result_list = new ArrayList();
		sys.defineVariable("update_ocr_result_list", update_ocr_result_list);
	]]&gt;&lt;/script&gt;

	&lt;loop item="map"&gt;
		&lt;list&gt;
			&lt;var name="ocr_result_list" /&gt;
		&lt;/list&gt;
		&lt;body&gt;
			&lt;script&gt;&lt;![CDATA[
				sys.defineVariable("ocr_document_name", map.getWrappedObject().get("ocr_document_name").toString());
				sys.defineVariable("ocr_export_format", map.getWrappedObject().get("ocr_export_format").toString());
				sys.defineVariable("ocr_document_format", map.getWrappedObject().get("ocr_document_format").toString());
			]]&gt;&lt;/script&gt;
			&lt;case&gt;
				&lt;if condition='${ocr_document_format.toString().equals("xml")}'&gt;
					&lt;s3 bucket="${s3_bucket_name}"&gt;
						&lt;var-def name="xml_text"&gt;
							&lt;s3-get name="${bp_run_id}/${document_uuid}/${ocr_document_name}.${ocr_document_format}" /&gt;
						&lt;/var-def&gt;
					&lt;/s3&gt;

					&lt;var-def name="ocr_raw_processed_document"&gt;
						&lt;xslt&gt;
							&lt;xml&gt;
								&lt;var name="xml_text" /&gt;
							&lt;/xml&gt;                       
							&lt;stylesheet&gt;&lt;![CDATA[ &lt;?xml version="1.0" encoding="UTF-8"?&gt;
								&lt;xsl:stylesheet version="1.0"
								xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
								xmlns:wfocr="http://ocr.crowdcomputingsystems.com/xml/schema-v1.xml" xmlns:csl="http://www.w3.org/1999/XSL/Transform"&gt;

								&lt;xsl:template match="@*|node()"&gt;
								&lt;xsl:copy&gt;
								&lt;xsl:apply-templates select="@*|node()"/&gt;
								&lt;/xsl:copy&gt;
               					&lt;/xsl:template&gt;

								&lt;xsl:template match="wfocr:charRecVariants" /&gt;
								&lt;xsl:template match="wfocr:*/@serifProbability" /&gt;
								&lt;xsl:template match="wfocr:*/@wordFromDictionary" /&gt;
								&lt;xsl:template match="wfocr:*/@wordPenalty" /&gt;
								&lt;xsl:template match="wfocr:*/@wordNumeric" /&gt;
								&lt;xsl:template match="wfocr:*/@wordNormal" /&gt;
								&lt;xsl:template match="wfocr:*/@wordIdentifier" /&gt;
								&lt;/xsl:stylesheet&gt;
							]]&gt;&lt;/stylesheet&gt;
						&lt;/xslt&gt;
					&lt;/var-def&gt;
					
					&lt;!--============================== Additional transformation for CT versions &lt; 8.5 ==============================--&gt;
					
					  	&lt;script&gt;&lt;![CDATA[ 
	
							System.setProperty("javax.xml.transform.TransformerFactory", "net.sf.saxon.TransformerFactoryImpl");
							
							//System.setProperty("javax.xml.transform.TransformerFactory", "org.apache.xalan.processor.TransformerFactoryImpl");
							
							System.setProperty("javax.xml.xpath.XPathFactory", "com.sun.org.apache.xpath.internal.jaxp.XPathFactoryImpl");
						
						]]&gt;&lt;/script&gt;
					
					    &lt;var-def name="viewer"&gt;
					        &lt;![CDATA[ 
					            &lt;link href="https://s3.amazonaws.com/workfusion-resources/ocr/ocr-xml-viewer-0.3-scale-to-width.css" rel="stylesheet" type="text/css"/&gt;
					            &lt;script src="https://s3.amazonaws.com/workfusion-resources/jquery/core/1.8.3/jquery.min.js" type="text/javascript"&gt;&lt;/script&gt;
					            &lt;script src="https://s3.amazonaws.com/workfusion-resources/ocr/ocr-xml-viewer-0.3-scale-to-width.js"&gt;&lt;/script&gt;
					            
					            &lt;script&gt;
					                $(document).ready(function() {
					                    generate($('body'), 1.8);
					                });
					            &lt;/script&gt;
					         ]]&gt;
					    &lt;/var-def&gt;
					    
					    &lt;var-def name="ocr_raw_processed_document" overwrite="true"&gt;
						    &lt;xslt&gt;
						        &lt;xml&gt;
						            &lt;var name="ocr_raw_processed_document"/&gt;
						        &lt;/xml&gt;
						        &lt;stylesheet&gt;
						            &lt;template&gt;
						            &lt;![CDATA[
						                &lt;?xml version="1.0" encoding="UTF-8"?&gt;
						                &lt;xsl:stylesheet version="1.0"
							                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
							                xmlns:csl="http://www.w3.org/1999/XSL/Transform"&gt;
						                    &lt;xsl:output method="html"/&gt;
						                    &lt;xsl:output method="html"/&gt;
						                    
						                    &lt;xsl:template match="node()|@*"&gt;
						                        &lt;xsl:copy&gt;
						                            &lt;xsl:apply-templates select="node()|@*"/&gt;
						                        &lt;/xsl:copy&gt;
						                    &lt;/xsl:template&gt;
						                    
						                    &lt;xsl:template match="*:document"&gt;
						                        &lt;!-- Adding newline after xml declaration (http://bugs.java.com/view_bug.do?bug_id=7150637 ???)--&gt;
						                        &lt;xsl:text&gt;&amp;#xa;&lt;/xsl:text&gt;
						                        &lt;xsl:copy&gt;
						                            &lt;xsl:apply-templates select="@*"/&gt;
						                         	&lt;xsl:text disable-output-escaping="yes"&gt;${sys.escapeXml(viewer)}&lt;/xsl:text&gt;
						                            
						                            &lt;xsl:apply-templates select="node()"/&gt;
						                        &lt;/xsl:copy&gt;
						                    &lt;/xsl:template&gt;
						                    
						                    &lt;xsl:template match="*:block[@blockType='Table' or @blocktype='Table']"&gt;
						                        &lt;xsl:element name="table"&gt;
						                            &lt;xsl:apply-templates select="node()|@*"/&gt;
						                        &lt;/xsl:element&gt;
						                    &lt;/xsl:template&gt;
						                    &lt;xsl:template match="*:row"&gt;
						                        &lt;xsl:if test="normalize-space(string(.)) != ''"&gt;
						                            &lt;xsl:element name="tr"&gt;
						                                &lt;xsl:apply-templates select="node()|@*"/&gt;
						                            &lt;/xsl:element&gt;
						                        &lt;/xsl:if&gt;
						                    &lt;/xsl:template&gt;
						                    &lt;xsl:template match="*:cell"&gt;
						                        &lt;xsl:element name="td"&gt;
						                            &lt;xsl:apply-templates select="node()|@*"/&gt;
						                        &lt;/xsl:element&gt;
						                    &lt;/xsl:template&gt;
						                    &lt;xsl:template match="@width"&gt;
						                       &lt;xsl:attribute name="w"&gt;
						                          &lt;xsl:value-of select="."/&gt;
						                       &lt;/xsl:attribute&gt;
						                    &lt;/xsl:template&gt;
						                    &lt;xsl:template match="@height"&gt;
						                       &lt;xsl:attribute name="h"&gt;
						                          &lt;xsl:value-of select="."/&gt;
						                       &lt;/xsl:attribute&gt;
						                    &lt;/xsl:template&gt;
						                    
						                    &lt;!-- Removing charParams and charRecVariants, leaving only the value itself. --&gt;
						                    &lt;xsl:template match="*:charParams"&gt;
						                        &lt;xsl:value-of select="text()[last()]"/&gt;
						                    &lt;/xsl:template&gt;
						                    
						                    &lt;!-- Removing whitespaces before and after charParams nodex --&gt;
						                    &lt;xsl:template match="text()[preceding-sibling::*:charParams or following-sibling::*:charParams]"&gt;
						                    &lt;/xsl:template&gt;
						                &lt;/xsl:stylesheet&gt;
						                 ]]&gt;
						                 &lt;/template&gt;
						        &lt;/stylesheet&gt;
						    &lt;/xslt&gt;
					    &lt;/var-def&gt;
					    
					
					&lt;!--=================================================================================================================--&gt;

					&lt;var-def name="ocr_raw_processed_document_url"&gt;
						&lt;s3 bucket="${s3_bucket_name}"&gt;
							&lt;s3-put-public
								path="${bp_run_id}/${document_uuid}/${ocr_document_name}-raw_processed.${ocr_document_format}"
								content="${ocr_raw_processed_document}" content-type="text/html; charset=utf-8"
								content-disposition="inline" /&gt;
						&lt;/s3&gt;
					&lt;/var-def&gt;
                  
					&lt;script&gt;&lt;![CDATA[
						map.getWrappedObject().put("ocr_raw_processed_document_url", ocr_raw_processed_document_url.toString());
						map.getWrappedObject().put("ocr_raw_processed_document_name", ocr_raw_processed_document_url.toString().substring(ocr_raw_processed_document_url.toString().lastIndexOf("/") + 1, ocr_raw_processed_document_url.toString().lastIndexOf(".")));
					]]&gt;&lt;/script&gt;
				&lt;/if&gt;
			&lt;/case&gt;
			
			&lt;script&gt;&lt;![CDATA[
				update_ocr_result_list.toList().add(new HashMap(map.getWrappedObject()));
			]]&gt;&lt;/script&gt;
		&lt;/body&gt;
	&lt;/loop&gt;

	&lt;script&gt;&lt;![CDATA[
		import com.google.gson.Gson;

		Gson gson = new Gson();
		String result_json = gson.toJson(update_ocr_result_list.toList());
		sys.defineVariable("ocr_json", result_json);
	]]&gt;&lt;/script&gt;


	&lt;export include-original-data="true"&gt;
		&lt;single-column name="ocr_json" value="${ocr_json}" /&gt;
      	&lt;single-column name="ocr_document_name" value="${ocr_document_name}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>6c70dfd9-33cc-4f6b-a4b6-b5a31207ebbd</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE XSLT Cut off Raw OCR XML tags</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>6c70dfd9-33cc-4f6b-a4b6-b5a31207ebbd</uuid>
                                    <version>
                                        <componentUuid>88f825ba-17a7-4af9-9839-3067c01f2cfd</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>e6d77567-0316-43d8-94b1-68eb00edc5e0</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE XSLT Cut off Raw OCR XML tags</title>
                                <type>SINGLE</type>
                                <uuid>6a17d1fb-fc55-48a6-b4d8-90ed2c7bbbbb</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>be9195c5-2987-402c-aeba-2d6dcbce5ef5</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>071602bd-6805-456e-80fd-043a2bb9b9ea</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>40</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>f70bdcc2-651b-4296-871f-c3a736ae8a06</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>ddef76be-8800-40e8-abc7-b569675ecaff</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>S3 bucket</answer>
                                            <answerCode>s3_bucket_name</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>OCR Type</answer>
                                            <answerCode>ocr_type</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Standard=standard|TOOD=tood</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>OCR cache datastore</answer>
                                            <answerCode>cache_datastore</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Export Format</answer>
                                            <answerCode>export_format</answerCode>
                                            <answerHtml>For Standard OCR type only.&lt;br /&gt;You can use maximum 3 types at once.</answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_MULTI</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select Multi</title>
                                                <valueSeparator>PIPE</valueSeparator>
                                                <valueType>MULTIVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>html=html|pdfSearchable=pdfSearchable|txt=txt|xml=xml|xmlForCorrectedImage=xmlForCorrectedImage</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Document language</answer>
                                            <answerCode>document_language</answerCode>
                                            <answerHtml>English (default).&lt;br /&gt;This parameter can contain several language names separated with commas, for example "English,French,German".</answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>5</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Switch for CharPosition option</answer>
                                            <answerCode>ocr_xml_char_recognition</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>false=false|true=true</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>6</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Allowed Region Types</answer>
                                            <answerCode>allowed_region_types</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_MULTI</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select Multi</title>
                                                <valueSeparator>PIPE</valueSeparator>
                                                <valueType>MULTIVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>BT_AutoAnalysis=BT_AutoAnalysis|BT_Barcode=BT_Barcode|BT_Checkmark=BT_Checkmark|BT_CheckmarkGroup=BT_CheckmarkGroup|BT_RasterPicture=BT_RasterPicture|BT_Separator=BT_Separator|BT_SeparatorGroup=BT_SeparatorGroup|BT_Table=BT_Table|BT_Text=BT_Text|BT_VectorPicture=BT_VectorPicture</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>7</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Change DPI</answer>
                                            <answerCode>change_dpi</answerCode>
                                            <answerHtml>From 50 to 400</answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>8</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Invert Image</answer>
                                            <answerCode>invert_image</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>false=false|true=true</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>9</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Discard Color Image</answer>
                                            <answerCode>discard_color_image</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>false=false|true=true</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>10</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Remove Color Objects</answer>
                                            <answerCode>remove_color_objects</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Blue=Blue|Green=Green|Red=Red|Yellow=Yellow</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>11</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Remove Color Objects Type</answer>
                                            <answerCode>remove_color_objects_type</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Background=Background|Full=Full|Stamp=Stamp</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>12</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Custom Regions</answer>
                                            <answerCode>custom_regions</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>13</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
  	 &lt;export include-original-data="true"&gt;
       &lt;single-column name="s3_bucket_name" value="ne-ocr-processing"/&gt;
       &lt;single-column name="ocr_type" value="standard" /&gt; 
       &lt;single-column name="cache_datastore" value="NE OCR Cache" /&gt; 
       &lt;single-column name="export_format" value="xmlForCorrectedImage" /&gt;
       &lt;single-column name="document_language" value="English,Finnish,Danish,Swedish,Norwegian" /&gt;
       &lt;single-column name="ocr_xml_char_recognition" value="" /&gt; 
       &lt;single-column name="allowed_region_types" value="BT_AutoAnalysis|BT_Table|BT_Text" /&gt; 
       &lt;single-column name="custom_regions" value="" /&gt; 
       &lt;single-column name="change_dpi" value="" /&gt; 
       &lt;single-column name="invert_image" value="" /&gt; 
       &lt;single-column name="discard_color_image" value="" /&gt; 
       &lt;single-column name="remove_color_objects" value="" /&gt; 
       &lt;single-column name="remove_color_objects_type" value="" /&gt; 
  &lt;/export&gt;    
&lt;/config&gt;</content>
                                    <includedConfigs/>
                                    <inclusionCode>49f6f497-2502-449a-b5b1-7313bb6b89a4</inclusionCode>
                                    <jsonParams>{"s3_bucket_name":"ne-ocr-processing","ocr_type":"standard","cache_datastore":"NE OCR Cache","export_format":"xmlForCorrectedImage","document_language":"English,Finnish,Danish,Swedish,Norwegian","allowed_region_types":"BT_AutoAnalysis|BT_Table|BT_Text"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>ETL</name>
                                            <private>false</private>
                                            <publicId>0ef23179-3fa8-4750-86ca-f6da84f6e16d</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>[TOOD+Standard] Settings Use Case</name>
                                        <publicId>c2b98d1d-6bef-4dfe-8039-2101e94ceff6</publicId>
                                        <version>
                                            <componentUuid>e579f473-c4ea-45a4-923f-972b5e9da835</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>false</lastInChain>
                                            <lastModified>2018-05-29T12:13:50Z</lastModified>
                                            <versionUuid>6ff785da-a780-4d54-ba1f-0e13d4cc361b</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>S3 bucket</answer>
                                                <answerCode>s3_bucket_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-14T14:46:32Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>OCR Type</answer>
                                                <answerCode>ocr_type</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Standard=standard|TOOD=tood</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>OCR cache datastore</answer>
                                                <answerCode>cache_datastore</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Export Format</answer>
                                                <answerCode>export_format</answerCode>
                                                <answerHtml>For Standard OCR type only.&lt;br /&gt;You can use maximum 3 types at once.</answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_MULTI</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select Multi</title>
                                                    <valueSeparator>PIPE</valueSeparator>
                                                    <valueType>MULTIVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>html=html|pdfSearchable=pdfSearchable|txt=txt|xml=xml|xmlForCorrectedImage=xmlForCorrectedImage</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Document language</answer>
                                                <answerCode>document_language</answerCode>
                                                <answerHtml>English (default).&lt;br /&gt;This parameter can contain several language names separated with commas, for example "English,French,German".</answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Switch for CharPosition option</answer>
                                                <answerCode>ocr_xml_char_recognition</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>false=false|true=true</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Allowed Region Types</answer>
                                                <answerCode>allowed_region_types</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_MULTI</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select Multi</title>
                                                    <valueSeparator>PIPE</valueSeparator>
                                                    <valueType>MULTIVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>BT_AutoAnalysis=BT_AutoAnalysis|BT_Barcode=BT_Barcode|BT_Checkmark=BT_Checkmark|BT_CheckmarkGroup=BT_CheckmarkGroup|BT_RasterPicture=BT_RasterPicture|BT_Separator=BT_Separator|BT_SeparatorGroup=BT_SeparatorGroup|BT_Table=BT_Table|BT_Text=BT_Text|BT_VectorPicture=BT_VectorPicture</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Change DPI</answer>
                                                <answerCode>change_dpi</answerCode>
                                                <answerHtml>From 50 to 400</answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Invert Image</answer>
                                                <answerCode>invert_image</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>false=false|true=true</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>9</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Discard Color Image</answer>
                                                <answerCode>discard_color_image</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>false=false|true=true</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Remove Color Objects</answer>
                                                <answerCode>remove_color_objects</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Blue=Blue|Green=Green|Red=Red|Yellow=Yellow</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>11</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Remove Color Objects Type</answer>
                                                <answerCode>remove_color_objects_type</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Background=Background|Full=Full|Stamp=Stamp</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>12</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Custom Regions</answer>
                                                <answerCode>custom_regions</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>13</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <machineWorkSettingType>ETL</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
  	 &lt;export include-original-data="true"&gt;
       &lt;single-column name="s3_bucket_name" value="{{s3_bucket_name}}"/&gt;
       &lt;single-column name="ocr_type" value="{{ocr_type}}" /&gt; 
       &lt;single-column name="cache_datastore" value="{{cache_datastore}}" /&gt; 
       &lt;single-column name="export_format" value="{{export_format}}" /&gt;
       &lt;single-column name="document_language" value="{{document_language}}" /&gt;
       &lt;single-column name="ocr_xml_char_recognition" value="{{ocr_xml_char_recognition}}" /&gt; 
       &lt;single-column name="allowed_region_types" value="{{allowed_region_types}}" /&gt; 
       &lt;single-column name="custom_regions" value="{{custom_regions}}" /&gt; 
       &lt;single-column name="change_dpi" value="{{change_dpi}}" /&gt; 
       &lt;single-column name="invert_image" value="{{invert_image}}" /&gt; 
       &lt;single-column name="discard_color_image" value="{{discard_color_image}}" /&gt; 
       &lt;single-column name="remove_color_objects" value="{{remove_color_objects}}" /&gt; 
       &lt;single-column name="remove_color_objects_type" value="{{remove_color_objects_type}}" /&gt; 
  &lt;/export&gt;    
&lt;/config&gt;</content>
                                            <name>[TOOD+Standard] Settings Template</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>3de5aba4-4425-4919-bd6e-11961fa5d0f8</uuid>
                                            <version>
                                                <componentUuid>6c311f0d-988b-4163-9ec3-bf6e887bed53</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>false</lastInChain>
                                                <lastModified>2018-05-29T12:12:05Z</lastModified>
                                                <versionUuid>1431a7dd-c211-4d4a-90cf-ca6e9325d1a0</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>ETL</machineWorkSettingType>
                                    <name>NorthernEurope_OCR_settings</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
  	 &lt;export include-original-data="true"&gt;
       &lt;single-column name="s3_bucket_name" value="{{s3_bucket_name}}"/&gt;
       &lt;single-column name="ocr_type" value="{{ocr_type}}" /&gt; 
       &lt;single-column name="cache_datastore" value="{{cache_datastore}}" /&gt; 
       &lt;single-column name="export_format" value="{{export_format}}" /&gt;
       &lt;single-column name="document_language" value="{{document_language}}" /&gt;
       &lt;single-column name="ocr_xml_char_recognition" value="{{ocr_xml_char_recognition}}" /&gt; 
       &lt;single-column name="allowed_region_types" value="{{allowed_region_types}}" /&gt; 
       &lt;single-column name="custom_regions" value="{{custom_regions}}" /&gt; 
       &lt;single-column name="change_dpi" value="{{change_dpi}}" /&gt; 
       &lt;single-column name="invert_image" value="{{invert_image}}" /&gt; 
       &lt;single-column name="discard_color_image" value="{{discard_color_image}}" /&gt; 
       &lt;single-column name="remove_color_objects" value="{{remove_color_objects}}" /&gt; 
       &lt;single-column name="remove_color_objects_type" value="{{remove_color_objects_type}}" /&gt; 
  &lt;/export&gt;    
&lt;/config&gt;</content>
                                        <name>[TOOD+Standard] Settings Template</name>
                                        <origination>CREATED_AUTOMATICALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>MACHINE</type>
                                        <uuid>57a4940e-0fd2-4d38-b524-e0ad291cc555</uuid>
                                        <version>
                                            <componentUuid>b19697cc-dc37-450f-ae0b-8e1295e43f12</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <versionUuid>982e340f-bdc2-4716-a8bd-f3411ec6f166</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>49f6f497-2502-449a-b5b1-7313bb6b89a4</uuid>
                                    <version>
                                        <componentUuid>7cc10bf9-4445-41b6-99b2-421bbcfbc036</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>781d3247-6a27-40cc-85fe-10cc78b6fa92</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NorthernEurope_OCR_settings</title>
                                <type>SINGLE</type>
                                <uuid>000b27a8-7f8d-41ee-ace8-4db1e8010d96</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>41524ba4-4b7d-4a73-b2ed-3f2d42f47e34</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>19a1cdd8-b95c-4e25-862a-864e7c0c1985</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>41</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>063b40c4-bab2-4da3-88b3-65e258550c87</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>dec58616-fda5-4c84-936c-e7a9822fae6e</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to make request to the OCR api, with our input parameters , but before, get one OCR taskId for all pages of document and make valid OCR api URL.
--&gt;

&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="java"&gt;

	&lt;!-- reading pNG from S3 --&gt;
	&lt;script&gt;&lt;![CDATA[
		import org.json.XML;
		import java.util.List;
		import java.util.ArrayList;
		import org.json.JSONObject;
		import org.json.JSONArray;
		import com.freedomoss.workfusion.utils.gson.GsonUtils;

		static String getJSONValue(String jsonString, String key) {
			try{
				JSONObject json = new JSONObject(jsonString);
				return json.get(key).get("directUrl").toString();
			} catch (Exception e){
				return "";
			}
		}
	]]&gt;&lt;/script&gt;
  
	&lt;var-def name="jsonSize"&gt;
		&lt;var name="pages" /&gt;
	&lt;/var-def&gt;
  
	&lt;while condition="true" maxloops="${jsonSize.toInt()}" index="i"&gt;
		&lt;var-def name="jsonKey"&gt;
			&lt;template&gt;fileList-${i.toInt()}&lt;/template&gt;
		&lt;/var-def&gt;
		&lt;!-- reading pNG from S3 --&gt;
		&lt;var-def name="jsonValue-${i}"&gt;
			&lt;script return="getJSONValue(json_file_urls.toString(), jsonKey.toString())" /&gt;
		&lt;/var-def&gt;
	&lt;/while&gt;

	&lt;var-def name="pagesList"&gt;
		&lt;while condition="true" maxloops="${jsonSize.toInt()}" index="i"&gt;
			&lt;var name="jsonValue-${i}" /&gt;
		&lt;/while&gt;
	&lt;/var-def&gt;

  	&lt;var-def name="ocr_url"&gt;
  		&lt;var-global name="ocr_url"/&gt;
  	&lt;/var-def&gt;
  
    &lt;var-def name="ocr_username"&gt;
  		&lt;var-global name="ocr_username"/&gt;
  	&lt;/var-def&gt;
  
    &lt;var-def name="ocr_password"&gt;
  		&lt;var-global name="ocr_password"/&gt;
  	&lt;/var-def&gt;
  
  	&lt;var-def name="submitImage"&gt;
      	&lt;case&gt;
			&lt;if condition='${ocr_username.toString().isEmpty() || ocr_password.toString().isEmpty()}'&gt;
				&lt;http url="${ocr_url}/submitImage" method="post" multipart="true"&gt;
					&lt;http-param name="file" isfile="true"&gt;
						&lt;http url="${original_document_url}" /&gt;
					&lt;/http-param&gt;
				&lt;/http&gt;
			&lt;/if&gt;
          	&lt;else&gt;
            	&lt;http url="${ocr_url}/submitImage" method="post" multipart="true" username="${ocr_username.toString()}" password="${ocr_password.toString()}"&gt;
					&lt;http-param name="file" isfile="true"&gt;
						&lt;http url="${original_document_url}" /&gt;
					&lt;/http-param&gt;
				&lt;/http&gt;
          	&lt;/else&gt;
		&lt;/case&gt;
	&lt;/var-def&gt;
  	
	&lt;var-def name="taskId"&gt;
		&lt;xpath expression="string(//response/task/@id)"&gt;
			&lt;var name="submitImage" /&gt;
		&lt;/xpath&gt;
	&lt;/var-def&gt;
  
  	&lt;case&gt;
		&lt;if condition="${pagesList.toList().size() &amp;gt; 1}"&gt;
			&lt;loop item="pagesListElement"&gt;
				&lt;list&gt;
					&lt;var name="pagesList" /&gt;
				&lt;/list&gt;
				&lt;body&gt;
                  	&lt;http url="${ocr_url}/submitImage" method="post" multipart="true"&gt;
						&lt;http-param name="file" isfile="true"&gt;
							&lt;http url="${pagesListElement}" /&gt;
						&lt;/http-param&gt;
                      	&lt;http-param name="taskId" isfile="${taskId}" /&gt;
					&lt;/http&gt;
                  &lt;/body&gt;
			&lt;/loop&gt;
		&lt;/if&gt;
	&lt;/case&gt;
  
  	&lt;script&gt;&lt;![CDATA[
		//-------------------------------------------------------making processDocument url-------------------------------------------------------
		String url = ocr_url.toString() + "/processDocument?taskId=" + taskId.toString() + "&amp;exportFormat=" + no_cached_export_format.toString() + "&amp;language=" + document_language.toString() + "&amp;xml:writeRecognitionVariants=" + ocr_xml_char_recognition.toString() + "&amp;correctSkew=true&amp;correctOrientation=true&amp;allowedRegionTypes=" + allowed_region_types.toString() + "&amp;invertImage=" + invert_image.toString() + "&amp;discardColorImage=" + discard_color_image.toString() + "&amp;removeColorObjectsType=" + remove_color_objects_type.toString();
		StringBuilder process_document_url = new StringBuilder(url.toString());
		
		if( !custom_regions.toString().isEmpty()) {
			process_document_url.append("&amp;customRegions=" + custom_regions.toString());
		}

		if( !change_dpi.toString().isEmpty()) {
			process_document_url.append("&amp;changeDPI=" + change_dpi.toString());
		}

		if( !remove_color_objects.toString().isEmpty()) {
			process_document_url.append("&amp;removeColorObjects=" + remove_color_objects.toString());
		}
		sys.defineVariable("processDocumentUrl", process_document_url)
	]]&gt;&lt;/script&gt;
  
	&lt;var-def name="processDocument"&gt;
      	&lt;case&gt;
			&lt;if condition='${ocr_username.toString().isEmpty() || ocr_password.toString().isEmpty()}'&gt;
				&lt;http url="${processDocumentUrl.toString()}" method="get" /&gt;
			&lt;/if&gt;
          	&lt;else&gt;
            	&lt;http url="${processDocumentUrl.toString()}" method="get" username="${ocr_username.toString()}" password="${ocr_password.toString()}" /&gt;
          	&lt;/else&gt;
		&lt;/case&gt;
	&lt;/var-def&gt;
  
	&lt;export include-original-data="true"&gt;
		&lt;single-column name="ocr_task_id" value="${taskId}"/&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>d3a64908-b94a-46c9-8af8-79cc648ef73a</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE [TOOD] OCR</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>d3a64908-b94a-46c9-8af8-79cc648ef73a</uuid>
                                    <version>
                                        <componentUuid>3e4d8346-05d0-47f1-86ef-02ea6e484f90</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>7a31a47d-67e6-4a58-9bcc-d307a190aa48</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE [TOOD] OCR</title>
                                <type>SINGLE</type>
                                <uuid>451f8589-6091-4d6e-987a-5df82f41202a</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>29257f85-6404-4193-92d9-66be3ad2d609</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>9328709d-5dc3-4ff0-a12c-da79990e1594</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>42</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>bc29876f-88f4-44f7-83fa-f9e82550a766</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>8a607658-7955-483b-9824-7064f5e24ff3</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy"&gt;
    
&lt;case&gt;
	&lt;if condition="${sys.isVariableDefined(&amp;#34;error_message&amp;#34;)}"&gt;
	    &lt;export include-original-data="true"&gt;
	    &lt;/export&gt;
	&lt;/if&gt;
	&lt;else&gt;
&lt;try&gt;&lt;body&gt;
    
    &lt;var-def name="xml_content"&gt;
        &lt;http url="${ocr_document_url}" charset="UTF-8"/&gt;
    &lt;/var-def&gt;
    
    &lt;script&gt;&lt;![CDATA[
        import org.jsoup.Jsoup
        import org.jsoup.parser.Parser
        import org.jsoup.select.Elements
		import java.util.regex.Pattern.Start;
		import java.security.AccessControlContext;
		import java.sql.RowId;
		import org.jsoup.nodes.Element
		import org.apache.commons.lang.StringUtils
		import org.jsoup.parser.Tag
		import org.jsoup.nodes.Attributes
		import org.jsoup.nodes.Attribute
		import groovy.json.*
		import java.math.BigDecimal
		import org.apache.commons.lang3.ArrayUtils
		import com.google.gson.Gson
		import org.jsoup.nodes.Attributes
		import org.jsoup.parser.Tag

    	document_name = ocr_document_url.toString().substring(ocr_document_url.toString().lastIndexOf("/") + 1, ocr_document_url.toString().lastIndexOf("."))
        if (http.statusCode != 200) {
            throw new RuntimeException("XML document is not accessible. URL: " + ocr_document_url.toString())
        }
        
        def xmlDocument = Jsoup.parse(xml_content.toString(), "", Parser.xmlParser())
        xmlDocument.outputSettings().prettyPrint(true)
        
        def overlaps = { def block1, def block2 -&gt;
            def top1 = block1.attr("t") as int
            def left1 = block1.attr("l") as int
            def right1 = block1.attr("r") as int
            def bottom1 = block1.attr("b") as int
            
            def top2 = block2.attr("t") as int
            def left2 = block2.attr("l") as int
            def right2 = block2.attr("r") as int
            def bottom2 = block2.attr("b") as int
            
            return left1 &lt; right2 &amp;&amp; right1 &gt; left2 &amp;&amp; top1 &lt; bottom2 &amp;&amp; bottom1 &gt; top2
        }
        
        def pages = xmlDocument.select("page")
        
        // Add "hidden" class styles
        pages.first().before("&lt;style&gt;.hidden {display:none;}&lt;/style&gt;")
        
        pages.each { page -&gt;
            def blocksAndTables = page.select("block")
            
            def candidatesToBeHidden = new Elements()
            
            for (int i = 0; i &lt; blocksAndTables.size(); i++) {
                def blockOrTableUnder = blocksAndTables[i]
                
                for (int j = i + 1; j &lt; blocksAndTables.size(); j++) {
                    def blockOrTableAbove = blocksAndTables[j]
                    
                    if (overlaps(blockOrTableUnder, blockOrTableAbove)) {
                        candidatesToBeHidden.add(blockOrTableAbove)
                    }
                }
            }
            
            def elementsToHide = new Elements()
            def allLinesOnPage = page.select("line")
            
            candidatesToBeHidden.each { candidate -&gt;
                def innerLinesOfCandidate = candidate.select("line")
                
                for (int i = 0; i &lt; allLinesOnPage.size(); i++) {
                    def line = allLinesOnPage[i]
                    
                    boolean isSelfLine = false
                    
                    innerLinesOfCandidate.each { selfLine -&gt;
                        if (selfLine.toString().equals(line.toString())) {
                            isSelfLine = true
                        }
                    }
                    
                    if (!isSelfLine) {
                        if (overlaps(candidate, line)) {
                            elementsToHide.add(candidate)
                            break
                        }
                    }
                }
            }
            
            elementsToHide.attr("class", "hidden")
        }
        
        def resultXml = xmlDocument.toString()
		
		doc = Jsoup.parse(xmlDocument.toString());
		Element[] line_elements =  doc.select('line');
		for (Element line : line_elements) {
			String line_text = "";
			int index = 1;
			for (Element formatting : line.select('formatting')) line_text += formatting.textNodes().get(0);
			while (line.select('formatting').size() &gt; 1) 
				line.select('formatting')[1].remove();
			
			line.select('formatting').first().text(Parser.unescapeEntities(line_text, false));	
		}

        sys.defineVariable("new_document_xml_content", doc)
		sys.defineVariable("document_name", document_name)
        
        sys.defineVariable("currentDate", new java.text.SimpleDateFormat("yyyyMMdd").format(new Date()))
    ]]&gt;&lt;/script&gt;
    
    &lt;var-def name="documentXmlS3Link"&gt;
        &lt;s3 bucket="${s3_bucket_name}"&gt;
            &lt;s3-put path="${bp_run_id}/${document_uuid}/${document_name}_additional_processing.xml" acl="PublicReadWrite" content-type="text/html; charset=utf-8" content-disposition="inline"&gt;
                &lt;var name="new_document_xml_content" /&gt;
            &lt;/s3-put&gt;
        &lt;/s3&gt;
    &lt;/var-def&gt;
    
    &lt;export include-original-data="true"&gt;
        &lt;single-column name="ocr_document_url_additional_processing" value="${documentXmlS3Link}" /&gt;
    &lt;/export&gt;

&lt;/body&gt;&lt;catch&gt;
	&lt;log level="WARN" message="Exception caught: ${_exception_stacktrace.toString()}"/&gt;
    &lt;export include-original-data="true"&gt;
        &lt;single-column name="error_message" value="${_exception.toString()}"/&gt;
        &lt;single-column name="error_message_step" value="Remove overlapping blocks from XML"/&gt;
    &lt;/export&gt;
&lt;/catch&gt;&lt;/try&gt;&lt;/else&gt;&lt;/case&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>9c62ca5e-d0ed-4534-91d5-8a3176ccaa50</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Additional XML processing</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9c62ca5e-d0ed-4534-91d5-8a3176ccaa50</uuid>
                                    <version>
                                        <componentUuid>220d83f7-4572-4785-97b1-a55ce92e2fb9</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>107b717f-b81a-405d-91d6-471a03c40347</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Additional XML processing</title>
                                <type>SINGLE</type>
                                <uuid>4dd6b3b3-6b2f-47cf-9b63-645770ac9abb</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>d3915eed-2a9f-4204-bd9e-542015ead0cd</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>2a70eb16-7766-4adb-b334-423637c250cc</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>43</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>7057a37f-ff0d-4793-84b9-6727495c246c</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>2e313db3-5d0f-4941-a1c7-49463649e0f0</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to split document into PNG pages. Then we get json of pages urls for used it in "[TOOD} XSLT XML Enrichment with WORD and DIV tags" step.
--&gt;

&lt;config charset="UTF-8"&gt;

  	&lt;required name="original_document_url"/&gt;
	
    &lt;var-def name="document_link"&gt;
     	 &lt;template&gt;${original_document_url.toString()}&lt;/template&gt;
    &lt;/var-def&gt; 
  
  	&lt;var-def name="convert_lib_path"&gt;
  		&lt;var-global name="convert_lib_path"/&gt;
  	&lt;/var-def&gt;
  
	&lt;var-def name="fileList"&gt;
		&lt;script return="convert(document_link.toString())"&gt;&lt;![CDATA[
			import java.io.BufferedReader;
			import java.io.File;
			import java.io.IOException;
			import java.io.InputStreamReader;
			import java.net.URL;
			import com.itextpdf.text.Image;

			import com.google.common.io.Files;
			import org.apache.commons.io.FileUtils;
			import org.apache.commons.io.FilenameUtils;
			import com.freedomoss.workfusion.utils.gson.GsonUtils;
			import org.webharvest.runtime.variables.ListVariable;
			import org.webharvest.runtime.variables.Variable;

			static Integer counter;
			static File outputFolder;
			static Integer size;
			static ListVariable lv;

			static int getSize(){
				return size;
			}

   			static Variable staticGetVariable(Object i){
				return lv.get((Integer)i);
			}

			static boolean getOS(){
				return ((String)System.getProperties().get("os.name")).contains("Windows");
			}

			boolean isWindows=getOS();


			static ListVariable convert(String documentLink) throws IOException, InterruptedException {
				File baseDir = Files.createTempDir();

				File inputFolder = new File(baseDir, "input");

				URL documentUrl = new URL(documentLink);
				String inputFileName = FilenameUtils.getName(documentUrl.getPath());

				if (inputFileName == null || inputFileName.isEmpty()) {
					inputFileName = "input.pdf";
				}

				File inputFile = new File(inputFolder, inputFileName);
				FileUtils.copyURLToFile(documentUrl, inputFile);

				outputFolder = new File(baseDir, "output");
				FileUtils.forceMkdir(outputFolder);

				File result = new File(outputFolder, "output.png");
				File resultTiff = new File(outputFolder, "output.tiff");

				if (isWindows){
				invoke(new ProcessBuilder(new String[] {
					"magick",
					"convert",
					"-density","288",
					inputFile.getAbsolutePath(),
					// "-resize", "25%",
					result.getAbsolutePath()}
				));
				} else {
				invoke(new ProcessBuilder(new String[] {
					convert_lib_path.toString(),
					"-density","288",
					inputFile.getAbsolutePath(),
					// "-resize", "25%",
					result.getAbsolutePath()}
				));
    			}

				List list=new ArrayList();
				counter=0;
				File created=new File(outputFolder, "output-"+counter.toString()+".png");
				while (created.exists()){
					counter++;
					list.add(created);
					created=new File(outputFolder, "output-"+counter.toString()+".png");
				}
				if (counter==0){
					created=new File(outputFolder, "output.png");
					if (created.exists()){
						File updated=new File(outputFolder, "output-0.png");
						created.renameTo(updated);
						counter++;
						list.add(updated);
					}
				}
				size=list.size();
				counter=0;
				lv=new ListVariable(list);
				return lv;
			}

			static void invoke(ProcessBuilder builder) throws IOException, InterruptedException {
				builder.redirectErrorStream(true);

				System.err.println(builder.command());
				Process process = builder.start();

				BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));
				String line;
				while ((line = in.readLine()) != null) {
					System.out.println(line);
				}
				in.close();

				int code = process.waitFor();
				if (code != 0) {
					throw new RuntimeException("Failed to invoke process: " + builder.command() + ". Return code: " + code);
				}
			}
		]]&gt;&lt;/script&gt;
	&lt;/var-def&gt;
	
	&lt;var-def name="numberOfPages"&gt;
		&lt;script return="getSize()" /&gt;
	&lt;/var-def&gt;

	&lt;loop item="fileJavaObject" index="i" filter="unique"&gt;
		&lt;list&gt;
			&lt;var name="fileList" /&gt;
		&lt;/list&gt;
		&lt;body&gt;
			&lt;log&gt;
				&lt;template&gt;File: ${fileJavaObject}&lt;/template&gt;
			&lt;/log&gt;
			&lt;var-def name="key"&gt;
				&lt;script return="staticGetVariable(i.toInt()-1)"&gt;&lt;/script&gt;
			&lt;/var-def&gt;
			&lt;var-def name="content-${i}"&gt;
		        &lt;file path="${key}" type="binary"/&gt;
			&lt;/var-def&gt;
			&lt;var-def name="content"&gt;
				&lt;var name="content-${i}" /&gt;
			&lt;/var-def&gt;

			&lt;var-def name="converted_link-${i}"&gt;
        		&lt;s3  bucket="${s3_bucket_name}"&gt;
         			&lt;s3-put-public path="${bp_run_id}/${document_uuid}/page-${i}.png" content="${content}" content-type="image/png" content-disposition="inline"/&gt;
        		&lt;/s3&gt;
			&lt;/var-def&gt;
		&lt;/body&gt;
	&lt;/loop&gt;
	
	&lt;var-def name="jsonFilesUrls"&gt;
		&lt;json&gt;
			&lt;loop item="fileJavaObject" index="i" filter="unique"&gt;
				&lt;list&gt;
					&lt;var name="fileList" /&gt;
				&lt;/list&gt;
				&lt;body&gt;
					&lt;json-put key="fileList-${i}"&gt;
						&lt;var name="converted_link-${i}" /&gt;
					&lt;/json-put&gt;
				&lt;/body&gt;
			&lt;/loop&gt;
		&lt;/json&gt;
	&lt;/var-def&gt;
     
	&lt;export include-original-data="true"&gt;
		&lt;single-column name="pages" value="${numberOfPages}" /&gt;
		&lt;single-column name="json_file_urls" value="${jsonFilesUrls}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>556448cb-265e-42e1-8f5b-8db1dfa258e8</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE [TOOD] Split document into PNG pages</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>556448cb-265e-42e1-8f5b-8db1dfa258e8</uuid>
                                    <version>
                                        <componentUuid>4dbd3589-bbfa-495f-a1cf-38d7b0cd278e</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>00b54b15-d478-47cb-b045-b30bc97663cc</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE [TOOD] Split document into PNG pages</title>
                                <type>SINGLE</type>
                                <uuid>b2851eb8-ea88-4a6d-b865-63bd197eeaa2</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>c3309b49-4d5e-4fdf-97c2-b62596c7d307</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>604e7e95-f667-48a2-bc47-8b31c8bf2611</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>44</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>c2d5663b-75d6-410c-835d-5e5b38f54cdc</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>041233f8-c450-4d68-9fff-371e7e602fc9</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"&gt;
   
    &lt;var-def name="ocr_results_s3_bucket"&gt;
        &lt;template&gt;${s3_bucket_name}&lt;/template&gt;
    &lt;/var-def&gt;
    
    &lt;var-def name="ocr_results_s3_path"&gt;
        &lt;template&gt;tiff&lt;/template&gt;
    &lt;/var-def&gt;
    
    &lt;script&gt;&lt;![CDATA[
        log.warn("Staring the config")
    ]]&gt;&lt;/script&gt;
    
    &lt;var-def name="error_return_code" /&gt;
    &lt;var-def name="error_return_message" /&gt;
    &lt;var-def name="completed_tiff"&gt;false&lt;/var-def&gt;
    
    &lt;var-def name='document_uuid'&gt;&lt;template&gt;${document_uuid}&lt;/template&gt;&lt;/var-def&gt;
    &lt;var-def name='document_uuid'&gt;&lt;template&gt;${document_uuid.toString().isEmpty() ? java.util.UUID.randomUUID().toString() : document_uuid}&lt;/template&gt;&lt;/var-def&gt;
    
    &lt;try&gt;
        &lt;body&gt;
            &lt;var-def name="scaledPath"&gt;
                &lt;script return="scale(document_link.toString()).getAbsolutePath()"&gt;
            &lt;![CDATA[ 
                import java.io.BufferedReader;
                import java.io.File;
                import java.io.IOException;
                import java.io.InputStreamReader;
                import java.net.URL;
                
                import com.google.common.io.Files;
                import org.apache.commons.io.FileUtils;
                import org.apache.commons.io.FilenameUtils;
                
                static File scale(String documentLink) throws IOException, InterruptedException {
                    log.warn("Check point #0");
                    
                    File baseDir = Files.createTempDir();
                    
                    log.warn("Check point #1");
                    
                    sys.defineVariable("base_dir_path", baseDir.getAbsolutePath());
                    log.warn(baseDir.getAbsolutePath());
                    
                    File inputFolder = new File(baseDir, "input");
                    
                    URL documentUrl = new URL(documentLink);
                    String inputFileName = FilenameUtils.getName(documentUrl.getPath());
                    if (inputFileName == null || inputFileName.isEmpty()) {
                        inputFileName = "input.pdf";
                    }
                    
                    log.warn("Check point #2");
                    
                    File inputFile = new File(inputFolder, inputFileName);
                    FileUtils.copyURLToFile(documentUrl, inputFile);
                    
                    log.warn("Check point #3");
                    
                    File outputFolder = new File(baseDir, "output");
                    FileUtils.forceMkdir(outputFolder);
                    
                    File result = new File(baseDir, "combined.tiff");
                    
                    log.warn("Check point #4");
          			log.warn(outputFolder.getAbsolutePath() + "/res_%02d.tiff");
                    log.warn(inputFile.getAbsolutePath());
                    try {
                    	// FIXME exact path to gs is a workaround, it should be removed when issue with gs is resolved
                    	invoke(new ProcessBuilder(new String[] {
                            "gs",
                            "-r200",
                            "-q",
                            "-dBATCH",
                            "-dNOPAUSE",
                            "-sDEVICE=tiff24nc",
                            "-sCompression=lzw",
              				"-dShowAnnots=false",
                            "-sOutputFile=" + outputFolder.getAbsolutePath() + "/res_%02d.tiff",
                            inputFile.getAbsolutePath(),
                            "-c", "quit"})); 
                  } catch (Exception e) {
                    log.warn("Ignored Exception after #4: " + e.getMessage());
                  }
                    
                    log.warn("Check point #5");
                    log.warn("outputFolder.getAbsolutePath(): " + outputFolder.getAbsolutePath());
                    log.warn("result.getAbsolutePath(): " + result.getAbsolutePath());
                    
                    invoke(new ProcessBuilder(new String[] {
                            "convert",
						 /*   "-background", "White", */
						 /*    "-colorspace", "gray",*/
 						/*		"-fill", "\"#FFFFFF\"", "-opaque","\"#515151\"", */
                         /*   "-sigmoidal-contrast", "8,50%",  */
                         /*   "+matte",  */
                            outputFolder.getAbsolutePath() + "/*.tiff",
                            result.getAbsolutePath()}));
                    
                    log.warn("Check point #6");
                    
                    return result;
                }
                
                static void invoke(ProcessBuilder builder) throws IOException, InterruptedException {
                    builder.redirectErrorStream(true);
                    
                    System.out.println(builder.command());
                    Process process = builder.start();
                    
                    BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));
                    String line = "";
                    while ((line = in.readLine()) != null) {
                        log.warn(line);
                    }
                    in.close();
                    
                    int code = process.waitFor();
                    if (code != 0) {
                        sys.defineVariable("error_return_code", code, true);
                        sys.defineVariable("error_return_message", line, true);
						log.warn(line);
                        throw new RuntimeException("Failed to invoke process: " + builder.command() + ". Return code: " + code);
                    }
                }
             ]]&gt;
                &lt;/script&gt;
            &lt;/var-def&gt;
            &lt;var-def name="content"&gt;
                &lt;file path="${scaledPath}" type="binary" /&gt;
            &lt;/var-def&gt;
            
            &lt;var-def name="timestamp"&gt;
                &lt;template&gt;${sys.datetime("yyyy-MM-dd'T'HH-mm-ss.SSS")}&lt;/template&gt;
            &lt;/var-def&gt;
            &lt;var-def name="currentDate"&gt;
                &lt;script return="result"&gt;
                  &lt;![CDATA[
                      Date date = new Date();
                      result = new java.text.SimpleDateFormat("yyyyMMdd").format(date);
                  ]]&gt;
                &lt;/script&gt;
            &lt;/var-def&gt;
            
            &lt;case&gt;
                &lt;if condition="${item.getWrappedObject().getRun().isSandbox()}"&gt;
                    &lt;var-def name="env_type"&gt;
                        sandbox
                    &lt;/var-def&gt;
                &lt;/if&gt;
                &lt;else&gt;
                    &lt;var-def name="env_type"&gt;
                        production
                    &lt;/var-def&gt;
                &lt;/else&gt;
            &lt;/case&gt;
            
            &lt;var-def name="s3Links"&gt;
                &lt;s3 bucket="${ocr_results_s3_bucket}"&gt;
                    &lt;s3-put path="${ocr_results_s3_path}/tiff/${document_uuid}.tiff" acl="PublicReadWrite" content-type="image/tiff" content-disposition="inline"&gt;
                        &lt;var name="content" /&gt;
                    &lt;/s3-put&gt;
                &lt;/s3&gt;
            &lt;/var-def&gt;
            
            &lt;var-def name="completed_tiff"&gt;true&lt;/var-def&gt;
            
            &lt;var-def name="document_image_link"&gt;
                &lt;template&gt;${s3Links.toList().get(0).toString()}&lt;/template&gt;
            &lt;/var-def&gt;
            
        &lt;/body&gt;
        &lt;catch&gt;
            &lt;script&gt;&lt;![CDATA[
                log.warn(_exception_message.toString())
            ]]&gt;&lt;/script&gt;
            
            &lt;var-def name="completed_tiff"&gt;false&lt;/var-def&gt;
            &lt;var-def name="document_image_link" /&gt;
        &lt;/catch&gt;
    &lt;/try&gt;
    
    &lt;script language="groovy"&gt;&lt;![CDATA[
        import org.apache.commons.io.FileUtils
        
        def tiffCreated = completed_tiff.toString().toBoolean()
        
        if (!tiffCreated) {
            def errorCode = error_return_code.toString()
            def errorMessage = error_return_message.toString()
            throw new RuntimeException("PDF to TIFF conversion has failed. Error code: " + errorCode + ". Error message: " + errorMessage)
        }
    ]]&gt;&lt;/script&gt;
    
    &lt;export include-original-data="true"&gt;
		&lt;!--  &lt;single-column name="document_uuid" value="${document_uuid}" /&gt;  --&gt;
        &lt;single-column name="original_document_url" value="${document_image_link}" /&gt;
        &lt;!-- &lt;single-column name="completed_tiff" value="${completed_tiff}" /&gt;    --&gt; 
        &lt;!-- &lt;single-column name="error_return_message" value="${error_return_message}" /&gt;    --&gt;
        &lt;!-- &lt;single-column name="error_return_code" value="${error_return_code}" /&gt;    --&gt;
    &lt;/export&gt;


&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>9b28ef6b-24ed-46d4-8943-6f4798e2ff0a</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE PDF_to_TIFF</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9b28ef6b-24ed-46d4-8943-6f4798e2ff0a</uuid>
                                    <version>
                                        <componentUuid>cf8bfc45-05d2-4eb1-bab7-a7e000a140a1</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>790c4ba3-3871-46e7-ac65-04f9cea15096</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE PDF_to_TIFF</title>
                                <type>SINGLE</type>
                                <uuid>c0d6671a-fa5b-43d6-9d28-8a173d77207c</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>2f7f44a0-1239-4bef-ac69-824f9bfb3514</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>31ab5fd5-3d31-4735-b7d3-26cd0614a35e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>45</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>308d5b02-2908-47d0-8f39-63d4e922d14c</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>9f3df3c3-99b9-4fde-b966-5fbedc8f5f83</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  	
  	&lt;script&gt;&lt;![CDATA[
		import groovy.json.JsonSlurper;

		result = new JsonSlurper().parseText(ocr_json.toString());

		if(result.xml != null) {
			ocr_document_url = result.xml.ocr_raw_processed_document_url;
		} else if(result.xmlForCorrectedImage != null) {
			ocr_document_url = result.xmlForCorrectedImage.ocr_raw_processed_document_url;
		} else if(result.html != null) {
			ocr_document_url = result.html.ocr_document_url;
		} else if(result.txt != null) {
			ocr_document_url = result.txt.ocr_document_url;
		} else {
			ocr_document_url = result.pdfSearchable.ocr_document_url;
		}	
	]]&gt;&lt;/script&gt;
  
	&lt;export include-original-data="true"&gt;
    	&lt;single-column name="ocr_document_url" value="${ocr_document_url}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>2f39866a-efb8-476e-ba9e-e2f24e30612f</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[Standard] Prepare URL- ATROCR_</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>2f39866a-efb8-476e-ba9e-e2f24e30612f</uuid>
                                    <version>
                                        <componentUuid>e703f184-99af-4541-8abc-63582cf1e0f0</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>aa96e830-836b-42eb-9700-985a94655919</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[Standard] Prepare URL- ATROCR_</title>
                                <type>SINGLE</type>
                                <uuid>ea22e111-d9d3-412d-824e-c8ebc3362cb1</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>5a5c4fd6-4ec6-4091-af6c-4cfdd6560b72</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>9895efe8-60bf-4b09-bbfc-f7e3e21bd05d</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>46</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>30df4372-1bfb-48c0-9f8f-aaaa42a7fbbe</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>736a344c-5cb9-468b-a575-388a9269bdc1</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to make request to the OCR api, with our input parameters , but before, get one OCR taskId for document and make valid OCR api URL.
--&gt;

&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  	  
  	&lt;var-def name="ocr_url"&gt;
  		&lt;var-global name="ocr_url"/&gt;
  	&lt;/var-def&gt;
  
    &lt;var-def name="ocr_username"&gt;
  		&lt;var-global name="ocr_username"/&gt;
  	&lt;/var-def&gt;
  
    &lt;var-def name="ocr_password"&gt;
  		&lt;var-global name="ocr_password"/&gt;
  	&lt;/var-def&gt;
  
  	&lt;var-def name="submitImage"&gt;
      	&lt;case&gt;
			&lt;if condition='${ocr_username.toString().isEmpty() || ocr_password.toString().isEmpty()}'&gt;
				&lt;http url="${ocr_url}/submitImage" method="post" multipart="true"&gt;
					&lt;http-param name="file" isfile="true"&gt;
						&lt;http url="${original_document_url}" /&gt;
					&lt;/http-param&gt;
				&lt;/http&gt;
			&lt;/if&gt;
          	&lt;else&gt;
            	&lt;http url="${ocr_url}/submitImage" method="post" multipart="true" username="${ocr_username.toString()}" password="${ocr_password.toString()}"&gt;
					&lt;http-param name="file" isfile="true"&gt;
						&lt;http url="${original_document_url}" /&gt;
					&lt;/http-param&gt;
				&lt;/http&gt;
          	&lt;/else&gt;
		&lt;/case&gt;
	&lt;/var-def&gt;
	
  	&lt;script&gt;&lt;![CDATA[
		log.warn("submitImage response=" + submitImage)
	]]&gt;&lt;/script&gt;
  
	&lt;var-def name="taskId"&gt;
		&lt;xpath expression="string(//response/task/@id)"&gt;
			&lt;var name="submitImage" /&gt;
		&lt;/xpath&gt;
	&lt;/var-def&gt;
  
  	&lt;script&gt;&lt;![CDATA[
		//-------------------------------------------------------making processDocument url-------------------------------------------------------
		String url = ocr_url.toString() + "/processDocument?taskId=" + taskId.toString() + "&amp;exportFormat=" + no_cached_export_format.toString() + "&amp;language=" + document_language.toString() + "&amp;xml:writeRecognitionVariants=" + ocr_xml_char_recognition.toString() + "&amp;correctSkew=true&amp;correctOrientation=true&amp;allowedRegionTypes=" + allowed_region_types.toString() + "&amp;invertImage=" + invert_image.toString() + "&amp;discardColorImage=" + discard_color_image.toString() + "&amp;removeColorObjectsType=" + remove_color_objects_type.toString(); 
		StringBuilder process_document_url = new StringBuilder(url.toString());
		
		if( !custom_regions.toString().isEmpty()) {
			process_document_url.append("&amp;customRegions=" + custom_regions.toString());
		}

		if( !change_dpi.toString().isEmpty()) {
			process_document_url.append("&amp;changeDPI=" + change_dpi.toString());
		}

		if( !remove_color_objects.toString().isEmpty()) {
			process_document_url.append("&amp;removeColorObjects=" + remove_color_objects.toString());
		}
		log.warn(process_document_url.toString());
		sys.defineVariable("processDocumentUrl", process_document_url)
	]]&gt;&lt;/script&gt;
  
	&lt;var-def name="processDocument"&gt;
      	&lt;case&gt;
			&lt;if condition='${ocr_username.toString().isEmpty() || ocr_password.toString().isEmpty()}'&gt;
				&lt;http url="${processDocumentUrl.toString()}" method="get" /&gt;
			&lt;/if&gt;
          	&lt;else&gt;
            	&lt;http url="${processDocumentUrl.toString()}" method="get" username="${ocr_username.toString()}" password="${ocr_password.toString()}" /&gt;
          	&lt;/else&gt;
		&lt;/case&gt;
	&lt;/var-def&gt;
  
	&lt;export include-original-data="true"&gt;
		&lt;single-column name="ocr_task_id" value="${taskId}"/&gt;      
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>b668cb46-c30a-48c8-a218-e0df6ec92c37</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE [Standard] OCR</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>b668cb46-c30a-48c8-a218-e0df6ec92c37</uuid>
                                    <version>
                                        <componentUuid>bdc680fe-b80c-4146-9a5e-dd5fb70a2ba4</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>ae9a5cfc-1005-45d5-92d3-d7552f283fb3</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE [Standard] OCR</title>
                                <type>SINGLE</type>
                                <uuid>170e140c-5a95-44c8-a750-c5270ac71145</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9af85f6e-10bb-43a6-8a94-8a451722415b</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>33516edd-bb6f-4a8b-b9fb-bdb934c23a02</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>47</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>f75500bf-85bd-4ea8-aecd-6852e25b9f1c</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"TOOD","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_type","value":"tood","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'TOOD' when ocr_type EQ 'tood'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_type", "EQ", "tood"));

    then
        $ctx.sendResultTo("TOOD", $item);
end

# RuleOutcome.Definition={"outcomeId":"Standard","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_type","value":"standard","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'Standard' when ocr_type EQ 'standard'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_type", "EQ", "standard"));

    then
        $ctx.sendResultTo("Standard", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>OCR Type</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>29462494-6859-41f6-b92c-689625a8bf97</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>c110a655-e193-4da8-9bd2-bd8e7ac68f75</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE GoTo OCR</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>c110a655-e193-4da8-9bd2-bd8e7ac68f75</uuid>
                                    <version>
                                        <componentUuid>41df69be-a3e9-4ef2-8707-b1bb21437c37</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>d463afff-d990-47ef-a635-459ddc90812f</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE GoTo OCR</title>
                                <type>SINGLE</type>
                                <uuid>97dc9f56-8be7-4520-9cf3-59329895832b</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>441e0371-2063-4378-b422-cedd52dbbdf7</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>82f6f873-273a-4363-bee4-df0592dc655a</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>48</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>e1d5f929-6541-4082-935f-47ca3b2f3bf8</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>5020b52c-1c21-483e-aa71-7ac31696b93a</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <description>Miscellaneous Tasks</description>
                                <executingType>HUMAN</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <question>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>TOOD</answer>
                                            <answerCode>ocr_document_url</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                <code>INFO_EXTRACTION</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Information Extraction</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                            <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Text</answer>
                                            <answerCode>answ_test_text</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>T</hotKey>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>TOOD</answer>
                                                <answerCode>ocr_document_url</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <assignmentDuration>1800000</assignmentDuration>
                                    <assignmentLimit>1</assignmentLimit>
                                    <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                                    <autoApprovalDelay>432000000</autoApprovalDelay>
                                    <automaticallyProcessed>0</automaticallyProcessed>
                                    <blockSize>1</blockSize>
                                    <constQualifiedWorkers>false</constQualifiedWorkers>
                                    <currency>USD</currency>
                                    <description>Miscellaneous Tasks</description>
                                    <dynamicTaskRenderingDisabled>true</dynamicTaskRenderingDisabled>
                                    <expiredTime>2592000000</expiredTime>
                                    <faqItems/>
                                    <frameHeight>2500</frameHeight>
                                    <geolocationEnabled>false</geolocationEnabled>
                                    <instructionItems/>
                                    <keywords>Miscellaneous Tasks</keywords>
                                    <maxAssignments>1</maxAssignments>
                                    <moderation>false</moderation>
                                    <moderationFlag>false</moderationFlag>
                                    <origination>CREATED_MANUALLY</origination>
                                    <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                                    <qualificationInstruction></qualificationInstruction>
                                    <qualificationRequirements/>
                                    <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                                    <qualificationTasks>20</qualificationTasks>
                                    <qualificationTraining>false</qualificationTraining>
                                    <questionRuleMaps>
                                        <questionRuleMap>
                                            <businessRule>
                                                <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                <name>Start with one assignment 1+0 pay all</name>
                                                <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                                <ruleType>DROOLS</ruleType>
                                                <ruleTypeUI>Adjudication</ruleTypeUI>
                                                <template>
                                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                    <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                                    <name>Start with 1 assignment X+0 rule (pay all)</name>
                                                    <params>
                                                        <param>
                                                            <code>MAJORITY_VALUE</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Number of correct answers</description>
                                                            <name>Majority value</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>70</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                            <name>Worst accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                            <name>Worst accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>95</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                            <name>Super accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>80</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                            <name>Normal accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAX_ASSIGNMENT_LIMIT</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Maximum number of assignments</description>
                                                            <name>Max assignments limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                            <name>Super accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Normal accuracy level lower limit in percents inclusive</description>
                                                            <name>Normal accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>CHECK_EVERY</code>
                                                            <defaultValue>5</defaultValue>
                                                            <description>Check every i-th gold question when evaluating qualification score</description>
                                                            <name>Check every i-th gold question</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAJORITY_HIT_THRESHOLD</code>
                                                            <defaultValue>100</defaultValue>
                                                            <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                            <name>Percent of correct answers</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Normal accuracy level upper limit in percents exclusive</description>
                                                            <name>Normal accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                    </params>
                                                </template>
                                                <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                                            </businessRule>
                                        </questionRuleMap>
                                    </questionRuleMaps>
                                    <radiusSelector>ExactLocation</radiusSelector>
                                    <randomizeAnswers>false</randomizeAnswers>
                                    <recursiveThreshold>1</recursiveThreshold>
                                    <restrictedCountries/>
                                    <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                                    <templates>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;
&lt;!-- 1.8 --&gt;
&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  
&lt;style type="text/css"&gt;
    document {
        background: none !important;
        overflow: visible!important;
        padding: 0 !important;
        position: absolute !important;
        left: 0;
        top: 0;
        width: 100%;
    }
    page {
        box-shadow: none !important;
        background: none !important;
        padding: 0 !important;
        margin: 0 !important;
        overflow: visible!important;
        height: 0 !important;
    }
    cell, document td {
        border: 0 !important;
    }
    block[blocktype="Picture"] {
        opacity: 1 !important;
        background: none !important;
    }
    .hidden_field {display:none; }
    .hidden {display:inline-block !important;}
    .extraction-content {padding: 0 !important;}
  	.ie-view-source {
  		display: none;
  	}
  	.ie-view-source + .ie-zoom-in-zoom-out-separator {
  		display: none !important;
  	}
  	.popup-original-document.ml10 {
  		margin-left: 0 !important;
  	}
    .opacity-control {
        float: left;
        line-height: 40px;
        margin-left: 3px;
    }
    .opacity-control span {
        display: inline-block;
    }
    #rangeInput {
        width: 100px;
        box-shadow: none;
        margin: -1px 0 0 10px;
        border: 0;
    }
    #rangeInput::-moz-focus-outer {
        border: 0;
    }
&lt;/style&gt;
 
&lt;script type="text/javascript"&gt;
    $(document).ready(function() {
        if (document.getElementsByClassName('submit-btn').length) {
            var originalSubmitEvent = document.getElementsByClassName('submit-btn')[0].onclick;
            document.getElementsByClassName('submit-btn')[0].onclick = function(){
                preprocessAppendOrder();
                originalSubmitEvent();
            }
        }
       
        var originalOnTextContainerLoad = ExtractionAnswerController.prototype.onTextContainerLoad;
        ExtractionAnswerController.prototype.onTextContainerLoad = function() {
            originalOnTextContainerLoad.apply(this, arguments);
            divSizes();
            var $textContainer = ExtractionAnswer.getExtractionController().$textContainer;
            if ($textContainer.find('document') &amp;&amp; $textContainer.find('document').attr('id') === 'TOOD') {
                initOpacity();
                var $page = $textContainer.find('page').eq(0);
                var scale = parseFloat((1/(parseInt($page.attr('width'))/$page.width())).toFixed(1));
                $textContainer.css({'transform':'scaleX(' + scale +') scaleY(' + scale + ') translateZ(0)'});
            }
        };
    });
   
    var OpacityElements = {
        image: $([]),
        textContainer: $([])
    };
  
    var handler;
    var isComputing=false;
    var counter=0;
    var isWidthChanged=false;
  
    function setIntervalHandler(){
    	handler=window.setInterval(divSizes, 1000);
    }
   
    function divSizes(){
    	if (!isComputing){
            counter++;
            isComputing=true;
            try {
        	    var divArray=document.getElementsByTagName("div");
            	var i;
          	    isWidthChanged=false;
   	            for (i in divArray){
  	            var divWithText=divArray[i];
   	            divSize(divWithText);
            }
            } catch (e){;}
            isComputing=false;
            if (counter&gt;3){
                window.clearInterval(handler);
            }
		}
    }

    function divSize(divWithText){
    	try{
            if (divWithText.className=="n"){
            	var divWithTextFontHeight=divWithText.style.fontSize.replace("px","");
            	var divWithTextWidth=divWithText.style.width.replace("px","");
            	var divWithTextScrollWidth=divWithText.scrollWidth;
            	var divWithTextHeight=divWithText.style.height.replace("px","");
            	var divWithTextScrollHeight=divWithText.scrollHeight;
            	if ((divWithTextWidth&lt;divWithTextScrollWidth)||(divWithTextHeight&lt;divWithTextScrollHeight)){
            		var updatedFontSizeWidth=Math.floor(divWithTextFontHeight*divWithTextWidth/divWithTextScrollWidth);
           			var updatedFontSizeHeight=Math.floor(divWithTextFontHeight*divWithTextHeight/divWithTextScrollHeight);
            		var updatedFontSize=Math.min(updatedFontSizeWidth, updatedFontSizeHeight);
            		divWithText.style.fontSize=updatedFontSize+"px";
            		isWidthChanged=true;
				}
        	}
		} catch (e){
            ;
        }
	}

   
    function initOpacity() {
        var template = $('&lt;div class="toolbar-boundary"&gt;&lt;/div&gt;&lt;div class="opacity-control"&gt;&lt;span&gt;Opacity&lt;/span&gt;&lt;input type="range" id="rangeInput" value="10" /&gt;&lt;/div&gt;');
        $('.extraction-search').before(template);
        OpacityElements.image = $('.extraction-content img');
        OpacityElements.textContainer = $('.extraction-content page');
      	OpacityElements.image.css('opacity', 0.1);
        $('#rangeInput').on('input', changeOpacity);
    }
   
    function changeOpacity() {
        var opacity = this.value;
        OpacityElements.image.css('opacity', this.value / 100);
        if (opacity &lt; 20) {
            OpacityElements.textContainer.find('block, table').css('opacity', 1);
        } else {
            OpacityElements.textContainer.find('block, table').css('opacity', (100 - this.value) / 100);
        }
    }
   
    function preprocessAppendOrder() {
        var appendOrder = 0;
        var controllers = Answers.getTaggingControllers();
        controllers.forEach(function(controller) {
            var $tags = DocumentContainer.getControllerTag(controller);
            if ($tags.length) {
                for (var i = 0, l = $tags.length; i &lt; l; i++) {
                    $tags.eq(i).attr('appendorder', nextAppendOrder());
                }
            }
        });
       
        function nextAppendOrder () {
            return ++appendOrder;
        }
    }
&lt;/script&gt;
  
&lt;@instructions title="&lt;h2&gt;[TOOD][MT][BASE] NE test set&lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;&lt;br data-mce-bogus="1"&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>[TOOD][MT][BASE] NE test set</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>TASK</type>
                                            <uuid>ef6ae898-a94b-47bd-a27e-ea3abab00ea0</uuid>
                                            <version>
                                                <componentUuid>405ab07b-ef2e-40d0-8210-d2c6028d8fc9</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <versionUuid>848d2162-437c-435c-b787-e17959a795ce</versionUuid>
                                            </version>
                                        </template>
                                    </templates>
                                    <title>[TOOD][MT][BASE] NE test set</title>
                                    <useCommonHitCoordinates>false</useCommonHitCoordinates>
                                    <uuid>488d6392-6d3f-4043-ba58-3e6bad5ad18b</uuid>
                                    <version>
                                        <componentUuid>6544fb5a-5cab-49e2-8065-d052b64d794e</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>bd24abc3-7de3-465b-8ef6-527cfbcedb76</versionUuid>
                                    </version>
                                    <workSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>HUMAN</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1104</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac8</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac8</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:00Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac8</versionUuid>
                                        </version>
                                        <answers/>
                                        <businessRules/>
                                        <isPrivate>false</isPrivate>
                                        <items>
                                            <item>
                                                <type>RECOMMENDATION_TAGS</type>
                                                <value>["information_extraction"]</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_APPROVED</type>
                                                <value>432000000</value>
                                            </item>
                                            <item>
                                                <type>TIME_PER_ASSIGNMENT</type>
                                                <value>1800000</value>
                                            </item>
                                            <item>
                                                <type>TITLE</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>HIT_EXPIRES_IN</type>
                                                <value>2592000000</value>
                                            </item>
                                            <item>
                                                <type>ADJUDICATION_RULE</type>
                                                <value>3</value>
                                            </item>
                                        </items>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="&lt;h2&gt;BLANK&lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;${question.data.blank} &lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc3</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc3</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc3</versionUuid>
                                            </version>
                                        </template>
                                    </workSetting>
                                </question>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[TOOD][MT][BASE] NE test set</title>
                                <type>SINGLE</type>
                                <uuid>e5a64d4d-b9ac-497b-b992-d2b0b55ae328</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>2d8de74c-1256-41c4-aee1-0e677ac707bd</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>76056204-2de0-41a3-a355-acba74d8775b</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>49</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>8e6681f8-ff9d-4c2c-ba77-6b5fab40abf5</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>c603cbcb-ca8d-4ce9-a313-768c80a154bd</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to save all new OCR result JSON members into cache datastore.
--&gt;

&lt;config&gt;
	&lt;var-def name="key"&gt;
		&lt;template&gt;${document_hash}&lt;/template&gt;
	&lt;/var-def&gt;

	&lt;script language="groovy"&gt;&lt;![CDATA[
		import groovy.json.JsonSlurper;

		List&lt;Map&gt; ocr_result_list = new JsonSlurper().parseText(ocr_json.toString());
		sys.defineVariable("ocr_result_list", ocr_result_list);
	]]&gt;&lt;/script&gt;

	&lt;loop item="map"&gt;
		&lt;list&gt;
			&lt;var name="ocr_result_list" /&gt;
		&lt;/list&gt;
		&lt;body&gt;
			&lt;script&gt;&lt;![CDATA[
				Map originalData = new LinkedHashMap();
				originalData.put("key", key.toString());
				originalData.put("cached_at", javax.xml.bind.DatatypeConverter.printDateTime(Calendar.getInstance()));

				originalData.put("ocr_type", ocr_type.toString());
				originalData.put("export_format", map.getWrappedObject().get("ocr_export_format").toString());
				originalData.put("document_language", document_language.toString());
				originalData.put("ocr_xml_char_recognition", ocr_xml_char_recognition.toString());
				originalData.put("allowed_region_types", allowed_region_types.toString());
				originalData.put("custom_regions", custom_regions.toString());
				originalData.put("change_dpi", change_dpi.toString());
				originalData.put("invert_image", invert_image.toString());
				originalData.put("discard_color_image", discard_color_image.toString());
				originalData.put("remove_color_objects", remove_color_objects.toString());
				originalData.put("remove_color_objects_type", remove_color_objects_type.toString());

				originalData.put("ocr_json", new com.google.gson.Gson().toJson(map.getWrappedObject()));
			]]&gt;&lt;/script&gt;

			&lt;var-def name="originalDataJson"&gt;
				&lt;script return="new com.google.gson.Gson().toJson(originalData)" /&gt;
			&lt;/var-def&gt;

			&lt;insert-datastore datastore-name="${cache_datastore}"
				json-value-map="${originalDataJson}" create="true" /&gt;

		&lt;/body&gt;
	&lt;/loop&gt;

	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>b51b33f9-ca57-4d16-b702-71192565e472</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE Cache OCR results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>b51b33f9-ca57-4d16-b702-71192565e472</uuid>
                                    <version>
                                        <componentUuid>48f6a9fd-472c-4419-a021-8d1d0cab152f</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>79526f06-cbfa-42e9-95bd-70ca224333b9</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE Cache OCR results</title>
                                <type>SINGLE</type>
                                <uuid>bbf487ab-aa33-4d82-a4b1-b325e0984234</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>57f1efe1-c667-4343-ac13-e8b03cccb548</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>344ea232-19da-463d-98ac-53585b4db3e7</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>50</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>ffb67f05-8ebc-4e8d-8a74-e9cda1f31cf4</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>5ec8ec1d-7232-44ee-bde4-2ee16d9ef6f5</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>04340249-5f0d-41ee-97eb-7b2e0e2d4186</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>empty_ocr</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>04340249-5f0d-41ee-97eb-7b2e0e2d4186</uuid>
                                    <version>
                                        <componentUuid>288bb548-43cb-4527-82f9-6e119abdc38d</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>7b7d8a55-6684-4a49-86f6-26b475c42d74</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>empty_ocr</title>
                                <type>SINGLE</type>
                                <uuid>15172c0f-e470-48c8-aedf-da4abec93076</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>c3deb9d3-a3cb-43dd-8079-8f189bb5278e</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>1068b09c-97f7-44b1-b42a-e829460051bd</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>51</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>67dced35-1df4-4a2c-8101-49f46ca6af33</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>d46c316a-edf2-483a-9dfc-e6f64fc01c83</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to configure OCR parameters
--&gt;

&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
  	&lt;required name="s3_bucket_name"/&gt;
  	&lt;required name="ocr_type"/&gt;
  	&lt;required name="cache_datastore"/&gt;
  
  	&lt;script&gt;&lt;![CDATA[
		if(ocr_type.toString().equals("tood")) {
			export_format = "xmlForCorrectedImage";
		} else if (ocr_type.toString().equals("standard")) {
  			if( !sys.isVariableDefined("export_format") || export_format == null || export_format.toString().isEmpty()) {
				export_format = "xmlForCorrectedImage";
			} else {
				export_format = export_format.toString().replace("|", ",");
			}
		}
		sys.defineVariable("exportFormat", export_format);

		if( !sys.isVariableDefined("document_language") || document_language == null || document_language.toString().isEmpty()) {
			document_language = "English";
		} else {
			document_language = document_language.toString().replace(" ", "");
		}
		sys.defineVariable("documentLanguage", document_language);

		if( !sys.isVariableDefined("ocr_xml_char_recognition") || ocr_xml_char_recognition == null || ocr_xml_char_recognition.toString().isEmpty()) {
			ocr_xml_char_recognition = "false";
		}
		sys.defineVariable("ocrXmlCharRecognition", ocr_xml_char_recognition);

		if( !sys.isVariableDefined("allowed_region_types") || allowed_region_types == null || allowed_region_types.toString().isEmpty()) {
			allowed_region_types = "BT_Table,BT_Text,BT_Separator,BT_SeparatorGroup,BT_Checkmark,BT_CheckmarkGroup,BT_AutoAnalysis";
		} else {
			allowed_region_types = allowed_region_types.toString().replace("|", ",");
		}
		sys.defineVariable("allowed_region_types", allowed_region_types)

		if( !sys.isVariableDefined("custom_regions") || custom_regions == null) {
			custom_regions = "";
		}
		sys.defineVariable("custom_regions", custom_regions);

		if( !sys.isVariableDefined("change_dpi") || change_dpi == null) {
			change_dpi = "";
		}	
 		sys.defineVariable("change_dpi", change_dpi);

		if( !sys.isVariableDefined("invert_image") || invert_image == null || invert_image.toString().isEmpty()) {
			invert_image = "false";
		}
		sys.defineVariable("invertImage", invert_image)

		if( !sys.isVariableDefined("discard_color_image") || discard_color_image == null || discard_color_image.toString().isEmpty()) {
			discard_color_image = "false";
		}
		sys.defineVariable("discardColorImage", discard_color_image);
		
		if( !sys.isVariableDefined("remove_color_objects") || remove_color_objects == null) {
			remove_color_objects = "";
		}	
 		sys.defineVariable("remove_color_objects", remove_color_objects);

		if( !sys.isVariableDefined("remove_color_objects_type") || remove_color_objects_type == null || remove_color_objects_type.toString().isEmpty()) {
			remove_color_objects_type = "Background";
		}
		sys.defineVariable("removeColorObjectsType", remove_color_objects_type);
		sys.defineVariable("document_uuid", UUID.randomUUID().toString());
	]]&gt;&lt;/script&gt;
  
	&lt;!--var-def name="document_uuid"&gt;
		&lt;script language="java" return="uuid"&gt;&lt;![CDATA[
			String uuid = UUID.randomUUID().toString();
		]]&gt;&lt;/script&gt;
	&lt;/var-def--&gt;
  
  	&lt;var-def name="bp_run_id"&gt;
		&lt;template&gt;
			${item.getWrappedObject().getRun().getRootRunUuid()}
		&lt;/template&gt;
	&lt;/var-def&gt;
  
	&lt;export include-original-data="true"&gt;
      	&lt;single-column name="cache_datastore" value="${cache_datastore}"/&gt;
    	&lt;single-column name="export_format" value="${exportFormat}"/&gt;
        &lt;single-column name="document_language" value="${documentLanguage}"/&gt;
        &lt;single-column name="ocr_xml_char_recognition" value="${ocrXmlCharRecognition}"/&gt;
      	&lt;single-column name="allowed_region_types" value="${allowed_region_types}"/&gt;
      	&lt;single-column name="custom_regions" value="${custom_regions}"/&gt;
      	&lt;single-column name="change_dpi" value="${change_dpi}"/&gt;
        &lt;single-column name="invert_image" value="${invertImage}"/&gt;
        &lt;single-column name="discard_color_image" value="${discardColorImage}"/&gt;
      	&lt;single-column name="remove_color_objects" value="${remove_color_objects}"/&gt;
      	&lt;single-column name="remove_color_objects_type" value="${removeColorObjectsType}"/&gt;
      
      	&lt;single-column name="bp_run_id" value="${bp_run_id}"/&gt;
      	&lt;single-column name="document_uuid" value="${document_uuid}"/&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>2e075748-2f6f-4860-a5b1-f12352c297d3</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE Input data processing</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>2e075748-2f6f-4860-a5b1-f12352c297d3</uuid>
                                    <version>
                                        <componentUuid>dc1450d4-a3fd-4de5-a480-eb1b915aea17</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>81e24dfb-b7da-4a0b-bb24-d4f40ee476cf</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE Input data processing</title>
                                <type>SINGLE</type>
                                <uuid>76d2b75b-836c-4497-9840-90e1a5451455</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>0d087067-8e1d-41fa-a613-b9f543f7353b</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>7435fbb7-833a-49e8-be2b-b58b126dd86c</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>52</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>c5fc08f5-d84c-4683-adf5-834b5f80eabb</uuid>
                        </campaignMap>
                        <campaignMap>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>2efe7d6d-ee80-4efd-9c99-03043fd557ba</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;var-def name="exportType"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_type")}'&gt;
                &lt;template&gt;${_sys_export_type}&lt;/template&gt;
            &lt;/if&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="exportColumns"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_columns")}'&gt;
                &lt;template&gt;${_sys_export_columns}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="columnNameCase"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_column_name_case")}'&gt;
                &lt;template&gt;${_sys_column_name_case}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;keep&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="dataOnly"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_data_only")}'&gt;
                &lt;template&gt;${_sys_data_only}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;true&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="datastoreName"&gt;
        &lt;script return="item.getWrappedObject().getRun().getDatastoreName()" /&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!datastoreName.isEmpty()}"&gt;
            &lt;insert-datastore   datastore-name="${datastoreName}" create="true"&gt;
                &lt;script return="hit_submission_data_item.getWrappedObject().getItemValueMap()"/&gt;
            &lt;/insert-datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"
            export-type="${exportType}"
            export-columns="${exportColumns}"
            column-name-case="${columnNameCase}"
            data-only="${dataOnly}"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>Default machine campaign for end step.</description>
                                    <includedConfigs/>
                                    <inclusionCode>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</inclusionCode>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <name>Final Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</uuid>
                                    <version>
                                        <componentUuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-08-21T10:54:19Z</lastModified>
                                        <versionUuid>71976d1d-a48f-4ce5-ae4d-10203991bf95</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>100</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Percents</streamValueType>
                                <title>Final Results</title>
                                <type>SINGLE</type>
                                <uuid>af4c8905-26dd-4120-b208-39ad3530ffc6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>a7c3c527-28fb-11e8-bf41-000d3a0302a9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>false</lastInChain>
                                    <lastModified>2018-08-21T10:54:19Z</lastModified>
                                    <versionUuid>56d0500e-1f1a-4755-9c95-600a8de71b5e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>53</stepIndex>
                            <stepPosition>SUBEND</stepPosition>
                            <uuid>317fc74f-33f6-4de9-8b0b-fa9180318366</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>32a0d590-11ca-4f22-9d31-79ef27cac551</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to make XSLT XML Enrichment with WORD and DIV tags processing for "row processed documents" from previous step, to prepare them for valid view on the TOOD HT, also put updated documents on S3 and update OCR JSON.
--&gt;

&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="java" charset="UTF-8"&gt;
  	
	&lt;script language="groovy"&gt;&lt;![CDATA[
		import groovy.json.JsonSlurper;

		List&lt;Map&gt; ocr_result_list = new JsonSlurper().parseText(ocr_json.toString());
		sys.defineVariable("ocr_result_list", ocr_result_list);

		List&lt;Map&gt; update_ocr_result_list = new ArrayList();
		sys.defineVariable("update_ocr_result_list", update_ocr_result_list);

		String ocr_document_name = ocr_result_list.get(0).get("ocr_document_name").toString();
		sys.defineVariable("ocr_document_name", ocr_document_name);

		String ocr_raw_processed_document_name = ocr_result_list.get(0).get("ocr_raw_processed_document_name").toString();
		sys.defineVariable("ocr_raw_processed_document_name", ocr_raw_processed_document_name);

		String ocr_document_format = ocr_result_list.get(0).get("ocr_document_format").toString();
		sys.defineVariable("ocr_document_format", ocr_document_format);
	]]&gt;&lt;/script&gt;
  
	&lt;var-def name="placeholder"&gt;
		&lt;template&gt;converted_pdf_link_PLACEHOLDER&lt;/template&gt;
	&lt;/var-def&gt;

  	&lt;var-def name="jsonKey"&gt;
		&lt;template&gt;fileList-1&lt;/template&gt;
	&lt;/var-def&gt;
  
	&lt;s3 bucket="${s3_bucket_name}"&gt;
		&lt;var-def name="xmlWordsDocument"&gt;
			&lt;s3-get name="${bp_run_id}/${document_uuid}/${ocr_raw_processed_document_name}.${ocr_document_format}" /&gt;
		&lt;/var-def&gt;
	&lt;/s3&gt;
  
	&lt;var-def name="imageLink"&gt;
		&lt;script return="getJSONValue(json_file_urls.toString(), jsonKey.toString())"&gt;&lt;![CDATA[
			import org.json.XML;
			import java.util.List;
			import java.util.ArrayList;
			import org.json.JSONObject;
			import org.json.JSONArray;
			import com.freedomoss.workfusion.utils.gson.GsonUtils;


			static String getJSONValue(String jsonString, String key) {
				try{
					JSONObject json = new JSONObject(jsonString);
					return json.get(key).get("directUrl").toString();
				} catch (Exception e){
					return "";
				}
			}

			public static String addImgTag(String xml, String placeholder, String fileUrl){
				return xml.replace(placeholder, fileUrl.substring(0, fileUrl.length()-5));
			}

		]]&gt;&lt;/script&gt;
	&lt;/var-def&gt;

&lt;!-- XSLT transformation
@date: 05/29/2018
@Author: Mikalai Yatskevich mikalai_yatskevich@epam.com
 v1.7.5
--&gt;
	&lt;var-def name="htmlWordsDocumentRaw"&gt;
		&lt;xslt&gt;
			&lt;xml&gt;
				&lt;var name="xmlWordsDocument" /&gt;
			&lt;/xml&gt;
			&lt;stylesheet&gt;&lt;template&gt;&lt;![CDATA[ 
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:wfocr="http://ocr.crowdcomputingsystems.com/xml/schema-v1.xml"&gt;
    &lt;xsl:output method="html" omit-xml-declaration="yes" media-type="text/html" indent="no"/&gt;
    &lt;xsl:variable name="currentHeight"&gt;
        &lt;xsl:value-of select="sum(//page/@height)"/&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:variable name="minimalFontHeight"&gt;
        &lt;xsl:value-of select="15"/&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:variable name="stopChars"&gt;
        &lt;xsl:value-of select='"&amp;apos;&amp;gt;&amp;lt;`&#8217;~""!@#$%^*()_-=+[]{}&#172;;:,./?|&#8220;&#174;&#171;&#187;&#8212;&#176;| "'/&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:variable name="numberChars"&gt;
        &lt;xsl:value-of select="'1234567890'"/&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:variable name="numberSeparators"&gt;
        &lt;xsl:value-of select="'., '"/&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:variable name="dateSeparators"&gt;
        &lt;xsl:value-of select="'./-'"/&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:variable name="space"&gt;
        &lt;xsl:value-of select="' '"/&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:template match="wfocr:document"&gt;
        &lt;html&gt;
            &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;!-- Version 1.7 --&amp;gt;&lt;/xsl:text&gt;
            &lt;head&gt;
                &lt;style type="text/css"&gt;div.n {position:absolute;border: 1px solid rgba(27, 138, 0, .2);white-space:nowrap;text-align:left;vertical-align:bottom;letter-spacing:0px;word-spacing:0px;} div.rc {position:absolute;border: 1px solid rgba(27, 138, 0, .2);-ms-layout-flow: vertical-ideographic;writing-mode: vertical-lr;white-space:nowrap;} div.rcc {position:absolute;border: 1px solid rgba(27, 138, 0, .2);-ms-layout-flow: vertical-ideographic;writing-mode: vertical-rl;transform: rotate(180deg);white-space:nowrap;} div.t {position:absolute;border: 1px solid rgba(27, 138, 0, .2);white-space:nowrap;}&lt;/style&gt;
            &lt;/head&gt;
            &lt;script type="text/javascript"&gt;
                function divSizes(){
                    var divArray=document.getElementsByTagName("div");
                    var i;
                    for (i in divArray){
                        var divWithText=divArray[i];
                        divSize(divWithText);
                    }
                }

                function divSize(divWithText){
                try{
                    var divWithTextFontHeight=divWithText.style.fontSize.replace("px","");
                    var divWithTextWidth=divWithText.style.width.replace("px","");
                    var divWithTextScrollWidth=divWithText.scrollWidth;
                    var divWithTextHeight=divWithText.style.height.replace("px","");
                    var divWithTextScrollHeight=divWithText.scrollHeight;
                    var updatedFontSizeWidth=Math.floor(divWithTextFontHeight*divWithTextWidth/divWithTextScrollWidth);
                    var updatedFontSizeHeight=Math.floor(divWithTextFontHeight*divWithTextHeight/divWithTextScrollHeight);
                    var updatedFontSize=Math.min(updatedFontSizeWidth, updatedFontSizeHeight);
                    divWithText.style.fontSize=updatedFontSize+"px";
                } catch (e){
                //window.alert(divWithText.style);
                    ;
                }
                }
            &lt;/script&gt;
            &lt;body onload="divSizes()"&gt;
                &lt;xsl:attribute name="style"&gt;width:&lt;xsl:value-of select="./page/@width"/&gt;px; height:&lt;xsl:value-of select="$currentHeight"/&gt;px; border: 1px solid black; background-repeat: no-repeat; font-family: 'Helvetica', 'Arial', sans-serif; padding: 0;
                &lt;/xsl:attribute&gt;
                &lt;document id="TOOD"&gt;
                    &lt;xsl:copy-of select="./@*"/&gt;
                    &lt;xsl:apply-templates select="./wfocr:page"/&gt;
                &lt;/document&gt;
            &lt;/body&gt;
        &lt;/html&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="wfocr:page"&gt;
        &lt;page&gt;
            &lt;xsl:copy-of select="./@*"/&gt;
            &lt;xsl:variable name="pageHeight"&gt;
                &lt;xsl:value-of select="sum(preceding::*[@resolution]/@height)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="previousPagesCount"&gt;
                &lt;xsl:value-of select="count(preceding::*[@resolution])+1"/&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:variable name="src"&gt;
                &lt;xsl:value-of select="concat('converted_pdf_link_PLACEHOLDER',$previousPagesCount,'.png')"/&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;img src="&lt;/xsl:text&gt;
            &lt;xsl:value-of select="$src"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;" style="&lt;/xsl:text&gt;position:absolute;top:&lt;xsl:value-of select="$pageHeight"/&gt;px;width:&lt;xsl:value-of select="@width"/&gt;px; height:&lt;xsl:value-of select="@height"/&gt;px; opacity:0.1; margin-left: 0px; margin-top: 0px;
            &lt;xsl:text disable-output-escaping="yes"&gt;" &amp;gt;&amp;lt;/img&amp;gt;&lt;/xsl:text&gt;

            &lt;xsl:apply-templates select="./wfocr:block"/&gt;
        &lt;/page&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="wfocr:block"&gt;
        &lt;xsl:choose&gt;
            &lt;xsl:when test="@blockType='Table'"&gt;
                &lt;table&gt;
                    &lt;tbody&gt;
                        &lt;xsl:apply-templates select="./wfocr:row"/&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
            &lt;/xsl:when&gt;
            &lt;xsl:when test="@blockType='Text'"&gt;
                &lt;block&gt;
                    &lt;xsl:copy-of select="./@*"/&gt;
                    &lt;p&gt;
                        &lt;xsl:apply-templates select="./wfocr:text"/&gt;
                    &lt;/p&gt;
                &lt;/block&gt;
            &lt;/xsl:when&gt;
        &lt;/xsl:choose&gt;
        &lt;xsl:copy-of select="./separator"/&gt;
        &lt;xsl:copy-of select="./region"/&gt;
    &lt;/xsl:template&gt;
    &lt;xsl:template match="wfocr:row"&gt;

        &lt;tr&gt;
            &lt;xsl:apply-templates select="./wfocr:cell"/&gt;
        &lt;/tr&gt;
    &lt;/xsl:template&gt;
    &lt;xsl:template match="wfocr:cell"&gt;

        &lt;xsl:variable name="cellHeight"&gt;
            &lt;xsl:value-of select="@height"/&gt;
        &lt;/xsl:variable&gt;

        &lt;xsl:variable name="cellWidth"&gt;
            &lt;xsl:value-of select="@width"/&gt;
        &lt;/xsl:variable&gt;
        &lt;td&gt;
            &lt;xsl:attribute name="style"&gt;height:&lt;xsl:value-of select="$cellHeight"/&gt;px;width:&lt;xsl:value-of select="$cellWidth"/&gt;px;
            &lt;/xsl:attribute&gt;
            &lt;xsl:apply-templates select="./wfocr:text"/&gt;
        &lt;/td&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="wfocr:text"&gt;
        &lt;text&gt;
            &lt;xsl:copy-of select="./@*"/&gt;
            &lt;xsl:apply-templates select="./wfocr:par"/&gt;
        &lt;/text&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="wfocr:par"&gt;
        &lt;par&gt;
            &lt;xsl:copy-of select="./@*"/&gt;

            &lt;xsl:apply-templates select="./wfocr:line"/&gt;
        &lt;/par&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="wfocr:line"&gt;

        &lt;line&gt;
            &lt;xsl:copy-of select="./@*"/&gt;

            &lt;xsl:variable name="pageHeight"&gt;
                &lt;xsl:value-of select="number(sum(preceding::*[@resolution]/@height))"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineTop"&gt;
                &lt;xsl:value-of select="number(@t)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineBottom"&gt;
                &lt;xsl:value-of select="number(@b)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineRight"&gt;
                &lt;xsl:value-of select="number(@r)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineLeft"&gt;
                &lt;xsl:value-of select="number(@l)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineFirstCharacterLeft"&gt;
                &lt;xsl:value-of select="number(descendant::wfocr:charParams[@l][1]/@l)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="rotatedFontHeight"&gt;
                &lt;xsl:value-of select="number($lineRight - $lineLeft)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineHeightOld"&gt;
                &lt;xsl:value-of select="number($lineBottom - $lineTop)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="charBottoms"&gt;
                &lt;xsl:value-of select="number(sum(descendant::wfocr:charParams[string-length(normalize-space(text()))&gt;0]/@b))"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="charTops"&gt;
                &lt;xsl:value-of select="number(sum(descendant::wfocr:charParams[string-length(normalize-space(text()))&gt;0]/@t))"/&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:variable name="countElements"&gt;
                &lt;xsl:value-of select="number(count(descendant::wfocr:charParams[@b]))"/&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:variable name="middle"&gt;
                &lt;xsl:value-of select="ceiling($countElements div 2)"/&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:variable name="even"&gt;
                &lt;xsl:value-of select="not($countElements mod 2)"/&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:variable name="chosenElement"&gt;
                &lt;xsl:value-of select="count(descendant::wfocr:charParams[@b][@t]) div 10+1"/&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:variable name="lineHeightChar"&gt;
                &lt;xsl:for-each select="descendant::wfocr:charParams[@b][@t]"&gt;
                    &lt;xsl:sort data-type="number" select="string(number(./@b)-number(./@t))" order="descending"/&gt;
                    &lt;xsl:if test="position() = $middle"&gt;
                        &lt;xsl:value-of select="number(./@b)-number(./@t)"/&gt;
                    &lt;/xsl:if&gt;
                &lt;/xsl:for-each&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="totalCharHeight"&gt;
                &lt;xsl:value-of select="number($charBottoms)-number($charTops)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="charCount"&gt;
                &lt;xsl:value-of select="number(count(descendant::wfocr:charParams[string-length(normalize-space(text()))&gt;0]))"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineHeightComputed"&gt;
                &lt;xsl:choose&gt;
                    &lt;xsl:when test="number($lineHeightOld) div 2 &amp;gt; number($lineHeightChar)"&gt;
                        &lt;xsl:value-of select="number($lineHeightChar)"/&gt;
                    &lt;/xsl:when&gt;
                    &lt;xsl:otherwise&gt;
                        &lt;xsl:value-of select="number($lineHeightOld)"/&gt;
                    &lt;/xsl:otherwise&gt;
                &lt;/xsl:choose&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:variable name="lineHeight"&gt;
                &lt;xsl:choose&gt;
                    &lt;xsl:when test="number($lineHeightComputed) &amp;lt; number($minimalFontHeight)"&gt;
                        &lt;xsl:value-of select="number($minimalFontHeight)"/&gt;
                    &lt;/xsl:when&gt;
                    &lt;xsl:otherwise&gt;
                        &lt;xsl:value-of select="number($lineHeightComputed)"/&gt;
                    &lt;/xsl:otherwise&gt;
                &lt;/xsl:choose&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="fontHeight"&gt;
                &lt;xsl:value-of select="number($lineHeight)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="rotatedLineHeight"&gt;
                &lt;xsl:value-of select="number($lineRight) - number($lineLeft)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineRightValue"&gt;
                &lt;xsl:choose&gt;
                    &lt;xsl:when test="normalize-space(descendant::wfocr:charParams[not(@charConfidence)][1]/@r)!=NaN"&gt;
                        &lt;xsl:value-of select="number(descendant::wfocr:charParams[not(@charConfidence)][1]/@r)"/&gt;
                    &lt;/xsl:when&gt;
                    &lt;xsl:otherwise&gt;
                        &lt;xsl:value-of select="number($lineRight)"/&gt;
                    &lt;/xsl:otherwise&gt;
                &lt;/xsl:choose&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="lineWidth"&gt;
                &lt;xsl:value-of select="number($lineRightValue) - number(@l)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;xsl:variable name="orientation"&gt;
                &lt;xsl:value-of disable-output-escaping="yes" select="normalize-space(ancestor::wfocr:text[@orientation]/@orientation)"/&gt;
            &lt;/xsl:variable&gt;

            &lt;formatting&gt;
                &lt;xsl:copy-of select="./@*"/&gt;

                &lt;xsl:variable name="sumConfidence"&gt;
                    &lt;xsl:value-of select="number(sum(descendant::wfocr:charParams[@charConfidence]/@charConfidence))"/&gt;
                &lt;/xsl:variable&gt;
                &lt;xsl:variable name="numNodes"&gt;
                    &lt;xsl:value-of select="number(count(descendant::wfocr:charParams[@charConfidence]/@charConfidence))"/&gt;
                &lt;/xsl:variable&gt;
                &lt;xsl:variable name="charConfidence"&gt;
                    &lt;xsl:value-of select="number($sumConfidence div $numNodes)"/&gt;
                &lt;/xsl:variable&gt;
                &lt;xsl:choose&gt;
                    &lt;xsl:when test="string-length(normalize-space($orientation))=0"&gt;

                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)+number($lineHeight)"/&gt;" l="&lt;xsl:value-of select="number($lineFirstCharacterLeft)"/&gt;" r="&lt;xsl:value-of select="number($lineLeft)+number($lineWidth)"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                        &lt;xsl:value-of select="number($charConfidence)"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div onload="divSize(this)" style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number($lineFirstCharacterLeft)"/&gt;px; width:&lt;xsl:value-of select="number($lineWidth)"/&gt;px; height:&lt;xsl:value-of select="number($lineHeight)"/&gt;px; font-size: &lt;xsl:value-of select="number($fontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($fontHeight)"/&gt;px;"&lt;xsl:text disable-output-escaping="yes"&gt; class="n"&amp;gt;&lt;/xsl:text&gt;
                        &lt;xsl:for-each select="descendant::wfocr:charParams"&gt;
                            &lt;xsl:variable name="charValue"&gt;
                                &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                            &lt;/xsl:variable&gt;
                            &lt;xsl:variable name="rightCharValueThatCanBeEmpty"&gt;
                                &lt;xsl:value-of select="normalize-space(./following::wfocr:charParams[1]/text()[1])"/&gt;
                            &lt;/xsl:variable&gt;
                            &lt;xsl:variable name="rightCharValue"&gt;
                                &lt;xsl:choose&gt;
                                    &lt;xsl:when test="string-length($rightCharValueThatCanBeEmpty)&gt;0"&gt;
                                        &lt;xsl:value-of select="$rightCharValueThatCanBeEmpty"/&gt;
                                    &lt;/xsl:when&gt;
                                    &lt;xsl:otherwise&gt;
                                        &lt;xsl:value-of select="'1'"/&gt;
                                    &lt;/xsl:otherwise&gt;
                                &lt;/xsl:choose&gt;
                            &lt;/xsl:variable&gt;

                            &lt;xsl:variable name="followingSpaceFst"&gt;
                                &lt;xsl:choose&gt;
                                    &lt;xsl:when test="(string-length(normalize-space(following-sibling::*[not(self::*[@charConfidence])][1]/@l[1])) &amp;gt; 0) and (not(contains($numberChars, $rightCharValue)))"&gt;
                                        &lt;xsl:value-of select="number(normalize-space(following-sibling::*[not(self::*[@charConfidence])][1]/@l[1]))"/&gt;
                                    &lt;/xsl:when&gt;
                                    &lt;xsl:otherwise&gt;
                                        &lt;xsl:value-of select="$lineRightValue"/&gt;
                                    &lt;/xsl:otherwise&gt;
                                &lt;/xsl:choose&gt;
                            &lt;/xsl:variable&gt;
                            &lt;xsl:variable name="followingStopCharFst"&gt;
                                &lt;xsl:choose&gt;
                                    &lt;xsl:when test="(string-length(normalize-space(following-sibling::wfocr:charParams[contains($stopChars,normalize-space(self::*/text()))][not(contains($dateSeparators,normalize-space(self::*/text())))][1]/@l[1])) &amp;gt; 0) and (not(contains($numberChars, $rightCharValue)))"&gt;
                                        &lt;xsl:value-of select="number(normalize-space(following-sibling::wfocr:charParams[contains($stopChars,normalize-space(self::*/text()))][not(contains($dateSeparators,normalize-space(self::*/text())))][1]/@l[1]))"/&gt;
                                    &lt;/xsl:when&gt;
                                    &lt;xsl:otherwise&gt;
                                        &lt;xsl:value-of select="$lineRightValue"/&gt;
                                    &lt;/xsl:otherwise&gt;
                                &lt;/xsl:choose&gt;
                            &lt;/xsl:variable&gt;

                            &lt;xsl:variable name="right"&gt;
                                &lt;xsl:choose&gt;
                                    &lt;xsl:when test="$followingSpaceFst &amp;lt; $followingStopCharFst"&gt;
                                        &lt;xsl:value-of select="number($followingSpaceFst)"/&gt;
                                    &lt;/xsl:when&gt;
                                    &lt;xsl:otherwise&gt;
                                        &lt;xsl:value-of select="number($followingStopCharFst)"/&gt;
                                    &lt;/xsl:otherwise&gt;
                                &lt;/xsl:choose&gt;
                            &lt;/xsl:variable&gt;
                            &lt;xsl:variable name="left"&gt;
                                &lt;xsl:value-of select="number(./@r[1])"/&gt;
                            &lt;/xsl:variable&gt;

                            &lt;xsl:variable name="width"&gt;
                                &lt;xsl:choose&gt;
                                    &lt;xsl:when test="string-length(normalize-space($right))=0"&gt;
                                        &lt;xsl:value-of select="number($lineRight)-number($left)"/&gt;
                                    &lt;/xsl:when&gt;
                                    &lt;xsl:otherwise&gt;
                                        &lt;xsl:value-of select="number($right)-number($left)"/&gt;
                                    &lt;/xsl:otherwise&gt;
                                &lt;/xsl:choose&gt;
                            &lt;/xsl:variable&gt;
&lt;!--                            &lt;xsl:if test="((number(./@r[1])-number(./@l[1])) &amp;gt; 0) and ($width &amp;gt; 0)"&gt;--&gt;

                                &lt;xsl:variable name="isFirstCharInLine"&gt;
                                    &lt;xsl:choose&gt;
                                        &lt;xsl:when test="number($lineFirstCharacterLeft) = number(./@l[1])"&gt;
                                            &lt;xsl:value-of select="1"/&gt;
                                        &lt;/xsl:when&gt;
                                        &lt;xsl:otherwise&gt;
                                            &lt;xsl:value-of select="0"/&gt;
                                        &lt;/xsl:otherwise&gt;
                                    &lt;/xsl:choose&gt;
                                &lt;/xsl:variable&gt;
                                &lt;xsl:variable name="leftCharValueThatCanBeEmpty"&gt;
                                    &lt;xsl:value-of select="normalize-space(./preceding::wfocr:charParams[1]/text()[1])"/&gt;
                                &lt;/xsl:variable&gt;
                                &lt;xsl:variable name="leftCharValue"&gt;
                                    &lt;xsl:choose&gt;
                                        &lt;xsl:when test="string-length($leftCharValueThatCanBeEmpty)&gt;0"&gt;
                                            &lt;xsl:value-of select="$leftCharValueThatCanBeEmpty"/&gt;
                                        &lt;/xsl:when&gt;
                                        &lt;xsl:otherwise&gt;
                                            &lt;xsl:value-of select="'1'"/&gt;
                                        &lt;/xsl:otherwise&gt;
                                    &lt;/xsl:choose&gt;
                                &lt;/xsl:variable&gt;
                                &lt;xsl:variable name="charRight"&gt;
                                    &lt;xsl:value-of select="./following-sibling::wfocr:charParams[1]/@l[1]"/&gt;
                                &lt;/xsl:variable&gt;
                                &lt;xsl:variable name="charLength"&gt;
                                    &lt;xsl:value-of select="string-length(normalize-space($charValue))"/&gt;
                                &lt;/xsl:variable&gt;
                                &lt;xsl:variable name="textValue"&gt;
                                    &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                                &lt;/xsl:variable&gt;
                            &lt;xsl:variable name="followingSibling"&gt;
                                &lt;xsl:value-of select="normalize-space(following-sibling::wfocr:charParams[1]/text()[1])"/&gt;
                            &lt;/xsl:variable&gt;

                                &lt;xsl:choose&gt;
                                    &lt;xsl:when test="((((not($charValue) or contains($stopChars, $charValue)) ) or
                                    (contains($numberChars, $charValue) and not(contains($numberChars, $followingSibling)) and not(contains($stopChars, $followingSibling))) or
                                    (not(contains($numberChars, $charValue)) and not(contains($stopChars, $followingSibling)) and not(contains($numberSeparators, $charValue)) and not(contains($stopChars, $charValue)) and contains($numberChars,$rightCharValue) and (string-length($rightCharValueThatCanBeEmpty) &amp;gt; 0)) or
                                    (contains($numberChars, $leftCharValue) and not(contains($numberSeparators, $charValue)) and not(contains($numberChars,$charValue)) and contains($stopChars, $rightCharValue)) or
                                (contains($numberChars, $leftCharValue) and not(contains($numberChars, $charValue)) and contains($numberChars, $rightCharValue) and not(contains($stopChars, $charValue)) and not($isFirstCharInLine='1'))) ) and
                            (($charLength &amp;gt; 0 and not(contains($numberSeparators, $charValue))) or
                            ($charLength=0 and not(contains($numberChars, $leftCharValue) and contains($numberChars, $rightCharValue))) or
                            (($charLength &amp;gt; 0) and not(contains($numberSeparators, $charValue) and contains($numberChars, $leftCharValue) and contains($numberChars, $rightCharValue)))) and
                            (($charLength &amp;gt; 0 and not(contains($dateSeparators, $charValue))) or
                            ($charLength=0 and not(contains($numberChars, $leftCharValue) and contains($numberChars, $rightCharValue))) or
                            (($charLength &amp;gt; 0) and not(contains($dateSeparators, $charValue) and contains($numberChars, $leftCharValue) and contains($numberChars, $rightCharValue))))"&gt;

                                        &lt;xsl:variable name="followingSpace"&gt;
                                            &lt;xsl:choose&gt;
                                                &lt;xsl:when test="string-length(normalize-space(following-sibling::*[not(self::*[@charConfidence])][1]/@l[1])) &amp;gt; 0"&gt;
                                                    &lt;xsl:value-of select="number(normalize-space(following-sibling::*[not(self::*[@charConfidence])][1]/@l[1]))"/&gt;
                                                &lt;/xsl:when&gt;
                                                &lt;xsl:otherwise&gt;
                                                    &lt;xsl:value-of select="$lineRightValue"/&gt;
                                                &lt;/xsl:otherwise&gt;
                                            &lt;/xsl:choose&gt;
                                        &lt;/xsl:variable&gt;
                                        &lt;xsl:variable name="followingStopChar"&gt;
                                            &lt;xsl:choose&gt;
                                                &lt;xsl:when test="string-length(normalize-space(following-sibling::wfocr:charParams[contains($stopChars,normalize-space(self::*/text()))][1]/@l[1])) &amp;gt; 0"&gt;
                                                    &lt;xsl:value-of select="number(normalize-space(following-sibling::wfocr:charParams[contains($stopChars,normalize-space(self::*/text()))][1]/@l[1]))"/&gt;
                                                &lt;/xsl:when&gt;
                                                &lt;xsl:otherwise&gt;
                                                    &lt;xsl:value-of select="$lineRightValue"/&gt;
                                                &lt;/xsl:otherwise&gt;
                                            &lt;/xsl:choose&gt;
                                        &lt;/xsl:variable&gt;
                                        &lt;xsl:if test="number($width) &amp;gt; -1"&gt;
                                            &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt;
                                            &lt;xsl:if test="(string-length(normalize-space($charValue)) &amp;gt; 0)"&gt;

                                                                            &lt;word&gt;
                                                                                &lt;xsl:attribute name="t"&gt;
                                                                                    &lt;xsl:value-of select="number(./@t[1])"/&gt;
                                                                                &lt;/xsl:attribute&gt;
                                                                                &lt;xsl:attribute name="b"&gt;
                                                                                    &lt;xsl:value-of select="number(./@b[1])"/&gt;
                                                                                &lt;/xsl:attribute&gt;
                                                                                &lt;xsl:attribute name="l"&gt;
                                                                                    &lt;xsl:value-of select="number(./@l[1])"/&gt;
                                                                                &lt;/xsl:attribute&gt;
                                                                                &lt;xsl:attribute name="r"&gt;
                                                                                    &lt;xsl:value-of select="number(./@r[1])"/&gt;
                                                                                &lt;/xsl:attribute&gt;
                                                                                &lt;xsl:attribute name="isTab"&gt;
                                                                                    &lt;xsl:value-of select="'1'"/&gt;
                                                                                &lt;/xsl:attribute&gt;
                                                                                &lt;div&gt;
                                                                                    &lt;xsl:attribute name="style"&gt;top:&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number(./@l[1])"/&gt;px; width:&lt;xsl:value-of select="number(./@r[1])-number(./@l[1])"/&gt;px; height:&lt;xsl:value-of select="number($lineHeight)"/&gt;px; font-size: &lt;xsl:value-of select="number($fontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($fontHeight)"/&gt;px;&lt;/xsl:attribute&gt;
                                                                                    &lt;xsl:attribute name="class"&gt;n&lt;/xsl:attribute&gt;
                                                                                    &lt;xsl:attribute name="onload"&gt;divSize(this)&lt;/xsl:attribute&gt;
                                                                                    &lt;xsl:value-of select="normalize-space($charValue)"/&gt;
                                                                                &lt;/div&gt;
                                                                            &lt;/word&gt;
                                            &lt;/xsl:if&gt;
                                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)+number($lineHeight)"/&gt;" r="&lt;xsl:value-of select="number(./@r)+number($width)"/&gt;" l="&lt;xsl:value-of select="number(./@r)"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                                        &lt;xsl:value-of select="number($charConfidence)"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div onload="divSize(this)" style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($lineTop+$pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number(./@r)"/&gt;px; width:&lt;xsl:value-of select="number($width)"/&gt;px; height:&lt;xsl:value-of select="number($lineHeight)"/&gt;px; font-size: &lt;xsl:value-of select="number($fontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($fontHeight)"/&gt;px;" &lt;xsl:text disable-output-escaping="yes"&gt; class="n"&amp;gt;&lt;/xsl:text&gt;
                                        &lt;/xsl:if&gt;
                                    &lt;/xsl:when&gt;
                                    &lt;xsl:otherwise&gt;
                                        &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                                    &lt;/xsl:otherwise&gt;
                                &lt;/xsl:choose&gt;
&lt;!--                            &lt;/xsl:if&gt;--&gt;
                        &lt;/xsl:for-each&gt;
                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt;
                    &lt;/xsl:when&gt;
                    &lt;xsl:when test="$orientation='RotatedClockwise'"&gt;
                        &lt;xsl:variable name="startBottom"&gt;
                            &lt;xsl:value-of select="number(descendant::*[not(self::*[@charConfidence])][1]/@t)"/&gt;
                        &lt;/xsl:variable&gt;
                        &lt;xsl:variable name="startTop"&gt;
                            &lt;xsl:value-of select="number(descendant::*[1]/@t)"/&gt;
                        &lt;/xsl:variable&gt;
                        &lt;xsl:variable name="startHeight"&gt;
                            &lt;xsl:value-of select="number($startBottom)-number($startTop)"/&gt;
                        &lt;/xsl:variable&gt;
                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($startTop)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($pageHeight)+number($startBottom)"/&gt;" l="&lt;xsl:value-of select="number($lineLeft)"/&gt;" r="&lt;xsl:value-of select="number($lineLeft)+number($lineWidth)"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                        &lt;xsl:value-of select="number($charConfidence)"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($startTop)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number($lineLeft)"/&gt;px; width:&lt;xsl:value-of select="number($lineWidth)"/&gt;px; height:&lt;xsl:value-of select="number($startHeight)"/&gt;px; font-size: &lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;"&lt;xsl:text disable-output-escaping="yes"&gt;class="rc"&amp;gt;&lt;/xsl:text&gt;
                        &lt;xsl:for-each select="descendant::wfocr:charParams"&gt;
                            &lt;xsl:variable name="charValue"&gt;
                                &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                            &lt;/xsl:variable&gt;
                            &lt;xsl:choose&gt;
                                &lt;xsl:when test="not($charValue) or contains($stopChars, $charValue)"&gt;

                                    &lt;xsl:variable name="followingSpace"&gt;
                                        &lt;xsl:value-of select="number(normalize-space(following-sibling::*[not(self::wfocr:charParams[@charConfidence])][1]/@b))"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:variable name="followingStopChar"&gt;
                                        &lt;xsl:value-of select="number(normalize-space(following-sibling::*[contains($stopChars,normalize-space(self::wfocr:charParams/text()))][1]/@b))"/&gt;
                                    &lt;/xsl:variable&gt;

                                    &lt;xsl:variable name="top"&gt;
                                        &lt;xsl:value-of select="number(./@b)"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:variable name="bottom"&gt;
                                        &lt;xsl:choose&gt;
                                            &lt;xsl:when test="(string-length($followingSpace)=0) and (string-length($followingStopChar)=0) and string-length(normalize-space(following-sibling::wfocr:charParams[last()]/@b))=0"&gt;
                                                &lt;xsl:value-of select="$lineBottom"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="(string-length($followingSpace)=0) and (string-length($followingStopChar)=0)"&gt;
                                                &lt;xsl:value-of select="normalize-space(following-sibling::wfocr:charParams[last()]/@b)"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="(string-length($followingStopChar)=0)"&gt;
                                                &lt;xsl:value-of select="$followingSpace"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="(string-length($followingSpace)=0)"&gt;
                                                &lt;xsl:value-of select="$followingStopChar"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="$followingSpace &amp;lt; $followingStopChar"&gt;
                                                &lt;xsl:value-of select="$followingSpace"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="$followingSpace &amp;gt; $followingStopChar"&gt;
                                                &lt;xsl:value-of select="$followingStopChar"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:otherwise&gt;
                                                &lt;xsl:value-of select="$lineBottom"/&gt;
                                            &lt;/xsl:otherwise&gt;
                                        &lt;/xsl:choose&gt;
                                    &lt;/xsl:variable&gt;

                                    &lt;xsl:variable name="height"&gt;
                                        &lt;xsl:value-of select="number($bottom)-number($top)"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt;

                                    &lt;word&gt;
                                        &lt;xsl:attribute name="t"&gt;
                                            &lt;xsl:value-of select="number(./@t)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;xsl:attribute name="b"&gt;
                                            &lt;xsl:value-of select="number(./@b)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;xsl:attribute name="l"&gt;
                                            &lt;xsl:value-of select="number(./@l)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;xsl:attribute name="r"&gt;
                                            &lt;xsl:value-of select="number(./@r)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;xsl:attribute name="isTab"&gt;
                                            &lt;xsl:value-of select="'1'"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;div&gt;
                                            &lt;xsl:attribute name="style"&gt;top:&lt;xsl:value-of select="number(./@t)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number(./@l)"/&gt;px; width:&lt;xsl:value-of select="number(./@r)-number(./@l)"/&gt;px; height:&lt;xsl:value-of select="number(./@b)-number(./@t)"/&gt;px; font-size: &lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;
                                            &lt;/xsl:attribute&gt;
                                            &lt;xsl:attribute name="class"&gt;rc&lt;/xsl:attribute&gt;
                                            &lt;xsl:value-of select="$charValue"/&gt;
                                        &lt;/div&gt;
                                    &lt;/word&gt;

                                    &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($top)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($top)+number($pageHeight)+number($height)"/&gt;" r="&lt;xsl:value-of select="number($lineLeft)+number($lineWidth)"/&gt;" l="&lt;xsl:value-of select="number($lineLeft)"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                                    &lt;xsl:value-of select="number($charConfidence)"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div onload="divSize(this)" style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($top)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number($lineLeft)"/&gt;px; width:&lt;xsl:value-of select="number($lineWidth)"/&gt;px; height:&lt;xsl:value-of select="number($height)"/&gt;px; font-size: &lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;"
                                    &lt;xsl:text disable-output-escaping="yes"&gt; class="rc"&amp;gt;&lt;/xsl:text&gt;
                                &lt;/xsl:when&gt;
                                &lt;xsl:otherwise&gt;
                                    &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                                &lt;/xsl:otherwise&gt;
                            &lt;/xsl:choose&gt;

                        &lt;/xsl:for-each&gt;
                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt;

                    &lt;/xsl:when&gt;
                    &lt;xsl:when test="$orientation='RotatedCounterclockwise'"&gt;
                        &lt;xsl:variable name="startBottom"&gt;
                            &lt;xsl:value-of select="number(@b)"/&gt;
                        &lt;/xsl:variable&gt;
                        &lt;xsl:variable name="startTop"&gt;
                            &lt;xsl:value-of select="number(descendant::wfocr:charParams[1]/@b)"/&gt;
                        &lt;/xsl:variable&gt;

                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($startTop)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($pageHeight)+number($startBottom)"/&gt;" l="&lt;xsl:value-of select="number($lineLeft)"/&gt;" r="&lt;xsl:value-of select="number($lineLeft)+number($lineWidth)"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                        &lt;xsl:value-of select="number($charConfidence)"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($startTop)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number($lineLeft)"/&gt;px; width:&lt;xsl:value-of select="number($lineWidth)"/&gt;px; height:&lt;xsl:value-of select="number($startBottom)-number($startTop)"/&gt;px; font-size: &lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;"
                        &lt;xsl:text disable-output-escaping="yes"&gt;class="rcc"&amp;gt;&lt;/xsl:text&gt;
                        &lt;xsl:for-each select="descendant::wfocr:charParams"&gt;
                            &lt;xsl:variable name="charValue"&gt;
                                &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                            &lt;/xsl:variable&gt;

                            &lt;xsl:choose&gt;
                                &lt;xsl:when test="not($charValue)or contains($stopChars, $charValue)"&gt;
                                    &lt;xsl:variable name="followingSpace"&gt;
                                        &lt;xsl:value-of select="number(normalize-space(following-sibling::*[not(self::*[@charConfidence])][1]/@t[1]))"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:variable name="followingStopChar"&gt;
                                        &lt;xsl:value-of select="number(normalize-space(following-sibling::*[contains($stopChars,normalize-space(self::*/text()))][1]/@t[1]))"/&gt;
                                    &lt;/xsl:variable&gt;

                                    &lt;xsl:variable name="top"&gt;
                                        &lt;xsl:choose&gt;
                                            &lt;xsl:when test="(string-length($followingSpace)=0) and (string-length($followingStopChar)=0) and (string-length(normalize-space(following-sibling::*[last()]/@t[1]))&gt;0)"&gt;
                                                &lt;xsl:value-of select="normalize-space(following-sibling::*[last()][@t]/@t[1])"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="(string-length($followingStopChar)=0) and (string-length($followingSpace)&gt;0)"&gt;
                                                &lt;xsl:value-of select="$followingSpace"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="(string-length($followingSpace)=0) and (string-length($followingStopChar)&gt;0)"&gt;
                                                &lt;xsl:value-of select="$followingStopChar"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="(string-length($followingSpace)&gt;0) and ($followingSpace &amp;lt; $followingStopChar)"&gt;
                                                &lt;xsl:value-of select="$followingSpace"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:when test="string-length($followingStopChar)&gt;0"&gt;
                                                &lt;xsl:value-of select="$followingStopChar"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:otherwise&gt;
                                                &lt;xsl:value-of select="0"/&gt;
                                            &lt;/xsl:otherwise&gt;
                                        &lt;/xsl:choose&gt;
                                    &lt;/xsl:variable&gt;

                                    &lt;xsl:variable name="bottom"&gt;
                                        &lt;xsl:value-of select="number(./@b)"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:variable name="height"&gt;
                                        &lt;xsl:value-of select="number($bottom)-number($top)"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt;

                                    &lt;word&gt;
                                        &lt;xsl:attribute name="t"&gt;
                                            &lt;xsl:value-of select="number(./@t)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;xsl:attribute name="b"&gt;
                                            &lt;xsl:value-of select="number(./@b)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;xsl:attribute name="l"&gt;
                                            &lt;xsl:value-of select="number(./@l)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;xsl:attribute name="r"&gt;
                                            &lt;xsl:value-of select="number(./@r)"/&gt;
                                        &lt;/xsl:attribute&gt;
                                        &lt;div&gt;
                                            &lt;xsl:attribute name="style"&gt;top:&lt;xsl:value-of select="number(./@t+$pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number(./@l)"/&gt;px; width:&lt;xsl:value-of select="number(./@r)-number(./@l)"/&gt;px; height:&lt;xsl:value-of select="number(./@b)-number(./@t)"/&gt;px; font-size: &lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;
                                            &lt;/xsl:attribute&gt;
                                            &lt;xsl:attribute name="class"&gt;rcc&lt;/xsl:attribute&gt;
                                            &lt;xsl:value-of select="$charValue"/&gt;
                                        &lt;/div&gt;
                                    &lt;/word&gt;

                                    &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($top)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($top)+number($pageHeight)+number($height)"/&gt;" r="&lt;xsl:value-of select="number($lineLeft)+number($lineWidth)"/&gt;" l="&lt;xsl:value-of select="number($lineLeft)"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                                    &lt;xsl:value-of select="number($charConfidence)"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($top)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number($lineLeft)"/&gt;px; width:&lt;xsl:value-of select="number($lineWidth)"/&gt;px; height:&lt;xsl:value-of select="number($height)"/&gt;px; font-size: &lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($rotatedFontHeight)"/&gt;px;"
                                    &lt;xsl:text disable-output-escaping="yes"&gt; class="rcc"&amp;gt;&lt;/xsl:text&gt;
                                &lt;/xsl:when&gt;
                                &lt;xsl:otherwise&gt;
                                    &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                                &lt;/xsl:otherwise&gt;
                            &lt;/xsl:choose&gt;
                        &lt;/xsl:for-each&gt;

                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt;
                    &lt;/xsl:when&gt;

                    &lt;xsl:otherwise&gt;
                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)+number($lineHeight)"/&gt;" l="&lt;xsl:value-of select="number($lineLeft)"/&gt;" r="&lt;xsl:value-of select="number($lineLeft)+number($lineWidth)"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                        &lt;xsl:value-of select="$charConfidence"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number($lineLeft)"/&gt;px; width:&lt;xsl:value-of select="number($lineWidth)"/&gt;px; height:&lt;xsl:value-of select="number($lineHeight)"/&gt;px; font-size: &lt;xsl:value-of select="number($fontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($fontHeight)"/&gt;px;"
                        &lt;xsl:text disable-output-escaping="yes"&gt;class="t"&amp;gt;&lt;/xsl:text&gt;
                        &lt;xsl:for-each select="descendant::wfocr:charParams"&gt;
                            &lt;xsl:choose&gt;
                                &lt;xsl:when test="not(normalize-space(./text()))"&gt;
                                    &lt;xsl:variable name="right"&gt;
                                        &lt;xsl:value-of select="number(following-sibling::*[not(self::*[@charConfidence])][1]/@l[1])"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:variable name="left"&gt;
                                        &lt;xsl:value-of select="number(./@r)"/&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:variable name="width"&gt;
                                        &lt;xsl:choose&gt;
                                            &lt;xsl:when test="not(normalize-space($right))"&gt;
                                                &lt;xsl:value-of select="number($lineRight)-number($left)"/&gt;
                                            &lt;/xsl:when&gt;
                                            &lt;xsl:otherwise&gt;
                                                &lt;xsl:value-of select="number($right)-number($left)"/&gt;
                                            &lt;/xsl:otherwise&gt;
                                        &lt;/xsl:choose&gt;
                                    &lt;/xsl:variable&gt;
                                    &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt; &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;word t&lt;/xsl:text&gt;="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;" b="&lt;xsl:value-of select="number($lineTop)+number($pageHeight)+number($lineHeight)"/&gt;" r="&lt;xsl:value-of select="number(./@r[1])+number($width)"/&gt;" l="&lt;xsl:value-of select="number(./@r[1])"/&gt;"&lt;xsl:text disable-output-escaping="yes"&gt; charConfidence="&lt;/xsl:text&gt;
                                    &lt;xsl:value-of select="$charConfidence"/&gt; &lt;xsl:text disable-output-escaping="yes"&gt;"&amp;gt;&amp;lt;div style&lt;/xsl:text&gt;= "top:&lt;xsl:value-of select="number($lineTop)+number($pageHeight)"/&gt;px;left:&lt;xsl:value-of select="number(./@r[1])"/&gt;px; width:&lt;xsl:value-of select="number($width)"/&gt;px; height:&lt;xsl:value-of select="number($lineHeight)"/&gt;px; font-size: &lt;xsl:value-of select="number($fontHeight)"/&gt;px;line-height:&lt;xsl:value-of select="number($fontHeight)"/&gt;px;"
                                    &lt;xsl:text disable-output-escaping="yes"&gt;class="t"&amp;gt;&lt;/xsl:text&gt;
                                &lt;/xsl:when&gt;
                                &lt;xsl:otherwise&gt;
                                    &lt;xsl:value-of select="normalize-space(./text())"/&gt;
                                &lt;/xsl:otherwise&gt;
                            &lt;/xsl:choose&gt;
                        &lt;/xsl:for-each&gt;
                        &lt;xsl:text disable-output-escaping="yes"&gt;&amp;lt;/div&amp;gt;&amp;lt;/word&amp;gt;&lt;/xsl:text&gt;
                    &lt;/xsl:otherwise&gt;
                &lt;/xsl:choose&gt;
            &lt;/formatting&gt;
        &lt;/line&gt;
    &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
]]&gt;&lt;/template&gt;&lt;/stylesheet&gt;
		&lt;/xslt&gt;
	&lt;/var-def&gt;

	&lt;var-def name="htmlWordsDocument"&gt;
		&lt;script return="addImgTag(htmlWordsDocumentRaw.toString(), placeholder.toString(), imageLink.toString())"&gt;&lt;/script&gt;
	&lt;/var-def&gt;

	&lt;var-def name="ocr_tood_document_url"&gt;
        &lt;s3 bucket="${s3_bucket_name}"&gt;
            &lt;s3-put-public path="${bp_run_id}/${document_uuid}/${ocr_document_name}-tood.xml" content-type="text/html; charset=utf-8" content-disposition="inline" content="${htmlWordsDocument}"/&gt;
        &lt;/s3&gt;
    &lt;/var-def&gt;
    
  	&lt;loop item="map" maxloops="1"&gt;
		&lt;list&gt;
			&lt;var name="ocr_result_list" /&gt;
		&lt;/list&gt;
		&lt;body&gt;
			&lt;script language="groovy"&gt;&lt;![CDATA[
				import com.google.gson.Gson;
				
				map.getWrappedObject().put("ocr_tood_document_url", ocr_tood_document_url.toString());
				map.getWrappedObject().put("ocr_tood_document_name", ocr_tood_document_url.toString().substring(ocr_tood_document_url.toString().lastIndexOf("/") + 1, ocr_tood_document_url.toString().lastIndexOf(".")));
				update_ocr_result_list.toList().add(new HashMap(map.getWrappedObject()));

				Gson gson = new Gson();
				String result_json = gson.toJson(update_ocr_result_list.toList());
				sys.defineVariable("ocr_json", result_json);
			]]&gt;&lt;/script&gt;
		&lt;/body&gt;
	&lt;/loop&gt;

    &lt;export include-original-data="true"&gt;
      	&lt;single-column name="ocr_json" value="${ocr_json}" /&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>99aa06b1-1269-4fb6-ad96-28de0999bfcd</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE [TOOD] XSLT XML Enrichment with WORD and DIV tags</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>99aa06b1-1269-4fb6-ad96-28de0999bfcd</uuid>
                                    <version>
                                        <componentUuid>9ebe616a-2582-4739-821c-3566d57aface</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>7408fec0-710d-47bc-8f4f-6f9771cbbacf</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE [TOOD] XSLT XML Enrichment with WORD and DIV tags</title>
                                <type>SINGLE</type>
                                <uuid>e447d790-357a-4052-b77b-755c3025bb79</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>17d3ffdc-3c4d-436b-a9d0-b20109a27560</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>22f7ea06-6b35-46b1-b5a4-b941e948693e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>54</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>ba0f919d-e88a-484c-815b-4b9d2b33b6b9</uuid>
                        </campaignMap>
                        <campaignMap>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"TOOD","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_type","value":"tood","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'TOOD' when ocr_type EQ 'tood'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_type", "EQ", "tood"));

    then
        $ctx.sendResultTo("TOOD", $item);
end

# RuleOutcome.Definition={"outcomeId":"Standard","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_type","value":"standard","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'Standard' when ocr_type EQ 'standard'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_type", "EQ", "standard"));

    then
        $ctx.sendResultTo("Standard", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>OCR Type</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>f433264b-fdca-4208-9fa1-3347543407e7</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;var-def name="exportType"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_type")}'&gt;
                &lt;template&gt;${_sys_export_type}&lt;/template&gt;
            &lt;/if&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="exportColumns"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_columns")}'&gt;
                &lt;template&gt;${_sys_export_columns}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="columnNameCase"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_column_name_case")}'&gt;
                &lt;template&gt;${_sys_column_name_case}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;keep&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="dataOnly"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_data_only")}'&gt;
                &lt;template&gt;${_sys_data_only}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;true&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="datastoreName"&gt;
        &lt;script return="item.getWrappedObject().getRun().getDatastoreName()" /&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!datastoreName.isEmpty()}"&gt;
            &lt;insert-datastore   datastore-name="${datastoreName}" create="true"&gt;
                &lt;script return="hit_submission_data_item.getWrappedObject().getItemValueMap()"/&gt;
            &lt;/insert-datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"
            export-type="${exportType}"
            export-columns="${exportColumns}"
            column-name-case="${columnNameCase}"
            data-only="${dataOnly}"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>Default machine campaign for end step.</description>
                                    <includedConfigs/>
                                    <inclusionCode>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</inclusionCode>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <name>Final Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</uuid>
                                    <version>
                                        <componentUuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-08-21T10:54:19Z</lastModified>
                                        <versionUuid>71976d1d-a48f-4ce5-ae4d-10203991bf95</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>100</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Percents</streamValueType>
                                <title>Final Results</title>
                                <type>SINGLE</type>
                                <uuid>af4c8905-26dd-4120-b208-39ad3530ffc6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>a7c3c527-28fb-11e8-bf41-000d3a0302a9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>false</lastInChain>
                                    <lastModified>2018-08-21T10:54:19Z</lastModified>
                                    <versionUuid>56d0500e-1f1a-4755-9c95-600a8de71b5e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>55</stepIndex>
                            <stepPosition>SUBEND</stepPosition>
                            <uuid>49336325-6369-48f2-b990-3c8c397b7812</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"OCR Failed","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_failed","value":"true","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'OCR Failed' when ocr_failed EQ 'true'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_failed", "EQ", "true"));

    then
        $ctx.sendResultTo("OCR Failed", $item);
end

# RuleOutcome.Definition={"outcomeId":"TOOD","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_failed","value":"false","operator":"EQ"},{"fieldName":"ocr_type","value":"tood","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'TOOD' when ocr_failed EQ 'false' AND ocr_type EQ 'tood'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_failed", "EQ", "false"));
        eval($item.checkValue("ocr_type", "EQ", "tood"));

    then
        $ctx.sendResultTo("TOOD", $item);
end

# RuleOutcome.Definition={"outcomeId":"Standard","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_failed","value":"false","operator":"EQ"},{"fieldName":"ocr_type","value":"standard","operator":"EQ"},{"fieldName":"xml_export_format_flag","value":"true","operator":"EQ"}],"customConditions":[]}
rule "3. Send records to 'Standard' when ocr_failed EQ 'false' AND ocr_type EQ 'standard' AND xml_export_format_flag EQ 'true'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_failed", "EQ", "false"));
        eval($item.checkValue("ocr_type", "EQ", "standard"));
        eval($item.checkValue("xml_export_format_flag", "EQ", "true"));

    then
        $ctx.sendResultTo("Standard", $item);
end

# RuleOutcome.Definition={"outcomeId":"Standard (without xml export format)","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"ocr_failed","value":"false","operator":"EQ"},{"fieldName":"ocr_type","value":"standard","operator":"EQ"},{"fieldName":"xml_export_format_flag","value":"false","operator":"EQ"}],"customConditions":[]}
rule "4. Send records to 'Standard (without xml export format)' when ocr_failed EQ 'false' AND ocr_type EQ 'standard' AND xml_export_format_flag EQ 'false'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("ocr_failed", "EQ", "false"));
        eval($item.checkValue("ocr_type", "EQ", "standard"));
        eval($item.checkValue("xml_export_format_flag", "EQ", "false"));

    then
        $ctx.sendResultTo("Standard (without xml export format)", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>OCR Router</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>a4212d99-92e3-46cc-8662-1c3d98a2ec93</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to get response from OCR api, and if OCR Process is "Completed", get OCRed document for each OCR export format parameter, put them on S3 and create OCR JSON with result OCR information.
--&gt;

&lt;config charset="UTF-8"&gt;
  
  	&lt;var-def name="ocr_url"&gt;
  		&lt;var-global name="ocr_url"/&gt;
  	&lt;/var-def&gt;
    
    &lt;var-def name="ocr_username"&gt;
  		&lt;var-global name="ocr_username"/&gt;
  	&lt;/var-def&gt;
  
    &lt;var-def name="ocr_password"&gt;
  		&lt;var-global name="ocr_password"/&gt;
  	&lt;/var-def&gt;
  
	&lt;var-def name="ocr_failed"&gt;
		false
	&lt;/var-def&gt;

	&lt;var-def name="xml_export_format_flag"&gt;
		false
	&lt;/var-def&gt;
  
  	&lt;var-def name="statusResponse"&gt;
      	&lt;case&gt;
			&lt;if condition='${ocr_username.toString().isEmpty() || ocr_password.toString().isEmpty()}'&gt;
				&lt;http url="${ocr_url.toString()}/getTaskStatus?taskId=${ocr_task_id.toString()}" method="get" /&gt;
			&lt;/if&gt;
          	&lt;else&gt;
            	&lt;http url="${ocr_url.toString()}/getTaskStatus?taskId=${ocr_task_id.toString()}" method="get" username="${ocr_username.toString()}" password="${ocr_password.toString()}" /&gt;
          	&lt;/else&gt;
		&lt;/case&gt;
	&lt;/var-def&gt;

	&lt;var-def name="taskStatus"&gt;
      	&lt;xpath expression="string(//response/task/@status)"&gt;
			&lt;var name="statusResponse" /&gt;
		&lt;/xpath&gt;
	&lt;/var-def&gt;

	&lt;case&gt;
		&lt;if
			condition='${!"Completed".equals(taskStatus.toString()) @and !"ProcessingFailed".equals(taskStatus.toString())}'&gt;
			&lt;release time-in-seconds="30" /&gt;
			&lt;exit /&gt;
		&lt;/if&gt;

		&lt;if condition='${"ProcessingFailed".equals(taskStatus.toString())}'&gt;
			&lt;script&gt;&lt;![CDATA[
				sys.defineVariable("ocr_failed", true);
				sys.defineVariable("ocr_failed_response", statusResponse);
			]]&gt;&lt;/script&gt;
		&lt;/if&gt;

		&lt;if condition='${"Completed".equals(taskStatus.toString())}'&gt;

			&lt;script language="groovy"&gt;&lt;![CDATA[
				import groovy.json.JsonSlurper;

				List export_format_list = Arrays.asList(no_cached_export_format.toString().split(","));
				sys.defineVariable("export_format_list", export_format_list);

				List&lt;Map&gt; ocr_result_list = new ArrayList();
				sys.defineVariable("ocr_result_list", ocr_result_list);

				def original_document_url_object = new java.net.URI(original_document_url.toString())
				def original_document_name = original_document_url_object.getPath().tokenize('/').last().tokenize('.').first()
				
				sys.defineVariable("original_document_name", original_document_name);
			]]&gt;&lt;/script&gt;

			&lt;loop item="format"&gt;
				&lt;list&gt;
					&lt;var name="export_format_list" /&gt;
				&lt;/list&gt;
				&lt;body&gt;
					&lt;case&gt;
						&lt;if condition='${export_format_list.toList().indexOf(format) == 0}'&gt;
							&lt;var-def name="result_url"&gt;
								&lt;xpath expression="string(//response/task/@resultUrl)"&gt;
									&lt;var name="statusResponse" /&gt;
								&lt;/xpath&gt;
							&lt;/var-def&gt;
						&lt;/if&gt;

						&lt;if condition='${export_format_list.toList().indexOf(format) == 1}'&gt;
							&lt;var-def name="result_url"&gt;
								&lt;xpath expression="string(//response/task/@resultUrl2)"&gt;
									&lt;var name="statusResponse" /&gt;
								&lt;/xpath&gt;
							&lt;/var-def&gt;
						&lt;/if&gt;

						&lt;if condition='${export_format_list.toList().indexOf(format) == 2}'&gt;
							&lt;var-def name="result_url"&gt;
								&lt;xpath expression="string(//response/task/@resultUrl3)"&gt;
									&lt;var name="statusResponse" /&gt;
								&lt;/xpath&gt;
							&lt;/var-def&gt;
						&lt;/if&gt;
					&lt;/case&gt;

					&lt;case&gt;
						&lt;if condition='${export_format_list.toList().indexOf(format) @lt 3}'&gt;
							&lt;var-def name="result"&gt;
								&lt;http url="${result_url}" charset="UTF-8" /&gt;
							&lt;/var-def&gt;

							&lt;case&gt;
								&lt;if condition='${format.toString().equals("html")}'&gt;
									&lt;var-def name="path"&gt;
										&lt;template&gt;${bp_run_id}/${document_uuid}/${original_document_name}-html.html&lt;/template&gt;
									&lt;/var-def&gt;

									&lt;var-def name="type"&gt;
										&lt;template&gt;text/html&lt;/template&gt;
									&lt;/var-def&gt;
								&lt;/if&gt;
								&lt;if condition='${format.toString().equals("pdfSearchable")}'&gt;
									&lt;var-def name="path"&gt;
										&lt;template&gt;${bp_run_id}/${document_uuid}/${original_document_name}-pdf.pdf&lt;/template&gt;
									&lt;/var-def&gt;

									&lt;var-def name="type"&gt;
										&lt;template&gt;application/pdf&lt;/template&gt;
									&lt;/var-def&gt;
								&lt;/if&gt;
								&lt;if condition='${format.toString().equals("xml")}'&gt;
									&lt;var-def name="xml_export_format_flag"&gt;
										&lt;script return="flag"&gt;&lt;![CDATA[
											String flag = "true";
										]]&gt;&lt;/script&gt;
									&lt;/var-def&gt;

									&lt;var-def name="result"&gt;
										&lt;script return="res"&gt;&lt;![CDATA[
											// Removing BOM
											String res = result.toString().replaceAll("^\uFEFF", "");
										]]&gt;&lt;/script&gt;
									&lt;/var-def&gt;

									&lt;var-def name="path"&gt;
										&lt;template&gt;${bp_run_id}/${document_uuid}/${original_document_name}-xml.xml&lt;/template&gt;
									&lt;/var-def&gt;

									&lt;var-def name="type"&gt;
										&lt;template&gt;text/xml&lt;/template&gt;
									&lt;/var-def&gt;
								&lt;/if&gt;
								&lt;if condition='${format.toString().equals("xmlForCorrectedImage")}'&gt;
									&lt;var-def name="xml_export_format_flag"&gt;
										&lt;script return="flag"&gt;&lt;![CDATA[
											String flag = "true";
										]]&gt;&lt;/script&gt;
									&lt;/var-def&gt;

									&lt;var-def name="result"&gt;
										&lt;script return="res"&gt;&lt;![CDATA[
											// Removing BOM
											String res = result.toString().replaceAll("^\uFEFF", "");
										]]&gt;&lt;/script&gt;
									&lt;/var-def&gt;

									&lt;var-def name="path"&gt;
										&lt;template&gt;${bp_run_id}/${document_uuid}/${original_document_name}-xmlForCorrectedImage.xml&lt;/template&gt;
									&lt;/var-def&gt;

									&lt;var-def name="type"&gt;
										&lt;template&gt;text/xml&lt;/template&gt;
									&lt;/var-def&gt;
								&lt;/if&gt;
								&lt;if condition='${format.toString().equals("txt")}'&gt;
									&lt;var-def name="path"&gt;
										&lt;template&gt;${bp_run_id}/${document_uuid}/${original_document_name}-txt.txt&lt;/template&gt;
									&lt;/var-def&gt;

									&lt;var-def name="type"&gt;
										&lt;template&gt;text/plain&lt;/template&gt;
									&lt;/var-def&gt;
								&lt;/if&gt;
							&lt;/case&gt;

							&lt;var-def name="ocr_document_url"&gt;
								&lt;s3 bucket="${s3_bucket_name}"&gt;
									&lt;s3-put-public path="${path}" content="${result}"
										content-type="${type}" content-disposition="inline" /&gt;
								&lt;/s3&gt;
							&lt;/var-def&gt;
                          
                          	&lt;var-def name="original_document_url_text"&gt;
								&lt;template&gt;${original_document_url.toString()}&lt;/template&gt;
							&lt;/var-def&gt;
							
							&lt;s3 bucket="${s3_bucket_name}"&gt;
								&lt;s3-put-public path="${bp_run_id}/${document_uuid}/original-document-url.txt" content="${original_document_url_text}"
									content-type="text/plain" content-disposition="inline" /&gt;
							&lt;/s3&gt;

							&lt;script language="groovy"&gt;&lt;![CDATA[
								def ocr_document_name = ocr_document_url.toString().tokenize('/').last().tokenize('.').first()
							
								Map map = new HashMap();
								
								map.put("original_document_url", original_document_url.toString());
								map.put("original_document_name", original_document_name.toString());
								map.put("ocr_document_url", ocr_document_url.toString());
								map.put("ocr_document_name", ocr_document_name);
								map.put("ocr_export_format", format.toString());
								map.put("ocr_document_format", path.toString().substring(path.toString().lastIndexOf(".") + 1, path.toString().length()));

								ocr_result_list.toList().add(map);
							]]&gt;&lt;/script&gt;
						&lt;/if&gt;
					&lt;/case&gt;

				&lt;/body&gt;
			&lt;/loop&gt;

			&lt;script language="groovy"&gt;&lt;![CDATA[
				import com.google.gson.Gson;

				Gson gson = new Gson();
				String result_json = gson.toJson(ocr_result_list.toList());
				sys.defineVariable("ocr_json", result_json);
			]]&gt;&lt;/script&gt;
		&lt;/if&gt;
	&lt;/case&gt;

	&lt;export include-original-data="true"&gt;
		&lt;single-column name="xml_export_format_flag" value="${xml_export_format_flag}" /&gt;
		&lt;single-column name="ocr_failed" value="${ocr_failed}" /&gt;
		&lt;single-column name="ocr_failed_response" value="${ocr_failed_response}" /&gt;
		&lt;single-column name="ocr_json" value="${ocr_json}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>a68343c8-5481-487b-aa56-dab1a3216058</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE Response from OCR</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>a68343c8-5481-487b-aa56-dab1a3216058</uuid>
                                    <version>
                                        <componentUuid>97066acd-05d1-4a87-bf3c-fb4bf9cfc231</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>9ae6ed41-5303-4e8d-90d2-523d67e90658</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE Response from OCR</title>
                                <type>SINGLE</type>
                                <uuid>8ffa204d-6884-41a2-9e56-306867ff76a6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>2d14a21a-2b13-4590-b914-6607fa0ad5f1</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>6923375b-9c59-4dd5-bf9f-c2c87d419da5</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>56</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>aa04bcac-01f2-4bd8-97c9-95dd112489c9</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>fa4cd5f0-a041-436a-9136-3159a6293226</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  	
  	&lt;script&gt;&lt;![CDATA[
		import groovy.json.JsonSlurper;

		result = new JsonSlurper().parseText(ocr_json.toString());
		ocr_document_url = result.xmlForCorrectedImage.ocr_tood_document_url;
	]]&gt;&lt;/script&gt;
  
	&lt;export include-original-data="true"&gt;
    	&lt;single-column name="ocr_document_url" value="${ocr_document_url}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>114fbb19-c6a6-4c55-a231-752feae3d038</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[TOOD] Prepare URL- ATROCR_</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>114fbb19-c6a6-4c55-a231-752feae3d038</uuid>
                                    <version>
                                        <componentUuid>0c26237a-4245-41d5-9d11-b777a0bb10cb</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>1f32699d-1489-4642-9024-dfc243f1827d</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[TOOD] Prepare URL- ATROCR_</title>
                                <type>SINGLE</type>
                                <uuid>0a632e79-6225-4972-92f3-7e0457d6f98e</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>416cc939-0958-48f2-88ed-a56b6b87a35e</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>588788fc-2b58-4c58-a096-4fe0c0e3a30f</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>57</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>9aab8df9-b254-414a-a149-68fb47f15ec6</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>3f2721de-2e1b-42f4-9d92-1f689da52b6d</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

	&lt;var-def name="content"&gt;
		&lt;http url="${ocr_document_url_additional_processing}" /&gt;
	&lt;/var-def&gt;

	&lt;script&gt;&lt;![CDATA[
		String content_updated = content.toString();
		content_updated = content_updated.replaceAll("&#246;", "oe").replaceAll("&#252;", "ue").replaceAll("&#228;", "ae").replaceAll("&#196;", "A").replaceAll("&#214;", "O").replaceAll("&#220;", "U").replaceAll("&#223;", "ss").replaceAll("&#248;", "o").replaceAll("&#216;", "O").replaceAll("&#229;", "a").replaceAll("&#197;", "A").replaceAll("&#233;", "e").replaceAll("&#230;", "ae");
		
		String folder = ocr_document_url_additional_processing.toString().substring(0, ocr_document_url_additional_processing.toString().lastIndexOf("/")).replaceAll("https://wfapp-s3-dev.workfusion.pg.com/ne-ocr-processing/", "")
		String file_name = ocr_document_url_additional_processing.toString().substring(ocr_document_url_additional_processing.toString().lastIndexOf("/") + 1, ocr_document_url_additional_processing.toString().length() - 4) + "_without_umlauts.xml";
		
		sys.defineVariable("content_updated", content_updated);
		sys.defineVariable("folder", folder);
		sys.defineVariable("file_name", file_name);
	]]&gt;&lt;/script&gt;

	&lt;var-def name="ocr_document_url_additional_processing_umlauts_fix"&gt;
		&lt;s3 bucket="${s3_bucket_name}"&gt;
			&lt;s3-put	path="${folder}/${file_name}"
				acl="PublicRead" content-type="text/html"
				content-disposition="inline"&gt;
				&lt;var name="content_updated"/&gt;
			&lt;/s3-put&gt;
		&lt;/s3&gt;
	&lt;/var-def&gt;

	&lt;export include-original-data="true"&gt;
			&lt;single-column name="ocr_document_url_additional_processing" value="${ocr_document_url_additional_processing_umlauts_fix}" /&gt;
			&lt;single-column name="document_link" value="${document_link}" /&gt;
	&lt;/export&gt;

&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>8aa1a41a-3196-4da0-afb1-86a1222b7885</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Umlauts replacement</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>8aa1a41a-3196-4da0-afb1-86a1222b7885</uuid>
                                    <version>
                                        <componentUuid>0a97545e-1983-4bf9-887f-abb9215adfa4</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>bd14a125-ff5f-420e-afd0-9c63853c7e47</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Umlauts replacement</title>
                                <type>SINGLE</type>
                                <uuid>5435720b-a7e6-4813-ad51-4d093234c291</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>6f460653-b27f-4e34-8a77-5697e28526ce</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>d3e194a0-73fb-4435-99fb-89cfc5f1e09c</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>58</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>0382b978-1d37-447c-843c-b89b180b6a42</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"Yes","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"cache_hit","value":"full","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'Yes' when cache_hit EQ 'full'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("cache_hit", "EQ", "full"));

    then
        $ctx.sendResultTo("Yes", $item);
end



# RuleOutcome.Definition={"outcomeId":"No","conditional":false,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[],"customConditions":[]}
rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>Cache hit?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>83a9df55-1f0a-40f1-9e27-f51bc9c7b01c</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
Step to look for OCR cache for each OCR export format by all input parameters, and if it full hits we go to last BP step, otherwise go to the OCR step.
--&gt;

&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;

	&lt;var-def name="document_link"&gt;
		&lt;template&gt;${sys.getVar("original_document_url")}&lt;/template&gt;
	&lt;/var-def&gt;

	&lt;script&gt;&lt;![CDATA[
		isUnsuccessfulStatusCode = {statusCode -&gt; return statusCode.toString().matches('^[45]\\d{2}')};
	]]&gt;&lt;/script&gt;

	&lt;try&gt;
		&lt;body&gt;
			&lt;var-def name="document"&gt;
				&lt;http url="${document_link}" /&gt;
			&lt;/var-def&gt;
		&lt;/body&gt;
		&lt;catch&gt;
		&lt;/catch&gt;
	&lt;/try&gt;

	&lt;case&gt;
		&lt;if condition="${isUnsuccessfulStatusCode(http.statusCode)}"&gt;
			&lt;try&gt;
				&lt;body&gt;
					&lt;var-def name="document_link"&gt;
						&lt;template&gt;${org.apache.commons.httpclient.util.URIUtil.encodeQuery(document_link.toString())}
						&lt;/template&gt;
					&lt;/var-def&gt;
					&lt;var-def name="document"&gt;
						&lt;http url="${document_link}" /&gt;
					&lt;/var-def&gt;
				&lt;/body&gt;
				&lt;catch&gt;
				&lt;/catch&gt;
			&lt;/try&gt;
		&lt;/if&gt;
	&lt;/case&gt;

	&lt;case&gt;
		&lt;if condition="${isUnsuccessfulStatusCode(http.statusCode)}"&gt;
			&lt;script&gt;&lt;![CDATA[
				throw new RuntimeException("Failed to fetch url: " + document_link + " status code: " + http.statusCode);
			]]&gt;&lt;/script&gt;
		&lt;/if&gt;
	&lt;/case&gt;

	&lt;var-def name="document_hash"&gt;
		&lt;template&gt;${sys.getVar("document_hash")}&lt;/template&gt;
	&lt;/var-def&gt;
	&lt;case&gt;
		&lt;if condition="${document_hash.toString().length() == 0}"&gt;
			&lt;var-def name="document_hash"&gt;
				&lt;script
					return="org.apache.commons.codec.digest.DigestUtils.md5Hex(document.toBinary())" /&gt;
			&lt;/var-def&gt;
		&lt;/if&gt;
	&lt;/case&gt;

	&lt;!-- If the datastore is missing --&gt;
	&lt;create-datastore name="${cache_datastore}"&gt;
		&lt;datastore-column name="key" /&gt;
		&lt;datastore-column name="ocr_type" /&gt;
		&lt;datastore-column name="export_format" /&gt;
		&lt;datastore-column name="document_language" /&gt;
		&lt;datastore-column name="ocr_xml_char_recognition" /&gt;
		&lt;datastore-column name="allowed_region_types" /&gt;
		&lt;datastore-column name="custom_regions" /&gt;
		&lt;datastore-column name="change_dpi" /&gt;
		&lt;datastore-column name="invert_image" /&gt;
		&lt;datastore-column name="discard_color_image" /&gt;
		&lt;datastore-column name="remove_color_objects" /&gt;
		&lt;datastore-column name="remove_color_objects_type" /&gt;
	&lt;/create-datastore&gt;

	&lt;script&gt;&lt;![CDATA[
		export_format_list = Arrays.asList(export_format.toString().split(","));
		sys.defineVariable("exportFormatList", export_format_list);

		no_cached_export_format_list = new ArrayList(export_format_list);

		List ocr_result_list = new ArrayList();
		sys.defineVariable("ocr_result_list", ocr_result_list);
	]]&gt;&lt;/script&gt;

	&lt;loop item="format"&gt;
		&lt;list&gt;
			&lt;var name="exportFormatList" /&gt;
		&lt;/list&gt;
		&lt;body&gt;
			&lt;var-def name="cachedRecord"&gt;
				&lt;datastore name="${cache_datastore}" max="1"&gt;
            		&lt;template&gt;
            			SELECT * FROM @this WHERE "key"='${document_hash}' AND "ocr_type"='${ocr_type}' AND "export_format"='${format}' AND "document_language"='${document_language}' AND "ocr_xml_char_recognition"='${ocr_xml_char_recognition}' AND "allowed_region_types"='${allowed_region_types}' AND "custom_regions"='${custom_regions}' AND "change_dpi"='${change_dpi}' AND "invert_image"='${invert_image}' AND "discard_color_image"='${discard_color_image}' AND "remove_color_objects"='${remove_color_objects}' AND "remove_color_objects_type"='${remove_color_objects_type}'    
          			&lt;/template&gt;
				&lt;/datastore&gt;
			&lt;/var-def&gt;
          
          	&lt;case&gt;
				&lt;if condition='${cachedRecord.toString().length() != 0}'&gt;
                  	&lt;var-def name="value"&gt;
                            &lt;xpath expression='/row/ocr_json/text()'&gt;
                                &lt;var name="cachedRecord"/&gt;
                            &lt;/xpath&gt;
                    &lt;/var-def&gt;
                  
					&lt;script&gt;&lt;![CDATA[
						no_cached_export_format_list.remove(format.toString());

						ocr_result_list.toList().add(new HashMap(new groovy.json.JsonSlurper().parseText(value.toString())));
					]]&gt;&lt;/script&gt;
				&lt;/if&gt;
			&lt;/case&gt;  
		&lt;/body&gt;
	&lt;/loop&gt;
  
  	&lt;script&gt;&lt;![CDATA[
		import com.google.gson.Gson;

		String no_cached_export_format = no_cached_export_format_list.toString().replaceAll("[\\[\\]\\s]","");
		sys.defineVariable("no_cached_export_format", no_cached_export_format);

		Gson gson = new Gson();
		String result_json = gson.toJson(ocr_result_list.toList());
		sys.defineVariable("cached_ocr_json", result_json);
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
		&lt;single-column name="document_hash" value="${document_hash}" /&gt;
      	&lt;single-column name="no_cached_export_format" value="${no_cached_export_format}" /&gt;
      	&lt;case&gt;
            &lt;if condition='${no_cached_export_format_list.size() == export_format_list.size()}'&gt;
            	&lt;single-column name="cache_hit" value="none"/&gt;
            &lt;/if&gt;
          	&lt;if condition='${no_cached_export_format_list.size() == 0}'&gt;
            	&lt;single-column name="cache_hit" value="full"/&gt;
              	&lt;single-column name="ocr_failed" value="false"/&gt;
            &lt;/if&gt;
            &lt;else&gt;
                &lt;single-column name="cache_hit" value="half"/&gt;
            &lt;/else&gt;
        &lt;/case&gt;
      	&lt;single-column name="cached_ocr_json" value="${cached_ocr_json}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>d4bd1496-2f53-48da-830a-e342462f9972</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>NE Look for OCR cache</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>d4bd1496-2f53-48da-830a-e342462f9972</uuid>
                                    <version>
                                        <componentUuid>322f8f1b-f547-4b1c-bef5-89706342b047</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>20610de3-be23-4917-9037-2559f5f862f9</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>NE Look for OCR cache</title>
                                <type>SINGLE</type>
                                <uuid>2c055696-e4aa-49d1-b889-f9acbdd9f08c</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>1dbdb8df-f1c0-4a05-84ae-66fb3e550c85</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>539fed0e-6935-4463-9d7c-a802b27601aa</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>59</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>df83d52b-87eb-4dc1-9609-b8f3c355f797</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>7d3b7cd3-03c5-426a-9fe1-2c6a0a0be006</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;export include-original-data="true"/&gt;
&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>173874d3-5fb0-4e98-847d-d0daaf8c9a0e</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>End SQC</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>173874d3-5fb0-4e98-847d-d0daaf8c9a0e</uuid>
                                    <version>
                                        <componentUuid>8c111711-b319-4b77-a916-111a7f39558a</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>947e743a-3ed5-4f49-8a70-93e453ff95bf</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>End SQC</title>
                                <type>SINGLE</type>
                                <uuid>7bd479b6-1ed0-4a33-837a-0e641966d707</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>886afa1f-2baf-43f9-860a-fbaa33b4d621</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>22935089-7461-411b-baa5-00b061d2aa72</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>60</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>8981cf90-aeba-4ca6-92b7-03be49f463ee</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>12da46cb-e680-40df-a09d-8ee79afb56d8</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>true</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <description>IE Cognitive Automation Task Example</description>
                                <executingType>HUMAN</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <question>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Order</answer>
                                            <answerCode>ocr_document_url_additional_processing</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                <code>INFO_EXTRACTION</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Information Extraction</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                            <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Customer name</answer>
                                            <answerCode>client_name</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>n</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Street address</answer>
                                            <answerCode>customer_delivery_address</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>s</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>City</answer>
                                            <answerCode>customer_delivery_city</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>c</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer> Zip code</answer>
                                            <answerCode>customer_delivery_zip_code</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>z</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>5</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Request Delivery Date</answer>
                                            <answerCode>rdd</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>d</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>6</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>RDD Time</answer>
                                            <answerCode>rdd_time</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>t</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>7</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Purchase Order</answer>
                                            <answerCode>po</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>o</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>8</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Net Total Price</answer>
                                            <answerCode>net_total_price</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                <code>NUMBER</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Number</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>p</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>9</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Product_information</answer>
                                            <answerCode>product_information</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                <code>GROUP</code>
                                                <description>Group of answers</description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Options value - tab name.</optionsDescription>
                                                <parentType>INFO_EXTRACTION</parentType>
                                                <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Group of answers</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>b</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>true</multiValue>
                                            <options>Product - </options>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>10</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Product code 1</answer>
                                            <answerCode>productcode1</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>1</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>ocr_document_url_additional_processing</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>11</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Product code 2</answer>
                                            <answerCode>productcode2</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>2</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>ocr_document_url_additional_processing</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>12</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Quantity</answer>
                                            <answerCode>quantity</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                <code>NUMBER</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Number</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>q</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>ocr_document_url_additional_processing</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>13</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                            <answerCode>canceled_manual_task</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>NO</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=YES|No=NO</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>14</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <assignmentDuration>1800000</assignmentDuration>
                                    <assignmentLimit>1</assignmentLimit>
                                    <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                                    <autoApprovalDelay>432000000</autoApprovalDelay>
                                    <automaticallyProcessed>0</automaticallyProcessed>
                                    <blockSize>1</blockSize>
                                    <constQualifiedWorkers>false</constQualifiedWorkers>
                                    <currency>USD</currency>
                                    <description>IE Cognitive Automation Task Example</description>
                                    <dynamicTaskRenderingDisabled>true</dynamicTaskRenderingDisabled>
                                    <expiredTime>2592000000</expiredTime>
                                    <faqItems/>
                                    <frameHeight>2500</frameHeight>
                                    <geolocationEnabled>false</geolocationEnabled>
                                    <instructionItems/>
                                    <keywords>IE Cognitive Automation Task Example</keywords>
                                    <maxAssignments>1</maxAssignments>
                                    <moderation>false</moderation>
                                    <moderationFlag>false</moderationFlag>
                                    <origination>CREATED_MANUALLY</origination>
                                    <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                                    <qualificationInstruction></qualificationInstruction>
                                    <qualificationRequirements/>
                                    <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                                    <qualificationTasks>20</qualificationTasks>
                                    <qualificationTraining>false</qualificationTraining>
                                    <questionRuleMaps>
                                        <questionRuleMap>
                                            <businessRule>
                                                <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                <name>Start with one assignment 1+0 pay all</name>
                                                <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                                <ruleType>DROOLS</ruleType>
                                                <ruleTypeUI>Adjudication</ruleTypeUI>
                                                <template>
                                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                    <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                                    <name>Start with 1 assignment X+0 rule (pay all)</name>
                                                    <params>
                                                        <param>
                                                            <code>MAJORITY_VALUE</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Number of correct answers</description>
                                                            <name>Majority value</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>70</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                            <name>Worst accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                            <name>Worst accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>95</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                            <name>Super accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>80</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                            <name>Normal accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAX_ASSIGNMENT_LIMIT</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Maximum number of assignments</description>
                                                            <name>Max assignments limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                            <name>Super accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Normal accuracy level lower limit in percents inclusive</description>
                                                            <name>Normal accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>CHECK_EVERY</code>
                                                            <defaultValue>5</defaultValue>
                                                            <description>Check every i-th gold question when evaluating qualification score</description>
                                                            <name>Check every i-th gold question</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAJORITY_HIT_THRESHOLD</code>
                                                            <defaultValue>100</defaultValue>
                                                            <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                            <name>Percent of correct answers</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Normal accuracy level upper limit in percents exclusive</description>
                                                            <name>Normal accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                    </params>
                                                </template>
                                                <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                                            </businessRule>
                                        </questionRuleMap>
                                    </questionRuleMaps>
                                    <radiusSelector>ExactLocation</radiusSelector>
                                    <randomizeAnswers>false</randomizeAnswers>
                                    <recursiveThreshold>1</recursiveThreshold>
                                    <restrictedCountries/>
                                    <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                                    <templates>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;  
&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  


  
&lt;@instructions title="&lt;h2&gt;MT- OTC-OM-EU-Manual Order Creation&amp;nbsp;NE OCR Tagging task_v8v1&lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
  
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Order:&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;&amp;nbsp;${question.data['document_link']}&lt;/a&gt;&lt;br&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
  
  &lt;script type=text/javascript&gt;
        $(function(){
           Application.subscribe(Events.Notifications.ON_START_TAGGING, addCustomDateFormat, this);
        });

        const customDateFormats = ["dd/MM/yyyy", "dd/MM/yy"];

        function addCustomDateFormat(event) {
           var controller = event.get(Constants.E_NOTIFICATION_CONTROLLER);
           if (controller.answerType === 'DATE') {
               var supportedFormats = controller.converter.supportedFormats;
               if (supportedFormats.indexOf(customDateFormats[0]) === -1) {
                   supportedFormats.unshift.apply(supportedFormats, customDateFormats);
               }
           }
        }
  &lt;/script&gt;
  
&lt;/@hit&gt;</content>
                                            <name>NE_Training_task_v8v1</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>TASK</type>
                                            <uuid>24ff97d2-7904-4b57-b679-489e63229497</uuid>
                                            <version>
                                                <componentUuid>8e79c4f8-8b93-4d60-9831-e735dd068300</componentUuid>
                                                <incrementalVersion>1.2</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-09-03T10:00:48Z</lastModified>
                                                <versionUuid>eb0f1f03-0c3c-4cc3-bc08-04fe62305178</versionUuid>
                                            </version>
                                        </template>
                                    </templates>
                                    <title>MT- OTC-OM-EU-Manual Order Creation&#160;NE OCR Tagging task_v8v1</title>
                                    <useCommonHitCoordinates>false</useCommonHitCoordinates>
                                    <uuid>244b9a0e-8cb5-4741-ae4c-55fecf654b90</uuid>
                                    <version>
                                        <componentUuid>a30dda1c-462d-49af-868c-11f302afce04</componentUuid>
                                        <incrementalVersion>1.2</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-03T10:00:48Z</lastModified>
                                        <versionUuid>19b0a61d-a496-4f68-90f0-d4e544ffeefc</versionUuid>
                                    </version>
                                    <workSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description>Europe OM Nordics</description>
                                            <enabled>true</enabled>
                                            <executingType>HUMAN</executingType>
                                            <name>Europe OM Nordics</name>
                                            <private>false</private>
                                            <publicId>d88e8a1d-e3e0-4c76-b374-c0530d279549</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Manual_Orders</name>
                                        <publicId>6bc83edb-99b3-4769-9ec3-f7da26a8e567</publicId>
                                        <version>
                                            <componentUuid>8faeca2d-6eaa-4332-b679-3cf4b75173b3</componentUuid>
                                            <incrementalVersion>1.2</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-05-22T13:03:20Z</lastModified>
                                            <versionUuid>4252ac42-ee12-4346-9bd8-b696a485f13a</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>document_html_link</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Customer name</answer>
                                                <answerCode>client_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>n</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Street address</answer>
                                                <answerCode>customer_delivery_address</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>s</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>City</answer>
                                                <answerCode>customer_delivery_city</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>c</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer> Zip code</answer>
                                                <answerCode>customer_delivery_zip_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>z</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request Delivery Date</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>d</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>RDD Time</answer>
                                                <answerCode>rdd_time</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>t</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Purchase Order</answer>
                                                <answerCode>po</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>o</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Net Total Price</answer>
                                                <answerCode>net_total_price</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>p</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>9</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product code 1</answer>
                                                <answerCode>productcode1</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>1</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Product_information</answer>
                                                    <answerCode>product_information</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GROUP</code>
                                                        <description>Group of answers</description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Options value - tab name.</optionsDescription>
                                                        <parentType>INFO_EXTRACTION</parentType>
                                                        <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Group of answers</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue></defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <hotKey>b</hotKey>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>true</multiValue>
                                                    <options>Product - </options>
                                                    <originalDocumentSource></originalDocumentSource>
                                                    <parentAnswer>
                                                        <allowNA>false</allowNA>
                                                        <answer>Order</answer>
                                                        <answerCode>document_html_link</answerCode>
                                                        <answerHtml></answerHtml>
                                                        <answerTypeObject>
                                                            <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                            <code>INFO_EXTRACTION</code>
                                                            <description></description>
                                                            <optionsAvailable>true</optionsAvailable>
                                                            <showDefaultValue>true</showDefaultValue>
                                                            <showForFieldScheme>false</showForFieldScheme>
                                                            <showForHumanTask>true</showForHumanTask>
                                                            <showForMachineConfig>false</showForMachineConfig>
                                                            <title>Information Extraction</title>
                                                            <valueType>SINGLEVALUE</valueType>
                                                        </answerTypeObject>
                                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                                        <autocompleteField>false</autocompleteField>
                                                        <category></category>
                                                        <constantable>false</constantable>
                                                        <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                        <htmlClasses></htmlClasses>
                                                        <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                        <letCustomValues>false</letCustomValues>
                                                        <manualField>false</manualField>
                                                        <multiValue>false</multiValue>
                                                        <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                        <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                        <percentRequired>false</percentRequired>
                                                        <range>false</range>
                                                        <required>false</required>
                                                        <sequenceNumber>1</sequenceNumber>
                                                        <shuffle>false</shuffle>
                                                        <useBlocks>false</useBlocks>
                                                        <useEmptyCell>false</useEmptyCell>
                                                    </parentAnswer>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>10</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>11</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product code 2</answer>
                                                <answerCode>productcode2</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>2</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Product_information</answer>
                                                    <answerCode>product_information</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GROUP</code>
                                                        <description>Group of answers</description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Options value - tab name.</optionsDescription>
                                                        <parentType>INFO_EXTRACTION</parentType>
                                                        <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Group of answers</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue></defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <hotKey>b</hotKey>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>true</multiValue>
                                                    <options>Product - </options>
                                                    <originalDocumentSource></originalDocumentSource>
                                                    <parentAnswer>
                                                        <allowNA>false</allowNA>
                                                        <answer>Order</answer>
                                                        <answerCode>document_html_link</answerCode>
                                                        <answerHtml></answerHtml>
                                                        <answerTypeObject>
                                                            <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                            <code>INFO_EXTRACTION</code>
                                                            <description></description>
                                                            <optionsAvailable>true</optionsAvailable>
                                                            <showDefaultValue>true</showDefaultValue>
                                                            <showForFieldScheme>false</showForFieldScheme>
                                                            <showForHumanTask>true</showForHumanTask>
                                                            <showForMachineConfig>false</showForMachineConfig>
                                                            <title>Information Extraction</title>
                                                            <valueType>SINGLEVALUE</valueType>
                                                        </answerTypeObject>
                                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                                        <autocompleteField>false</autocompleteField>
                                                        <category></category>
                                                        <constantable>false</constantable>
                                                        <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                        <htmlClasses></htmlClasses>
                                                        <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                        <letCustomValues>false</letCustomValues>
                                                        <manualField>false</manualField>
                                                        <multiValue>false</multiValue>
                                                        <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                        <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                        <percentRequired>false</percentRequired>
                                                        <range>false</range>
                                                        <required>false</required>
                                                        <sequenceNumber>1</sequenceNumber>
                                                        <shuffle>false</shuffle>
                                                        <useBlocks>false</useBlocks>
                                                        <useEmptyCell>false</useEmptyCell>
                                                    </parentAnswer>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>10</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>12</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Quantity</answer>
                                                <answerCode>quantity</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>q</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Product_information</answer>
                                                    <answerCode>product_information</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GROUP</code>
                                                        <description>Group of answers</description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Options value - tab name.</optionsDescription>
                                                        <parentType>INFO_EXTRACTION</parentType>
                                                        <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Group of answers</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue></defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <hotKey>b</hotKey>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>true</multiValue>
                                                    <options>Product - </options>
                                                    <originalDocumentSource></originalDocumentSource>
                                                    <parentAnswer>
                                                        <allowNA>false</allowNA>
                                                        <answer>Order</answer>
                                                        <answerCode>document_html_link</answerCode>
                                                        <answerHtml></answerHtml>
                                                        <answerTypeObject>
                                                            <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                            <code>INFO_EXTRACTION</code>
                                                            <description></description>
                                                            <optionsAvailable>true</optionsAvailable>
                                                            <showDefaultValue>true</showDefaultValue>
                                                            <showForFieldScheme>false</showForFieldScheme>
                                                            <showForHumanTask>true</showForHumanTask>
                                                            <showForMachineConfig>false</showForMachineConfig>
                                                            <title>Information Extraction</title>
                                                            <valueType>SINGLEVALUE</valueType>
                                                        </answerTypeObject>
                                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                                        <autocompleteField>false</autocompleteField>
                                                        <category></category>
                                                        <constantable>false</constantable>
                                                        <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                        <htmlClasses></htmlClasses>
                                                        <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                        <letCustomValues>false</letCustomValues>
                                                        <manualField>false</manualField>
                                                        <multiValue>false</multiValue>
                                                        <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                        <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                        <percentRequired>false</percentRequired>
                                                        <range>false</range>
                                                        <required>false</required>
                                                        <sequenceNumber>1</sequenceNumber>
                                                        <shuffle>false</shuffle>
                                                        <useBlocks>false</useBlocks>
                                                        <useEmptyCell>false</useEmptyCell>
                                                    </parentAnswer>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>10</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>13</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Is the document well OCR-ed</answer>
                                                <answerCode>ocred</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>YES</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=YES|No=NO</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>14</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Feedback</answer>
                                                <answerCode>feedback</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>15</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <businessRules/>
                                        <isPrivate>false</isPrivate>
                                        <items>
                                            <item>
                                                <type>RECURSIVE_THRESHOLD</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_APPROVED</type>
                                                <value>432000000</value>
                                            </item>
                                            <item>
                                                <type>FRAME_HEIGHT</type>
                                                <value>2500</value>
                                            </item>
                                            <item>
                                                <type>DESCRIPTION</type>
                                                <value>IE Cognitive Automation Task Example</value>
                                            </item>
                                            <item>
                                                <type>TITLE</type>
                                                <value></value>
                                            </item>
                                            <item>
                                                <type>HIT_EXPIRES_IN</type>
                                                <value>2592000000</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATIONS</type>
                                            </item>
                                            <item>
                                                <type>LIMIT_NUMBER_ASSIGNMENTS</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_PROCESSED</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATION_RULE</type>
                                            </item>
                                            <item>
                                                <type>PENDING_ASSIGNMENTS_LIMIT</type>
                                                <value>10</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENTS_PER_HIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>BLOCK_SIZE</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>TIME_PER_ASSIGNMENT</type>
                                                <value>1800000</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENT_LIMIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATION_REQUIREMENTS</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>KEYWORDS</type>
                                                <value>IE Cognitive Automation Task Example</value>
                                            </item>
                                            <item>
                                                <type>RESTRICTED_COUNTRIES</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>REQUIRED_FOR_PREVIEW</type>
                                                <value>false</value>
                                            </item>
                                            <item>
                                                <type>ADJUDICATION_RULE</type>
                                                <value>3</value>
                                            </item>
                                            <item>
                                                <type>EXTERNAL_URL</type>
                                                <value>https://wfapp-dev.workfusion.pg.com/workfusion/public/HTMLRenderer</value>
                                            </item>
                                        </items>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="Extract data from Excel"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Email:&amp;nbsp;&lt;a href="${question.data['eml_file_location']}" data-mce-href="${question.data['eml_file_location']}"&gt;${question.data['eml_file_location']}&lt;br&gt;&lt;/a&gt;Order:&amp;nbsp;&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;Error message/List of multi-sheet order:&amp;nbsp;${question.data['error_message']}&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Miscellaneous Tasks (Blank)</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE</type>
                                            <uuid>6778197e-5123-4587-9bfd-0fe361b1ac23</uuid>
                                            <version>
                                                <componentUuid>b440737a-1966-46d2-953d-e1fef74fd055</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2017-09-13T22:42:01Z</lastModified>
                                                <versionUuid>a26c02b9-0130-4b3c-9f8e-0bddd14f8819</versionUuid>
                                            </version>
                                        </template>
                                        <useCaseConfiguration>[]</useCaseConfiguration>
                                    </workSetting>
                                    <workSpacePreviewData>[{"name":"purchase_order_date","value":"${question.data['creation_sorting_dttm']}"},{"name":"id","value":"${question.data['uuid']}-${question.data['mail_id']}"}]</workSpacePreviewData>
                                    <workSpacePreviewScheme>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>OCR Date/Time</answer>
                                                <answerCode>purchase_order_date</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-09-03T09:35:46Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>ID</answer>
                                                <answerCode>id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-09-03T09:36:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <description>NE_ST_Schema</description>
                                        <id>346</id>
                                        <name>NE_ST_Schema</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <uuid>caf294f5-7d1c-420d-b8ef-55be8de8912f</uuid>
                                    </workSpacePreviewScheme>
                                </question>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>MT- OTC-OM-EU-Manual Order Creation&#160;NE OCR Tagging task_v8v1</title>
                                <type>SINGLE</type>
                                <uuid>4347818c-d555-434c-9c32-5140240a6d3f</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9b714c13-c36f-4949-b697-032aa8a6f389</componentUuid>
                                    <incrementalVersion>1.6</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-03T10:00:48Z</lastModified>
                                    <versionUuid>1f4947b8-e547-4adb-a9a6-6ed2c2a0c9b7</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>61</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>5db91635-c450-499d-a0da-163dbf08e444</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>92f43494-3910-4cdd-8863-8598495ac264</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;

    &lt;script&gt;
        &lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.requester.service.automation.AutomationConstants;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        import java.util.Map;
        import java.util.List;
        import java.util.ArrayList;
        import com.freedomoss.workfusion.utils.gson.GsonUtils;
        import java.text.SimpleDateFormat;

        Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");

        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        String trainJobsDataStoreName = AutomationConstants.DS_JOB_DATA_TABLE;
        String experimentGroup = _sys_automation_experiment_group.toString();
        ]]&gt;
    &lt;/script&gt;

    &lt;!-- ############################################## START JOB STAGE ############################################## --&gt;
    &lt;var-def name="trainJobDataVar"&gt;
        &lt;datastore name="${trainJobsDataStoreName}"&gt;
            select * from @this where experimentGroup = '${experimentGroup}';
        &lt;/datastore&gt;
    &lt;/var-def&gt;
    &lt;var-def name="documentCountVar"&gt;
        &lt;datastore name="${_sys_automation_ds_name}"&gt;
            select count(*) from @this;
        &lt;/datastore&gt;
    &lt;/var-def&gt;

    &lt;case&gt;
        &lt;if condition="${trainJobDataVar.toList().isEmpty()}"&gt;
            &lt;script&gt;
                &lt;![CDATA[
                /*
                    Answers are sent for IE extraction
                 */
                Map createAnswerInfo(AnswerInfoDTO answer) {
                    Map res = new HashMap();
                    res.put("answerCode", answer.answerCode);
                    res.put("answerType", answer.answerType);
                    res.put("required", answer.required);
                    res.put("multiValue", answer.multiValue);
                    res.put("constantable", answer.constantable);
                    res.put("allowNA", answer.allowNA);
                    List subAnswers = new ArrayList();
                    for (AnswerInfoDTO subAnswer : answer.subAnswers) {
                        Map subAnswerMap = createAnswerInfo(subAnswer);
                        subAnswers.add(subAnswerMap);
                    }
                    res.put("subAnswers", subAnswers);
                    return res;
                }

                Map convertAnswersToJson(List answers) {
                    List answerInfos = new ArrayList();
                    for (AnswerInfoDTO answer : answers) {
                        answerInfos.add(createAnswerInfo(answer));
                    }
                    Map resultMap = new HashMap();
                    resultMap.put("answers", GsonUtils.GSON.toJson(answerInfos).toString());
                    return resultMap;
                }

                Map answersMap = convertAnswersToJson(run.automationInfo.answers);
                String answersJson= GsonUtils.GSON.toJson(answersMap);
            ]]&gt;
            &lt;/script&gt;

            &lt;var-def name='startEvalResult'&gt;
                &lt;automation-start-eval model-name='${_sys_automation_tags}' egid='${experimentGroup}' use-tableau='true'
                                       parameters='${answersJson}' model-version="${_sys_model_version.toString()}" /&gt;
            &lt;/var-def&gt;

            &lt;script&gt;
                &lt;![CDATA[

                logger.info("Start mesos job. Result:" + startEvalResult.toString());
                Map responseMap = GsonUtils.GSON.fromJson(startEvalResult.toString(), GsonUtils.TYPE_MAP_STRING_STRING);

                if (Integer.valueOf(responseMap.get("responseStatus")) != 200 ) {
                    throw new RuntimeException("Error!!! VDS eval service unavailable. Response = " + responseMap);
                }

                Map operationResult = GsonUtils.GSON.fromJson(responseMap.get("responseBody"),GsonUtils.TYPE_MAP_STRING_STRING);
                String jobId = String.valueOf(operationResult.get("evalJobId"));
                String modelVersion = String.valueOf(operationResult.get("modelVersion"));

                logger.info("Evaluation job id:" + jobId);
                logger.info("Model version:" + modelVersion);

                SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
                String date = dateFormat.format(new Date());

                StringBuilder sqlQuery = new StringBuilder("update @this set ");
                String documentCount = documentCountVar.getWrappedObject().get(0).getWrappedObject()[0];
                if (org.apache.commons.lang.StringUtils.isEmpty(jobId)) {
                    sqlQuery.append(" status='ERROR',");
                } else {
                    sqlQuery.append(" status='IN_PROGRESS',");
                    sqlQuery.append(" startDate='" + date + "',");
                    sqlQuery.append(" jobId='" + jobId + "',");
                    sqlQuery.append(" trainingSetSize='" + documentCount.toString() + "',");
                    sqlQuery.append(" modelVersion='" + modelVersion + "',");
                    sqlQuery.append(" automationRootRunUUID='" + run.rootRunUuid + "',");
                    sqlQuery.append(" author='" + run.authorFullName + "',");
                    sqlQuery.append(" campaignName='" + run.campaignName + "',");
                }
                sqlQuery.append(" lastUpdated='" + date + "',");
                sqlQuery.append(" experimentGroup='" + experimentGroup + "'");
                sqlQuery.append(" where originalCampaignUUID='" + run.automationInfo.originalCampaignUuid + "'");
                sqlQuery.append(" and modelVersion='" + modelVersion + "'");
                sqlQuery.append(" and status='PREPARING'");
                sqlQuery.append(" and tags='" + _sys_automation_tags.toString() + "'");
                sqlQuery.append(";");

                logger.info("Update query:" + sqlQuery.toString());
                sys.defineVariable("hyperModelVersion", modelVersion, true);
                ]]&gt;
            &lt;/script&gt;
            &lt;datastore name="${trainJobsDataStoreName}"&gt;
                ${sqlQuery}
            &lt;/datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_model_version" value="${hyperModelVersion}"/&gt;
    &lt;/export&gt;

&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>669d6918-339c-4ff0-bbfc-a50cd55e81a8</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>(Generic) Start Train&amp;Evaluation</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>669d6918-339c-4ff0-bbfc-a50cd55e81a8</uuid>
                                    <version>
                                        <componentUuid>a30eee8e-1606-4877-b2bf-943d827b6548</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>06b6d3f3-9ad2-46a7-bae0-651b9915e8f2</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>(Generic) Start Train&amp;Evaluation</title>
                                <type>SINGLE</type>
                                <uuid>7935e054-546b-407d-959f-dc3e22183df1</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>38e57297-e87a-4a09-85f9-ea57e7dbcc97</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>9b6952f7-620a-49fc-b6ea-d4bd08e116fc</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>62</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>99315d75-b78f-42ef-88d5-1becd696a042</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>73ee77f5-2446-4c50-b90a-729a9355bb45</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;

    &lt;case&gt;
        &lt;if condition='${_sys_model_type.toString().equals("ie")}'&gt;
            &lt;script&gt;
                &lt;![CDATA[
                import java.text.SimpleDateFormat;
                import org.apache.commons.httpclient.HttpClient;
                import org.apache.commons.httpclient.methods.PostMethod;
                import org.apache.commons.httpclient.methods.StringRequestEntity;
                import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
                import com.freedomoss.crowdcontrol.webharvest.RunDto;
                import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
                import com.freedomoss.requester.util.extraction.TextAggregationProcessor;
                import org.slf4j.Logger;
                import org.slf4j.LoggerFactory;

                Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");

                RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
                ]]&gt;
            &lt;/script&gt;

            &lt;script&gt;
                &lt;![CDATA[

                    Map dictAnswerMap = new HashMap();
                    List dsAnswers = new ArrayList();

                    if (run.automationInfo != null) {
                        for (AnswerInfoDTO answer : run.automationInfo.answers) {
                            if (answer.getAnswerType().equals("INFO_EXTRACTION")) {
                               for (AnswerInfoDTO subAnswer: answer.subAnswers) {

                                 if (subAnswer.dataStoreName != null &amp;&amp; !"GROUP".equals(subAnswer.answerType)) {
                                    dsAnswers.add(subAnswer);

                                 }  else if (subAnswer.options != null &amp;&amp; !"GROUP".equals(subAnswer.answerType)) {

                                    Map dictionary = new HashMap();
                                    String[] optionPairs = subAnswer.options.split("\\|");
                                    String dictionaryValues = "";
                                    for (String pair: optionPairs) {
                                      String[] pairParts = pair.split("=");

                                      if (pairParts.length == 2) {
                                        dictionaryValues = dictionaryValues + pairParts[1] + "\n";
                                      }

                                    }
                                    dictAnswerMap.put(subAnswer.answerCode, dictionaryValues);
                                }
                              }
                            }
                        }
                    }

                    ]]&gt;
            &lt;/script&gt;

            &lt;loop item="documentItem"
                  index="documentIndex" empty="true"&gt;
                &lt;list&gt;
                    &lt;script return="dictAnswerMap.entrySet()"/&gt;
                &lt;/list&gt;

                &lt;body&gt;

                    &lt;var-def name="documentVar"&gt;&lt;template&gt;${documentItem.getWrappedObject().getValue().toString()}&lt;/template&gt;&lt;/var-def&gt;

                    &lt;s3 bucket="vds-resources" s3-keys-type="vds"&gt;
                        &lt;s3-put-public path="${_sys_automation_experiment_group.toString()}/input/dictionaries/${documentItem.getWrappedObject().getKey().toString()}.txt" content="${documentVar}" content-type="text/html" content-disposition="inline"/&gt;
                    &lt;/s3&gt;

                &lt;/body&gt;
            &lt;/loop&gt;

            &lt;loop item="answer" empty="true"&gt;
                &lt;list&gt;
                    &lt;script return="dsAnswers"/&gt;
                &lt;/list&gt;

                &lt;body&gt;

                    &lt;script&gt;
                        &lt;![CDATA[
                            String dictionaryValues = "";
                            List dsContent = new ArrayList();
                        ]]&gt;
                    &lt;/script&gt;

                    &lt;loop item="row" empty="true"&gt;
                        &lt;list&gt;
                            &lt;datastore name="${answer.getWrappedObject().getDataStoreName()}"&gt;
                                &lt;template&gt;select * from @this;&lt;/template&gt;
                            &lt;/datastore&gt;
                        &lt;/list&gt;
                        &lt;body&gt;

                            &lt;script&gt;
                                &lt;![CDATA[

                                        Map rowData = new HashMap();

                                        for (int i = 0; i &lt; row.getColumnCount(); i++) {

                                            String col = row.getColumnName(i);
                                            String val = row.get(i).toString();

                                            rowData.put("name".equalsIgnoreCase(col) ? answer.getWrappedObject().getAnswerCode().toString() : col, val);

                                            if ("name".equalsIgnoreCase(col)) {
                                                dictionaryValues = dictionaryValues + val + "\n";
                                            }
                                        }

                                        dsContent.add(rowData);
                                    ]]&gt;
                            &lt;/script&gt;

                        &lt;/body&gt;
                    &lt;/loop&gt;

                    &lt;var-def name="dictVar"&gt;&lt;template&gt;${dictionaryValues.toString()}&lt;/template&gt;&lt;/var-def&gt;
                    &lt;s3 bucket="vds-resources" s3-keys-type="vds"&gt;
                        &lt;s3-put-public path="${_sys_automation_experiment_group.toString()}/input/dictionaries/${answer.getWrappedObject().getAnswerCode().toString()}.txt" content="${dictVar}" content-type="text/html" content-disposition="inline"/&gt;
                    &lt;/s3&gt;

                    &lt;var-def name="dsContentVar"&gt;
                        &lt;list-to-csv&gt;
                            &lt;template&gt;${new com.google.gson.Gson().toJson(dsContent).toString()}&lt;/template&gt;
                        &lt;/list-to-csv&gt;
                    &lt;/var-def&gt;
                    &lt;s3 bucket="vds-resources" s3-keys-type="vds"&gt;
                        &lt;s3-put-public path="${_sys_automation_experiment_group.toString()}/input/ref-data/${answer.getWrappedObject().getAnswerCode().toString()}.csv" content="${dsContentVar}" content-type="text/html" content-disposition="inline"/&gt;
                    &lt;/s3&gt;

                &lt;/body&gt;
            &lt;/loop&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"/&gt;

&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>35e9b890-eebd-41dd-b546-9c430028f2a1</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>(Generic) Upload Dictionaries</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>35e9b890-eebd-41dd-b546-9c430028f2a1</uuid>
                                    <version>
                                        <componentUuid>6caed040-7285-4f96-8fa1-5a8e4b28cddc</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>3382f0b0-ea46-4703-9bc6-78a8973062ee</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>(Generic) Upload Dictionaries</title>
                                <type>SINGLE</type>
                                <uuid>8e9ad0ca-71d9-4f9b-8866-ed81dfada2de</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>97fd31bb-a76a-415d-b732-2494e2f2fbf5</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>c945c062-1f18-4920-8922-a9f0e71cb75b</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>63</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>e42d79b8-9ce0-49e1-bdde-1e495249e3db</uuid>
                        </campaignMap>
                        <campaignMap>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>c6c5ffa8-2f41-4862-b4ba-86b01f69429f</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;var-def name="exportType"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_type")}'&gt;
                &lt;template&gt;${_sys_export_type}&lt;/template&gt;
            &lt;/if&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="exportColumns"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_columns")}'&gt;
                &lt;template&gt;${_sys_export_columns}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="columnNameCase"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_column_name_case")}'&gt;
                &lt;template&gt;${_sys_column_name_case}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;keep&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="dataOnly"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_data_only")}'&gt;
                &lt;template&gt;${_sys_data_only}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;true&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="datastoreName"&gt;
        &lt;script return="item.getWrappedObject().getRun().getDatastoreName()" /&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!datastoreName.isEmpty()}"&gt;
            &lt;insert-datastore   datastore-name="${datastoreName}" create="true"&gt;
                &lt;script return="hit_submission_data_item.getWrappedObject().getItemValueMap()"/&gt;
            &lt;/insert-datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"
            export-type="${exportType}"
            export-columns="${exportColumns}"
            column-name-case="${columnNameCase}"
            data-only="${dataOnly}"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>Default machine campaign for end step.</description>
                                    <includedConfigs/>
                                    <inclusionCode>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</inclusionCode>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <name>Final Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</uuid>
                                    <version>
                                        <componentUuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-08-21T10:54:19Z</lastModified>
                                        <versionUuid>71976d1d-a48f-4ce5-ae4d-10203991bf95</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>100</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Percents</streamValueType>
                                <title>Final Results</title>
                                <type>SINGLE</type>
                                <uuid>af4c8905-26dd-4120-b208-39ad3530ffc6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>a7c3c527-28fb-11e8-bf41-000d3a0302a9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>false</lastInChain>
                                    <lastModified>2018-08-21T10:54:19Z</lastModified>
                                    <versionUuid>56d0500e-1f1a-4755-9c95-600a8de71b5e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>64</stepIndex>
                            <stepPosition>SUBEND</stepPosition>
                            <uuid>3c74cf71-dd7d-4b8e-a9e1-69c376de0b68</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>55419266-7cc9-4443-a820-5c285dbbdadb</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;!-- ############################################## GET TRAIN RESULTS STAGE ############################################## --&gt;

    &lt;script&gt;
        &lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        import java.text.SimpleDateFormat;
        import com.freedomoss.workfusion.utils.gson.GsonUtils;

        Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
        SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");

        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        String experimentGroup = _sys_automation_experiment_group.toString();
        String trainJobsDataStoreName = "WFML_Job_Data";
        ]]&gt;
    &lt;/script&gt;

    &lt;var-def name="trainJobDataVar"&gt;
        &lt;datastore name="${trainJobsDataStoreName}"&gt;
            select * from @this where experimentGroup = '${experimentGroup}';
        &lt;/datastore&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!trainJobDataVar.toList().isEmpty()}"&gt;
            &lt;var-def name='getEvalResult'&gt;
                &lt;automation-get-eval-result egid='${experimentGroup}'/&gt;
            &lt;/var-def&gt;

            &lt;script&gt;
                &lt;![CDATA[

                logger.info("VDS eval job status. Result:" + getEvalResult);
                Map responseMap = GsonUtils.GSON.fromJson(getEvalResult.toString(), GsonUtils.TYPE_MAP_STRING_STRING);

                if (Integer.valueOf(responseMap.get("responseStatus")) != 200 ) {
                    throw new RuntimeException("Error!!! VDS eval service unavailable. Response = " + responseMap);
                }

                Map operationResult = GsonUtils.GSON.fromJson(responseMap.get("responseBody"), GsonUtils.TYPE_MAP_STRING_OBJECT);
                String vdsEvalStatus = operationResult.get("evalStatus");

                logger.info("VDS eval job has status " + vdsEvalStatus);
                if ("ERROR".equals(vdsEvalStatus)) {
                    String errorMessage = operationResult.get("errorMessage");
                    logger.error("Error was occurred during VDS eval job. " + errorMessage);
                }

                ]]&gt;
            &lt;/script&gt;

            &lt;case&gt;
                &lt;if condition='${"COMPLETED".equalsIgnoreCase(vdsEvalStatus)}'&gt;
                    &lt;script&gt;
                        &lt;![CDATA[
                            Map experiments = operationResult.get("results");
                            if (experiments.isEmpty()) {
                                logger.error("Error!!! Service no return any experiment informations.");
                                vdsEvalStatus = "ERROR";
                            } else {
                              String experimentId = new ArrayList(experiments.keySet()).get(0);
                              logger.info("experimentId = " + experimentId);
                              logger.info("experimentGroup = " + experimentGroup);
                              logger.info("Precision json = " + GsonUtils.GSON.toJson(experiments));
                              run.automationInfo.newExperimentGroup = experimentGroup;
                              run.automationInfo.newExperimentId = experimentId;
                              run.automationInfo.automationEstimation = experiments;
                              run.automationInfo.modelVersion =  _sys_model_version.toString();
                            }
                        ]]&gt;
                    &lt;/script&gt;
                    &lt;datastore name="${_sys_automation_ds_name}"&gt;
                        update @this set "train_status" = 'PRODUCTION' where "train_status" = 'EVALUATE';
                    &lt;/datastore&gt;
                &lt;/if&gt;
            &lt;/case&gt;

            &lt;case&gt;
                &lt;if condition='${"FAILED".equalsIgnoreCase(vdsEvalStatus)}'&gt;
                    &lt;datastore name="${_sys_automation_ds_name}"&gt;
                        update @this set "train_status" = 'NEW' where "train_status" = 'EVALUATE';
                    &lt;/datastore&gt;
                &lt;/if&gt;
            &lt;/case&gt;

            &lt;case&gt;
                &lt;if condition='${"IN_PROGRESS".equalsIgnoreCase(vdsEvalStatus)}'&gt;
                    &lt;script&gt;
                        &lt;![CDATA[
                          Thread.sleep(60000); //Wait 1 minute
                          ]]&gt;
                    &lt;/script&gt;
                &lt;/if&gt;
            &lt;/case&gt;

            &lt;datastore name="${trainJobsDataStoreName}"&gt;
                update @this set status = '${vdsEvalStatus}', lastUpdated = '${dateFormat.format(new Date())}'
                where experimentGroup = '${experimentGroup}';
            &lt;/datastore&gt;
        &lt;/if&gt;
        &lt;else&gt;
            &lt;script&gt;
                &lt;![CDATA[
                import org.slf4j.Logger;
                import org.slf4j.LoggerFactory;

                Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");

                logger.error("Train Job Data was not found for egid: " + experimentGroup);
                throw new RuntimeException("Train Job Data for egid: " + experimentGroup + " was not found in WFML_Job_Data data store");
                ]]&gt;
            &lt;/script&gt;
        &lt;/else&gt;
    &lt;/case&gt;
    &lt;case&gt;
        &lt;if condition='${"COMPLETED".equalsIgnoreCase(vdsEvalStatus) || "FAILED".equalsIgnoreCase(vdsEvalStatus) || "TERMINATED".equalsIgnoreCase(vdsEvalStatus) || "FAILED".equalsIgnoreCase(vdsEvalStatus)}'&gt;
            &lt;export include-original-data="true"/&gt;
        &lt;/if&gt;
        &lt;else&gt;
            &lt;script&gt;
                &lt;![CDATA[
                  Thread.sleep(60000); //Wait 1 minutes
                  ]]&gt;
            &lt;/script&gt;
        &lt;/else&gt;
    &lt;/case&gt;

&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>02fa0c30-f756-457d-9262-47acb04d666c</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>(Generic) Get Train&amp;Evaluation Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>02fa0c30-f756-457d-9262-47acb04d666c</uuid>
                                    <version>
                                        <componentUuid>e454fad8-2a1a-4279-bb16-728560fbfea4</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>a1cd4772-9508-482d-ac43-ba1736029ab0</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>(Generic) Get Train&amp;Evaluation Results</title>
                                <type>SINGLE</type>
                                <uuid>f4939aab-bf62-42b3-99f6-2df215586fae</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>689fb5bb-3a33-4569-acde-91c63709558b</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>f8efc7da-318e-452a-9de9-22404f776386</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>65</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>a243cdfa-1305-47ea-8c5f-c971a465c8e4</uuid>
                        </campaignMap>
                        <campaignMap>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>9a04accb-dc15-4714-9432-03630b1def0e</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;var-def name="exportType"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_type")}'&gt;
                &lt;template&gt;${_sys_export_type}&lt;/template&gt;
            &lt;/if&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="exportColumns"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_columns")}'&gt;
                &lt;template&gt;${_sys_export_columns}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="columnNameCase"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_column_name_case")}'&gt;
                &lt;template&gt;${_sys_column_name_case}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;keep&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="dataOnly"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_data_only")}'&gt;
                &lt;template&gt;${_sys_data_only}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;true&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="datastoreName"&gt;
        &lt;script return="item.getWrappedObject().getRun().getDatastoreName()" /&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!datastoreName.isEmpty()}"&gt;
            &lt;insert-datastore   datastore-name="${datastoreName}" create="true"&gt;
                &lt;script return="hit_submission_data_item.getWrappedObject().getItemValueMap()"/&gt;
            &lt;/insert-datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"
            export-type="${exportType}"
            export-columns="${exportColumns}"
            column-name-case="${columnNameCase}"
            data-only="${dataOnly}"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>Default machine campaign for end step.</description>
                                    <includedConfigs/>
                                    <inclusionCode>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</inclusionCode>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <name>Final Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</uuid>
                                    <version>
                                        <componentUuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-08-21T10:54:19Z</lastModified>
                                        <versionUuid>71976d1d-a48f-4ce5-ae4d-10203991bf95</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>100</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Percents</streamValueType>
                                <title>Final Results</title>
                                <type>SINGLE</type>
                                <uuid>af4c8905-26dd-4120-b208-39ad3530ffc6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>a7c3c527-28fb-11e8-bf41-000d3a0302a9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>false</lastInChain>
                                    <lastModified>2018-08-21T10:54:19Z</lastModified>
                                    <versionUuid>56d0500e-1f1a-4755-9c95-600a8de71b5e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>66</stepIndex>
                            <stepPosition>SUBEND</stepPosition>
                            <uuid>573fdae4-7cc9-4374-8dbc-1a6dc82cd48e</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>6a82e873-fa22-41b0-ba39-c1414a709c9d</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;case&gt;
        &lt;if condition='${"false".equals(_sys_is_statistics_calculation_skipped.toString())}'&gt;

            &lt;script language="groovy"&gt;&lt;![CDATA[
                import com.workfusion.utils.datastore.DataStoreUtils;

                String datastore_name = "automation_stat_" + DataStoreUtils.replaceNonWordCharacters(_sys_bp_campaign_uuid.toString());
                sys.defineVariable("datastore_name", datastore_name);
            ]]&gt;&lt;/script&gt;

            &lt;create-datastore name="${datastore_name}"&gt;
                &lt;datastore-column name="run_uuid" type="TEXT"/&gt;
                &lt;datastore-column name="field_name" type="TEXT"/&gt;
                &lt;datastore-column name="group_name" type="TEXT"/&gt;
                &lt;datastore-column name="gold_value" type="TEXT"/&gt;
                &lt;datastore-column name="extracted_value" type="TEXT"/&gt;
                &lt;datastore-column name="tp" type="INTEGER"/&gt;
                &lt;datastore-column name="tn" type="INTEGER"/&gt;
                &lt;datastore-column name="fp" type="INTEGER"/&gt;
                &lt;datastore-column name="fn" type="INTEGER"/&gt;
                &lt;datastore-column name="score" type="TEXT"/&gt;
                &lt;datastore-column name="confidence" type="TEXT"/&gt;
                &lt;datastore-column name="document_id" type="TEXT"/&gt;
                &lt;datastore-column name="doc_html_link_tagged" type="TEXT"/&gt;
                &lt;datastore-column name="timestamp" type="TIMESTAMP"/&gt;
                &lt;datastore-column name="environment" type="TEXT"/&gt;
            &lt;/create-datastore&gt;

            &lt;datastore-transaction isolation="SERIALIZABLE"&gt;
                &lt;datastore name="${datastore_name}"&gt;
                    LOCK TABLE @this;
                &lt;/datastore&gt;

                &lt;script language="groovy"&gt;&lt;![CDATA[
                    import org.apache.commons.lang.StringUtils;
					import com.freedomoss.workfusion.utils.gson.GsonUtils;
					import com.google.gson.reflect.TypeToken;

					Object getWrappedObjectOrNull(Object var) {
						return var == null ? null : var.getWrappedObject();
					}

                    String modelType = _sys_model_type.toString();
                    List fieldList;
                    Boolean isIe;
                    if ("ie".equals(modelType)) {
                        fieldList = Arrays.asList(_sys_automation_ie_fields.toString().split(","));
                        isIe = Boolean.TRUE;
                    } else if ("classification".equals(modelType)) {
                        String categoryColumn = _sys_automation_ie_answer_code.toString();
                        fieldList = Arrays.asList(categoryColumn);
                        isIe = Boolean.FALSE;
                    }

                    goldAnswers = new HashMap();
                    modelAnswers = new HashMap();
                    scores = new HashMap();
                    confidences = new HashMap();
                    for (String field : fieldList) {
                        goldAnswers.put(field, getWrappedObjectOrNull(sys.getVar(field)));
                        modelAnswers.put(field, getWrappedObjectOrNull(sys.getVar(field + "_extracted")));
                        scores.put(field, getWrappedObjectOrNull(sys.getVar(field + "_score_extracted")));
                        confidences.put(field, getWrappedObjectOrNull(sys.getVar(field + "_confidence_extracted")));
                    }

                    Map subGroupAnswersCodes = GsonUtils.GSON.fromJson(_sys_sub_group_answers_codes.toString(), new TypeToken&lt;Map&lt;String, List&lt;String&gt;&gt;&gt;() {}.getType());

                    sys.defineVariable("fieldList", fieldList);
                    sys.defineVariable("goldAnswers", goldAnswers);
                    sys.defineVariable("modelAnswers", modelAnswers);
                    sys.defineVariable("scores", scores);
                    sys.defineVariable("confidences", confidences);
                    sys.defineVariable("isIe", isIe);
                    sys.defineVariable("subGroupAnswersCodes", subGroupAnswersCodes );
                ]]&gt;&lt;/script&gt;

                &lt;loop item="field" empty="true"&gt;
                    &lt;list&gt;
                        &lt;var name="fieldList"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;script&gt;&lt;![CDATA[
                            import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.enums.DataStoreColumnType;
                            import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.DataStoreRow;
                            import com.freedomoss.workfusion.utils.gson.GsonUtils;
                            import java.time.LocalDateTime;
							import java.time.format.DateTimeFormatter;
							import java.util.Arrays;
							import org.apache.commons.lang3.StringUtils;

                            /**
                             * Compare not null gold and extracted values:
                             *      1. split by '|'
                             *      2. sort obtained arrays
                             *      3. compare arrays by elements on the same position
                             * Such comparison required because multivalue fields saved in one string with separator '|'.
                             * If field is not multivalue and containg '|' then such comparison is the same as using equals.
                             */
                            boolean compare(String goldValue, String extractedValue) {
                                String[] goldSubValue = goldValue.split("\\|");
                                String[] extractedSubValue = extractedValue.split("\\|");
                                if (goldSubValue.length != extractedSubValue.length) {
                                    return false;
                                }
                                Arrays.sort(goldSubValue);
                                Arrays.sort(extractedSubValue);
                                for (int j = 0; j &lt; goldSubValue.length; j++) {
                                    if (!goldSubValue[j].equals(extractedSubValue[j])) {
                                        return false;
                                    }
                                }
                                return true;
                            }

							class DsRowFieldData {
                                String runUuid;
                                String fieldName;
                                String groupName;
                                String goldValue;
                                String extractedValue;
                                int tp;
                                int fp;
                                int tn;
                                int fn;
                                String score;
                                String confidence;
                                String documentId;
                                String docHtmlLinkTagged;
                                LocalDateTime timestamp;
                                String environment;

                                void init(boolean isIe) {
                                    tp = 0;
                                    fp = 0;
                                    tn = 0;
                                    fn = 0;
                                    if (StringUtils.isEmpty(goldValue) &amp;&amp; StringUtils.isEmpty(extractedValue)) {
                                        tn = 1;
                                    } else if (StringUtils.isNotEmpty(goldValue) &amp;&amp; StringUtils.isEmpty(extractedValue)) {
                                        fn = 1;
                                    } else if (StringUtils.isEmpty(goldValue) &amp;&amp; StringUtils.isNotEmpty(extractedValue)) {
                                        fp = 1;
                                    } else if (compare(goldValue, extractedValue)) {
                                        tp = 1;
                                    } else {
                                        fp = 1;
                                        if (isIe) {
                                            fn = 1;
                                        }
                                    }
                                }
                            }

                            StringBuilder addStringValueForSql(String value, StringBuilder sql) {
                                return value == null ? sql.append("null") : sql.append("'").append(value).append("'");
                            }

                            String environment = "true".equals(_sys_is_sandbox.toString()) ? "sandbox" : "production";

                            LocalDateTime now = LocalDateTime.now();
                            List dsRows = new ArrayList();
                            String f = field.toString();
                            String group;
                            if (subGroupAnswersCodes.getWrappedObject().containsKey(f)) {
                                group = f;
                                List goldGroupAnswers = GsonUtils.GSON.fromJson(goldAnswers.getWrappedObject().get(f).toString(), GsonUtils.TYPE_MAP_STRING_LIST_MAP_STRING).get(group);
                                List modelGroupAnswers = GsonUtils.GSON.fromJson(modelAnswers.getWrappedObject().get(f).toString(), GsonUtils.TYPE_MAP_STRING_LIST_MAP_STRING).get(group);
                                // Restriction: compare answer based on that order in group is equivalent for model and gold answers
                                int minLength = goldGroupAnswers.size() &lt; modelGroupAnswers.size() ? goldGroupAnswers.size() : modelGroupAnswers.size();
                                Map subScores = GsonUtils.GSON.fromJson(scores.getWrappedObject().get(group), GsonUtils.TYPE_MAP_STRING_STRING);
                                Map subConfidences = GsonUtils.GSON.fromJson(confidences.getWrappedObject().get(group), GsonUtils.TYPE_MAP_STRING_STRING);
                                for (int j = 0; j &lt; minLength; j++) {
                                    Map goldGroupAnswer = goldGroupAnswers.get(j);
                                    Map modelGroupAnswer = modelGroupAnswers.get(j);
                                    String tabnumber = modelGroupAnswer.get("tabnumber");

                                    for (String sf : subGroupAnswersCodes.getWrappedObject().get(f)) {
                                        DsRowFieldData dsRowData = new DsRowFieldData();

                                        dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                        dsRowData.fieldName = sf;
                                        dsRowData.groupName = group;
                                        dsRowData.goldValue = goldGroupAnswer.get(sf) == null ? null : goldGroupAnswer.get(sf).toString();
                                        dsRowData.extractedValue = modelGroupAnswer.get(sf) == null ? null : modelGroupAnswer.get(sf).toString();
                                        dsRowData.score = subScores.get(sf + "_" + tabnumber);
                                        dsRowData.confidence = subConfidences.get(sf + "_" + tabnumber);
                                        dsRowData.documentId = _sys_document_id.toString();
                                        dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                        dsRowData.timestamp = now;
                                        dsRowData.environment = environment;

                                        dsRowData.init(isIe.getWrappedObject());
                                        dsRows.add(dsRowData);
                                    }
                                }

                                if (goldGroupAnswers.size() &gt; minLength) {
                                    for (int j = minLength; j &lt; goldGroupAnswers.size(); j++) {
                                        Map goldGroupAnswer = goldGroupAnswers.get(j);
                                        for (String sf : subGroupAnswersCodes.getWrappedObject().get(f)) {
                                            DsRowFieldData dsRowData = new DsRowFieldData();

                                            dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                            dsRowData.fieldName = sf;
                                            dsRowData.groupName = group;
                                            dsRowData.goldValue = goldGroupAnswer.get(sf) == null ? null : goldGroupAnswer.get(sf).toString();
                                            dsRowData.extractedValue = null;
                                            dsRowData.score = null;
                                            dsRowData.confidence = null;
                                            dsRowData.documentId = _sys_document_id.toString();
                                            dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                            dsRowData.timestamp = now;
                                            dsRowData.environment = environment;

                                            dsRowData.init(isIe.getWrappedObject());
                                            dsRows.add(dsRowData);
                                        }
                                    }
                                } else if (modelGroupAnswers.size() &gt; minLength) {
                                    for (int j = minLength; j &lt; modelGroupAnswers.size(); j++) {
                                        Map modelGroupAnswer = modelGroupAnswers.get(j);
                                        String tabnumber = modelGroupAnswer.get("tabnumber");
                                        for (String sf : subGroupAnswersCodes.getWrappedObject().get(f)) {
                                            DsRowFieldData dsRowData = new DsRowFieldData();

                                            dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                            dsRowData.fieldName = sf;
                                            dsRowData.groupName = group;
                                            dsRowData.goldValue = null;
                                            dsRowData.extractedValue = modelGroupAnswer.get(sf) == null ? null : modelGroupAnswer.get(sf).toString();
                                            dsRowData.score = subScores.get(sf + "_" + tabnumber);
                                            dsRowData.confidence = subConfidences.get(sf + "_" + tabnumber);
                                            dsRowData.documentId = _sys_document_id.toString();
                                            dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                            dsRowData.timestamp = now;
                                            dsRowData.environment = environment;

                                            dsRowData.init(isIe.getWrappedObject());
                                            dsRows.add(dsRowData);
                                        }
                                    }
                                }

                            } else {
                                DsRowFieldData dsRowData = new DsRowFieldData();

                                dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                dsRowData.fieldName = f;
                                dsRowData.groupName = null;
                                dsRowData.goldValue = goldAnswers.getWrappedObject().get(f).toString();
                                dsRowData.extractedValue = modelAnswers.getWrappedObject().get(f).toString();
                                dsRowData.score = scores.getWrappedObject().get(f);
                                dsRowData.confidence = confidences.getWrappedObject().get(f);
                                dsRowData.documentId = _sys_document_id.toString();
                                dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                dsRowData.timestamp = now;
                                dsRowData.environment = environment;

                                dsRowData.init(isIe.getWrappedObject());
                                dsRows.add(dsRowData);
                            }

        					DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern("MM/dd/yyyy hh:mm:ss");

                            StringBuilder sb = new StringBuilder("INSERT INTO @this");
                            sb.append(" (run_uuid, field_name, group_name, gold_value, extracted_value, tp, fp, tn, fn, score, confidence, document_id, doc_html_link_tagged, timestamp, environment)");
                            sb.append(" VALUES ");
                            for (DsRowFieldData data: dsRows) {
                                sb.append("(");
                                sb.append("'").append(data.runUuid).append("', ");
                                sb.append("'").append(data.fieldName).append("', ");
                                addStringValueForSql(data.groupName, sb).append(", ");
                                addStringValueForSql(data.goldValue, sb).append(", ");
                                addStringValueForSql(data.extractedValue, sb).append(", ");
                                sb.append(data.tp).append(", ");
                                sb.append(data.fp).append(", ");
                                sb.append(data.tn).append(", ");
                                sb.append(data.fn).append(", ");
                                addStringValueForSql(data.score, sb).append(", ");
                                addStringValueForSql(data.confidence, sb).append(", ");
                                addStringValueForSql(data.documentId, sb).append(", ");
                                addStringValueForSql(data.docHtmlLinkTagged, sb).append(", ");
                                sb.append("'").append(data.timestamp.format(dateTimeFormatter)).append("', ");
                                addStringValueForSql(data.environment, sb);
                                sb.append(")");
                                sb.append(",");
                            }
                            sb.deleteCharAt(sb.length() - 1);
                            sb.append(";");
                            String insertQueue = sb.toString();

                        ]]&gt;&lt;/script&gt;
                        &lt;datastore name="${datastore_name}"&gt;
                            ${insertQueue}
                        &lt;/datastore&gt;

                    &lt;/body&gt;
                &lt;/loop&gt;

            &lt;/datastore-transaction&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"&gt;
    &lt;/export&gt;

&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>7eae39f4-71c2-48d7-aa5f-39278e8621d0</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Statistics Calculation</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;case&gt;
        &lt;if condition='${"false".equals(_sys_is_statistics_calculation_skipped.toString())}'&gt;

            &lt;script language="groovy"&gt;&lt;![CDATA[
                import com.workfusion.utils.datastore.DataStoreUtils;

                String datastore_name = "automation_stat_" + DataStoreUtils.replaceNonWordCharacters(_sys_bp_campaign_uuid.toString());
                sys.defineVariable("datastore_name", datastore_name);
            ]]&gt;&lt;/script&gt;

            &lt;create-datastore name="${datastore_name}"&gt;
                &lt;datastore-column name="run_uuid" type="TEXT"/&gt;
                &lt;datastore-column name="field_name" type="TEXT"/&gt;
                &lt;datastore-column name="group_name" type="TEXT"/&gt;
                &lt;datastore-column name="gold_value" type="TEXT"/&gt;
                &lt;datastore-column name="extracted_value" type="TEXT"/&gt;
                &lt;datastore-column name="tp" type="INTEGER"/&gt;
                &lt;datastore-column name="tn" type="INTEGER"/&gt;
                &lt;datastore-column name="fp" type="INTEGER"/&gt;
                &lt;datastore-column name="fn" type="INTEGER"/&gt;
                &lt;datastore-column name="score" type="TEXT"/&gt;
                &lt;datastore-column name="confidence" type="TEXT"/&gt;
                &lt;datastore-column name="document_id" type="TEXT"/&gt;
                &lt;datastore-column name="doc_html_link_tagged" type="TEXT"/&gt;
                &lt;datastore-column name="timestamp" type="TIMESTAMP"/&gt;
                &lt;datastore-column name="environment" type="TEXT"/&gt;
            &lt;/create-datastore&gt;

            &lt;datastore-transaction isolation="SERIALIZABLE"&gt;
                &lt;datastore name="${datastore_name}"&gt;
                    LOCK TABLE @this;
                &lt;/datastore&gt;

                &lt;script language="groovy"&gt;&lt;![CDATA[
                    import org.apache.commons.lang.StringUtils;
					import com.freedomoss.workfusion.utils.gson.GsonUtils;
					import com.google.gson.reflect.TypeToken;

					Object getWrappedObjectOrNull(Object var) {
						return var == null ? null : var.getWrappedObject();
					}

                    String modelType = _sys_model_type.toString();
                    List fieldList;
                    Boolean isIe;
                    if ("ie".equals(modelType)) {
                        fieldList = Arrays.asList(_sys_automation_ie_fields.toString().split(","));
                        isIe = Boolean.TRUE;
                    } else if ("classification".equals(modelType)) {
                        String categoryColumn = _sys_automation_ie_answer_code.toString();
                        fieldList = Arrays.asList(categoryColumn);
                        isIe = Boolean.FALSE;
                    }

                    goldAnswers = new HashMap();
                    modelAnswers = new HashMap();
                    scores = new HashMap();
                    confidences = new HashMap();
                    for (String field : fieldList) {
                        goldAnswers.put(field, getWrappedObjectOrNull(sys.getVar(field)));
                        modelAnswers.put(field, getWrappedObjectOrNull(sys.getVar(field + "_extracted")));
                        scores.put(field, getWrappedObjectOrNull(sys.getVar(field + "_score_extracted")));
                        confidences.put(field, getWrappedObjectOrNull(sys.getVar(field + "_confidence_extracted")));
                    }

                    Map subGroupAnswersCodes = GsonUtils.GSON.fromJson(_sys_sub_group_answers_codes.toString(), new TypeToken&lt;Map&lt;String, List&lt;String&gt;&gt;&gt;() {}.getType());

                    sys.defineVariable("fieldList", fieldList);
                    sys.defineVariable("goldAnswers", goldAnswers);
                    sys.defineVariable("modelAnswers", modelAnswers);
                    sys.defineVariable("scores", scores);
                    sys.defineVariable("confidences", confidences);
                    sys.defineVariable("isIe", isIe);
                    sys.defineVariable("subGroupAnswersCodes", subGroupAnswersCodes );
                ]]&gt;&lt;/script&gt;

                &lt;loop item="field" empty="true"&gt;
                    &lt;list&gt;
                        &lt;var name="fieldList"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;script&gt;&lt;![CDATA[
                            import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.enums.DataStoreColumnType;
                            import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.DataStoreRow;
                            import com.freedomoss.workfusion.utils.gson.GsonUtils;
                            import java.time.LocalDateTime;
							import java.time.format.DateTimeFormatter;
							import java.util.Arrays;
							import org.apache.commons.lang3.StringUtils;

                            /**
                             * Compare not null gold and extracted values:
                             *      1. split by '|'
                             *      2. sort obtained arrays
                             *      3. compare arrays by elements on the same position
                             * Such comparison required because multivalue fields saved in one string with separator '|'.
                             * If field is not multivalue and containg '|' then such comparison is the same as using equals.
                             */
                            boolean compare(String goldValue, String extractedValue) {
                                String[] goldSubValue = goldValue.split("\\|");
                                String[] extractedSubValue = extractedValue.split("\\|");
                                if (goldSubValue.length != extractedSubValue.length) {
                                    return false;
                                }
                                Arrays.sort(goldSubValue);
                                Arrays.sort(extractedSubValue);
                                for (int j = 0; j &lt; goldSubValue.length; j++) {
                                    if (!goldSubValue[j].equals(extractedSubValue[j])) {
                                        return false;
                                    }
                                }
                                return true;
                            }

							class DsRowFieldData {
                                String runUuid;
                                String fieldName;
                                String groupName;
                                String goldValue;
                                String extractedValue;
                                int tp;
                                int fp;
                                int tn;
                                int fn;
                                String score;
                                String confidence;
                                String documentId;
                                String docHtmlLinkTagged;
                                LocalDateTime timestamp;
                                String environment;

                                void init(boolean isIe) {
                                    tp = 0;
                                    fp = 0;
                                    tn = 0;
                                    fn = 0;
                                    if (StringUtils.isEmpty(goldValue) &amp;&amp; StringUtils.isEmpty(extractedValue)) {
                                        tn = 1;
                                    } else if (StringUtils.isNotEmpty(goldValue) &amp;&amp; StringUtils.isEmpty(extractedValue)) {
                                        fn = 1;
                                    } else if (StringUtils.isEmpty(goldValue) &amp;&amp; StringUtils.isNotEmpty(extractedValue)) {
                                        fp = 1;
                                    } else if (compare(goldValue, extractedValue)) {
                                        tp = 1;
                                    } else {
                                        fp = 1;
                                        if (isIe) {
                                            fn = 1;
                                        }
                                    }
                                }
                            }

                            StringBuilder addStringValueForSql(String value, StringBuilder sql) {
                                return value == null ? sql.append("null") : sql.append("'").append(value).append("'");
                            }

                            String environment = "true".equals(_sys_is_sandbox.toString()) ? "sandbox" : "production";

                            LocalDateTime now = LocalDateTime.now();
                            List dsRows = new ArrayList();
                            String f = field.toString();
                            String group;
                            if (subGroupAnswersCodes.getWrappedObject().containsKey(f)) {
                                group = f;
                                List goldGroupAnswers = GsonUtils.GSON.fromJson(goldAnswers.getWrappedObject().get(f).toString(), GsonUtils.TYPE_MAP_STRING_LIST_MAP_STRING).get(group);
                                List modelGroupAnswers = GsonUtils.GSON.fromJson(modelAnswers.getWrappedObject().get(f).toString(), GsonUtils.TYPE_MAP_STRING_LIST_MAP_STRING).get(group);
                                // Restriction: compare answer based on that order in group is equivalent for model and gold answers
                                int minLength = goldGroupAnswers.size() &lt; modelGroupAnswers.size() ? goldGroupAnswers.size() : modelGroupAnswers.size();
                                Map subScores = GsonUtils.GSON.fromJson(scores.getWrappedObject().get(group), GsonUtils.TYPE_MAP_STRING_STRING);
                                Map subConfidences = GsonUtils.GSON.fromJson(confidences.getWrappedObject().get(group), GsonUtils.TYPE_MAP_STRING_STRING);
                                for (int j = 0; j &lt; minLength; j++) {
                                    Map goldGroupAnswer = goldGroupAnswers.get(j);
                                    Map modelGroupAnswer = modelGroupAnswers.get(j);
                                    String tabnumber = modelGroupAnswer.get("tabnumber");

                                    for (String sf : subGroupAnswersCodes.getWrappedObject().get(f)) {
                                        DsRowFieldData dsRowData = new DsRowFieldData();

                                        dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                        dsRowData.fieldName = sf;
                                        dsRowData.groupName = group;
                                        dsRowData.goldValue = goldGroupAnswer.get(sf) == null ? null : goldGroupAnswer.get(sf).toString();
                                        dsRowData.extractedValue = modelGroupAnswer.get(sf) == null ? null : modelGroupAnswer.get(sf).toString();
                                        dsRowData.score = subScores.get(sf + "_" + tabnumber);
                                        dsRowData.confidence = subConfidences.get(sf + "_" + tabnumber);
                                        dsRowData.documentId = _sys_document_id.toString();
                                        dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                        dsRowData.timestamp = now;
                                        dsRowData.environment = environment;

                                        dsRowData.init(isIe.getWrappedObject());
                                        dsRows.add(dsRowData);
                                    }
                                }

                                if (goldGroupAnswers.size() &gt; minLength) {
                                    for (int j = minLength; j &lt; goldGroupAnswers.size(); j++) {
                                        Map goldGroupAnswer = goldGroupAnswers.get(j);
                                        for (String sf : subGroupAnswersCodes.getWrappedObject().get(f)) {
                                            DsRowFieldData dsRowData = new DsRowFieldData();

                                            dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                            dsRowData.fieldName = sf;
                                            dsRowData.groupName = group;
                                            dsRowData.goldValue = goldGroupAnswer.get(sf) == null ? null : goldGroupAnswer.get(sf).toString();
                                            dsRowData.extractedValue = null;
                                            dsRowData.score = null;
                                            dsRowData.confidence = null;
                                            dsRowData.documentId = _sys_document_id.toString();
                                            dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                            dsRowData.timestamp = now;
                                            dsRowData.environment = environment;

                                            dsRowData.init(isIe.getWrappedObject());
                                            dsRows.add(dsRowData);
                                        }
                                    }
                                } else if (modelGroupAnswers.size() &gt; minLength) {
                                    for (int j = minLength; j &lt; modelGroupAnswers.size(); j++) {
                                        Map modelGroupAnswer = modelGroupAnswers.get(j);
                                        String tabnumber = modelGroupAnswer.get("tabnumber");
                                        for (String sf : subGroupAnswersCodes.getWrappedObject().get(f)) {
                                            DsRowFieldData dsRowData = new DsRowFieldData();

                                            dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                            dsRowData.fieldName = sf;
                                            dsRowData.groupName = group;
                                            dsRowData.goldValue = null;
                                            dsRowData.extractedValue = modelGroupAnswer.get(sf) == null ? null : modelGroupAnswer.get(sf).toString();
                                            dsRowData.score = subScores.get(sf + "_" + tabnumber);
                                            dsRowData.confidence = subConfidences.get(sf + "_" + tabnumber);
                                            dsRowData.documentId = _sys_document_id.toString();
                                            dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                            dsRowData.timestamp = now;
                                            dsRowData.environment = environment;

                                            dsRowData.init(isIe.getWrappedObject());
                                            dsRows.add(dsRowData);
                                        }
                                    }
                                }

                            } else {
                                DsRowFieldData dsRowData = new DsRowFieldData();

                                dsRowData.runUuid = _sys_bp_run_uuid.getWrappedObject().toString();
                                dsRowData.fieldName = f;
                                dsRowData.groupName = null;
                                dsRowData.goldValue = goldAnswers.getWrappedObject().get(f).toString();
                                dsRowData.extractedValue = modelAnswers.getWrappedObject().get(f).toString();
                                dsRowData.score = scores.getWrappedObject().get(f);
                                dsRowData.confidence = confidences.getWrappedObject().get(f);
                                dsRowData.documentId = _sys_document_id.toString();
                                dsRowData.docHtmlLinkTagged = _sys_doc_html_link_tagged.toString();
                                dsRowData.timestamp = now;
                                dsRowData.environment = environment;

                                dsRowData.init(isIe.getWrappedObject());
                                dsRows.add(dsRowData);
                            }

        					DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern("MM/dd/yyyy hh:mm:ss");

                            StringBuilder sb = new StringBuilder("INSERT INTO @this");
                            sb.append(" (run_uuid, field_name, group_name, gold_value, extracted_value, tp, fp, tn, fn, score, confidence, document_id, doc_html_link_tagged, timestamp, environment)");
                            sb.append(" VALUES ");
                            for (DsRowFieldData data: dsRows) {
                                sb.append("(");
                                sb.append("'").append(data.runUuid).append("', ");
                                sb.append("'").append(data.fieldName).append("', ");
                                addStringValueForSql(data.groupName, sb).append(", ");
                                addStringValueForSql(data.goldValue, sb).append(", ");
                                addStringValueForSql(data.extractedValue, sb).append(", ");
                                sb.append(data.tp).append(", ");
                                sb.append(data.fp).append(", ");
                                sb.append(data.tn).append(", ");
                                sb.append(data.fn).append(", ");
                                addStringValueForSql(data.score, sb).append(", ");
                                addStringValueForSql(data.confidence, sb).append(", ");
                                addStringValueForSql(data.documentId, sb).append(", ");
                                addStringValueForSql(data.docHtmlLinkTagged, sb).append(", ");
                                sb.append("'").append(data.timestamp.format(dateTimeFormatter)).append("', ");
                                addStringValueForSql(data.environment, sb);
                                sb.append(")");
                                sb.append(",");
                            }
                            sb.deleteCharAt(sb.length() - 1);
                            sb.append(";");
                            String insertQueue = sb.toString();

                        ]]&gt;&lt;/script&gt;
                        &lt;datastore name="${datastore_name}"&gt;
                            ${insertQueue}
                        &lt;/datastore&gt;

                    &lt;/body&gt;
                &lt;/loop&gt;

            &lt;/datastore-transaction&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"&gt;
    &lt;/export&gt;

&lt;/config&gt;
</content>
                                        <name>Statistics Calculation 8.4.4.1</name>
                                        <origination>CREATED_AUTOMATICALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>MACHINE</type>
                                        <uuid>2a28bcf2-c2d4-4f1f-b2ad-e14d12565aed</uuid>
                                        <version>
                                            <componentUuid>2a2dcb09-f044-44fd-86a4-c216cb66c664</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <versionUuid>69858d80-cb64-442e-8783-b00dc043e78c</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>7eae39f4-71c2-48d7-aa5f-39278e8621d0</uuid>
                                    <version>
                                        <componentUuid>84861905-e2b9-440c-88a5-db455b3bcb87</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>8581808d-359b-4db9-98c8-c3c2eb00dc9c</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Statistics Calculation</title>
                                <type>SINGLE</type>
                                <uuid>ba501459-e071-40ad-8bfd-f8db17918023</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>65cec551-9f53-4fa7-8a5a-bac5347874a8</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>394ae546-55d0-4644-b457-534bcea0cadf</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>67</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>c02a8e89-6c0d-4d4d-8aa9-ad173bcf33b9</uuid>
                        </campaignMap>
                        <campaignMap>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>73ee77f5-2446-4c50-b90a-729a9355bb45</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;var-def name="exportType"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_type")}'&gt;
                &lt;template&gt;${_sys_export_type}&lt;/template&gt;
            &lt;/if&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="exportColumns"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_columns")}'&gt;
                &lt;template&gt;${_sys_export_columns}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="columnNameCase"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_column_name_case")}'&gt;
                &lt;template&gt;${_sys_column_name_case}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;keep&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="dataOnly"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_data_only")}'&gt;
                &lt;template&gt;${_sys_data_only}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;true&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="datastoreName"&gt;
        &lt;script return="item.getWrappedObject().getRun().getDatastoreName()" /&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!datastoreName.isEmpty()}"&gt;
            &lt;insert-datastore   datastore-name="${datastoreName}" create="true"&gt;
                &lt;script return="hit_submission_data_item.getWrappedObject().getItemValueMap()"/&gt;
            &lt;/insert-datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"
            export-type="${exportType}"
            export-columns="${exportColumns}"
            column-name-case="${columnNameCase}"
            data-only="${dataOnly}"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>Default machine campaign for end step.</description>
                                    <includedConfigs/>
                                    <inclusionCode>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</inclusionCode>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <name>Final Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</uuid>
                                    <version>
                                        <componentUuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-08-21T10:54:19Z</lastModified>
                                        <versionUuid>71976d1d-a48f-4ce5-ae4d-10203991bf95</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>100</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Percents</streamValueType>
                                <title>Final Results</title>
                                <type>SINGLE</type>
                                <uuid>af4c8905-26dd-4120-b208-39ad3530ffc6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>a7c3c527-28fb-11e8-bf41-000d3a0302a9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>false</lastInChain>
                                    <lastModified>2018-08-21T10:54:19Z</lastModified>
                                    <versionUuid>56d0500e-1f1a-4755-9c95-600a8de71b5e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>68</stepIndex>
                            <stepPosition>SUBEND</stepPosition>
                            <uuid>e2e85455-ed09-422a-bad8-d9d0da126df3</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"Success","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_skip_human_steps","value":"false","operator":"EQ"},{"fieldName":"_sys_automation_extract_status","value":"success","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'Success' when _sys_skip_human_steps EQ 'false' AND _sys_automation_extract_status EQ 'success'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_skip_human_steps", "EQ", "false"));
        eval($item.checkValue("_sys_automation_extract_status", "EQ", "success"));

    then
        $ctx.sendResultTo("Success", $item);
end

# RuleOutcome.Definition={"outcomeId":"Failure","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_skip_human_steps","value":"false","operator":"EQ"},{"fieldName":"_sys_automation_extract_status","value":"failure","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'Failure' when _sys_skip_human_steps EQ 'false' AND _sys_automation_extract_status EQ 'failure'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_skip_human_steps", "EQ", "false"));
        eval($item.checkValue("_sys_automation_extract_status", "EQ", "failure"));

    then
        $ctx.sendResultTo("Failure", $item);
end

# RuleOutcome.Definition={"outcomeId":"Partial success","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_skip_human_steps","value":"false","operator":"EQ"},{"fieldName":"_sys_automation_extract_status","value":"partial_success","operator":"EQ"}],"customConditions":[]}
rule "3. Send records to 'Partial success' when _sys_skip_human_steps EQ 'false' AND _sys_automation_extract_status EQ 'partial_success'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_skip_human_steps", "EQ", "false"));
        eval($item.checkValue("_sys_automation_extract_status", "EQ", "partial_success"));

    then
        $ctx.sendResultTo("Partial success", $item);
end

# RuleOutcome.Definition={"outcomeId":"Statistics calculation with gold input data","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_skip_human_steps","value":"true","operator":"EQ"}],"customConditions":[]}
rule "4. Send records to 'Statistics calculation with gold input data' when _sys_skip_human_steps EQ 'true'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_skip_human_steps", "EQ", "true"));

    then
        $ctx.sendResultTo("Statistics calculation with gold input data", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end
</content>
                                <name>Skip manual steps or is data extracted automatically?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>6ef80a7c-09e6-4e09-ab71-1ca8cb6cf863</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;script language="groovy"&gt;&lt;![CDATA[
		import com.freedomoss.workfusion.utils.gson.GsonUtils;
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
		import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
		import com.google.gson.reflect.TypeToken;

//--------------------------------------------------------------------------------------------------------------
//------------------------------------- START OF METHODS DECLARATION -------------------------------------------
//--------------------------------------------------------------------------------------------------------------

        List prepareFieldList() {
            String modelType = _sys_model_type.toString();
            List fieldList;
            if ("ie".equals(modelType)) {
                fieldList = Arrays.asList(_sys_automation_ie_fields.toString().split(","));
            } else if ("classification".equals(modelType)) {
                fieldList = Arrays.asList(getCategoryColumn());
            }
            sys.defineVariable("fieldList", fieldList);
            return fieldList;
        }

        void prepareGoldAnswers() {
            if (Boolean.valueOf(_sys_is_gold_input_data.getWrappedObject())) {
                goldAnswers = GsonUtils.GSON.fromJson(_sys_gold_answer.toString(), GsonUtils.TYPE_MAP_STRING_STRING);
                List goldAnswerFields = new ArrayList(goldAnswers.keySet());
                sys.defineVariable("goldAnswers", goldAnswers);
                sys.defineVariable("goldAnswerFields", goldAnswerFields);
            }
        }

        Map prepareSubAnswerCodesForGroupAnswer(){
            RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            Map&lt;String, List&lt;String&gt;&gt; subGroupAnswersCodes = new HashMap&lt;&gt;();
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    for (AnswerInfoDTO subAnswer : ieAnswer.getSubAnswers()) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            List&lt;String&gt; subCodes = new ArrayList&lt;&gt;();
                            for (AnswerInfoDTO subAnswerForGroup : subAnswer.subAnswers) {
                                subCodes.add(subAnswerForGroup.answerCode);
                            }
                            subGroupAnswersCodes.put(subAnswer.answerCode, subCodes);
                        }
                    }
                }
            }
            sys.defineVariable("subGroupAnswersCodes", GsonUtils.GSON.toJson(subGroupAnswersCodes, new TypeToken&lt;Map&lt;String, List&lt;String&gt;&gt;&gt;() {}.getType()));
            return subGroupAnswersCodes;
        }

        AnswerInfoDTO findIeAnswer(List answers) {
            for (AnswerInfoDTO answer : answers) {
                if (answer.answerType.equals("INFO_EXTRACTION")) {
                    return answer;
                }
                if (answer.subAnswers != null &amp;&amp; !answer.subAnswers.isEmpty()) {
                    AnswerInfoDTO ieAnswer = findIeAnswer(answer.subAnswers);
                    if (ieAnswer != null) {
                        return ieAnswer;
                    }
                }
            }
            return null;
        }

        void prepareScoresAndConfidences(List fieldList, Map subGroupAnswersCodes) {
            String modelType = _sys_model_type.toString();
            Map modelResult = GsonUtils.GSON.fromJson(_sys_model_result.getWrappedObject().toString(), GsonUtils.TYPE_MAP_STRING_OBJECT);
            Map scores = new HashMap();
            Map confidences = new HashMap();
            if ("ie".equals(modelType)) {
                List tagList = modelResult.get("tags");
                Map tagInfos = new HashMap();
                for (Map tagInfo : tagList) {
                    tagInfos.put(tagInfo.get("tag"), tagInfo);
                }
                for (String fieldName : fieldList) {
                    String score = null;
                    String confidence = null;
                    if (subGroupAnswersCodes.containsKey(fieldName)) {
                        List subGroupFieldNames = subGroupAnswersCodes.get(fieldName);
                        Map subScores = new HashMap();
                        Map subConfidences = new HashMap();
                        for (Map tagInfo : tagList) {
                            String tag = tagInfo.get("tag");
                            if (subGroupFieldNames.contains(tag)) {
                                subScores.put(tag + "_" + tagInfo.get("tabnumber"), tagInfo.get("score"));
                                subConfidences.put(tag + "_" + tagInfo.get("tabnumber"), tagInfo.get("estimatedAccuracy"));
                            }
                        }
                        score = GsonUtils.GSON.toJson(subScores, GsonUtils.TYPE_MAP_STRING_STRING);
                        confidence = GsonUtils.GSON.toJson(subConfidences, GsonUtils.TYPE_MAP_STRING_STRING);
                    } else {
                        Map tagInfo = tagInfos.get(fieldName);
                        if (tagInfo != null) {
                            score = tagInfo.get("score");
                            confidence = tagInfo.get("estimatedAccuracy");
                        }
                    }
                    scores.put(fieldName, score);
                    confidences.put(fieldName, confidence);
                }
            } else if ("classification".equals(modelType)) {
                String categoryColumn = getCategoryColumn();
                scores.put(categoryColumn, modelResult.get("score"));
                confidences.put(categoryColumn, modelResult.get("estimatedAccuracy"));
            }
            sys.defineVariable("scores", scores);
            sys.defineVariable("confidences", confidences);
        }

        String getCategoryColumn() {
            return _sys_automation_ie_answer_code.toString();
        }

//--------------------------------------------------------------------------------------------------------------
//------------------------------------- END OF METHODS DECLARATION ---------------------------------------------
//--------------------------------------------------------------------------------------------------------------

        isStatisticsCalculationSkipped = !("true".equals(_sys_statistics_calculation_enabled.toString()) &amp;&amp; "false".equals(_sys_is_extract_system_error.toString()));
        sys.defineVariable("isStatisticsCalculationSkipped", isStatisticsCalculationSkipped);

        if (!isStatisticsCalculationSkipped) {
            List fieldList = prepareFieldList();
            prepareGoldAnswers();
            Map subGroupAnswersCodes = prepareSubAnswerCodesForGroupAnswer();
            prepareScoresAndConfidences(fieldList, subGroupAnswersCodes);
        }

	]]&gt;&lt;/script&gt;


    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_bp_run_uuid"
                       value="${item.wrappedObject.run.rootRunUuid}"/&gt;
        &lt;single-column name="_sys_bp_campaign_uuid"
                       value="${item.wrappedObject.run.automationInfo.bpCampaignUuid}"/&gt;
        &lt;single-column name="_sys_is_statistics_calculation_skipped"
                       value="${isStatisticsCalculationSkipped}"/&gt;

        &lt;case&gt;
            &lt;if condition='${"true".equals(_sys_has_conversion_errors.toString()) &amp;amp;&amp;amp; "success".equals(_sys_automation_extract_status.toString())}'&gt;
                &lt;single-column name="_sys_automation_extract_status"
                               value="partial_success"/&gt;
            &lt;/if&gt;
        &lt;/case&gt;

        &lt;case&gt;
            &lt;if condition='${"false".equals(isStatisticsCalculationSkipped.toString())}'&gt;
                &lt;single-column name="_sys_is_sandbox"
                               value="${item.wrappedObject.run.sandbox}"/&gt;

                &lt;single-column name="_sys_sub_group_answers_codes"
                               value="${subGroupAnswersCodes}"/&gt;

                &lt;single-column name="_sys_document_id" value="${item.wrappedObject.submission.awsHit.uuid}"/&gt;
                &lt;single-column name="_sys_doc_html_link_tagged" value=""/&gt;

                &lt;loop item="fieldName" empty="true"&gt;
                    &lt;list&gt;
                        &lt;var name="fieldList"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;single-column name="${fieldName}_extracted"
                                       value='${sys.getVar(fieldName.toString()).getWrappedObject()}'/&gt;
                        &lt;single-column name="${fieldName}_score_extracted"
                                       value='${scores.getWrappedObject().get(fieldName.toString())}'/&gt;
                        &lt;single-column name="${fieldName}_confidence_extracted"
                                       value='${confidences.getWrappedObject().get(fieldName.toString())}'/&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
                &lt;case&gt;
                    &lt;if condition='${"true".equals(_sys_is_gold_input_data.toString())}'&gt;
                        &lt;loop item="goldAnswerField" empty="true"&gt;
                            &lt;list&gt;
                                &lt;var name="goldAnswerFields"/&gt;
                            &lt;/list&gt;
                            &lt;body&gt;
                                &lt;single-column name="${goldAnswerField}"
                                               value='${goldAnswers.getWrappedObject().get(goldAnswerField.toString())}'/&gt;
                            &lt;/body&gt;
                        &lt;/loop&gt;
                        &lt;single-column name="_sys_skip_human_steps" value="true"/&gt;
                    &lt;/if&gt;
                    &lt;else&gt;
                        &lt;single-column name="_sys_skip_human_steps" value="false"/&gt;
                    &lt;/else&gt;
                &lt;/case&gt;
            &lt;/if&gt;
            &lt;else&gt;
                &lt;single-column name="_sys_skip_human_steps" value="false"/&gt;
            &lt;/else&gt;
        &lt;/case&gt;

    &lt;/export&gt;

&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>d0fdbdf8-7202-4111-b185-fe3001dc39f1</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Prepare Data</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;script language="groovy"&gt;&lt;![CDATA[
		import com.freedomoss.workfusion.utils.gson.GsonUtils;
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
		import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
		import com.google.gson.reflect.TypeToken;

//--------------------------------------------------------------------------------------------------------------
//------------------------------------- START OF METHODS DECLARATION -------------------------------------------
//--------------------------------------------------------------------------------------------------------------

        List prepareFieldList() {
            String modelType = _sys_model_type.toString();
            List fieldList;
            if ("ie".equals(modelType)) {
                fieldList = Arrays.asList(_sys_automation_ie_fields.toString().split(","));
            } else if ("classification".equals(modelType)) {
                fieldList = Arrays.asList(getCategoryColumn());
            }
            sys.defineVariable("fieldList", fieldList);
            return fieldList;
        }

        void prepareGoldAnswers() {
            if (Boolean.valueOf(_sys_is_gold_input_data.getWrappedObject())) {
                goldAnswers = GsonUtils.GSON.fromJson(_sys_gold_answer.toString(), GsonUtils.TYPE_MAP_STRING_STRING);
                List goldAnswerFields = new ArrayList(goldAnswers.keySet());
                sys.defineVariable("goldAnswers", goldAnswers);
                sys.defineVariable("goldAnswerFields", goldAnswerFields);
            }
        }

        Map prepareSubAnswerCodesForGroupAnswer(){
            RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            Map&lt;String, List&lt;String&gt;&gt; subGroupAnswersCodes = new HashMap&lt;&gt;();
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    for (AnswerInfoDTO subAnswer : ieAnswer.getSubAnswers()) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            List&lt;String&gt; subCodes = new ArrayList&lt;&gt;();
                            for (AnswerInfoDTO subAnswerForGroup : subAnswer.subAnswers) {
                                subCodes.add(subAnswerForGroup.answerCode);
                            }
                            subGroupAnswersCodes.put(subAnswer.answerCode, subCodes);
                        }
                    }
                }
            }
            sys.defineVariable("subGroupAnswersCodes", GsonUtils.GSON.toJson(subGroupAnswersCodes, new TypeToken&lt;Map&lt;String, List&lt;String&gt;&gt;&gt;() {}.getType()));
            return subGroupAnswersCodes;
        }

        AnswerInfoDTO findIeAnswer(List answers) {
            for (AnswerInfoDTO answer : answers) {
                if (answer.answerType.equals("INFO_EXTRACTION")) {
                    return answer;
                }
                if (answer.subAnswers != null &amp;&amp; !answer.subAnswers.isEmpty()) {
                    AnswerInfoDTO ieAnswer = findIeAnswer(answer.subAnswers);
                    if (ieAnswer != null) {
                        return ieAnswer;
                    }
                }
            }
            return null;
        }

        void prepareScoresAndConfidences(List fieldList, Map subGroupAnswersCodes) {
            String modelType = _sys_model_type.toString();
            Map modelResult = GsonUtils.GSON.fromJson(_sys_model_result.getWrappedObject().toString(), GsonUtils.TYPE_MAP_STRING_OBJECT);
            Map scores = new HashMap();
            Map confidences = new HashMap();
            if ("ie".equals(modelType)) {
                List tagList = modelResult.get("tags");
                Map tagInfos = new HashMap();
                for (Map tagInfo : tagList) {
                    tagInfos.put(tagInfo.get("tag"), tagInfo);
                }
                for (String fieldName : fieldList) {
                    String score = null;
                    String confidence = null;
                    if (subGroupAnswersCodes.containsKey(fieldName)) {
                        List subGroupFieldNames = subGroupAnswersCodes.get(fieldName);
                        Map subScores = new HashMap();
                        Map subConfidences = new HashMap();
                        for (Map tagInfo : tagList) {
                            String tag = tagInfo.get("tag");
                            if (subGroupFieldNames.contains(tag)) {
                                subScores.put(tag + "_" + tagInfo.get("tabnumber"), tagInfo.get("score"));
                                subConfidences.put(tag + "_" + tagInfo.get("tabnumber"), tagInfo.get("estimatedAccuracy"));
                            }
                        }
                        score = GsonUtils.GSON.toJson(subScores, GsonUtils.TYPE_MAP_STRING_STRING);
                        confidence = GsonUtils.GSON.toJson(subConfidences, GsonUtils.TYPE_MAP_STRING_STRING);
                    } else {
                        Map tagInfo = tagInfos.get(fieldName);
                        if (tagInfo != null) {
                            score = tagInfo.get("score");
                            confidence = tagInfo.get("estimatedAccuracy");
                        }
                    }
                    scores.put(fieldName, score);
                    confidences.put(fieldName, confidence);
                }
            } else if ("classification".equals(modelType)) {
                String categoryColumn = getCategoryColumn();
                scores.put(categoryColumn, modelResult.get("score"));
                confidences.put(categoryColumn, modelResult.get("estimatedAccuracy"));
            }
            sys.defineVariable("scores", scores);
            sys.defineVariable("confidences", confidences);
        }

        String getCategoryColumn() {
            return _sys_automation_ie_answer_code.toString();
        }

//--------------------------------------------------------------------------------------------------------------
//------------------------------------- END OF METHODS DECLARATION ---------------------------------------------
//--------------------------------------------------------------------------------------------------------------

        isStatisticsCalculationSkipped = !("true".equals(_sys_statistics_calculation_enabled.toString()) &amp;&amp; "false".equals(_sys_is_extract_system_error.toString()));
        sys.defineVariable("isStatisticsCalculationSkipped", isStatisticsCalculationSkipped);

        if (!isStatisticsCalculationSkipped) {
            List fieldList = prepareFieldList();
            prepareGoldAnswers();
            Map subGroupAnswersCodes = prepareSubAnswerCodesForGroupAnswer();
            prepareScoresAndConfidences(fieldList, subGroupAnswersCodes);
        }

	]]&gt;&lt;/script&gt;


    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_bp_run_uuid"
                       value="${item.wrappedObject.run.rootRunUuid}"/&gt;
        &lt;single-column name="_sys_bp_campaign_uuid"
                       value="${item.wrappedObject.run.automationInfo.bpCampaignUuid}"/&gt;
        &lt;single-column name="_sys_is_statistics_calculation_skipped"
                       value="${isStatisticsCalculationSkipped}"/&gt;

        &lt;case&gt;
            &lt;if condition='${"true".equals(_sys_has_conversion_errors.toString()) &amp;amp;&amp;amp; "success".equals(_sys_automation_extract_status.toString())}'&gt;
                &lt;single-column name="_sys_automation_extract_status"
                               value="partial_success"/&gt;
            &lt;/if&gt;
        &lt;/case&gt;

        &lt;case&gt;
            &lt;if condition='${"false".equals(isStatisticsCalculationSkipped.toString())}'&gt;
                &lt;single-column name="_sys_is_sandbox"
                               value="${item.wrappedObject.run.sandbox}"/&gt;

                &lt;single-column name="_sys_sub_group_answers_codes"
                               value="${subGroupAnswersCodes}"/&gt;

                &lt;single-column name="_sys_document_id" value="${item.wrappedObject.submission.awsHit.uuid}"/&gt;
                &lt;single-column name="_sys_doc_html_link_tagged" value=""/&gt;

                &lt;loop item="fieldName" empty="true"&gt;
                    &lt;list&gt;
                        &lt;var name="fieldList"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;single-column name="${fieldName}_extracted"
                                       value='${sys.getVar(fieldName.toString()).getWrappedObject()}'/&gt;
                        &lt;single-column name="${fieldName}_score_extracted"
                                       value='${scores.getWrappedObject().get(fieldName.toString())}'/&gt;
                        &lt;single-column name="${fieldName}_confidence_extracted"
                                       value='${confidences.getWrappedObject().get(fieldName.toString())}'/&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
                &lt;case&gt;
                    &lt;if condition='${"true".equals(_sys_is_gold_input_data.toString())}'&gt;
                        &lt;loop item="goldAnswerField" empty="true"&gt;
                            &lt;list&gt;
                                &lt;var name="goldAnswerFields"/&gt;
                            &lt;/list&gt;
                            &lt;body&gt;
                                &lt;single-column name="${goldAnswerField}"
                                               value='${goldAnswers.getWrappedObject().get(goldAnswerField.toString())}'/&gt;
                            &lt;/body&gt;
                        &lt;/loop&gt;
                        &lt;single-column name="_sys_skip_human_steps" value="true"/&gt;
                    &lt;/if&gt;
                    &lt;else&gt;
                        &lt;single-column name="_sys_skip_human_steps" value="false"/&gt;
                    &lt;/else&gt;
                &lt;/case&gt;
            &lt;/if&gt;
            &lt;else&gt;
                &lt;single-column name="_sys_skip_human_steps" value="false"/&gt;
            &lt;/else&gt;
        &lt;/case&gt;

    &lt;/export&gt;

&lt;/config&gt;
</content>
                                        <name>Prepare Data 8.4.4.1</name>
                                        <origination>CREATED_AUTOMATICALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>MACHINE</type>
                                        <uuid>e9eb646b-e8f4-45e2-81a6-ebb781f8866a</uuid>
                                        <version>
                                            <componentUuid>bfefb736-2f64-4081-91b6-53d90b91630f</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <versionUuid>242b1199-127b-44e7-90a5-f5cbe8928334</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>d0fdbdf8-7202-4111-b185-fe3001dc39f1</uuid>
                                    <version>
                                        <componentUuid>7084daa5-91ce-424f-b477-81d0ec7dfa78</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>726792be-ee47-4cbd-89ee-84ccf5dd8588</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Prepare Data</title>
                                <type>SINGLE</type>
                                <uuid>1c2f327c-0073-49bf-8cbe-3bc7cf6a3ca3</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>89256c7b-98b8-4d00-83c9-5612e32634c9</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>5ff3dc08-3966-4e94-a421-300d776ce041</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>69</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>a102eff0-a3cf-4f48-9c14-7a2a6e128df6</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"Yes","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_sqc_enabled","value":"true","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'Yes' when _sys_sqc_enabled EQ 'true'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_enabled", "EQ", "true"));

    then
        $ctx.sendResultTo("Yes", $item);
end

# RuleOutcome.Definition={"outcomeId":"No","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_sqc_enabled","value":"true","operator":"NE"}],"customConditions":[]}
rule "2. Send records to 'No' when _sys_sqc_enabled NE 'true'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_enabled", "NE", "true"));

    then
        $ctx.sendResultTo("No", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end
</content>
                                <name>Is SQC enabled?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>dad97c09-457e-4e14-b97b-afd452ff1480</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;export include-original-data="true"/&gt;
&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>c9553e74-c9f1-44d9-8d6f-d6805b03f27f</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Start SQC</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>c9553e74-c9f1-44d9-8d6f-d6805b03f27f</uuid>
                                    <version>
                                        <componentUuid>b965c690-9c4b-4978-8c7d-1ef9f051e862</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:31Z</lastModified>
                                        <versionUuid>1ce59ffe-7fc8-4c25-9c64-831349ba27c2</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Start SQC</title>
                                <type>SINGLE</type>
                                <uuid>5c83d789-2f8e-4f9d-ac57-4da4f6efea2b</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>288a8750-1d65-4e6b-8ce4-6a2b18db705d</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:31Z</lastModified>
                                    <versionUuid>896183ed-dba1-49a6-99ae-c9a77f2f2b97</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>70</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>9b544d52-3b67-4610-b017-7e27385f6b44</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>f2ecdf58-f104-4432-add1-e29a546d8dec</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	charset="UTF-8"&gt;


	&lt;script language="groovy"&gt;&lt;![CDATA[
		import org.jsoup.Jsoup
		import org.jsoup.parser.Parser
		import org.jsoup.select.Elements
		import org.jsoup.nodes.Element
		import org.jsoup.parser.Tag
		import org.jsoup.nodes.Attributes
		import org.jsoup.nodes.Attribute
		import org.jsoup.nodes.Document
		import org.jsoup.nodes.Node
		import org.jsoup.nodes.TextNode

		import org.apache.commons.collections.CollectionUtils;
		import java.util.Collections;

		Document doc = Jsoup.parse(ocr_document_url_additional_processing_tagged.toString());
		doc.outputSettings().indentAmount(0).prettyPrint(false);


		/*============================== Post-processing for single fields ==============================*/


		try {
			String client = client_name;

			Element aldiClientName = doc.select("client_name").first();
			if (aldiClientName != null) {
				Node aldiTextNode = aldiClientName.nextSibling();
				if("Aldi Stores Ltd".equals(client) &amp;&amp; aldiTextNode.toString().startsWith(".")) {
					aldiClientName.attr("data-value", doc.select("client_name").attr("data-value") + ".");
					aldiClientName.append(".");
					aldiTextNode.text(aldiTextNode.toString().substring(1));
				}
			}

			Element elGigantenClientName = doc.select("client_name").first();
			if("Ei-Giganten Logistik".equals(client)) {
				elGigantenClientName.attr("data-value", "El-Giganten Logistik");
			}

			String city = customer_delivery_city;

			if("Springfield/Chelmsford".equals(city)) {
				Element customerDeliveryCity  = doc.select("customer_delivery_city").first();
				customerDeliveryCity.attr("data-value", "Chelmsford");
				customerDeliveryCity.text("Chelmsford");
				Node textNode = customerDeliveryCity.previousSibling();
				textNode.text(textNode.getWholeText() + "Springfield/");
			}

			if(city.contains("90-")) {
				Element customerDeliveryZipCode  = doc.select("customer_delivery_zip_code").first();
				Elements divChildren = customerDeliveryZipCode.children();
				if (divChildren.size() == 1 &amp;&amp; divChildren.first().tagName().equals("customer_delivery_city")) {
					Element cityTag = divChildren.first();
					customerDeliveryZipCode.removeChild(cityTag);
					Element parent = customerDeliveryZipCode.parent();
					Node textNode = new TextNode("-",null);
					parent.appendChild(textNode);
					parent.appendChild(cityTag);
					String zipData = customerDeliveryZipCode.attr("data-value");
					zipData = zipData.substring(0, zipData.indexOf("-"));
					customerDeliveryZipCode.attr("data-value", zipData);
					customerDeliveryZipCode.text(zipData);
					String cityData = cityTag.attr("data-value");
					cityData = cityData.substring(cityData.indexOf("-") + 1);
					cityTag.attr("data-value", cityData);
					cityTag.text(cityData);
				}
			}

			String zipCode = customer_delivery_zip_code;

			if(zipCode.contains("  ")) {
				Elements customerDeliveryZipCodeList  = doc.select("customer_delivery_zip_code");
				for (Element zip : customerDeliveryZipCodeList) {
					String dataValue = zip.attr("data-value");
					dataValue = dataValue.replaceAll("\\s+"," ");
					zip.attr("data-value", dataValue);
				}
			}

			String netTotalPrice = net_total_price;

			if(netTotalPrice.contains(" ")) {
				Elements netTotalPriceList  = doc.select("net_total_price");
				for (Element price : netTotalPriceList) {
					String dataValue = price.attr("data-value");
					dataValue = dataValue.replaceAll("\\s+","");
					price.attr("data-value", dataValue);
				}
			}

			if(netTotalPrice.matches("^\\d+,\\d+.\\d\\d")) {
				Elements netTotalPriceList  = doc.select("net_total_price");
				for (Element price : netTotalPriceList) {
					String dataValue = price.attr("data-value");
					if(dataValue.matches("^\\d+,\\d+.\\d\\d")) {
						dataValue = dataValue.replaceAll(",","");
						price.attr("data-value", dataValue);
					}
				}
			}
		} catch (Exception ex) {
			log.warn(ex.printStackTrace());
		}

		Integer maxTagOrder = 0;

		try{
			List&lt;Integer&gt; tagOrderList = new ArrayList&lt;Integer&gt;();
			UtilsFunctions func = new UtilsFunctions();

			tagOrderList = func.tagsCleanup(doc, "client_name", tagOrderList);
			tagOrderList = func.tagsCleanup(doc, "customer_delivery_address", tagOrderList);
			tagOrderList = func.tagsCleanup(doc, "customer_delivery_city", tagOrderList);
			tagOrderList = func.tagsCleanup(doc, "customer_delivery_zip_code", tagOrderList);
			tagOrderList = func.tagsCleanup(doc, "net_total_price", tagOrderList);
			tagOrderList = func.tagsCleanup(doc, "po", tagOrderList);
			tagOrderList = func.tagsCleanup(doc, "rdd", tagOrderList);
			tagOrderList = func.tagsCleanup(doc, "rdd_time", tagOrderList);

			if(CollectionUtils.isNotEmpty(tagOrderList)) {
				maxTagOrder = Collections.max(tagOrderList);
			}
		} catch (Exception ex) {
			log.warn(ex.printStackTrace());
		}

		/*============================== Post-processing for Elgiganten group fields ==============================*/

		Fixer fixer = new Fixer();

		try {
			if ("Ei-Giganten Logistik".equals(client_name.toString()) || "El-Giganten Logistik".equals(client_name.toString())) {
				Element[] tr_list = doc.select('tr');

				for (int tr_index = 0; tr_index &lt; tr_list.size(); tr_index++) {
					if (tr_list[tr_index].text().contains("Article") &amp;&amp; tr_list[tr_index].text().contains("Quantity")){
						Element[] td_list = tr_list[tr_index].select('td');
						for (int td_index = 0; td_index &lt; td_list.size(); td_index++){
							if (td_list[td_index].text().contains("Article") &amp;&amp;  td_list[td_index].select('formatting').size() &gt; 1) {
								Element el = td_list[td_index].select('formatting').get(1);
								fixer.createXMLTag(el, "productcode2", 0, 0);
							}
							else if (td_list[td_index].text().contains("Article") &amp;&amp;  td_list[td_index].select('formatting').size() == 1)
								fixer.createXMLTag(tr_list[tr_index+1].select("td").get(td_index), "productcode2", 0, 0);
							if (td_list[td_index].text().contains("Quantity") &amp;&amp;  td_list[td_index].select('formatting').size() &gt; 1)
								fixer.createXMLTag(td_list[td_index].select('formatting').get(1), "quantity", 0, 0);
							else if (td_list[td_index].text().contains("Quantity") &amp;&amp;  td_list[td_index].select('formatting').size() == 1)
								fixer.createXMLTag(tr_list[tr_index+1].select("td").get(td_index), "quantity", 0, 0);
						}
					}

					if (tr_list[tr_index].text().contains("(GTIN)") || tr_list[tr_index].text().contains("(GT1N)") || tr_list[tr_index].text().contains("(GTiN)")){
						Element[] td_list = tr_list[tr_index].select('td');
						if (td_list.size() != 0)
							for (int td_index = 0; td_index &lt; td_list.size(); td_index++){
								if ((td_list[td_index].text().contains("(GTIN)") || td_list[td_index].text().contains("(GT1N)") || td_list[td_index].text().contains("(GTiN)")) &amp;&amp; td_index + 1 != td_list.size()) {
									int number_item_for_tagging = (td_list[td_index + 1].select('formatting').size() - 1)  &lt; 0 ? 0 : (td_list[td_index + 1].select('formatting').size() - 1);
									if (td_list[td_index + 1].select('formatting').size()!=0 &amp;&amp;  td_list[td_index + 1].select('formatting').size()&gt;= number_item_for_tagging)
										fixer.createXMLTag(td_list[td_index + 1].select('formatting').get(number_item_for_tagging), "productcode1", 0, 0);
								}
							}
					}
				}

				Element[] block_list = doc.select('block');
				for (Element block : block_list) {
					Element[] formattings = block.select('formatting');

					for (Element formatting : formattings){
						if (formatting.text().contains("(GTIN)") || formatting.text().contains("(GT1N)") || formatting.text().contains("(GTiN)")) {
							String text_for_tag = formatting.text().substring(formatting.text().lastIndexOf(")") + 1, formatting.text().length()).trim();
							String text_before_tag_value = formatting.text().substring(0, formatting.text().lastIndexOf(" ") + 1);
							Attributes attr = new Attributes();
							attr.put("class", "extraction-tag ml-tag");
							attr.put("data-toggle", "tooltip");
							attr.put("data-value", text_for_tag);
							attr.put("style", "border: 2px solid rgb(125, 157, 1)");
							attr.put("tabnumber", "0");
							attr.put("tagorder", "0");
							attr.put("score", "0");
							Element extractionTag = new Element(Tag.valueOf("productcode1"),"", attr)
							extractionTag.text(text_for_tag);
							formatting.select('formatting').get(0).html(text_before_tag_value + extractionTag.toString());
						}
					}
				}

				Element[] quantity_list = doc.select('quantity');
				Element[] productcode1_list = doc.select('productcode1');
				Element[] productcode2_list = doc.select('productcode2');

				int tagorder = 0;
				for (int tabnumber = 0; tabnumber &lt; quantity_list.size(); tabnumber++){
					quantity_list[tabnumber].attr("tabnumber", String.valueOf(tabnumber));
					quantity_list[tabnumber].attr("tagorder", String.valueOf(tagorder));
					tagorder+=3;
				}

				tagorder = 1;
				for (int tabnumber = 0; tabnumber &lt; productcode1_list.size(); tabnumber++){
					productcode1_list[tabnumber].attr("tabnumber", String.valueOf(tabnumber));
					productcode1_list[tabnumber].attr("tagorder", String.valueOf(tagorder));
					tagorder+=3;
				}

				tagorder = 2;
				for (int tabnumber = 0; tabnumber &lt; productcode2_list.size(); tabnumber++) {
					productcode2_list[tabnumber].attr("tabnumber", String.valueOf(tabnumber));
					productcode2_list[tabnumber].attr("tagorder", String.valueOf(tagorder));
					tagorder+=3;
				}
			}
		} catch (Exception ex) {
			log.warn(ex.printStackTrace());
		}

		/*============================== Post-processing for Oriola group fields ==============================*/

		try {

			if ("ORIOLA AB".equals(client_name.toString())) {
				Element[] table_list = doc.select('table');
				int tabnumber = 0;
				for (Element table : table_list) {
					Element[] tr_list = table.select('tr');
					int quantity_td_number = 0;
					boolean quantity_found = false;
					for (int tr_num = 0; tr_num &lt; tr_list.size(); tr_num++) {
						Element[] td_list = tr_list[tr_num].select('td');
						int current_column_number = 0;
						boolean update_tabnumber = false;
						if (!quantity_found) quantity_td_number = 0;
						for (int td_num = 0; td_num &lt; td_list.size(); td_num++) {
							if (!quantity_found) quantity_td_number += (td_list[td_num].attr('colspan') != "" ? Integer.parseInt(td_list[td_num].attr('colspan')) : 1);
							if (!quantity_found &amp;&amp; td_list[td_num].text().contains("Kvantitet")) {
								quantity_found = true;
								break;
							}
							current_column_number += (td_list[td_num].attr('colspan') != "" ? Integer.parseInt(td_list[td_num].attr('colspan')) : 1);
							if (quantity_found &amp;&amp; current_column_number == quantity_td_number) {
								if (td_list[td_num].select('quantity').size() == 0) {
									fixer.createXMLTag(td_list[td_num], "quantity", tabnumber, ++maxTagOrder);
									update_tabnumber = true;
								} else {
									td_list[td_num].select('quantity').first().attr("tabnumber", String.valueOf(tabnumber));
									update_tabnumber = true;
								}
							}

							if (quantity_found &amp;&amp; td_num == 1) {

								if (!td_list[td_num].text().contains(" ")) {
									if (td_list[td_num].select('productcode2').size() == 0) {
										fixer.createXMLTag(td_list[td_num], "productcode2", tabnumber, ++maxTagOrder);
										update_tabnumber = true;
									}
									else {
										td_list[td_num].select('productcode2').first().attr("tabnumber", String.valueOf(tabnumber));
										update_tabnumber = true;
									}
									if (td_list[2].select('formatting').size()!=0)
										if (td_list[2].select('productcode1').size() == 0) {
											fixer.createXMLTag(td_list[2], "productcode1", tabnumber, ++maxTagOrder);
											update_tabnumber = true;
										}
										else {
											td_list[2].select('productcode1').first().attr("tabnumber", String.valueOf(tabnumber));
											td_list[2].select('productcode1').first().attr("tagorder", String.valueOf(++maxTagOrder));
											update_tabnumber = true;
										}
								}

								if (td_list[td_num].text().contains(" ")) {
									if (td_list[1].select('productcode1').size() != 0 &amp;&amp; td_list[1].select('productcode2').size() != 0) {
										td_list[1].select('productcode1').first().attr("tabnumber", String.valueOf(tabnumber));
										td_list[1].select('productcode1').first().attr("tagorder", String.valueOf(++maxTagOrder));
										td_list[1].select('productcode2').first().attr("tabnumber", String.valueOf(tabnumber));
										td_list[1].select('productcode2').first().attr("tagorder", String.valueOf(++maxTagOrder));
									}
									if (td_list[1].select('productcode1').size() == 0 &amp;&amp; td_list[1].select('productcode2').size() == 0) {
										String tag_text = td_list[td_num].text()
										String productcode2_value = tag_text.substring(0, tag_text.indexOf(" "));
										String productcode1_value = tag_text.substring(tag_text.indexOf(" ") + 1, tag_text.length());

										Attributes attr = new Attributes();
										attr.put("class", "extraction-tag ml-tag");
										attr.put("data-toggle", "tooltip");
										attr.put("data-value", productcode2_value);
										attr.put("style", "border: 2px solid rgb(125, 157, 1)");
										attr.put("tabnumber", String.valueOf(tabnumber));
										attr.put("tagorder", String.valueOf(++maxTagOrder));
										attr.put("score", "0");
										Element extractionTag = new Element(Tag.valueOf("productcode2"),"", attr)
										extractionTag.text(productcode2_value);

										Attributes attr2 = new Attributes();
										attr2.put("class", "extraction-tag ml-tag");
										attr2.put("data-toggle", "tooltip");
										attr2.put("data-value", productcode1_value);
										attr2.put("style", "border: 2px solid rgb(125, 157, 1)");
										attr2.put("tabnumber", String.valueOf(tabnumber));
										attr2.put("tagorder", String.valueOf(++maxTagOrder));
										attr2.put("score", "0");
										Element extractionTag2 = new Element(Tag.valueOf("productcode1"),"", attr2)
										extractionTag2.text(productcode1_value);

										td_list[1].select('formatting').get(0).html("" + extractionTag + " " + extractionTag2);
										update_tabnumber = true;
									}
									else if (td_list[1].select('productcode1').size() == 0 &amp;&amp; td_list[1].select('productcode2').size() != 0) {
										String formatting_text = td_list[1].select('formatting').get(0).html();
										td_list[1].select('formatting').get(0).select('productcode2').first().attr("tabnumber", String.valueOf(tabnumber));
										td_list[1].select('formatting').get(0).select('productcode2').first().attr("tagorder", String.valueOf(++maxTagOrder));
										String productcode2_tag = td_list[1].select('formatting').get(0).select('productcode2').first();
										String productcode1_text = formatting_text.substring(formatting_text.indexOf("&lt;/productcode2&gt;"), formatting_text.length()).replaceAll("&lt;/productcode2&gt;","").trim();

										Attributes attr = new Attributes();
										attr.put("class", "extraction-tag ml-tag");
										attr.put("data-toggle", "tooltip");
										attr.put("data-value", productcode1_text);
										attr.put("style", "border: 2px solid rgb(125, 157, 1)");
										attr.put("tabnumber", String.valueOf(tabnumber));
										attr.put("tagorder", String.valueOf(++maxTagOrder));
										attr.put("score", "0");
										Element extractionTag = new Element(Tag.valueOf("productcode1"),"", attr);
										extractionTag.text(productcode1_text);
										td_list[1].select('formatting').get(0).html(productcode2_tag + " " + extractionTag);

										update_tabnumber = true;
									}
									else if (td_list[1].select('productcode1').size() != 0 &amp;&amp; td_list[1].select('productcode2').size() == 0) {
										String formatting_text = td_list[1].select('formatting').get(0).html();
										td_list[1].select('formatting').get(0).select('productcode1').first().attr("tabnumber", String.valueOf(tabnumber));
										td_list[1].select('formatting').get(0).select('productcode1').first().attr("tagorder", String.valueOf(++maxTagOrder));

										String productcode1_tag = td_list[1].select('formatting').get(0).select('productcode1').first();
										String productcode2_text = formatting_text.substring(0, formatting_text.indexOf("&lt;productcode1&gt;")).trim();

										Attributes attr = new Attributes();
										attr.put("class", "extraction-tag ml-tag");
										attr.put("data-toggle", "tooltip");
										attr.put("data-value", productcode2_text);
										attr.put("style", "border: 2px solid rgb(125, 157, 1)");
										attr.put("tabnumber", String.valueOf(tabnumber));
										attr.put("tagorder", String.valueOf(++maxTagOrder));
										attr.put("score", "0");
										Element extractionTag = new Element(Tag.valueOf("productcode2"),"", attr);
										extractionTag.text(productcode2_text);

										td_list[1].select('formatting').get(0).html("" + extractionTag + " " + productcode1_tag);
										update_tabnumber = true;
									}
								}
							}
						}
						if (update_tabnumber) tabnumber++;
					}
				}
			}
		} catch (Exception ex) {
			log.warn(ex.printStackTrace());
		}



		/*============================== Post-processing for Europris AS group fields ==============================*/

		try {
			if(client_name &amp;&amp; client_name.toString() == 'Europris AS') {

				def groupFieldsList = ['productcode1', 'productcode2', 'quantity']

				def tableList = doc.select('table');
// 				def tableList = tableList.findAll { tableEl -&gt;
// 					def groupFieldsSelector = groupFieldsList.join(',')
// 					tableEl.select(groupFieldsSelector).size()
// 				}

				tableList.each { tableEl -&gt;

					/*============ begin of tagging 'productcode2' field =============*/
					def indexOfPosColumn = -1
					def indexOfArtikkelnrColumn = -1

					tableEl.select('tr').each { trEl -&gt;
						if (indexOfPosColumn &gt;= 0 &amp;&amp; indexOfArtikkelnrColumn &gt;= 0) {
							//if index of 'Pos' column already found
							if(trEl.select('productcode2').size() == 0) {
								def tdElList = trEl.select('td')
								def posColumnValue = tdElList.get(indexOfPosColumn).text().trim().replaceAll('i', '1')
								def artikkelnrColumnValue = tdElList.get(indexOfArtikkelnrColumn).text().trim().replaceAll('i', '1')

								if(posColumnValue.isInteger() &amp;&amp; artikkelnrColumnValue.isLong() ) {
									fixer.createXMLTag(tdElList.get(indexOfArtikkelnrColumn), "productcode2");
								} else if(posColumnValue.isInteger() &amp;&amp; artikkelnrColumnValue ==~ /^[0-9]+\s.+/) { //starts with digits
									fixer.createXMLTag(tdElList.get(indexOfArtikkelnrColumn), "productcode2", artikkelnrColumnValue.split(' ')[0]);
								}
							}
						} else {//find index of 'Pos' column and 'Artikkelnr' column
							indexOfPosColumn = trEl.select('td').findIndexOf { tdEl -&gt;
								tdEl.text().trim() == 'Pos'
							}
							if(indexOfPosColumn &gt;= 0) {
								if(trEl.select('td').get(indexOfPosColumn + 1).text().contains('Artikkelnr')) { //if 'Artikkelnr' column the following
									indexOfArtikkelnrColumn = indexOfPosColumn + 1
								}
							}
						}
					}
					/*============ end of tagging 'productcode2' field =============*/		

					/*============ begin of tagging 'productcode1' field =============*/
					tableEl.select('tr').eachWithIndex { trEl, trIndex -&gt;
						if(trEl.select('td').get(0)) {
							def firstColumnValue = trEl.select('td').get(0).text().trim().replaceAll('i', '1')

							if(firstColumnValue.isInteger() &amp;&amp; trEl.select('productcode2').size() &gt; 0) {
								if(tableEl.select('tr').size() &gt; trIndex + 1) {
									def nextTrEl = tableEl.select('tr').get(trIndex + 1)
									def firstColumnValueInNextRow = nextTrEl.select('td').get(0).text().trim().replaceAll('i', '1')

									if(firstColumnValueInNextRow.isEmpty() &amp;&amp; nextTrEl.select('productcode1').size() == 0) { //if first column without 'Pos' value and 'productcode1' column not tagged
										def secondColumnElInNextRow = nextTrEl.select('td').get(1)
										if(secondColumnElInNextRow) {
											def secondColumnValueInNextRow = secondColumnElInNextRow.text().trim()
											if(secondColumnValueInNextRow.isLong()) {
												fixer.createXMLTag(secondColumnElInNextRow, 'productcode1');
											}
										}

									} else if (firstColumnValueInNextRow.isInteger() &amp;&amp; nextTrEl.select('productcode2').size() &gt; 0) {//if data from next row belongs to different group
										if(trEl.select('productcode1').size() == 0) {
											def secondColumnEl = trEl.select('td').get(1)
											def productCode1El = secondColumnEl.select('line').find { lineEl -&gt;
												lineEl.select('productcode2').size() == 0 &amp;&amp; lineEl.text().trim().isLong()
											}
											if(productCode1El) {
												fixer.createXMLTag(productCode1El, 'productcode1');
											}
										}

									}
								}

							}
						}

					}
					/*============ end of tagging 'productcode1' field =============*/		


					/*============ begin of tagging 'quantity' field =============*/
					tableEl.select('tr').eachWithIndex { trEl, trIndex -&gt;
						if(trEl.select('productcode2').size() &gt; 0 &amp;&amp; trEl.select('quantity').size() == 0) {
							def tdElList = trEl.select('td')
							indexOfColumnWithProduct2Field = tdElList.findIndexOf {it.select('productcode2').size() &gt; 0}
							for (int i = indexOfColumnWithProduct2Field; i &lt; tdElList.size(); i++) {

								def tdValue = tdElList.get(i).text().trim()

								if(tdValue &amp;&amp; tdValue ==~ /[0-9 ]+STK/) {
									fixer.createXMLTag(tdElList.get(i), 'quantity', tdValue.replace(' STK', '').trim());

								} else if(tdValue &amp;&amp; tdValue ==~ /[0-9 ]+/) {
									if(tdElList.size() &gt; i + 1) {
										def nextTdValue = tdElList.get(i + 1).text().trim()
										if(nextTdValue &amp;&amp; nextTdValue == 'STK') {
											fixer.createXMLTag(tdElList.get(i), 'quantity');
										}
									}
								}
							}
						}
					}
					/*============ end of tagging 'quantity' field =============*/	
				}

				/*============ begin of fixing 'quantity' field when each digit of 'quantity' number is tagged =============*/
				doc.select('formatting').each { formattingEl -&gt;
					def quantityElList = formattingEl.select('quantity')
					if(quantityElList.size() &gt; 1) {
						def quantityDataValue = quantityElList.get(0).attr('data-value')
						if(quantityElList.every{ it.attr('data-value') == quantityDataValue }) { //if all fields have the same data-value
							formattingEl.html(formattingEl.text())
							fixer.createXMLTag(formattingEl.parents().get(0), 'quantity', quantityDataValue);
						}
					}
				}
				/*============ end of fixing 'quantity' field ==============================================================*/	


				/*============ begin of normalizing 'quantity' field =============*/
				doc.select('quantity').each { quantityEl -&gt;
					def originalDataValue = quantityEl.attr('data-value')
					if(originalDataValue) {
						quantityEl.attr('data-value', originalDataValue.replaceAll('\\s', ''))
					}
				}
				/*============ end of normalizing 'quantity' field =============*/


				/*============ begin of fix tab numbers =============*/
				def quantityFields = doc.select('quantity')
				def productcode2Fields = doc.select('productcode2')
				if(quantityFields.size() &gt; 0 &amp;&amp; productcode2Fields.size() &gt; 0) {
					def quantityCoveringTable = quantityFields.get(0).parents().find({it.tagName() == 'table'})
					def productcode2CoveringTable = productcode2Fields.get(0).parents().find({it.tagName() == 'table'})

					if(quantityCoveringTable.equals(productcode2CoveringTable)) {
						PositionBasedGroupingProcessor.findAndChangeGroups(doc, groupFieldsList)
					}
				}
				/*============ end of fix tab numbers ===============*/

			}

		} catch (Exception ex) {
			log.warn(ex.printStackTrace());
		}


		class Fixer{

			void createXMLTag(Element el, String tag_name, int tabnumber, int tagorder){
				String tag_value = el.text();
				if (tag_name.equals("quantity")) tag_value = tag_value.replaceAll(",", "");
				//	if (tag_name.equals("productcode2")) tag_value = tag_value.replaceAll(" ", "");
				Attributes attr = new Attributes();
				attr.put("class", "extraction-tag ml-tag");
				attr.put("data-toggle", "tooltip");
				attr.put("data-value", tag_value);
				attr.put("style", "border: 2px solid rgb(125, 157, 1)");
				attr.put("tabnumber", String.valueOf(tabnumber));
				attr.put("tagorder", String.valueOf(tagorder));
				attr.put("score", "0");
				Element extractionTag = new Element(Tag.valueOf(tag_name),"", attr)
				extractionTag.text(tag_value);
				el.select('formatting').get(0).html(extractionTag.toString());
			}

			void createXMLTag(Element el, String tag_name, String tag_value_to_wrap = null){
				String tag_value = tag_value_to_wrap ? tag_value_to_wrap : el.text();
				if (tag_name.equals("quantity")) tag_value = tag_value.replaceAll(",", "");
				if (tag_name.equals("productcode2")) tag_value = tag_value.replaceAll(" ", "");
				Attributes attr = new Attributes();
				attr.put("class", "extraction-tag ml-tag");
				attr.put("data-toggle", "tooltip");
				attr.put("data-value", tag_value);
				attr.put("style", "border: 2px solid rgb(125, 157, 1)");
				attr.put("tabnumber", "0");
				attr.put("tagorder", "0");
				attr.put("score", "0");
				String resultHtml = ''
				Element extractionTag = new Element(Tag.valueOf(tag_name),"", attr)
				extractionTag.text(tag_value);
				if(tag_value_to_wrap) {
					resultHtml = el.text().replace(tag_value_to_wrap, extractionTag.toString())
				} else {
					resultHtml = extractionTag.toString()
				}
				el.select('formatting').get(0).html(resultHtml);
			}
		}

		class UtilsFunctions {

			public List&lt;Integer&gt; tagsCleanup(Document doc, String tagName, List&lt;Integer&gt; tagOrderList) {
				Elements tagList  = doc.select(tagName);
				for (Element tag : tagList) {
					tag.removeAttr("tabnumber");
					tagOrderList.add(Integer.valueOf(tag.attr("tagorder")));
				}
				return tagOrderList;
			}
		}

		class PositionBasedGroupingProcessor {
			public static void findAndChangeGroups(Document document, ArrayList groupCodes) {
				def fields = document.select(groupCodes.join(','))
				def group = [:]
				int tabNumber = 0;

				fields.each { field -&gt;
					if (!group.containsKey(field.tagName())) {
						group.put(field.tagName(), field);
					} else {
						this.insertGroupIndices(group.values(), tabNumber);
						group.clear();
						++tabNumber;
						group.put(field.tagName(), field);
					}
				}

				if (!group.isEmpty()) {
					this.insertGroupIndices(group.values(), tabNumber);
				}
			}

			private static void insertGroupIndices(Collection fields, int indices) {
				fields.each { field -&gt;
					this.insertGroupIndices(field, indices);
				}
			}

			private static void insertGroupIndices(Element field, int indices) {
				field.attr('tabnumber', String.valueOf(indices));
			}
		}


		//	sys.defineVariable("max_tag_order", maxTagOrder);
		sys.defineVariable("ocr_document_url_additional_processing_tagged", doc);
	]]&gt;&lt;/script&gt;


	&lt;export include-original-data="true"&gt;
		&lt;single-column name="ocr_document_url_additional_processing_tagged"
			value="${ocr_document_url_additional_processing_tagged}" /&gt;
	&lt;/export&gt;

&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>8ddc02af-c6df-4e56-ab2d-79e35eb334ba</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Post Processing 8.4.4.1v1 NE</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
    &lt;export include-original-data="true"&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                        <name>Post Processing 8.4.4.1</name>
                                        <origination>CREATED_AUTOMATICALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>MACHINE</type>
                                        <uuid>fc59c947-65d5-4a67-9ffd-d1fc00e9f628</uuid>
                                        <version>
                                            <componentUuid>d3067451-b957-4f60-be14-3de589e63ad4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <versionUuid>922ac37e-7d95-4b8f-9a73-2e15f668d1e3</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>8ddc02af-c6df-4e56-ab2d-79e35eb334ba</uuid>
                                    <version>
                                        <componentUuid>c19e3378-b4f9-4348-a69f-0093ad752fa5</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>de689938-e866-4493-b964-3631286fc09f</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Post Processing 8.4.4.1v1 NE</title>
                                <type>SINGLE</type>
                                <uuid>a2bcd145-438f-48e6-9320-356c6f09565c</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>5efe9082-46dd-42fe-929e-8e228de31147</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>5428d622-d459-4705-b54c-539f362ab812</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>71</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>37b85299-8757-47bc-879b-dc8530577aaa</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>92f43494-3910-4cdd-8863-8598495ac264</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;script&gt;
        &lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.requester.util.extraction.TextAggregationProcessor;
        import com.freedomoss.workfusion.utils.gson.GsonUtils;
        import org.webharvest.runtime.processors.plugins.DbRowVariable;
        import org.apache.commons.lang3.tuple.Pair;
        import org.webharvest.runtime.variables.NodeVariable;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        import org.apache.commons.lang3.StringUtils;
        import org.jsoup.Jsoup;
        import org.jsoup.nodes.Document;
        import org.jsoup.nodes.Element;
        import org.jsoup.parser.Parser;

        Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");

        boolean trainingSetHasRecords = true;
        int batchSize = _sys_automation_ds_doc_batch_size.toInt();
        int offset = 0;
        String taggedTextColumnName = _sys_automation_ds_tagged_text_column.toString();
        String taggedTextHashColumnName = taggedTextColumnName + "_hash";

        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();

        //for ie models
        String campaignUuid = run.automationInfo.originalCampaignUuid;
        List histRefData = new ArrayList();
        String[] ieFields = _sys_automation_ie_fields.toString().split(",");
        String correctionsDS = "Corrections_" + campaignUuid.replace("-", "_");
        List corrections = new ArrayList();
        Map correctionByAnswer = new HashMap();

        void collectCorrections(String taggedText) {
            Document doc = Jsoup.parse(taggedText, "", Parser.xmlParser());
            Map correctionsByTagOrder = new HashMap();

            for (Element tag : doc.select(".extraction-tag")) {

                String answerCode = tag.tagName();
                String originalValue = tag.text();
                String correctedValue = tag.attr("data-value");
                String tagOrder = tag.attr("tagorder");

                if (StringUtils.isNotBlank(correctedValue)
                        &amp;&amp; StringUtils.isNotBlank(originalValue)) {

                    originalValue = originalValue.replaceAll("\\s+", " ");
                    correctedValue = correctedValue.replaceAll("\\s+", " ");

                    if (!correctedValue.equals(originalValue)) {

                        Map correction = new HashMap(3);
                        correction.put("answerCode", answerCode);
                        correction.put("originalValue", originalValue);
                        correction.put("correctedValue", correctedValue);

                        addCorrectionByTagOrder(correctionsByTagOrder, correction, tagOrder);
                    }
                }
            }

            for (Object object : correctionsByTagOrder.entrySet()) {
                Map.Entry entry = (Map.Entry) object;
                List oneOrderCorrections = (List) entry.getValue();

                String original = buildOriginal(oneOrderCorrections);
                Map correctionToAdd = (Map) oneOrderCorrections.get(0);

                if (!getCorrected(oneOrderCorrections).equals(original)) {
                    correctionToAdd.put("originalValue", original);
                    corrections.add(correctionToAdd);
                }
            }

            for (Object correction : corrections) {
                addCorrectionByAnswer(correctionByAnswer, (Map) correction);
            }
        }

        String getCorrected(List oneOrderCorrections) {
            return (String) ((Map) oneOrderCorrections.get(0)).get("correctedValue");
        }

        String buildOriginal(List parts) {

            List valuesParts = new ArrayList();
            for (Object correctionObject : parts) {
                Map correction = (Map) correctionObject;
                valuesParts.add(correction.get("originalValue"));
            }

            return StringUtils.join(valuesParts, " ");
        }

        void addCorrectionByAnswer(Map correctionByAnswer, Map lastCorrection) {
            List grouped = (List) correctionByAnswer.get(lastCorrection.get("answerCode"));
            if (grouped == null) {
                grouped = new ArrayList();
            }

            grouped.add(lastCorrection);
            correctionByAnswer.put(lastCorrection.get("answerCode"), grouped);
        }

        void addCorrectionByTagOrder(Map correctionToTagOrder, Map correction, String tagOrder) {
            List grouped = (List) correctionToTagOrder.get(tagOrder);
            if (grouped == null) {
                grouped = new ArrayList();
            }

            grouped.add(correction);
            correctionToTagOrder.put(tagOrder, grouped);
        }

        Map buildCorrection(String answerCode, String originalValue, String correctedValue, String currentTagOrder) {
            Map correction = new HashMap(4);

            correction.put("answerCode", answerCode);
            correction.put("originalValue", originalValue);
            correction.put("correctedValue", correctedValue);
            correction.put("tagorder", currentTagOrder);

            return correction;
        }
        ]]&gt;
    &lt;/script&gt;

    &lt;while condition="${trainingSetHasRecords}" index="i" empty="true"&gt;
        &lt;var-def name="trainingDataBatch"&gt;
            &lt;datastore name="${_sys_automation_ds_name}"&gt;
                SELECT * FROM @this order by @id LIMIT ${batchSize} OFFSET ${offset};
            &lt;/datastore&gt;
        &lt;/var-def&gt;
        &lt;var-def name="documents"/&gt;
        &lt;script&gt;
            &lt;![CDATA[
            documents.toList().clear();

            List batch = trainingDataBatch.toList();
            logger.info("Batch: " + i.toString());
            logger.info("Records size: " + batch.size());

            if (batch.isEmpty()) {
                trainingSetHasRecords = false;
            } else {
                offset = offset + batchSize;
                for (DbRowVariable record : batch) {
                    String taggedText = record.get(taggedTextColumnName).toString();
                    String documentHash = record.get(taggedTextHashColumnName).toString();
                    Map map2Json = new HashMap();
                    List list2Json = new ArrayList();
                    boolean skip = false;
                    if (_sys_model_type.toString().equals("ie")) {
                        try {
                            double confidenceThreshold = _sys_automation_threshold.toDouble();
                            String filteredTaggedText = TextAggregationProcessor.filter(taggedText, confidenceThreshold);
                            list2Json.add(filteredTaggedText);
                            collectCorrections(filteredTaggedText);
                            Map histData = new HashMap();
                            boolean emptyRecord = true;
                            for (String field : ieFields) {
                                String value = record.get(field).toString();
                                if (StringUtils.isNotBlank(value)) {
                                    emptyRecord = false;
                                }
                                histData.put(field, value);
                            }
                            if (!emptyRecord) {
                                histRefData.add(histData);
                            }
                        } catch (Exception exc) {
                            logger.error("Error when filtering tagged text by confidence.", exc);
                            log.error("Error when filtering tagged text by confidence.", exc);
                        }
                    } else {
                        /*
                            values that end with _automation_ignore are ignored (e.g. invalid links marked with "Invalid URL" option)
                            //TODO: replace with UI flag in human task
                          */
                        String goldValue = record.get(_sys_automation_ie_answer_code).toString().trim();
                        if (!goldValue.endsWith("_automation_ignore")) {
                            logger.debug("gold value: " + goldValue);
                            list2Json.add(taggedText);
                            map2Json.put("goldValue", goldValue);
                        } else {
                            skip = true;
                            logger.debug("document with unsuitable gold tag: " + goldValue);
                        }
                    }
                    if (!skip) {
                        //fail fast approach to avoid sending empty documents to automation engine
                        if (list2Json.isEmpty()) {
                            throw new RuntimeException("textParts are empty");
                        }
                        map2Json.put("textParts", list2Json);
                        String documentJson = GsonUtils.GSON.toJson(map2Json);
                        documents.toList().add(new NodeVariable(Pair.of(documentHash, documentJson)));
                        logger.debug("document is added to trainset");
                    }
                }
            }

            ]]&gt;
        &lt;/script&gt;

        &lt;s3 bucket="vds-resources" s3-keys-type="vds"&gt;
            &lt;loop item="documentItem"
                  index="documentIndex" empty="true"&gt;
                &lt;list&gt;
                    &lt;var name="documents"/&gt;
                &lt;/list&gt;
                &lt;body&gt;
                    &lt;var-def name="documentVar"&gt;
                        &lt;template&gt;${documentItem.getWrappedObject().getValue()}&lt;/template&gt;
                    &lt;/var-def&gt;
                    &lt;s3-put path="${_sys_automation_experiment_group.toString()}/input/training-set/${documentItem.getWrappedObject().getKey()}.txt"
                            content-type="text/html" content-disposition="inline"&gt;
                        &lt;var name='documentVar'/&gt;
                    &lt;/s3-put&gt;
                &lt;/body&gt;
            &lt;/loop&gt;
        &lt;/s3&gt;

        &lt;case&gt;
            &lt;if condition='${_sys_model_type.toString().equals("ie") &amp;amp;&amp;amp; !corrections.isEmpty()}'&gt;
                &lt;create-datastore name="${correctionsDS}"&gt;
                    &lt;datastore-column name="correctedvalue"/&gt;
                    &lt;datastore-column name="originalvalue"/&gt;
                    &lt;datastore-column name="answercode"/&gt;
                &lt;/create-datastore&gt;
                &lt;loop item="correctionItem" empty="true"&gt;
                    &lt;list&gt;
                        &lt;script return="corrections"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;var-def name="originalValue"&gt;
                            &lt;template&gt;${correctionItem.getWrappedObject().get("originalValue")}&lt;/template&gt;
                        &lt;/var-def&gt;

                        &lt;var-def name="correctionsInDataStore"&gt;
                            &lt;datastore name="${correctionsDS}"&gt;
                                select @id from @this where originalValue =
                                '${org.apache.commons.lang.StringEscapeUtils.escapeSql(originalValue.toString())}';
                            &lt;/datastore&gt;
                        &lt;/var-def&gt;

                        &lt;case&gt;
                            &lt;if condition="${correctionsInDataStore.toList().isEmpty()}"&gt;
                                &lt;insert-datastore datastore-name="${correctionsDS}" create="true"&gt;
                                    &lt;script return="correctionItem.getWrappedObject()"/&gt;
                                &lt;/insert-datastore&gt;
                            &lt;/if&gt;
                        &lt;/case&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
                &lt;loop item="correctionItem" empty="true"&gt;
                    &lt;list&gt;
                        &lt;script return="correctionByAnswer.entrySet()"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;var-def name="documentVar"&gt;
                            &lt;list-to-csv&gt;
                                &lt;template&gt;${GsonUtils.GSON.toJson(correctionItem.getWrappedObject().getValue()).toString()}
                                &lt;/template&gt;
                            &lt;/list-to-csv&gt;
                        &lt;/var-def&gt;
                        &lt;s3 bucket="vds-resources" s3-keys-type="vds"&gt;
                            &lt;s3-put-public
                                    path="${_sys_automation_experiment_group.toString()}/input/corrections/${correctionItem.getWrappedObject().getKey().toString()}.csv"
                                    content="${documentVar}" content-type="text/html" content-disposition="inline"/&gt;
                        &lt;/s3&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
            &lt;/if&gt;
        &lt;/case&gt;

    &lt;/while&gt;

    &lt;case&gt;
        &lt;if condition='${_sys_model_type.toString().equals("ie")}'&gt;
            &lt;var-def name="histRefDataVar"&gt;
                &lt;list-to-csv&gt;
                    &lt;template&gt;${GsonUtils.GSON.toJson(histRefData).toString()}&lt;/template&gt;
                &lt;/list-to-csv&gt;
            &lt;/var-def&gt;
            &lt;s3 bucket="vds-resources" s3-keys-type="vds"&gt;
                &lt;s3-put path="${_sys_automation_experiment_group.toString()}/input/ref-data/historical-ref-data.csv"
                        content-type="text/csv" content-disposition="inline"&gt;
                    &lt;var name="histRefDataVar"/&gt;
                &lt;/s3-put&gt;
            &lt;/s3&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;datastore name="${_sys_automation_ds_name}"&gt;
        update @this set "train_status" = 'EVALUATE' where "train_status" = 'NEW';
    &lt;/datastore&gt;
    &lt;export include-original-data="true"/&gt;
&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>4600a1c7-cad8-4a84-82f9-5cec256007ef</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>(Generic) Upload Training Set</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>4600a1c7-cad8-4a84-82f9-5cec256007ef</uuid>
                                    <version>
                                        <componentUuid>3c5f94a5-7e27-4873-a5ac-074e1759bf5f</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>8049ac98-f4f1-4d89-bd38-8f74c15fc07b</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>(Generic) Upload Training Set</title>
                                <type>SINGLE</type>
                                <uuid>5e1c4d31-434c-421a-9016-509dcd8b0c84</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>f666abb6-3687-4232-9198-d1d9669e5882</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>2ddffeb7-ad14-4210-8a84-12721a413786</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>72</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>d01622ad-b32a-4bbd-9543-33056fe60d98</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params

rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end


rule "1. Make request to SQC"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        not Inspection(item == $item);
    then
        String batchUuid = $item.getNotToCheckValue("_sys_sqc_batch_uuid");
        boolean inspectionRequired = $ctx.sqcService.isInspectionRequired(batchUuid);
        insert(new Inspection(inspectionRequired, $item));
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "2. Send records to 'No' when inspection is not required"
agenda-group "calculation"
dialect "mvel"
salience 50
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        Inspection(inspectionRequired == false, item == $item);
    then
        $ctx.sendResultTo("No", $item);
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "3. Send records to 'Yes' when inspection is required"
agenda-group "calculation"
dialect "mvel"
salience 50
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        Inspection(inspectionRequired == true, item == $item);
    then
        $ctx.renameAnswerItem($item, "_sys_sqc_inspection", "_sys_sqc_inspection_required");
        foreach (name : $item.getNotToCheckValue("_sys_automation_ie_fields").split(",")) {
           $ctx.renameAnswerItem($item, name, name + "_ml_extracted");
        }
        $ctx.sendResultTo("Yes", $item);
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

declare Inspection
   inspectionRequired : boolean
   item : CompositeRuleDataItemContext
end
</content>
                                <name>Is inspection required?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>62aea292-531d-43b2-b386-174017ce88de</uuid>
                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;script&gt;
        &lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;

        import com.freedomoss.requester.service.sqc.SqcService;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;

        Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");

        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        String runUuid = run.uuid;
        String batchUuid = "";
        String executorId = "";
        String executorName = "";
        String assembleBatchDataStoreName = "ML_Assemble_Batch";
        boolean productionMode = !run.isSandbox();
        boolean needToSendNotification = false;
        ]]&gt;
    &lt;/script&gt;
    &lt;create-datastore name="${assembleBatchDataStoreName}"&gt;
        &lt;datastore-column name="runuuid" type="text"/&gt;
        &lt;datastore-column name="batchuuid" type="text"/&gt;
        &lt;datastore-column name="startdate" type="text"/&gt;
        &lt;datastore-column name="recordscount" type="integer"/&gt;
        &lt;datastore-column name="totalrecords" type="integer"/&gt;
    &lt;/create-datastore&gt;
    &lt;datastore-transaction isolation="SERIALIZABLE"&gt;
        &lt;datastore name="${assembleBatchDataStoreName}"&gt;
            LOCK TABLE @this;
        &lt;/datastore&gt;
        &lt;var-def name="assembledBatchList"&gt;
            &lt;datastore name="${assembleBatchDataStoreName}"&gt;
                select * from @this where runUuid = '${runUuid}' order by @id desc;
            &lt;/datastore&gt;
        &lt;/var-def&gt;
        &lt;script&gt;
            &lt;![CDATA[
            import org.webharvest.runtime.processors.plugins.DbRowVariable;

            List assembledBatches = assembledBatchList.toList();
            boolean needToCreateBatch;
            int newBatchSize;
            Map existingBatchTotals = new LinkedHashMap();
            String batchUuid = null;
            if (assembledBatches.isEmpty()) {
                needToCreateBatch = true;
                newBatchSize = run.getSubmissionSize();
                logger.trace("SQC: new batch, size : {}", newBatchSize);
            } else {
                int totalRecords = 0;
                for (int i = 0; i &lt; assembledBatches.size(); i++) {
                    String uuid = assembledBatches.get(i).get("batchuuid").toString();
                    int total = assembledBatches.get(i).get("totalRecords").toInt();
                    int count = assembledBatches.get(i).get("recordscount").toInt();
                    Object[] logParams = {uuid, count, total};
                    logger.trace("SQC: batch {} : {}/{}", logParams);
                    existingBatchTotals.put(uuid, total);
                    totalRecords += total;
                    if (count &lt; total) {
                        batchUuid = uuid;
                    }
                }
                logger.trace("SQC: prev batches {}", existingBatchTotals);
                logger.trace("SQC: totalRecords {}", totalRecords);
                newBatchSize = run.getSubmissionSize() - totalRecords;
                logger.trace("SQC: newBatchSize {}", newBatchSize);
                if (newBatchSize &gt; 0) {
                    needToCreateBatch = true;
                }
            }
            logger.trace("SQC: for run {} was selected batch {}", runUuid, batchUuid);
            ]]&gt;
        &lt;/script&gt;
        &lt;case&gt;
            &lt;if condition="${needToCreateBatch}"&gt;
                &lt;script&gt;
                    &lt;![CDATA[
                    import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.DataStoreRow;
                    import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.enums.DataStoreColumnType;
                    import com.freedomoss.requester.service.sqc.SqcService;
                    import com.google.gson.Gson;
                    import java.text.SimpleDateFormat;
					import com.freedomoss.spring.ApplicationContextProvider;

                    Gson gson = new Gson();
                    SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");

                    String ieAnswerCode = _sys_automation_ie_answer_code.toString();
                    AutomationInfoDto automationInfo = run.automationInfo;

                    String originalCampaignUuid = automationInfo.originalCampaignUuid;
                    Long automationUseCaseId = automationInfo.automationUseCaseId;
                    String experimentGroup = automationInfo.experimentGroup;

                    String sourceId = _sys_sqc_source_id.toString();
                    executorId = originalCampaignUuid + ":" + experimentGroup;
                    String executorType = "ML";
                    executorName = run.campaignName + " (" + ieAnswerCode + ")";
                    double targetQuality = 0d;
                    try {
                        targetQuality = Double.parseDouble(_sys_sqc_target_quality.toString());
                    } catch (NumberFormatException e) {
                        targetQuality = automationInfo.targetQuality * 100.0;
                    }
                    // TODO hardcoded 5 min
                    Long extendTime = (long) (5 * 60 * 1000);
                    Long expirationTime = automationInfo.originalCampaignExpirationTime;

                    logger.info("Trying to assemble batch with executor '" + executorId + "' and productionMode = " + productionMode);
                    SqcService sqcService = ApplicationContextProvider.getContext().getBean(SqcService.class);

                    Map response = sqcService.assembleBatch(sourceId, executorId, executorType, executorName, targetQuality, newBatchSize, extendTime, expirationTime, productionMode);

                    if (!response.isEmpty()) {
                        batchUuid = response.get("batchUuid");
                        logger.info("Assembled batch '" + batchUuid + "' for execuror '" + executorId + "'");
                        String inspectionType = response.get("inspectionType");
                        needToSendNotification = "DISCONTINUE".equalsIgnoreCase(inspectionType);
                    } else {
                        logger.info("Assembled batch '&lt;EMPTY&gt;' for execuror '" + executorId + "'");
                    }

                    String startDate = dateFormat.format(new Date());
                    boolean needToCreateNewBatch = !existingBatchTotals.containsKey(batchUuid);
                    DataStoreRow batchRecord = null;
                    if (needToCreateNewBatch) {
                        logger.info("Write to DB '" + assembleBatchDataStoreName + "' batch '" + batchUuid + "' for run '" + runUuid + "'");
                        batchRecord = new DataStoreRow();
                        batchRecord.addValue("batchuuid", DataStoreColumnType.TEXT, batchUuid);
                        batchRecord.addValue("runuuid", DataStoreColumnType.TEXT, runUuid);
                        batchRecord.addValue("startdate", DataStoreColumnType.TEXT, startDate);
                        batchRecord.addValue("totalrecords", DataStoreColumnType.INTEGER, newBatchSize);
                        batchRecord.addValue("recordscount", DataStoreColumnType.INTEGER, 1);
                    }
                    ]]&gt;
                &lt;/script&gt;
                &lt;case&gt;
                    &lt;if condition="${needToCreateNewBatch}"&gt;
                        &lt;insert-datastore datastore-name="${assembleBatchDataStoreName}" json-value-map="${gson.toJson(batchRecord)}" create="true"/&gt;
                        &lt;script&gt;
                            &lt;![CDATA[
                            logger.trace("SQC: Inserted batch {}", gson.toJson(batchRecord));
                          ]]&gt;
                        &lt;/script&gt;

                    &lt;/if&gt;
                    &lt;else&gt;
                        &lt;datastore name="${assembleBatchDataStoreName}"&gt;
                            UPDATE @this SET recordscount = recordscount + 1, totalrecords = totalrecords + ${newBatchSize} WHERE batchuuid = '${batchUuid}' AND runuuid = '${runUuid}';
                        &lt;/datastore&gt;
                        &lt;script&gt;
                            &lt;![CDATA[
                            Object[] logParams2 = {batchUuid, runUuid, newBatchSize};
                            logger.trace("SQC: Updated batch {}({}): count +1, total +{}", logParams2);
                          ]]&gt;
                        &lt;/script&gt;
                    &lt;/else&gt;
                &lt;/case&gt;
                &lt;case&gt;
                    &lt;if condition="${needToSendNotification}"&gt;
                        &lt;script&gt;
                            &lt;![CDATA[
                            import org.slf4j.Logger;
                            import org.slf4j.LoggerFactory;
                            import com.freedomoss.requester.service.event.impl.EventTrackingService;
                            import com.freedomoss.requester.model.enums.EventTrackingLevelType;
                            import com.freedomoss.spring.ApplicationContextProvider;
                            import com.google.gson.Gson;
                            import com.freedomoss.crowdcontrol.webharvest.RunDto;
                            import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

                            Gson gson = new Gson();
                            RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();

                            String rootRunUuid = run.rootRunUuid;
                            String campaignName = run.campaignName;

                            Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");

                            String templateFile = "SqcFallsIntoDiscontinueNotification.txt";
                            String templateSubject = "Quality decline: " + campaignName;
                            String[] toEmail = { "cc_alerts@crowdcomputingsystems.com" };
                            String[] templateParamsNames = { "linkToAutomationBP" };
                            String[] templateParams = {
                                "https://integration.crowdcomputingsystems.com/workfusion/secure/task/edit/" + rootRunUuid
                            };

                            List params = new ArrayList();
                            params.add(templateFile);
                            params.add(templateSubject);
                            params.add(gson.toJson(toEmail));
                            params.add(gson.toJson(templateParamsNames));
                            params.add(gson.toJson(templateParams));

                            String jsonParams = gson.toJson(params.toArray());
                            logger.info("eventTrackingService jsonParams: " + jsonParams);
                            String eventName = "Test mail name";
                            String eventDescription = "Test mail description";

                            EventTrackingService eventTrackingService = ApplicationContextProvider.getContext().getBean("eventTrackingService", EventTrackingService.class);
                            eventTrackingService.registerMailEvent(eventName, eventDescription, null, EventTrackingLevelType.INFO, jsonParams);
                            logger.info("Message sent to: " + toEmail);
                            ]]&gt;
                        &lt;/script&gt;
                    &lt;/if&gt;
                &lt;/case&gt;
            &lt;/if&gt;
            &lt;else&gt;
                &lt;datastore name="${assembleBatchDataStoreName}"&gt;
                    UPDATE @this SET recordscount = recordscount + 1 WHERE batchuuid = '${batchUuid}' AND runuuid = '${runUuid}';
                &lt;/datastore&gt;
                &lt;script&gt;
                    &lt;![CDATA[
                    logger.trace("Updated batch {}({}) count +1", batchUuid, runUuid);
                    if (batchUuid == null || "".equals(batchUuid)) {
                        throw new IllegalArgumentException("Empty batch UUID");
                    }
                  ]]&gt;
                &lt;/script&gt;
            &lt;/else&gt;
        &lt;/case&gt;
    &lt;/datastore-transaction&gt;
    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_sqc_batch_uuid" value="${batchUuid}"/&gt;
        &lt;single-column name="_sys_sqc_inspection" value="true"/&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>0e15c9b0-9727-4cb8-917d-d068587d18b9</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Assemble Batch</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>0e15c9b0-9727-4cb8-917d-d068587d18b9</uuid>
                                    <version>
                                        <componentUuid>95810167-1d4e-4c9c-bcb2-075f49bd9b5b</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>1ddcebd8-454c-40cd-86df-559ca2de2fec</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Assemble Batch</title>
                                <type>SINGLE</type>
                                <uuid>a38f99cb-b10b-4403-9c4a-4fe8897b84de</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9442df76-1394-43d3-96f0-2355bd04ef73</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>fab22b14-6c95-4bb2-9204-6de07154ce99</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>73</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>21790ecc-e04d-4f6c-a1c4-8c6bd068ea12</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>2a63b868-18ab-4116-9390-3ee3ac546a7f</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>true</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <description>IE Cognitive Automation Task Example</description>
                                <executingType>HUMAN</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <question>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Order</answer>
                                            <answerCode>ocr_document_url_additional_processing</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                <code>INFO_EXTRACTION</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Information Extraction</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                            <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Customer name</answer>
                                            <answerCode>client_name</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>n</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Street address</answer>
                                            <answerCode>customer_delivery_address</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>s</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>City</answer>
                                            <answerCode>customer_delivery_city</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>c</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer> Zip code</answer>
                                            <answerCode>customer_delivery_zip_code</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>z</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>5</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Request Delivery Date</answer>
                                            <answerCode>rdd</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>d</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>6</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>RDD Time</answer>
                                            <answerCode>rdd_time</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>t</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>7</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Purchase Order</answer>
                                            <answerCode>po</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>o</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>8</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Net Total Price</answer>
                                            <answerCode>net_total_price</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                <code>NUMBER</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Number</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>p</hotKey>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>9</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Product_information</answer>
                                            <answerCode>product_information</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                <code>GROUP</code>
                                                <description>Group of answers</description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Options value - tab name.</optionsDescription>
                                                <parentType>INFO_EXTRACTION</parentType>
                                                <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Group of answers</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>b</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>true</multiValue>
                                            <options>Product - </options>
                                            <originalDocumentSource></originalDocumentSource>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>ocr_document_url_additional_processing</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>10</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Product code 1</answer>
                                            <answerCode>productcode1</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>1</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>ocr_document_url_additional_processing</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>11</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Product code 2</answer>
                                            <answerCode>productcode2</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>2</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>ocr_document_url_additional_processing</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>12</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>true</allowNA>
                                            <answer>Quantity</answer>
                                            <answerCode>quantity</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                <code>NUMBER</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Number</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <hotKey>q</hotKey>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>ocr_document_url_additional_processing</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['ocr_document_url_additional_processing_tagged']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>13</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                            <answerCode>canceled_manual_task</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>NO</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=YES|No=NO</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>14</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <assignmentDuration>1800000</assignmentDuration>
                                    <assignmentLimit>1</assignmentLimit>
                                    <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                                    <autoApprovalDelay>432000000</autoApprovalDelay>
                                    <automaticallyProcessed>0</automaticallyProcessed>
                                    <blockSize>1</blockSize>
                                    <constQualifiedWorkers>false</constQualifiedWorkers>
                                    <currency>USD</currency>
                                    <description>IE Cognitive Automation Task Example</description>
                                    <dynamicTaskRenderingDisabled>true</dynamicTaskRenderingDisabled>
                                    <expiredTime>2592000000</expiredTime>
                                    <faqItems/>
                                    <frameHeight>2500</frameHeight>
                                    <geolocationEnabled>false</geolocationEnabled>
                                    <instructionItems/>
                                    <keywords>IE Cognitive Automation Task Example</keywords>
                                    <maxAssignments>1</maxAssignments>
                                    <moderation>false</moderation>
                                    <moderationFlag>false</moderationFlag>
                                    <origination>CREATED_MANUALLY</origination>
                                    <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                                    <qualificationInstruction></qualificationInstruction>
                                    <qualificationRequirements/>
                                    <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                                    <qualificationTasks>20</qualificationTasks>
                                    <qualificationTraining>false</qualificationTraining>
                                    <questionRuleMaps>
                                        <questionRuleMap>
                                            <businessRule>
                                                <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                <name>Start with one assignment 1+0 pay all</name>
                                                <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                                <ruleType>DROOLS</ruleType>
                                                <ruleTypeUI>Adjudication</ruleTypeUI>
                                                <template>
                                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                    <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                                    <name>Start with 1 assignment X+0 rule (pay all)</name>
                                                    <params>
                                                        <param>
                                                            <code>MAJORITY_VALUE</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Number of correct answers</description>
                                                            <name>Majority value</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>70</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                            <name>Worst accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                            <name>Worst accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>95</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                            <name>Super accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>80</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                            <name>Normal accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAX_ASSIGNMENT_LIMIT</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Maximum number of assignments</description>
                                                            <name>Max assignments limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                            <name>Super accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Normal accuracy level lower limit in percents inclusive</description>
                                                            <name>Normal accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>CHECK_EVERY</code>
                                                            <defaultValue>5</defaultValue>
                                                            <description>Check every i-th gold question when evaluating qualification score</description>
                                                            <name>Check every i-th gold question</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAJORITY_HIT_THRESHOLD</code>
                                                            <defaultValue>100</defaultValue>
                                                            <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                            <name>Percent of correct answers</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Normal accuracy level upper limit in percents exclusive</description>
                                                            <name>Normal accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                    </params>
                                                </template>
                                                <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                                            </businessRule>
                                        </questionRuleMap>
                                    </questionRuleMaps>
                                    <radiusSelector>ExactLocation</radiusSelector>
                                    <randomizeAnswers>false</randomizeAnswers>
                                    <recursiveThreshold>1</recursiveThreshold>
                                    <restrictedCountries/>
                                    <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                                    <templates>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;  
&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  


  
&lt;@instructions title="&lt;h2&gt;MT- OTC-OM-EU-Manual Order Creation&amp;nbsp;NE OCR Tagging task_v8v1&lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
  
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Order:&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;&amp;nbsp;${question.data['document_link']}&lt;/a&gt;&lt;br&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
  
  &lt;script type=text/javascript&gt;
        $(function(){
           Application.subscribe(Events.Notifications.ON_START_TAGGING, addCustomDateFormat, this);
        });

        const customDateFormats = ["dd/MM/yyyy", "dd/MM/yy"];

        function addCustomDateFormat(event) {
           var controller = event.get(Constants.E_NOTIFICATION_CONTROLLER);
           if (controller.answerType === 'DATE') {
               var supportedFormats = controller.converter.supportedFormats;
               if (supportedFormats.indexOf(customDateFormats[0]) === -1) {
                   supportedFormats.unshift.apply(supportedFormats, customDateFormats);
               }
           }
        }
  &lt;/script&gt;
  
&lt;/@hit&gt;</content>
                                            <name>NE_Training_task_v8v1</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>TASK</type>
                                            <uuid>24ff97d2-7904-4b57-b679-489e63229497</uuid>
                                            <version>
                                                <componentUuid>8e79c4f8-8b93-4d60-9831-e735dd068300</componentUuid>
                                                <incrementalVersion>1.2</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-09-03T10:00:48Z</lastModified>
                                                <versionUuid>eb0f1f03-0c3c-4cc3-bc08-04fe62305178</versionUuid>
                                            </version>
                                        </template>
                                    </templates>
                                    <title>MT- OTC-OM-EU-Manual Order Creation&#160;NE OCR Tagging task_v8v1</title>
                                    <useCommonHitCoordinates>false</useCommonHitCoordinates>
                                    <uuid>244b9a0e-8cb5-4741-ae4c-55fecf654b90</uuid>
                                    <version>
                                        <componentUuid>a30dda1c-462d-49af-868c-11f302afce04</componentUuid>
                                        <incrementalVersion>1.2</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-03T10:00:48Z</lastModified>
                                        <versionUuid>19b0a61d-a496-4f68-90f0-d4e544ffeefc</versionUuid>
                                    </version>
                                    <workSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description>Europe OM Nordics</description>
                                            <enabled>true</enabled>
                                            <executingType>HUMAN</executingType>
                                            <name>Europe OM Nordics</name>
                                            <private>false</private>
                                            <publicId>d88e8a1d-e3e0-4c76-b374-c0530d279549</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Manual_Orders</name>
                                        <publicId>6bc83edb-99b3-4769-9ec3-f7da26a8e567</publicId>
                                        <version>
                                            <componentUuid>8faeca2d-6eaa-4332-b679-3cf4b75173b3</componentUuid>
                                            <incrementalVersion>1.2</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-05-22T13:03:20Z</lastModified>
                                            <versionUuid>4252ac42-ee12-4346-9bd8-b696a485f13a</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Order</answer>
                                                <answerCode>document_html_link</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                    <code>INFO_EXTRACTION</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Information Extraction</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Customer name</answer>
                                                <answerCode>client_name</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>n</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Street address</answer>
                                                <answerCode>customer_delivery_address</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>s</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>City</answer>
                                                <answerCode>customer_delivery_city</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>c</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer> Zip code</answer>
                                                <answerCode>customer_delivery_zip_code</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>z</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Request Delivery Date</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>d</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>RDD Time</answer>
                                                <answerCode>rdd_time</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>t</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Purchase Order</answer>
                                                <answerCode>po</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>o</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Net Total Price</answer>
                                                <answerCode>net_total_price</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>p</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>9</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product_information</answer>
                                                <answerCode>product_information</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GROUP</code>
                                                    <description>Group of answers</description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Options value - tab name.</optionsDescription>
                                                    <parentType>INFO_EXTRACTION</parentType>
                                                    <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Group of answers</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>b</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>true</multiValue>
                                                <options>Product - </options>
                                                <originalDocumentSource></originalDocumentSource>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Order</answer>
                                                    <answerCode>document_html_link</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                        <code>INFO_EXTRACTION</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Information Extraction</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                    <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product code 1</answer>
                                                <answerCode>productcode1</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue></defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>1</hotKey>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Product_information</answer>
                                                    <answerCode>product_information</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GROUP</code>
                                                        <description>Group of answers</description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Options value - tab name.</optionsDescription>
                                                        <parentType>INFO_EXTRACTION</parentType>
                                                        <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Group of answers</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue></defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <hotKey>b</hotKey>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>true</multiValue>
                                                    <options>Product - </options>
                                                    <originalDocumentSource></originalDocumentSource>
                                                    <parentAnswer>
                                                        <allowNA>false</allowNA>
                                                        <answer>Order</answer>
                                                        <answerCode>document_html_link</answerCode>
                                                        <answerHtml></answerHtml>
                                                        <answerTypeObject>
                                                            <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                            <code>INFO_EXTRACTION</code>
                                                            <description></description>
                                                            <optionsAvailable>true</optionsAvailable>
                                                            <showDefaultValue>true</showDefaultValue>
                                                            <showForFieldScheme>false</showForFieldScheme>
                                                            <showForHumanTask>true</showForHumanTask>
                                                            <showForMachineConfig>false</showForMachineConfig>
                                                            <title>Information Extraction</title>
                                                            <valueType>SINGLEVALUE</valueType>
                                                        </answerTypeObject>
                                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                                        <autocompleteField>false</autocompleteField>
                                                        <category></category>
                                                        <constantable>false</constantable>
                                                        <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                        <htmlClasses></htmlClasses>
                                                        <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                        <letCustomValues>false</letCustomValues>
                                                        <manualField>false</manualField>
                                                        <multiValue>false</multiValue>
                                                        <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                        <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                        <percentRequired>false</percentRequired>
                                                        <range>false</range>
                                                        <required>false</required>
                                                        <sequenceNumber>1</sequenceNumber>
                                                        <shuffle>false</shuffle>
                                                        <useBlocks>false</useBlocks>
                                                        <useEmptyCell>false</useEmptyCell>
                                                    </parentAnswer>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>10</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>11</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Product code 2</answer>
                                                <answerCode>productcode2</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>2</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Product_information</answer>
                                                    <answerCode>product_information</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GROUP</code>
                                                        <description>Group of answers</description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Options value - tab name.</optionsDescription>
                                                        <parentType>INFO_EXTRACTION</parentType>
                                                        <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Group of answers</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue></defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <hotKey>b</hotKey>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>true</multiValue>
                                                    <options>Product - </options>
                                                    <originalDocumentSource></originalDocumentSource>
                                                    <parentAnswer>
                                                        <allowNA>false</allowNA>
                                                        <answer>Order</answer>
                                                        <answerCode>document_html_link</answerCode>
                                                        <answerHtml></answerHtml>
                                                        <answerTypeObject>
                                                            <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                            <code>INFO_EXTRACTION</code>
                                                            <description></description>
                                                            <optionsAvailable>true</optionsAvailable>
                                                            <showDefaultValue>true</showDefaultValue>
                                                            <showForFieldScheme>false</showForFieldScheme>
                                                            <showForHumanTask>true</showForHumanTask>
                                                            <showForMachineConfig>false</showForMachineConfig>
                                                            <title>Information Extraction</title>
                                                            <valueType>SINGLEVALUE</valueType>
                                                        </answerTypeObject>
                                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                                        <autocompleteField>false</autocompleteField>
                                                        <category></category>
                                                        <constantable>false</constantable>
                                                        <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                        <htmlClasses></htmlClasses>
                                                        <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                        <letCustomValues>false</letCustomValues>
                                                        <manualField>false</manualField>
                                                        <multiValue>false</multiValue>
                                                        <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                        <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                        <percentRequired>false</percentRequired>
                                                        <range>false</range>
                                                        <required>false</required>
                                                        <sequenceNumber>1</sequenceNumber>
                                                        <shuffle>false</shuffle>
                                                        <useBlocks>false</useBlocks>
                                                        <useEmptyCell>false</useEmptyCell>
                                                    </parentAnswer>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>10</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>12</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Quantity</answer>
                                                <answerCode>quantity</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>true</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <hotKey>q</hotKey>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Product_information</answer>
                                                    <answerCode>product_information</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                        <code>GROUP</code>
                                                        <description>Group of answers</description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Options value - tab name.</optionsDescription>
                                                        <parentType>INFO_EXTRACTION</parentType>
                                                        <parentTypeConstraint>PARENT</parentTypeConstraint>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>false</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>false</showForMachineConfig>
                                                        <title>Group of answers</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <category></category>
                                                    <constantable>false</constantable>
                                                    <defaultValue></defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <hotKey>b</hotKey>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>true</multiValue>
                                                    <options>Product - </options>
                                                    <originalDocumentSource></originalDocumentSource>
                                                    <parentAnswer>
                                                        <allowNA>false</allowNA>
                                                        <answer>Order</answer>
                                                        <answerCode>document_html_link</answerCode>
                                                        <answerHtml></answerHtml>
                                                        <answerTypeObject>
                                                            <answerTypeGroup>ADVANCED</answerTypeGroup>
                                                            <code>INFO_EXTRACTION</code>
                                                            <description></description>
                                                            <optionsAvailable>true</optionsAvailable>
                                                            <showDefaultValue>true</showDefaultValue>
                                                            <showForFieldScheme>false</showForFieldScheme>
                                                            <showForHumanTask>true</showForHumanTask>
                                                            <showForMachineConfig>false</showForMachineConfig>
                                                            <title>Information Extraction</title>
                                                            <valueType>SINGLEVALUE</valueType>
                                                        </answerTypeObject>
                                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                                        <autocompleteField>false</autocompleteField>
                                                        <category></category>
                                                        <constantable>false</constantable>
                                                        <defaultValue>${question.data['document_html_link']}</defaultValue>
                                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                        <htmlClasses></htmlClasses>
                                                        <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                        <letCustomValues>false</letCustomValues>
                                                        <manualField>false</manualField>
                                                        <multiValue>false</multiValue>
                                                        <options>{"ieExtractorType":"ORIGINAL_APPEARANCE_EXTRACTOR"}</options>
                                                        <originalDocumentSource>${question.data['document_link']}</originalDocumentSource>
                                                        <percentRequired>false</percentRequired>
                                                        <range>false</range>
                                                        <required>false</required>
                                                        <sequenceNumber>1</sequenceNumber>
                                                        <shuffle>false</shuffle>
                                                        <useBlocks>false</useBlocks>
                                                        <useEmptyCell>false</useEmptyCell>
                                                    </parentAnswer>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>10</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>13</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Is the document well OCR-ed</answer>
                                                <answerCode>ocred</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>YES</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=YES|No=NO</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>14</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Feedback</answer>
                                                <answerCode>feedback</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-05-22T12:24:10Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>15</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <businessRules/>
                                        <isPrivate>false</isPrivate>
                                        <items>
                                            <item>
                                                <type>RECURSIVE_THRESHOLD</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_APPROVED</type>
                                                <value>432000000</value>
                                            </item>
                                            <item>
                                                <type>FRAME_HEIGHT</type>
                                                <value>2500</value>
                                            </item>
                                            <item>
                                                <type>DESCRIPTION</type>
                                                <value>IE Cognitive Automation Task Example</value>
                                            </item>
                                            <item>
                                                <type>TITLE</type>
                                                <value></value>
                                            </item>
                                            <item>
                                                <type>HIT_EXPIRES_IN</type>
                                                <value>2592000000</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATIONS</type>
                                            </item>
                                            <item>
                                                <type>LIMIT_NUMBER_ASSIGNMENTS</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_PROCESSED</type>
                                                <value>0</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATION_RULE</type>
                                            </item>
                                            <item>
                                                <type>PENDING_ASSIGNMENTS_LIMIT</type>
                                                <value>10</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENTS_PER_HIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>BLOCK_SIZE</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>TIME_PER_ASSIGNMENT</type>
                                                <value>1800000</value>
                                            </item>
                                            <item>
                                                <type>ASSIGNMENT_LIMIT</type>
                                                <value>1</value>
                                            </item>
                                            <item>
                                                <type>QUALIFICATION_REQUIREMENTS</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>KEYWORDS</type>
                                                <value>IE Cognitive Automation Task Example</value>
                                            </item>
                                            <item>
                                                <type>RESTRICTED_COUNTRIES</type>
                                                <value>[]</value>
                                            </item>
                                            <item>
                                                <type>REQUIRED_FOR_PREVIEW</type>
                                                <value>false</value>
                                            </item>
                                            <item>
                                                <type>ADJUDICATION_RULE</type>
                                                <value>3</value>
                                            </item>
                                            <item>
                                                <type>EXTERNAL_URL</type>
                                                <value>https://wfapp-dev.workfusion.pg.com/workfusion/public/HTMLRenderer</value>
                                            </item>
                                        </items>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="Extract data from Excel"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Email:&amp;nbsp;&lt;a href="${question.data['eml_file_location']}" data-mce-href="${question.data['eml_file_location']}"&gt;${question.data['eml_file_location']}&lt;br&gt;&lt;/a&gt;Order:&amp;nbsp;&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;Error message/List of multi-sheet order:&amp;nbsp;${question.data['error_message']}&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Miscellaneous Tasks (Blank)</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE</type>
                                            <uuid>6778197e-5123-4587-9bfd-0fe361b1ac23</uuid>
                                            <version>
                                                <componentUuid>b440737a-1966-46d2-953d-e1fef74fd055</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2017-09-13T22:42:01Z</lastModified>
                                                <versionUuid>a26c02b9-0130-4b3c-9f8e-0bddd14f8819</versionUuid>
                                            </version>
                                        </template>
                                        <useCaseConfiguration>[]</useCaseConfiguration>
                                    </workSetting>
                                    <workSpacePreviewData>[{"name":"purchase_order_date","value":"${question.data['creation_sorting_dttm']}"},{"name":"id","value":"${question.data['uuid']}-${question.data['mail_id']}"}]</workSpacePreviewData>
                                    <workSpacePreviewScheme>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>OCR Date/Time</answer>
                                                <answerCode>purchase_order_date</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-09-03T09:35:46Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>ID</answer>
                                                <answerCode>id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-09-03T09:36:42Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <description>NE_ST_Schema</description>
                                        <id>346</id>
                                        <name>NE_ST_Schema</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <uuid>caf294f5-7d1c-420d-b8ef-55be8de8912f</uuid>
                                    </workSpacePreviewScheme>
                                </question>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>MT- OTC-OM-EU-Manual Order Creation&#160;NE OCR Tagging task_v8v1</title>
                                <type>SINGLE</type>
                                <uuid>4347818c-d555-434c-9c32-5140240a6d3f</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>9b714c13-c36f-4949-b697-032aa8a6f389</componentUuid>
                                    <incrementalVersion>1.6</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-03T10:00:48Z</lastModified>
                                    <versionUuid>1f4947b8-e547-4adb-a9a6-6ed2c2a0c9b7</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>74</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>8f9ba61e-60ff-4c1b-bc15-ebe1ec08724a</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

rule "1. Add success inspection result"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_inspection_result", "EQ", "success"));
    then
        $ctx.sendResultTo("Yes", $item);
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "2. Add fail inspection result"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_inspection_result", "EQ", "fail"));
    then
        $ctx.sendResultTo("No", $item);
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "3. Send records to 'No verification'"
agenda-group "calculation"
dialect "mvel"
salience 90
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_inspection_result", "EQ", "none"));
    then
        $ctx.sendResultTo("There was no inspection", $item);
        $ctx.logExecutedRule(kcontext.getRule().getName());
end
</content>
                                <name>Is inspection successful?</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>7b4b131b-20d2-4deb-be5e-6ea9658674ec</uuid>
                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;script&gt;
        &lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.nlp.AnswerCompareUtils;
        import com.freedomoss.requester.service.sqc.SqcService;
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.spring.ApplicationContextProvider;


        Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		String experimentGroup = run.getAutomationInfo().getExperimentGroup();
		String _sys_automation_ds_name = run.getAutomationInfo().getAutomationDatastoreName();
        String inspectionResult = "success";
        if (sys.isVariableDefined("_sys_sqc_inspection_required")) {
            String ML_SUFFIX = "_ml_extracted";
            List requiredFieldList = Arrays.asList(_sys_automation_ie_sqc_required_fields.toString().split(","));
            Map valuesMap = new HashMap();
            for (String field : requiredFieldList) {
                if (sys.isVariableDefined(field + ML_SUFFIX) &amp;&amp; sys.isVariableDefined(field)) {
                    String machineExtractedAnswer = sys.getVar(field + ML_SUFFIX).toString().trim();
                    String humanExtractedAnswer = sys.getVar(field).toString().trim();

                    logger.info("Machine value = " + machineExtractedAnswer);
                    logger.info("Human value = " + humanExtractedAnswer);
                    AnswerInfoDTO groupAnswer = null;
                    boolean isGroupField = field.equals(_sys_automation_relations_subanswer_code.toString());
                    if (isGroupField) {
                        //find group answer
                        for (AnswerInfoDTO answer : run.automationInfo.answers) {
                              if (answer.answerType.equals("INFO_EXTRACTION")) {
                                  for (AnswerInfoDTO subAnswer : answer.subAnswers) {
                                      if ("GROUP".equals(subAnswer.answerType)) {
                                          groupAnswer = subAnswer;
                                      }

                                  }
                              }
                        }

                    }

                    int compareResult = 0;
                    if (groupAnswer != null) {
                        compareResult = AnswerCompareUtils.compareAnswerValues(humanExtractedAnswer, machineExtractedAnswer, groupAnswer, run.automationInfo);
                    } else {
                        Double precision = run.automationInfo.getSelectedTagPrecisions().get(field);
                        if (precision == null || precision &gt; 1e-9) {
                            compareResult = AnswerCompareUtils.compareAnswerValues(humanExtractedAnswer, machineExtractedAnswer, groupAnswer);
                        } else {
                            logger.debug("Field '{}' comparison skipped because of 0 tag precision", field);
                        }
                    }

                    if (compareResult != 0) {
                        logger.info("Comparing answer values failed.");
                        inspectionResult = "fail";
                    } else {
                        logger.debug("Machine answer for '{}' is correct", field);
                    }

                } else {
                    inspectionResult = "fail";
                    break;
                }
            }

        }
        boolean needToSendNotification = false;
        boolean needToLaunchRetrain = false;
        if (sys.isVariableDefined("_sys_sqc_batch_uuid")) {
            RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
            String runUuid = run.uuid;
            String batchUuid = _sys_sqc_batch_uuid.toString();
            boolean success = "success".equalsIgnoreCase(inspectionResult);
            boolean fail = "fail".equalsIgnoreCase(inspectionResult);
            String cacheKey = "Add_Inspection_Result_" + runUuid;

            SqcService sqcService = ApplicationContextProvider.getContext().getBean(SqcService.class);

            if (success || fail) {
                double inspectionResultValue = success ? 1d : 0d;
                Map response = sqcService.addInspectionResult(batchUuid, inspectionResultValue);
                String inspectionType = response.get("inspectionType");
                needToSendNotification = "DISCONTINUE".equalsIgnoreCase(inspectionType);
                String prevInspectionType = response.get("prevInspectionType");
                needToLaunchRetrain = "DISCONTINUE".equalsIgnoreCase(inspectionType) &amp;&amp; !"DISCONTINUE".equalsIgnoreCase(prevInspectionType);
            }
        }
        ]]&gt;
    &lt;/script&gt;
    &lt;case&gt;
        &lt;if condition="${needToSendNotification}"&gt;
            &lt;cache key="${cacheKey}"&gt;
                &lt;script&gt;
                    &lt;![CDATA[
                    import com.freedomoss.requester.service.event.impl.EventTrackingService;
                    import com.freedomoss.requester.model.enums.EventTrackingLevelType;
                    import com.freedomoss.spring.ApplicationContextProvider;
                    import com.google.gson.Gson;
                    import com.freedomoss.crowdcontrol.webharvest.RunDto;
                    import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
                    Gson gson = new Gson();
                    RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();

                    String rootRunUuid = run.rootRunUuid;
                    String campaignName = run.campaignName;

                    String templateFile = "SqcFallsIntoDiscontinueNotification.txt";
                    String templateSubject = "Quality decline: " + campaignName;
                    String[] toEmail = { "cc_alerts@crowdcomputingsystems.com" };
                    String[] templateParamsNames = { "linkToAutomationBP" };
                    String[] templateParams = {
                        applicationHost.toString() + applicationContextPath.toString() + "/secure/task/edit/" + rootRunUuid
                    };

                    List params = new ArrayList();
                    params.add(templateFile);
                    params.add(templateSubject);
                    params.add(gson.toJson(toEmail));
                    params.add(gson.toJson(templateParamsNames));
                    params.add(gson.toJson(templateParams));

                    String jsonParams = gson.toJson(params.toArray());
                    logger.info("eventTrackingService jsonParams: " + jsonParams);
                    String eventName = "Test mail name";
                    String eventDescription = "Test mail description";

                    EventTrackingService eventTrackingService = ApplicationContextProvider.getContext().getBean("eventTrackingService", EventTrackingService.class);
                    eventTrackingService.registerMailEvent(eventName, eventDescription, null, EventTrackingLevelType.INFO, jsonParams);
                    logger.info("Message sent to: " + toEmail);
                    ]]&gt;
                &lt;/script&gt;
            &lt;/cache&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_sqc_inspection_result" value="${inspectionResult}"/&gt;
        &lt;single-column name="_sys_start_task_result" value="${startTaskResult}"/&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>fbc4ab1c-f570-40d4-9c18-e002106c4a78</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Check Inspection Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>fbc4ab1c-f570-40d4-9c18-e002106c4a78</uuid>
                                    <version>
                                        <componentUuid>6e67e9c4-e82b-4da0-9629-c3d6f770ae0f</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>5c55d979-b3fc-426e-a578-f7a0ec37f0e9</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Check Inspection Results</title>
                                <type>SINGLE</type>
                                <uuid>4c4a0f73-f31f-4531-85ce-6a98339766e1</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>e6f8a4c3-8887-4285-a943-b5ddd08b8645</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>faa723a6-c0c0-416c-804c-388d7d03a13c</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>75</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>5e50dca4-ab1f-4ed9-9379-be72d59a10b6</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"None","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_automation_mode","value":"none","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'None' when _sys_automation_mode EQ 'none'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_automation_mode", "EQ", "none"));

    then
        $ctx.sendResultTo("None", $item);
end

# RuleOutcome.Definition={"outcomeId":"Training","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_automation_mode","value":"training","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'Training' when _sys_automation_mode EQ 'training'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_automation_mode", "EQ", "training"));

    then
        $ctx.sendResultTo("Training", $item);
end

# RuleOutcome.Definition={"outcomeId":"Production","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"_sys_automation_mode","value":"production","operator":"EQ"}],"customConditions":[]}
rule "3. Send records to 'Production' when _sys_automation_mode EQ 'production'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_automation_mode", "EQ", "production"));

    then
        $ctx.sendResultTo("Production", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end
</content>
                                <name>Check mode</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>1b10d4f1-116a-406e-8df9-7242160339a8</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Parameters of ML Sweeping Experiments</answer>
                                            <answerCode>multi_config</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>LONG_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Please provide number of rows for text area to display by default.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Long Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>5</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Human accuracy threshold</answer>
                                            <answerCode>threshold</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                <code>NUMBER</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Number</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>80</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Train model version</answer>
                                            <answerCode>train_model_version</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>1.0</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Model Accuracy Threshold % for cut-off to Human-based processing (AQL)</answer>
                                            <answerCode>target_quality</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                <code>NUMBER</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Number</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Statistical Quality Control</answer>
                                            <answerCode>sqc_enabled</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>true</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Enabled=true|Disabled=false</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>5</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Statistics Calculation</answer>
                                            <answerCode>statistics_calculation_enabled</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>false</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Enabled=true|Disabled=false</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>6</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Retrain the model as more data collected</answer>
                                            <answerCode>retrain_count_type</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>model</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Model Defined=model|Automatically=auto|User Defined=user</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>7</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Retrain records count</answer>
                                            <answerCode>retrain_count_value</answerCode>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>model</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(user)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Retrain the model as more data collected</answer>
                                                <answerCode>retrain_count_type</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>model</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Model Defined=model|Automatically=auto|User Defined=user</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>8</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
    &lt;var-def name="threshold"&gt;50&lt;/var-def&gt;
    &lt;var-def name="sqc_enabled"&gt;false&lt;/var-def&gt;
    &lt;var-def name="targetQuality"&gt;0&lt;/var-def&gt;
    &lt;var-def name="sqcSourceId"&gt;local&lt;/var-def&gt;
    &lt;var-def name="retrain_count_type"&gt;model&lt;/var-def&gt;
    &lt;var-def name="retrain_count_value"&gt;&lt;/var-def&gt;
    &lt;var-def name="train_model_version"&gt;&lt;/var-def&gt;
    &lt;var-def name="time_limit_offline"&gt;&lt;/var-def&gt;
    &lt;var-def name="time_limit_online"&gt;&lt;/var-def&gt;
    &lt;var-def name="statistics_calculation_enabled"&gt;false&lt;/var-def&gt;

    &lt;script&gt;&lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.requester.service.automation.AutomationConstants;
        import java.text.SimpleDateFormat;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;

        AnswerInfoDTO findIeAnswer(List answers) {
            for (AnswerInfoDTO answer : answers) {
                if (answer.answerType.equals("INFO_EXTRACTION")) {
                    return answer;
                }
                if (answer.subAnswers != null &amp;&amp; !answer.subAnswers.isEmpty()) {
                    AnswerInfoDTO ieAnswer = findIeAnswer(answer.subAnswers);
                    if (ieAnswer != null) {
                        return ieAnswer;
                    }
                }
            }
            return null;
        }

        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        List fields = new ArrayList();
        List requiredFields = new ArrayList();
        List requiredFieldsForSQC = new ArrayList();
        String automationMode = "none";
        String ieAnswerCode = "NOT_DEFINED";
        String ieTextAnswerCode = "";
        String ieGroupAnswerCode = "";
        String automationUrl = "";
        String modelVersion = "";
        String answerOptions = "";
        String modelType = "NOT_DEFINED";
        Long retrainCount = 0l;

        if (run.automationInfo != null) {
            if (!train_model_version.toString().isEmpty()) {
                modelVersion = train_model_version.toString();
            } else {
                modelVersion = run.automationInfo.modelVersion;
            }
            if (run.automationInfo.trainingMode) {
                automationMode = "training";
            } else {
                automationMode = "production";
            }
            if (!retrain_count_type.isEmpty()) {
                if("model".equals(retrain_count_type.toString())) {
                    run.automationInfo.retrainRecordsCount = retrainCount;
                }
                if ("user".equals(retrain_count_type.toString())) {
                    if(!"".equals(retrain_count_value.toString())) {
                        run.automationInfo.retrainRecordsCount = Long.valueOf(retrain_count_value.toString());
                    } else {
                        run.automationInfo.retrainRecordsCount = retrainCount;
                    }
                }
                retrainCount = run.automationInfo.retrainRecordsCount;
                run.automationInfo.retrainCountChanged = true;
            }
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            /*
                as ie answer is used in classification to display content, we only could determine model type by
                empty subanswers for classification
                //TODO: find a way to detect model type from vds-gateway rest or by specifying on UI
                //TODO: add cheboxes to UI to mark the answers that should be used in automation instead of hardcode below
             */
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    modelType = "ie";
                    ieAnswerCode = ieAnswer.answerCode;
                    for (AnswerInfoDTO subAnswer : ieAnswer.subAnswers) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            ieGroupAnswerCode = subAnswer.answerCode;
                            for (AnswerInfoDTO subGroupAnswer : subAnswer.subAnswers) {
                                requiredFields.add(subGroupAnswer.answerCode);
                            }
                             requiredFieldsForSQC.add(subAnswer.answerCode);
                        } else {
                            if (subAnswer.required) {
                                requiredFieldsForSQC.add(subAnswer.answerCode);
                                requiredFields.add(subAnswer.answerCode);
                            }
                        }
                        fields.add(subAnswer.answerCode);
                    }
                } else {
                    modelType = "classification";
                    for (AnswerInfoDTO answer : run.automationInfo.answers) {
                        if (answer.answerType.equals("INFO_EXTRACTION")) {
                            ieTextAnswerCode = answer.answerCode;
                        }
                        if(answer.answerType.equals("CHECK_ONE") || answer.answerType.equals("SELECT_ONE")){
                            ieAnswerCode = answer.answerCode;
                            fields.add(answer.answerCode);
                            requiredFields.add(answer.answerCode);
                            requiredFieldsForSQC.add(answer.answerCode);
                            answerOptions = answer.options;
                        }
                    }
                }
                if ("training".equals(automationMode)) {
                    sys.defineVariable("experimentGroup", ieAnswerCode + "_" + run.rootRunUuid, true);
                }
            }
            automationUrl = run.automationInfo.automationUrl;
        }
        sys.defineVariable("fieldList", fields, true);
        sys.defineVariable("requiredFieldList", requiredFields, true);
        sys.defineVariable("requiredFieldListForSQC", requiredFieldsForSQC, true);


        ]]&gt;
    &lt;/script&gt;
    &lt;case&gt;
        &lt;if condition='${"training".equals(automationMode)}'&gt;
            &lt;script&gt;
                &lt;![CDATA[
                    String trainJobsDataStoreName = AutomationConstants.DS_JOB_DATA_TABLE;

                    StringBuilder sqlQuery = new StringBuilder("update @this set ");
                    sqlQuery.append(" modelVersion='").append(modelVersion).append("',");
                    sqlQuery.append(" automationRootRunUUID='").append(run.rootRunUuid).append("',");
                    sqlQuery.append(" author='").append(run.authorFullName).append("',");
                    sqlQuery.append(" campaignName='").append(run.campaignName).append("',");

                    SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
                    String date = dateFormat.format(new Date());
                    sqlQuery.append(" lastUpdated='").append(date).append("'");

                    sqlQuery.append(" where originalCampaignUUID='").append(run.automationInfo.originalCampaignUuid).append("'");
                    sqlQuery.append(" and modelVersion='").append(run.automationInfo.modelVersion).append("'");
                    sqlQuery.append(" and status='PREPARING'");
                    sqlQuery.append(" and tags='").append(_sys_automation_tags.toString()).append("'");
                    sqlQuery.append(";");

                    Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
                    logger.info("Job for training was updated: " + sqlQuery.toString());
                ]]&gt;
            &lt;/script&gt;
            &lt;datastore name="${trainJobsDataStoreName}"&gt;
                ${sqlQuery}
            &lt;/datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;
    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_automation_threshold" value='${threshold.toString()}'/&gt;
        &lt;single-column name="_sys_automation_mode" value="${automationMode}"/&gt;
        &lt;single-column name="_sys_model_version" value="${modelVersion}"/&gt;
        &lt;case&gt;
            &lt;if condition='${"training".equals(automationMode)}'&gt;
                &lt;single-column name="_sys_automation_experiment_group" value="${experimentGroup}"/&gt;
                &lt;single-column name="_sys_automation_experiment_group_online" value="${experimentGroup}-online"/&gt;
            &lt;/if&gt;
        &lt;/case&gt;
        &lt;single-column name="_sys_automation_ds_doc_batch_size" value="100"/&gt;
        &lt;single-column name="_sys_automation_url" value="${automationUrl}"/&gt;
        &lt;single-column name="time_limit_offline" value="${time_limit_offline}"/&gt;
        &lt;single-column name="time_limit_online" value="${time_limit_online}"/&gt;
        &lt;single-column name="_sys_automation_retrain_count" value="${retrainCount}"/&gt;

        &lt;single-column name="_sys_automation_ie_answer_code" value="${ieAnswerCode}"/&gt;
        &lt;single-column name="_sys_automation_ie_fields" value='${fieldList.toString("UTF-8", ",")}'/&gt;
        &lt;single-column name="_sys_automation_ie_required_fields"
                       value='${requiredFieldList.toString("UTF-8", ",")}'/&gt;
        &lt;single-column name="_sys_automation_ie_sqc_required_fields"
                       value='${requiredFieldListForSQC.toString("UTF-8", ",")}'/&gt;

        &lt;single-column name="_sys_sqc_source_id" value="${sqcSourceId}"/&gt;
        &lt;single-column name="_sys_sqc_enabled" value='${sqc_enabled}'/&gt;
        &lt;single-column name="_sys_sqc_target_quality" value='${targetQuality}'/&gt;
        &lt;single-column name="_sys_model_type" value='${modelType}'/&gt;

        &lt;!-- for classification--&gt;
        &lt;single-column name="_sys_automation_answer_options" value="${answerOptions}"/&gt;
        &lt;single-column name="_sys_automation_text_answer_code" value="${ieTextAnswerCode}"/&gt;

        &lt;!-- for ie --&gt;
        &lt;single-column name="_sys_automation_relations_subanswer_code" value="${ieGroupAnswerCode}"/&gt;

        &lt;!-- for online offline models --&gt;
        &lt;single-column name="_sys_train_only_online_model" value="false"/&gt;
        &lt;single-column name="_sys_do_not_hide_default_value" value="true"/&gt;

        &lt;single-column name="_sys_statistics_calculation_enabled" value='${statistics_calculation_enabled}'/&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>0dc7d027-90f8-4c90-9ab7-cf7ddce23835</inclusionCode>
                                    <jsonParams>{"threshold":"50","sqc_enabled":"false","target_quality":"0","retrain_count_type":"model","statistics_calculation_enabled":"false"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <enabled>true</enabled>
                                        <name>Automation settings</name>
                                        <publicId>5b62a2f4-85a8-4f4b-b16e-93baa5d24027</publicId>
                                        <version>
                                            <componentUuid>4f1f71d8-ffd3-4d30-904a-59b9c6b8b142</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-02-22T15:18:22Z</lastModified>
                                            <versionUuid>edcbec00-ecee-4b61-8e1a-4f7967584553</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Parameters of ML Sweeping Experiments</answer>
                                                <answerCode>multi_config</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>LONG_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Please provide number of rows for text area to display by default.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Long Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>5</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Human accuracy threshold</answer>
                                                <answerCode>threshold</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                    <code>NUMBER</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Number</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>80</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Train model version</answer>
                                                <answerCode>train_model_version</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>1.0</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Model Accuracy Threshold % for cut-off to Human-based processing (AQL)</answer>
                                                <answerCode>target_quality</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>NUMBERS</answerTypeGroup>
                                                    <code>NUMBER</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Number</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Statistical Quality Control</answer>
                                                <answerCode>sqc_enabled</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Enabled=true|Disabled=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Statistics Calculation</answer>
                                                <answerCode>statistics_calculation_enabled</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>false</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Enabled=true|Disabled=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Retrain the model as more data collected</answer>
                                                <answerCode>retrain_count_type</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>model</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Model Defined=model|Automatically=auto|User Defined=user</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Retrain records count</answer>
                                                <answerCode>retrain_count_value</answerCode>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>model</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(user)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Retrain the model as more data collected</answer>
                                                    <answerCode>retrain_count_type</answerCode>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                        <code>CHECK_ONE</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>true</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>true</showForMachineConfig>
                                                        <title>Check One</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <constantable>false</constantable>
                                                    <defaultValue>model</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>Model Defined=model|Automatically=auto|User Defined=user</options>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>false</required>
                                                    <sequenceNumber>7</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <machineWorkSettingType>ETL</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
    &lt;var-def name="threshold"&gt;{{threshold}}&lt;/var-def&gt;
    &lt;var-def name="sqc_enabled"&gt;{{sqc_enabled}}&lt;/var-def&gt;
    &lt;var-def name="targetQuality"&gt;{{target_quality}}&lt;/var-def&gt;
    &lt;var-def name="sqcSourceId"&gt;local&lt;/var-def&gt;
    &lt;var-def name="retrain_count_type"&gt;{{retrain_count_type}}&lt;/var-def&gt;
    &lt;var-def name="retrain_count_value"&gt;{{retrain_count_value}}&lt;/var-def&gt;
    &lt;var-def name="train_model_version"&gt;{{train_model_version}}&lt;/var-def&gt;
    &lt;var-def name="time_limit_offline"&gt;{{time_limit_offline}}&lt;/var-def&gt;
    &lt;var-def name="time_limit_online"&gt;{{time_limit_online}}&lt;/var-def&gt;
    &lt;var-def name="statistics_calculation_enabled"&gt;{{statistics_calculation_enabled}}&lt;/var-def&gt;

    &lt;script&gt;&lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.requester.service.automation.AutomationConstants;
        import java.text.SimpleDateFormat;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;

        AnswerInfoDTO findIeAnswer(List answers) {
            for (AnswerInfoDTO answer : answers) {
                if (answer.answerType.equals("INFO_EXTRACTION")) {
                    return answer;
                }
                if (answer.subAnswers != null &amp;&amp; !answer.subAnswers.isEmpty()) {
                    AnswerInfoDTO ieAnswer = findIeAnswer(answer.subAnswers);
                    if (ieAnswer != null) {
                        return ieAnswer;
                    }
                }
            }
            return null;
        }

        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        List fields = new ArrayList();
        List requiredFields = new ArrayList();
        List requiredFieldsForSQC = new ArrayList();
        String automationMode = "none";
        String ieAnswerCode = "NOT_DEFINED";
        String ieTextAnswerCode = "";
        String ieGroupAnswerCode = "";
        String automationUrl = "";
        String modelVersion = "";
        String answerOptions = "";
        String modelType = "NOT_DEFINED";
        Long retrainCount = 0l;

        if (run.automationInfo != null) {
            if (!train_model_version.toString().isEmpty()) {
                modelVersion = train_model_version.toString();
            } else {
                modelVersion = run.automationInfo.modelVersion;
            }
            if (run.automationInfo.trainingMode) {
                automationMode = "training";
            } else {
                automationMode = "production";
            }
            if (!retrain_count_type.isEmpty()) {
                if("model".equals(retrain_count_type.toString())) {
                    run.automationInfo.retrainRecordsCount = retrainCount;
                }
                if ("user".equals(retrain_count_type.toString())) {
                    if(!"".equals(retrain_count_value.toString())) {
                        run.automationInfo.retrainRecordsCount = Long.valueOf(retrain_count_value.toString());
                    } else {
                        run.automationInfo.retrainRecordsCount = retrainCount;
                    }
                }
                retrainCount = run.automationInfo.retrainRecordsCount;
                run.automationInfo.retrainCountChanged = true;
            }
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            /*
                as ie answer is used in classification to display content, we only could determine model type by
                empty subanswers for classification
                //TODO: find a way to detect model type from vds-gateway rest or by specifying on UI
                //TODO: add cheboxes to UI to mark the answers that should be used in automation instead of hardcode below
             */
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    modelType = "ie";
                    ieAnswerCode = ieAnswer.answerCode;
                    for (AnswerInfoDTO subAnswer : ieAnswer.subAnswers) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            ieGroupAnswerCode = subAnswer.answerCode;
                            for (AnswerInfoDTO subGroupAnswer : subAnswer.subAnswers) {
                                requiredFields.add(subGroupAnswer.answerCode);
                            }
                             requiredFieldsForSQC.add(subAnswer.answerCode);
                        } else {
                            if (subAnswer.required) {
                                requiredFieldsForSQC.add(subAnswer.answerCode);
                                requiredFields.add(subAnswer.answerCode);
                            }
                        }
                        fields.add(subAnswer.answerCode);
                    }
                } else {
                    modelType = "classification";
                    for (AnswerInfoDTO answer : run.automationInfo.answers) {
                        if (answer.answerType.equals("INFO_EXTRACTION")) {
                            ieTextAnswerCode = answer.answerCode;
                        }
                        if(answer.answerType.equals("CHECK_ONE") || answer.answerType.equals("SELECT_ONE")){
                            ieAnswerCode = answer.answerCode;
                            fields.add(answer.answerCode);
                            requiredFields.add(answer.answerCode);
                            requiredFieldsForSQC.add(answer.answerCode);
                            answerOptions = answer.options;
                        }
                    }
                }
                if ("training".equals(automationMode)) {
                    sys.defineVariable("experimentGroup", ieAnswerCode + "_" + run.rootRunUuid, true);
                }
            }
            automationUrl = run.automationInfo.automationUrl;
        }
        sys.defineVariable("fieldList", fields, true);
        sys.defineVariable("requiredFieldList", requiredFields, true);
        sys.defineVariable("requiredFieldListForSQC", requiredFieldsForSQC, true);


        ]]&gt;
    &lt;/script&gt;
    &lt;case&gt;
        &lt;if condition='${"${" + "\"training\".equals(automationMode)" + "}"}'&gt;
            &lt;script&gt;
                &lt;![CDATA[
                    String trainJobsDataStoreName = AutomationConstants.DS_JOB_DATA_TABLE;

                    StringBuilder sqlQuery = new StringBuilder("update @this set ");
                    sqlQuery.append(" modelVersion='").append(modelVersion).append("',");
                    sqlQuery.append(" automationRootRunUUID='").append(run.rootRunUuid).append("',");
                    sqlQuery.append(" author='").append(run.authorFullName).append("',");
                    sqlQuery.append(" campaignName='").append(run.campaignName).append("',");

                    SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
                    String date = dateFormat.format(new Date());
                    sqlQuery.append(" lastUpdated='").append(date).append("'");

                    sqlQuery.append(" where originalCampaignUUID='").append(run.automationInfo.originalCampaignUuid).append("'");
                    sqlQuery.append(" and modelVersion='").append(run.automationInfo.modelVersion).append("'");
                    sqlQuery.append(" and status='PREPARING'");
                    sqlQuery.append(" and tags='").append(_sys_automation_tags.toString()).append("'");
                    sqlQuery.append(";");

                    Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
                    logger.info("Job for training was updated: " + sqlQuery.toString());
                ]]&gt;
            &lt;/script&gt;
            &lt;datastore name="${trainJobsDataStoreName}"&gt;
                ${sqlQuery}
            &lt;/datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;
    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_automation_threshold" value='${"${" + "threshold.toString()" + "}"}'/&gt;
        &lt;single-column name="_sys_automation_mode" value="${automationMode}"/&gt;
        &lt;single-column name="_sys_model_version" value="${modelVersion}"/&gt;
        &lt;case&gt;
            &lt;if condition='${"${" + "\"training\".equals(automationMode)" + "}"}'&gt;
                &lt;single-column name="_sys_automation_experiment_group" value="${experimentGroup}"/&gt;
                &lt;single-column name="_sys_automation_experiment_group_online" value="${experimentGroup}-online"/&gt;
            &lt;/if&gt;
        &lt;/case&gt;
        &lt;single-column name="_sys_automation_ds_doc_batch_size" value="100"/&gt;
        &lt;single-column name="_sys_automation_url" value="${automationUrl}"/&gt;
        &lt;single-column name="time_limit_offline" value="${time_limit_offline}"/&gt;
        &lt;single-column name="time_limit_online" value="${time_limit_online}"/&gt;
        &lt;single-column name="_sys_automation_retrain_count" value="${retrainCount}"/&gt;

        &lt;single-column name="_sys_automation_ie_answer_code" value="${ieAnswerCode}"/&gt;
        &lt;single-column name="_sys_automation_ie_fields" value='${"${" + "fieldList.toString(\"UTF-8\", \",\")" + "}"}'/&gt;
        &lt;single-column name="_sys_automation_ie_required_fields"
                       value='${"${" + "requiredFieldList.toString(\"UTF-8\", \",\")" + "}"}'/&gt;
        &lt;single-column name="_sys_automation_ie_sqc_required_fields"
                       value='${"${" + "requiredFieldListForSQC.toString(\"UTF-8\", \",\")" + "}"}'/&gt;

        &lt;single-column name="_sys_sqc_source_id" value="${sqcSourceId}"/&gt;
        &lt;single-column name="_sys_sqc_enabled" value='${"${" + "sqc_enabled" + "}"}'/&gt;
        &lt;single-column name="_sys_sqc_target_quality" value='${"${" + "targetQuality" + "}"}'/&gt;
        &lt;single-column name="_sys_model_type" value='${modelType}'/&gt;

        &lt;!-- for classification--&gt;
        &lt;single-column name="_sys_automation_answer_options" value="${answerOptions}"/&gt;
        &lt;single-column name="_sys_automation_text_answer_code" value="${ieTextAnswerCode}"/&gt;

        &lt;!-- for ie --&gt;
        &lt;single-column name="_sys_automation_relations_subanswer_code" value="${ieGroupAnswerCode}"/&gt;

        &lt;!-- for online offline models --&gt;
        &lt;single-column name="_sys_train_only_online_model" value="false"/&gt;
        &lt;single-column name="_sys_do_not_hide_default_value" value="true"/&gt;

        &lt;single-column name="_sys_statistics_calculation_enabled" value='${"${" + "statistics_calculation_enabled" + "}"}'/&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                            <name>(Generic) Automation Settings 8.4.4.1</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>MACHINE</type>
                                            <uuid>9edc931f-2a1a-43a2-a293-623b797e2bc3</uuid>
                                            <version>
                                                <componentUuid>757edd7b-9933-4d1c-9f7e-d9d9af042d9a</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <versionUuid>20af407b-72e3-4aaa-abee-140bcbc8c20d</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>ETL</machineWorkSettingType>
                                    <name>(Generic) Automation Settings 8.4.4.1</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
    &lt;var-def name="threshold"&gt;{{threshold}}&lt;/var-def&gt;
    &lt;var-def name="sqc_enabled"&gt;{{sqc_enabled}}&lt;/var-def&gt;
    &lt;var-def name="targetQuality"&gt;{{target_quality}}&lt;/var-def&gt;
    &lt;var-def name="sqcSourceId"&gt;local&lt;/var-def&gt;
    &lt;var-def name="retrain_count_type"&gt;{{retrain_count_type}}&lt;/var-def&gt;
    &lt;var-def name="retrain_count_value"&gt;{{retrain_count_value}}&lt;/var-def&gt;
    &lt;var-def name="train_model_version"&gt;{{train_model_version}}&lt;/var-def&gt;
    &lt;var-def name="time_limit_offline"&gt;{{time_limit_offline}}&lt;/var-def&gt;
    &lt;var-def name="time_limit_online"&gt;{{time_limit_online}}&lt;/var-def&gt;
    &lt;var-def name="statistics_calculation_enabled"&gt;{{statistics_calculation_enabled}}&lt;/var-def&gt;

    &lt;script&gt;&lt;![CDATA[
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.requester.service.automation.AutomationConstants;
        import java.text.SimpleDateFormat;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;

        AnswerInfoDTO findIeAnswer(List answers) {
            for (AnswerInfoDTO answer : answers) {
                if (answer.answerType.equals("INFO_EXTRACTION")) {
                    return answer;
                }
                if (answer.subAnswers != null &amp;&amp; !answer.subAnswers.isEmpty()) {
                    AnswerInfoDTO ieAnswer = findIeAnswer(answer.subAnswers);
                    if (ieAnswer != null) {
                        return ieAnswer;
                    }
                }
            }
            return null;
        }

        RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        List fields = new ArrayList();
        List requiredFields = new ArrayList();
        List requiredFieldsForSQC = new ArrayList();
        String automationMode = "none";
        String ieAnswerCode = "NOT_DEFINED";
        String ieTextAnswerCode = "";
        String ieGroupAnswerCode = "";
        String automationUrl = "";
        String modelVersion = "";
        String answerOptions = "";
        String modelType = "NOT_DEFINED";
        Long retrainCount = 0l;

        if (run.automationInfo != null) {
            if (!train_model_version.toString().isEmpty()) {
                modelVersion = train_model_version.toString();
            } else {
                modelVersion = run.automationInfo.modelVersion;
            }
            if (run.automationInfo.trainingMode) {
                automationMode = "training";
            } else {
                automationMode = "production";
            }
            if (!retrain_count_type.isEmpty()) {
                if("model".equals(retrain_count_type.toString())) {
                    run.automationInfo.retrainRecordsCount = retrainCount;
                }
                if ("user".equals(retrain_count_type.toString())) {
                    if(!"".equals(retrain_count_value.toString())) {
                        run.automationInfo.retrainRecordsCount = Long.valueOf(retrain_count_value.toString());
                    } else {
                        run.automationInfo.retrainRecordsCount = retrainCount;
                    }
                }
                retrainCount = run.automationInfo.retrainRecordsCount;
                run.automationInfo.retrainCountChanged = true;
            }
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            /*
                as ie answer is used in classification to display content, we only could determine model type by
                empty subanswers for classification
                //TODO: find a way to detect model type from vds-gateway rest or by specifying on UI
                //TODO: add cheboxes to UI to mark the answers that should be used in automation instead of hardcode below
             */
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    modelType = "ie";
                    ieAnswerCode = ieAnswer.answerCode;
                    for (AnswerInfoDTO subAnswer : ieAnswer.subAnswers) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            ieGroupAnswerCode = subAnswer.answerCode;
                            for (AnswerInfoDTO subGroupAnswer : subAnswer.subAnswers) {
                                requiredFields.add(subGroupAnswer.answerCode);
                            }
                             requiredFieldsForSQC.add(subAnswer.answerCode);
                        } else {
                            if (subAnswer.required) {
                                requiredFieldsForSQC.add(subAnswer.answerCode);
                                requiredFields.add(subAnswer.answerCode);
                            }
                        }
                        fields.add(subAnswer.answerCode);
                    }
                } else {
                    modelType = "classification";
                    for (AnswerInfoDTO answer : run.automationInfo.answers) {
                        if (answer.answerType.equals("INFO_EXTRACTION")) {
                            ieTextAnswerCode = answer.answerCode;
                        }
                        if(answer.answerType.equals("CHECK_ONE") || answer.answerType.equals("SELECT_ONE")){
                            ieAnswerCode = answer.answerCode;
                            fields.add(answer.answerCode);
                            requiredFields.add(answer.answerCode);
                            requiredFieldsForSQC.add(answer.answerCode);
                            answerOptions = answer.options;
                        }
                    }
                }
                if ("training".equals(automationMode)) {
                    sys.defineVariable("experimentGroup", ieAnswerCode + "_" + run.rootRunUuid, true);
                }
            }
            automationUrl = run.automationInfo.automationUrl;
        }
        sys.defineVariable("fieldList", fields, true);
        sys.defineVariable("requiredFieldList", requiredFields, true);
        sys.defineVariable("requiredFieldListForSQC", requiredFieldsForSQC, true);


        ]]&gt;
    &lt;/script&gt;
    &lt;case&gt;
        &lt;if condition='${"${" + "\"training\".equals(automationMode)" + "}"}'&gt;
            &lt;script&gt;
                &lt;![CDATA[
                    String trainJobsDataStoreName = AutomationConstants.DS_JOB_DATA_TABLE;

                    StringBuilder sqlQuery = new StringBuilder("update @this set ");
                    sqlQuery.append(" modelVersion='").append(modelVersion).append("',");
                    sqlQuery.append(" automationRootRunUUID='").append(run.rootRunUuid).append("',");
                    sqlQuery.append(" author='").append(run.authorFullName).append("',");
                    sqlQuery.append(" campaignName='").append(run.campaignName).append("',");

                    SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
                    String date = dateFormat.format(new Date());
                    sqlQuery.append(" lastUpdated='").append(date).append("'");

                    sqlQuery.append(" where originalCampaignUUID='").append(run.automationInfo.originalCampaignUuid).append("'");
                    sqlQuery.append(" and modelVersion='").append(run.automationInfo.modelVersion).append("'");
                    sqlQuery.append(" and status='PREPARING'");
                    sqlQuery.append(" and tags='").append(_sys_automation_tags.toString()).append("'");
                    sqlQuery.append(";");

                    Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
                    logger.info("Job for training was updated: " + sqlQuery.toString());
                ]]&gt;
            &lt;/script&gt;
            &lt;datastore name="${trainJobsDataStoreName}"&gt;
                ${sqlQuery}
            &lt;/datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;
    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_automation_threshold" value='${"${" + "threshold.toString()" + "}"}'/&gt;
        &lt;single-column name="_sys_automation_mode" value="${automationMode}"/&gt;
        &lt;single-column name="_sys_model_version" value="${modelVersion}"/&gt;
        &lt;case&gt;
            &lt;if condition='${"${" + "\"training\".equals(automationMode)" + "}"}'&gt;
                &lt;single-column name="_sys_automation_experiment_group" value="${experimentGroup}"/&gt;
                &lt;single-column name="_sys_automation_experiment_group_online" value="${experimentGroup}-online"/&gt;
            &lt;/if&gt;
        &lt;/case&gt;
        &lt;single-column name="_sys_automation_ds_doc_batch_size" value="100"/&gt;
        &lt;single-column name="_sys_automation_url" value="${automationUrl}"/&gt;
        &lt;single-column name="time_limit_offline" value="${time_limit_offline}"/&gt;
        &lt;single-column name="time_limit_online" value="${time_limit_online}"/&gt;
        &lt;single-column name="_sys_automation_retrain_count" value="${retrainCount}"/&gt;

        &lt;single-column name="_sys_automation_ie_answer_code" value="${ieAnswerCode}"/&gt;
        &lt;single-column name="_sys_automation_ie_fields" value='${"${" + "fieldList.toString(\"UTF-8\", \",\")" + "}"}'/&gt;
        &lt;single-column name="_sys_automation_ie_required_fields"
                       value='${"${" + "requiredFieldList.toString(\"UTF-8\", \",\")" + "}"}'/&gt;
        &lt;single-column name="_sys_automation_ie_sqc_required_fields"
                       value='${"${" + "requiredFieldListForSQC.toString(\"UTF-8\", \",\")" + "}"}'/&gt;

        &lt;single-column name="_sys_sqc_source_id" value="${sqcSourceId}"/&gt;
        &lt;single-column name="_sys_sqc_enabled" value='${"${" + "sqc_enabled" + "}"}'/&gt;
        &lt;single-column name="_sys_sqc_target_quality" value='${"${" + "targetQuality" + "}"}'/&gt;
        &lt;single-column name="_sys_model_type" value='${modelType}'/&gt;

        &lt;!-- for classification--&gt;
        &lt;single-column name="_sys_automation_answer_options" value="${answerOptions}"/&gt;
        &lt;single-column name="_sys_automation_text_answer_code" value="${ieTextAnswerCode}"/&gt;

        &lt;!-- for ie --&gt;
        &lt;single-column name="_sys_automation_relations_subanswer_code" value="${ieGroupAnswerCode}"/&gt;

        &lt;!-- for online offline models --&gt;
        &lt;single-column name="_sys_train_only_online_model" value="false"/&gt;
        &lt;single-column name="_sys_do_not_hide_default_value" value="true"/&gt;

        &lt;single-column name="_sys_statistics_calculation_enabled" value='${"${" + "statistics_calculation_enabled" + "}"}'/&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                        <name>(Generic) Automation Settings 8.4.4.1</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>MACHINE</type>
                                        <uuid>ce812128-b770-47bd-a355-18c20a98fddd</uuid>
                                        <version>
                                            <componentUuid>5e9b498f-945e-4e90-8602-81aeb1e9b283</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <versionUuid>9d638218-9849-4bdb-a68e-54fc25d6ec2b</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>0dc7d027-90f8-4c90-9ab7-cf7ddce23835</uuid>
                                    <version>
                                        <componentUuid>94534535-e02a-4bbd-a15b-291b7b935fe6</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>6ebf6c7f-d6a5-47dc-a90c-8e15a8dbc1bc</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>(Generic) Automation Settings 8.4.4.1</title>
                                <type>SINGLE</type>
                                <uuid>9a6c2d8e-d5db-4b00-8cc2-95b8d09e9178</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>4ac62ec8-d94a-42a5-bd37-65f657816246</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>77b4001c-4276-48e0-aac9-6bcc1558a8e9</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>76</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>a13d149f-2a7e-4228-9ab5-4b79009ae7c2</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>0e30b888-b776-4f44-adbd-d10839eeccb3</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Format Dates</answer>
                                            <answerCode>enable_date_conversion</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>true</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=true|No=false</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Format Dates</answer>
                                            <answerCode>date_format</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>MM/dd/yyyy</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(true)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Dates</answer>
                                                <answerCode>enable_date_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Convert Relative Dates Based on</answer>
                                            <answerCode>convert_relative_dates_based_on</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>field_value</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(true)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Current date=current_date|Field Value=field_value</options>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Dates</answer>
                                                <answerCode>enable_date_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>today_field</answer>
                                            <answerCode>today_field</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>date</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(field_value)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Format Numbers</answer>
                                            <answerCode>enable_number_conversion</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>true</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=true|No=false</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>5</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>number_format</answer>
                                            <answerCode>number_format</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>#.##</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(true)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Numbers</answer>
                                                <answerCode>enable_number_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>6</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Format Prices</answer>
                                            <answerCode>enable_price_conversion</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>true</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(true)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=true|No=false</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>7</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>price_format</answer>
                                            <answerCode>price_format</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>C:#.################</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(true)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Prices</answer>
                                                <answerCode>enable_price_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>8</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>default_currency</answer>
                                            <answerCode>default_currency</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>USD</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>expand:on(true)</htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>USD=USD|EUR=EUR</options>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Prices</answer>
                                                <answerCode>enable_price_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-09-02T14:41:29Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>9</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Format Dictionary Based Values</answer>
                                            <answerCode>enable_dictionary_based_conversion</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>true</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=true|No=false</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>10</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Format Percent</answer>
                                            <answerCode>enable_percent_conversion</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <constantable>false</constantable>
                                            <defaultValue>true</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=true|No=false</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>11</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;var-def name="enableDateConversion"&gt;false&lt;/var-def&gt;
    &lt;var-def name="todayReference"&gt;current_date&lt;/var-def&gt;
    &lt;var-def name="todayField"&gt;&lt;/var-def&gt;
    &lt;var-def name="enableNumberConversion"&gt;false&lt;/var-def&gt;
    &lt;var-def name="enablePercentConversion"&gt;false&lt;/var-def&gt;
    &lt;var-def name="enablePriceConversion"&gt;false&lt;/var-def&gt;
    &lt;var-def name="enableDictionaryBasedConversion"&gt;false&lt;/var-def&gt;
    &lt;var-def name="date_format"&gt;yyyy/MM/dd&lt;/var-def&gt;
    &lt;var-def name="enableJsonConversion"&gt;true&lt;/var-def&gt;

    &lt;script&gt;
        &lt;![CDATA[
            Boolean isIe =_sys_model_type.toString().equals("ie");
        ]]&gt;
    &lt;/script&gt;

    &lt;case&gt;
        &lt;if condition='${isIe}'&gt;
            &lt;script&gt;
                &lt;![CDATA[
                import com.freedomoss.crowdcontrol.webharvest.RunDto;
                import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
                import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
                import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;
                import java.text.SimpleDateFormat;
                import com.google.common.base.Joiner;
                import org.apache.commons.lang3.StringUtils;

                import org.slf4j.Logger;
                import org.slf4j.LoggerFactory;
                Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");


                RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
                AutomationInfoDto automationInfo = run.automationInfo;
                boolean isAutomationInfoExists = automationInfo != null;
                String correctionsDS = !isAutomationInfoExists ? "" : "Corrections_" + automationInfo.originalCampaignUuid.replace("-", "_");

                ]]&gt;
            &lt;/script&gt;

            &lt;script&gt;
                &lt;![CDATA[

                List dateTagTypeList = new ArrayList();
                List numberTagTypeList = new ArrayList();
                List priceTagTypeList = new ArrayList();
                List selectTagTypeList = new ArrayList();
                List percentTagList = new ArrayList();
                List otherTagTypeList = new ArrayList();

                Map dictionaries = new HashMap();

                String groupAnswerCode = null;
                List jsonNumberFields = new ArrayList();
                List jsonDateFields = new ArrayList();
                List jsonPriceFields = new ArrayList();
                List jsonPercentFields = new ArrayList();

                if (isAutomationInfoExists) {
                    for (AnswerInfoDTO answer : run.automationInfo.answers) {
                        if ("INFO_EXTRACTION".equals(answer.getAnswerType())) {
                            for (AnswerInfoDTO subAnswer : answer.getSubAnswers()) {
                                String subAnswerType = subAnswer.getAnswerType();
                                String subAnswerCode = subAnswer.getAnswerCode();
                                if ("GROUP".equals(subAnswerType)) { // init data for json converter
                                    groupAnswerCode = subAnswerCode;
                                    for (AnswerInfoDTO groupSubAnswer : subAnswer.getSubAnswers()) {
                                        String groupSubAnswerType = groupSubAnswer.getAnswerType();
                                        String groupSubAnswerCode = groupSubAnswer.getAnswerCode();
                                        if ("DATE".equals(groupSubAnswerType) || "SELECT_DATE".equals(groupSubAnswerType)) {
                                            jsonDateFields.add(groupSubAnswerCode);
                                        } else if ("NUMBER".equals(groupSubAnswerType)) {
                                            jsonNumberFields.add(groupSubAnswerCode);
                                        } else if ("PERCENT".equals(groupSubAnswerType)) {
                                            jsonPercentFields.add(groupSubAnswerCode);
                                        } else if ("PRICE".equals(groupSubAnswerType)) {
                                            jsonPriceFields.add(groupSubAnswerCode);
                                        }

                                    }
                                    logger.info("number fields: " + jsonNumberFields);
                                    logger.info("date fields: " + jsonDateFields);
                                    logger.info("price fields: " + jsonPriceFields);
                                    logger.info("percent fields: " + jsonPercentFields);

                                } else if ("DATE".equals(subAnswerType) || "SELECT_DATE".equals(subAnswerType)) {
                                    dateTagTypeList.add(subAnswerCode);
                                } else if ("NUMBER".equals(subAnswerType)) {
                                    numberTagTypeList.add(subAnswerCode);
                                } else if ("PERCENT".equals(subAnswerType)) {
                                    percentTagList.add(subAnswerCode);
                                } else if ("PRICE".equals(subAnswerType)) {
                                    priceTagTypeList.add(subAnswerCode);
                                } else if("SELECT_ONE".equals(subAnswerType) || "CHECK_ONE".equals(subAnswerType)){
                                    selectTagTypeList.add(subAnswerCode);
                                    Map dictionary = subAnswer.getOptionsMap();
                                    dictionaries.put(subAnswerCode, dictionary);
                                } else {
                                    otherTagTypeList.add(subAnswerCode);
                                }
                            }
                            break;
                        }
                    }
                }
                String currentDate = null;
                if(enablePercentConversion.toBoolean()){
                     if ("field_value".equals(todayReference.toString())) {
                        if (sys.isVariableDefined(todayField.toString()) &amp;&amp; !sys.getVar(todayField.toString()).toString().trim().isEmpty()) {
                            currentDate = sys.getVar(todayField.toString()).toString();
                            if (currentDate.contains(" ")) {
                                currentDate = currentDate.split("\\s")[0];
                            }
                        }
                    } else {
                            SimpleDateFormat dateFormat = new SimpleDateFormat(sys.getVar("date_format").toString());
                            currentDate = dateFormat.format(new Date());
                    }
                }

                List tags = Arrays.asList(_sys_automation_ie_fields.toString().split(","));

                Map fieldsMap = new HashMap();

                for (int i = 0; i &lt; tags.size(); i++) {
                    String tagName = tags.get(i).toString();
                    if (sys.isVariableDefined(tagName) &amp;&amp; !sys.getVar(tagName).toString().isEmpty()) {
                        String extractedTagValue = sys.getVar(tagName).toString();
                        fieldsMap.put(tagName, extractedTagValue);
                    }
                }

                logger.info("Fields to normalize: " + fieldsMap);
                sys.defineVariable("extractedFieldNameListVar", new ArrayList(fieldsMap.keySet()));
                sys.defineVariable("tagNamesListVar", tags);


                boolean isFetchCorrections = isAutomationInfoExists &amp;&amp; !fieldsMap.isEmpty();

                String prepareCorrectionDsSql() {

                    String sql = "select * from @this ";
                    if (!fieldsMap.isEmpty()) {

                        sql += "where ";

                        int i = 0;
                        for (Object pairObj : fieldsMap.entrySet()) {

                            Map.Entry pair = (Map.Entry) pairObj;

                            String answerCode = pair.getKey().toString();
                            String currentValue = pair.getValue().toString();
                            currentValue = currentValue.replace("'", "''"); //escape

                            if (i &gt; 0) {
                                sql += " or ";
                            }

                            sql += "(answerCode='" + answerCode + "' and originalValue='" + currentValue + "')";
                            i++;
                        }
                    }
                    return sql + ";";
                }

                boolean hasConversionErrors = false;
                ]]&gt;
            &lt;/script&gt;


            &lt;case&gt;
                &lt;if condition='${isFetchCorrections}' &gt;

                    &lt;script&gt;
                        &lt;![CDATA[
                        boolean isCorrectDsProcessed = true;
                        String prepareCheckCorrectionDsExistSql() {
                            return "select * from @this LIMIT 1;";
                        }
                        ]]&gt;
                    &lt;/script&gt;

                    &lt;try&gt;
                        &lt;body&gt;
                            &lt;datastore name="${correctionsDS}"&gt;
                                &lt;script return="prepareCheckCorrectionDsExistSql()"/&gt;
                            &lt;/datastore&gt;
                        &lt;/body&gt;
                        &lt;catch&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                isCorrectDsProcessed = false;
                                logger.error("Could not process sql script on ds '" + correctionsDS + "'");
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/catch&gt;
                    &lt;/try&gt;

                    &lt;case&gt;
                        &lt;if condition="${isCorrectDsProcessed}"&gt;
                            &lt;loop item="row"&gt;
                                &lt;list&gt;
                                    &lt;datastore name="${correctionsDS}"&gt;
                                        &lt;script return="prepareCorrectionDsSql()"/&gt;
                                    &lt;/datastore&gt;
                                &lt;/list&gt;
                                &lt;body&gt;
                                    &lt;script&gt;
                                        &lt;![CDATA[
                                        String answerCode = row.get("answerCode").toString();
                                        String originalValue = row.get("originalValue").toString();
                                        String correctedValue = row.get("correctedValue").toString();

                                        String currentValue = fieldsMap.get(answerCode).toString();
                                        if (originalValue.equals(currentValue)) {
                                            fieldsMap.put(answerCode, correctedValue);
                                        }
                                        ]]&gt;
                                    &lt;/script&gt;
                                &lt;/body&gt;
                            &lt;/loop&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                &lt;/if&gt;
            &lt;/case&gt;

            &lt;loop item="extractedFieldName"&gt;
                &lt;list&gt;
                    &lt;var name="extractedFieldNameListVar"/&gt;
                &lt;/list&gt;
                &lt;body&gt;
                    &lt;case&gt;
                        &lt;if condition='${enablePercentConversion.toBoolean() &amp;amp;&amp;amp; percentTagList.contains(extractedFieldName.toString())}'&gt;
                            &lt;var-def name="percent_converted"&gt;
                                &lt;convert-percent on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${fieldsMap.get(extractedFieldName.toString())}&lt;/template&gt;
                                &lt;/convert-percent&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String percentConverted = percent_converted.toString();
                                fieldsMap.put(fieldName, percentConverted);
                                if (percentConverted == null || percentConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${enableDateConversion.toBoolean() &amp;amp;&amp;amp; dateTagTypeList.contains(extractedFieldName.toString())}'&gt;
                            &lt;var-def name="date_converted"&gt;
                                &lt;convert-date output-format="${date_format}" current-date='${currentDate}' on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${fieldsMap.get(extractedFieldName.toString())}&lt;/template&gt;
                                &lt;/convert-date&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String dateConverted = date_converted.toString();
                                fieldsMap.put(fieldName, dateConverted);
                                if (dateConverted == null || dateConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${enableNumberConversion.toBoolean() &amp;amp;&amp;amp; numberTagTypeList.contains(extractedFieldName.toString())}'&gt;
                            &lt;var-def name="number_converted"&gt;
                                &lt;convert-number output-format="#.##" on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${fieldsMap.get(extractedFieldName.toString())}&lt;/template&gt;
                                &lt;/convert-number&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String numberConverted = number_converted.toString();
                                fieldsMap.put(fieldName, numberConverted);
                                if (numberConverted == null || numberConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${enablePriceConversion.toBoolean() &amp;amp;&amp;amp; priceTagTypeList.contains(extractedFieldName.toString())}'&gt;
                            &lt;var-def name="price_converted"&gt;
                                &lt;convert-price output-format="C:#.#" default-currency="USD" on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${fieldsMap.get(extractedFieldName.toString())}&lt;/template&gt;
                                &lt;/convert-price&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String priceConverted = price_converted.toString();
                                String extractedValue = fieldsMap.get(fieldName);
                                if (priceConverted.contains(":")) {
                                    String[] splittedPrice = priceConverted.split(":");
                                    String priceCurrency = splittedPrice[0];
                                    String priceValue = splittedPrice[1];
                                    extractedValue = priceValue;
                                    if (priceCurrency != null &amp;&amp; !priceCurrency.isEmpty()) {
                                        // if amount contains currency -&gt; always replace 'currency' field by amount's currency
                                        fieldsMap.put("currency", priceCurrency);
                                    }
                                }
                                fieldsMap.put(fieldName, priceConverted);
                                if (priceConverted == null || priceConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${enableDictionaryBasedConversion.toBoolean() &amp;amp;&amp;amp; selectTagTypeList.contains(extractedFieldName.toString())}'&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String extractedValue = fieldsMap.get(fieldName);
                                Map dictionary = dictionaries.get(fieldName);
                                if (dictionary != null) {
                                    String value = dictionary.get(extractedValue.trim().toLowerCase());
                                    extractedValue = value;
                                }
                                fieldsMap.put(fieldName, extractedValue);
                                if (extractedValue == null || extractedValue.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${enableJsonConversion.toBoolean() &amp;amp;&amp;amp; extractedFieldName.toString().equals(groupAnswerCode)}'&gt;

                            &lt;var-def name="json_converted"&gt;

                                &lt;convert-json value='${fieldsMap.get(groupAnswerCode)}' on-error="EMPTY_VALUE"&gt;
                                    &lt;convert-number output-format="#.##" on-error="EMPTY_VALUE"
                                                    for='${Joiner.on(",").join(jsonNumberFields)}'/&gt;
                                    &lt;convert-date output-format="${date_format}" current-date='${currentDate}' on-error="EMPTY_VALUE"
                                                  for='${Joiner.on(",").join(jsonDateFields)}'/&gt;
                                    &lt;convert-price output-format="C:#.#" default-currency="USD"
                                                   for='${Joiner.on(",").join(jsonPriceFields)}'/&gt;
                                    &lt;convert-percent on-error="EMPTY_VALUE" for='${Joiner.on(",").join(jsonPercentFields)}'/&gt;
                                &lt;/convert-json&gt;

                            &lt;/var-def&gt;

                            &lt;script&gt;
                                &lt;![CDATA[
                                fieldsMap.put(groupAnswerCode, json_converted.toString());
                                if (json_converted.toString().isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                &lt;/body&gt;
            &lt;/loop&gt;

            &lt;export include-original-data="true"&gt;
                &lt;loop item="extractedFieldNameVar"&gt;
                    &lt;list&gt;
                        &lt;var name="tagNamesListVar"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;single-column name='${extractedFieldNameVar}'
                                       value='${fieldsMap.get(extractedFieldNameVar.toString())}'/&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
                &lt;single-column name='_sys_has_conversion_errors' value='${hasConversionErrors}'/&gt;
            &lt;/export&gt;
        &lt;/if&gt;
        &lt;else&gt;
            &lt;export include-original-data="true"&gt;
                &lt;single-column name='_sys_has_conversion_errors' value='false'/&gt;
            &lt;/export&gt;
        &lt;/else&gt;
    &lt;/case&gt;
&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>e1e5511a-4549-4641-b746-9ea7f25970b6</inclusionCode>
                                    <jsonParams>{"enable_date_conversion":"false","date_format":"yyyy/MM/dd","convert_relative_dates_based_on":"current_date","enable_number_conversion":"false","number_format":"#.##","enable_percent_conversion":"false","enable_price_conversion":"false","price_format":"C:#.#","default_currency":"USD","enable_dictionary_based_conversion":"false"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>NORMAL</contentType>
                                        <enabled>true</enabled>
                                        <name>Normalization</name>
                                        <publicId>d6b8862a-55e7-4443-966f-72563f94188f</publicId>
                                        <version>
                                            <componentUuid>a752f19d-9dd3-4930-b9de-bb5a05130a1a</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-02-22T15:18:23Z</lastModified>
                                            <versionUuid>00f5fd75-a515-46e1-928e-22d8f49b1914</versionUuid>
                                        </version>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Dates</answer>
                                                <answerCode>enable_date_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Dates</answer>
                                                <answerCode>date_format</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>MM/dd/yyyy</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Format Dates</answer>
                                                    <answerCode>enable_date_conversion</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                        <code>CHECK_ONE</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>true</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>true</showForMachineConfig>
                                                        <title>Check One</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <constantable>false</constantable>
                                                    <defaultValue>true</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>Yes=true|No=false</options>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>true</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Convert Relative Dates Based on</answer>
                                                <answerCode>convert_relative_dates_based_on</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>field_value</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Current date=current_date|Field Value=field_value</options>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Format Dates</answer>
                                                    <answerCode>enable_date_conversion</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                        <code>CHECK_ONE</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>true</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>true</showForMachineConfig>
                                                        <title>Check One</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <constantable>false</constantable>
                                                    <defaultValue>true</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-02-22T15:18:22Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>Yes=true|No=false</options>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>true</required>
                                                    <sequenceNumber>1</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>today_field</answer>
                                                <answerCode>today_field</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>date</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(field_value)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Numbers</answer>
                                                <answerCode>enable_number_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>number_format</answer>
                                                <answerCode>number_format</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>#.##</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Format Numbers</answer>
                                                    <answerCode>enable_number_conversion</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                        <code>CHECK_ONE</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>true</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>true</showForMachineConfig>
                                                        <title>Check One</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <constantable>false</constantable>
                                                    <defaultValue>true</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses></htmlClasses>
                                                    <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>Yes=true|No=false</options>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>true</required>
                                                    <sequenceNumber>5</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Prices</answer>
                                                <answerCode>enable_price_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>7</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>price_format</answer>
                                                <answerCode>price_format</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>C:#.################</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Format Prices</answer>
                                                    <answerCode>enable_price_conversion</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                        <code>CHECK_ONE</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>true</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>true</showForMachineConfig>
                                                        <title>Check One</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <constantable>false</constantable>
                                                    <defaultValue>true</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>expand:on(true)</htmlClasses>
                                                    <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>Yes=true|No=false</options>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>true</required>
                                                    <sequenceNumber>7</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>8</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>default_currency</answer>
                                                <answerCode>default_currency</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                    <code>SELECT_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Select One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>USD</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses>expand:on(true)</htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>USD=USD|EUR=EUR</options>
                                                <parentAnswer>
                                                    <allowNA>false</allowNA>
                                                    <answer>Format Prices</answer>
                                                    <answerCode>enable_price_conversion</answerCode>
                                                    <answerHtml></answerHtml>
                                                    <answerTypeObject>
                                                        <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                        <code>CHECK_ONE</code>
                                                        <description></description>
                                                        <optionsAvailable>true</optionsAvailable>
                                                        <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                        <showDefaultValue>true</showDefaultValue>
                                                        <showForFieldScheme>true</showForFieldScheme>
                                                        <showForHumanTask>true</showForHumanTask>
                                                        <showForMachineConfig>true</showForMachineConfig>
                                                        <title>Check One</title>
                                                        <valueType>SINGLEVALUE</valueType>
                                                    </answerTypeObject>
                                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                                    <autocompleteField>false</autocompleteField>
                                                    <constantable>false</constantable>
                                                    <defaultValue>true</defaultValue>
                                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                    <htmlClasses>expand:on(true)</htmlClasses>
                                                    <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                    <letCustomValues>false</letCustomValues>
                                                    <manualField>false</manualField>
                                                    <multiValue>false</multiValue>
                                                    <options>Yes=true|No=false</options>
                                                    <percentRequired>false</percentRequired>
                                                    <range>false</range>
                                                    <required>true</required>
                                                    <sequenceNumber>7</sequenceNumber>
                                                    <shuffle>false</shuffle>
                                                    <useBlocks>false</useBlocks>
                                                    <useEmptyCell>false</useEmptyCell>
                                                </parentAnswer>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>9</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Dictionary Based Values</answer>
                                                <answerCode>enable_dictionary_based_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>10</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Format Percent</answer>
                                                <answerCode>enable_percent_conversion</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                    <code>CHECK_ONE</code>
                                                    <description></description>
                                                    <optionsAvailable>true</optionsAvailable>
                                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Check One</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <defaultValue>true</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <options>Yes=true|No=false</options>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>true</required>
                                                <sequenceNumber>11</sequenceNumber>
                                                <shuffle>false</shuffle>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <machineWorkSettingType>ETL</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;var-def name="enableDateConversion"&gt;{{enable_date_conversion}}&lt;/var-def&gt;
    &lt;var-def name="todayReference"&gt;{{convert_relative_dates_based_on}}&lt;/var-def&gt;
    &lt;var-def name="todayField"&gt;{{today_field}}&lt;/var-def&gt;
    &lt;var-def name="enableNumberConversion"&gt;{{enable_number_conversion}}&lt;/var-def&gt;
    &lt;var-def name="enablePercentConversion"&gt;{{enable_percent_conversion}}&lt;/var-def&gt;
    &lt;var-def name="enablePriceConversion"&gt;{{enable_price_conversion}}&lt;/var-def&gt;
    &lt;var-def name="enableDictionaryBasedConversion"&gt;{{enable_dictionary_based_conversion}}&lt;/var-def&gt;
    &lt;var-def name="date_format"&gt;{{date_format}}&lt;/var-def&gt;
    &lt;var-def name="enableJsonConversion"&gt;true&lt;/var-def&gt;

    &lt;script&gt;
        &lt;![CDATA[
            Boolean isIe =_sys_model_type.toString().equals("ie");
        ]]&gt;
    &lt;/script&gt;

    &lt;case&gt;
        &lt;if condition='${isIe}'&gt;
            &lt;script&gt;
                &lt;![CDATA[
                import com.freedomoss.crowdcontrol.webharvest.RunDto;
                import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
                import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
                import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;
                import java.text.SimpleDateFormat;
                import com.google.common.base.Joiner;
                import org.apache.commons.lang3.StringUtils;

                import org.slf4j.Logger;
                import org.slf4j.LoggerFactory;
                Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");


                RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
                AutomationInfoDto automationInfo = run.automationInfo;
                boolean isAutomationInfoExists = automationInfo != null;
                String correctionsDS = !isAutomationInfoExists ? "" : "Corrections_" + automationInfo.originalCampaignUuid.replace("-", "_");

                ]]&gt;
            &lt;/script&gt;

            &lt;script&gt;
                &lt;![CDATA[

                List dateTagTypeList = new ArrayList();
                List numberTagTypeList = new ArrayList();
                List priceTagTypeList = new ArrayList();
                List selectTagTypeList = new ArrayList();
                List percentTagList = new ArrayList();
                List otherTagTypeList = new ArrayList();

                Map dictionaries = new HashMap();

                String groupAnswerCode = null;
                List jsonNumberFields = new ArrayList();
                List jsonDateFields = new ArrayList();
                List jsonPriceFields = new ArrayList();
                List jsonPercentFields = new ArrayList();

                if (isAutomationInfoExists) {
                    for (AnswerInfoDTO answer : run.automationInfo.answers) {
                        if ("INFO_EXTRACTION".equals(answer.getAnswerType())) {
                            for (AnswerInfoDTO subAnswer : answer.getSubAnswers()) {
                                String subAnswerType = subAnswer.getAnswerType();
                                String subAnswerCode = subAnswer.getAnswerCode();
                                if ("GROUP".equals(subAnswerType)) { // init data for json converter
                                    groupAnswerCode = subAnswerCode;
                                    for (AnswerInfoDTO groupSubAnswer : subAnswer.getSubAnswers()) {
                                        String groupSubAnswerType = groupSubAnswer.getAnswerType();
                                        String groupSubAnswerCode = groupSubAnswer.getAnswerCode();
                                        if ("DATE".equals(groupSubAnswerType) || "SELECT_DATE".equals(groupSubAnswerType)) {
                                            jsonDateFields.add(groupSubAnswerCode);
                                        } else if ("NUMBER".equals(groupSubAnswerType)) {
                                            jsonNumberFields.add(groupSubAnswerCode);
                                        } else if ("PERCENT".equals(groupSubAnswerType)) {
                                            jsonPercentFields.add(groupSubAnswerCode);
                                        } else if ("PRICE".equals(groupSubAnswerType)) {
                                            jsonPriceFields.add(groupSubAnswerCode);
                                        }

                                    }
                                    logger.info("number fields: " + jsonNumberFields);
                                    logger.info("date fields: " + jsonDateFields);
                                    logger.info("price fields: " + jsonPriceFields);
                                    logger.info("percent fields: " + jsonPercentFields);

                                } else if ("DATE".equals(subAnswerType) || "SELECT_DATE".equals(subAnswerType)) {
                                    dateTagTypeList.add(subAnswerCode);
                                } else if ("NUMBER".equals(subAnswerType)) {
                                    numberTagTypeList.add(subAnswerCode);
                                } else if ("PERCENT".equals(subAnswerType)) {
                                    percentTagList.add(subAnswerCode);
                                } else if ("PRICE".equals(subAnswerType)) {
                                    priceTagTypeList.add(subAnswerCode);
                                } else if("SELECT_ONE".equals(subAnswerType) || "CHECK_ONE".equals(subAnswerType)){
                                    selectTagTypeList.add(subAnswerCode);
                                    Map dictionary = subAnswer.getOptionsMap();
                                    dictionaries.put(subAnswerCode, dictionary);
                                } else {
                                    otherTagTypeList.add(subAnswerCode);
                                }
                            }
                            break;
                        }
                    }
                }
                String currentDate = null;
                if(enablePercentConversion.toBoolean()){
                     if ("field_value".equals(todayReference.toString())) {
                        if (sys.isVariableDefined(todayField.toString()) &amp;&amp; !sys.getVar(todayField.toString()).toString().trim().isEmpty()) {
                            currentDate = sys.getVar(todayField.toString()).toString();
                            if (currentDate.contains(" ")) {
                                currentDate = currentDate.split("\\s")[0];
                            }
                        }
                    } else {
                            SimpleDateFormat dateFormat = new SimpleDateFormat(sys.getVar("date_format").toString());
                            currentDate = dateFormat.format(new Date());
                    }
                }

                List tags = Arrays.asList(_sys_automation_ie_fields.toString().split(","));

                Map fieldsMap = new HashMap();

                for (int i = 0; i &lt; tags.size(); i++) {
                    String tagName = tags.get(i).toString();
                    if (sys.isVariableDefined(tagName) &amp;&amp; !sys.getVar(tagName).toString().isEmpty()) {
                        String extractedTagValue = sys.getVar(tagName).toString();
                        fieldsMap.put(tagName, extractedTagValue);
                    }
                }

                logger.info("Fields to normalize: " + fieldsMap);
                sys.defineVariable("extractedFieldNameListVar", new ArrayList(fieldsMap.keySet()));
                sys.defineVariable("tagNamesListVar", tags);


                boolean isFetchCorrections = isAutomationInfoExists &amp;&amp; !fieldsMap.isEmpty();

                String prepareCorrectionDsSql() {

                    String sql = "select * from @this ";
                    if (!fieldsMap.isEmpty()) {

                        sql += "where ";

                        int i = 0;
                        for (Object pairObj : fieldsMap.entrySet()) {

                            Map.Entry pair = (Map.Entry) pairObj;

                            String answerCode = pair.getKey().toString();
                            String currentValue = pair.getValue().toString();
                            currentValue = currentValue.replace("'", "''"); //escape

                            if (i &gt; 0) {
                                sql += " or ";
                            }

                            sql += "(answerCode='" + answerCode + "' and originalValue='" + currentValue + "')";
                            i++;
                        }
                    }
                    return sql + ";";
                }

                boolean hasConversionErrors = false;
                ]]&gt;
            &lt;/script&gt;


            &lt;case&gt;
                &lt;if condition='${isFetchCorrections}' &gt;

                    &lt;script&gt;
                        &lt;![CDATA[
                        boolean isCorrectDsProcessed = true;
                        String prepareCheckCorrectionDsExistSql() {
                            return "select * from @this LIMIT 1;";
                        }
                        ]]&gt;
                    &lt;/script&gt;

                    &lt;try&gt;
                        &lt;body&gt;
                            &lt;datastore name="${correctionsDS}"&gt;
                                &lt;script return="prepareCheckCorrectionDsExistSql()"/&gt;
                            &lt;/datastore&gt;
                        &lt;/body&gt;
                        &lt;catch&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                isCorrectDsProcessed = false;
                                logger.error("Could not process sql script on ds '" + correctionsDS + "'");
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/catch&gt;
                    &lt;/try&gt;

                    &lt;case&gt;
                        &lt;if condition="${isCorrectDsProcessed}"&gt;
                            &lt;loop item="row"&gt;
                                &lt;list&gt;
                                    &lt;datastore name="${correctionsDS}"&gt;
                                        &lt;script return="prepareCorrectionDsSql()"/&gt;
                                    &lt;/datastore&gt;
                                &lt;/list&gt;
                                &lt;body&gt;
                                    &lt;script&gt;
                                        &lt;![CDATA[
                                        String answerCode = row.get("answerCode").toString();
                                        String originalValue = row.get("originalValue").toString();
                                        String correctedValue = row.get("correctedValue").toString();

                                        String currentValue = fieldsMap.get(answerCode).toString();
                                        if (originalValue.equals(currentValue)) {
                                            fieldsMap.put(answerCode, correctedValue);
                                        }
                                        ]]&gt;
                                    &lt;/script&gt;
                                &lt;/body&gt;
                            &lt;/loop&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                &lt;/if&gt;
            &lt;/case&gt;

            &lt;loop item="extractedFieldName"&gt;
                &lt;list&gt;
                    &lt;var name="extractedFieldNameListVar"/&gt;
                &lt;/list&gt;
                &lt;body&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enablePercentConversion.toBoolean() &amp;amp;&amp;amp; percentTagList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="percent_converted"&gt;
                                &lt;convert-percent on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-percent&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String percentConverted = percent_converted.toString();
                                fieldsMap.put(fieldName, percentConverted);
                                if (percentConverted == null || percentConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableDateConversion.toBoolean() &amp;amp;&amp;amp; dateTagTypeList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="date_converted"&gt;
                                &lt;convert-date output-format="${date_format}" current-date='${"${" + "currentDate" + "}"}' on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-date&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String dateConverted = date_converted.toString();
                                fieldsMap.put(fieldName, dateConverted);
                                if (dateConverted == null || dateConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableNumberConversion.toBoolean() &amp;amp;&amp;amp; numberTagTypeList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="number_converted"&gt;
                                &lt;convert-number output-format="{{number_format}}" on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-number&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String numberConverted = number_converted.toString();
                                fieldsMap.put(fieldName, numberConverted);
                                if (numberConverted == null || numberConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enablePriceConversion.toBoolean() &amp;amp;&amp;amp; priceTagTypeList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="price_converted"&gt;
                                &lt;convert-price output-format="{{price_format}}" default-currency="{{default_currency}}" on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-price&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String priceConverted = price_converted.toString();
                                String extractedValue = fieldsMap.get(fieldName);
                                if (priceConverted.contains(":")) {
                                    String[] splittedPrice = priceConverted.split(":");
                                    String priceCurrency = splittedPrice[0];
                                    String priceValue = splittedPrice[1];
                                    extractedValue = priceValue;
                                    if (priceCurrency != null &amp;&amp; !priceCurrency.isEmpty()) {
                                        // if amount contains currency -&gt; always replace 'currency' field by amount's currency
                                        fieldsMap.put("currency", priceCurrency);
                                    }
                                }
                                fieldsMap.put(fieldName, priceConverted);
                                if (priceConverted == null || priceConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableDictionaryBasedConversion.toBoolean() &amp;amp;&amp;amp; selectTagTypeList.contains(extractedFieldName.toString())"+ "}"}'&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String extractedValue = fieldsMap.get(fieldName);
                                Map dictionary = dictionaries.get(fieldName);
                                if (dictionary != null) {
                                    String value = dictionary.get(extractedValue.trim().toLowerCase());
                                    extractedValue = value;
                                }
                                fieldsMap.put(fieldName, extractedValue);
                                if (extractedValue == null || extractedValue.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableJsonConversion.toBoolean() &amp;amp;&amp;amp; extractedFieldName.toString().equals(groupAnswerCode)" + "}"}'&gt;

                            &lt;var-def name="json_converted"&gt;

                                &lt;convert-json value='${"${" + "fieldsMap.get(groupAnswerCode)" + "}"}' on-error="EMPTY_VALUE"&gt;
                                    &lt;convert-number output-format="{{number_format}}" on-error="EMPTY_VALUE"
                                                    for='${"${" + "Joiner.on(\",\").join(jsonNumberFields)" + "}"}'/&gt;
                                    &lt;convert-date output-format="${date_format}" current-date='${"${" + "currentDate" + "}"}' on-error="EMPTY_VALUE"
                                                  for='${"${" + "Joiner.on(\",\").join(jsonDateFields)" + "}"}'/&gt;
                                    &lt;convert-price output-format="{{price_format}}" default-currency="{{default_currency}}"
                                                   for='${"${" + "Joiner.on(\",\").join(jsonPriceFields)" + "}"}'/&gt;
                                    &lt;convert-percent on-error="EMPTY_VALUE" for='${"${" + "Joiner.on(\",\").join(jsonPercentFields)" + "}"}'/&gt;
                                &lt;/convert-json&gt;

                            &lt;/var-def&gt;

                            &lt;script&gt;
                                &lt;![CDATA[
                                fieldsMap.put(groupAnswerCode, json_converted.toString());
                                if (json_converted.toString().isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                &lt;/body&gt;
            &lt;/loop&gt;

            &lt;export include-original-data="true"&gt;
                &lt;loop item="extractedFieldNameVar"&gt;
                    &lt;list&gt;
                        &lt;var name="tagNamesListVar"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;single-column name='${"${" +"extractedFieldNameVar" + "}"}'
                                       value='${"${" + "fieldsMap.get(extractedFieldNameVar.toString())" + "}"}'/&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
                &lt;single-column name='_sys_has_conversion_errors' value='${"${" +"hasConversionErrors" + "}"}'/&gt;
            &lt;/export&gt;
        &lt;/if&gt;
        &lt;else&gt;
            &lt;export include-original-data="true"&gt;
                &lt;single-column name='_sys_has_conversion_errors' value='false'/&gt;
            &lt;/export&gt;
        &lt;/else&gt;
    &lt;/case&gt;
&lt;/config&gt;
</content>
                                            <name>(Generic) Normalization 8.4.4.1</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>MACHINE</type>
                                            <uuid>fe05aed5-2288-4de8-bf6d-6f6973309112</uuid>
                                            <version>
                                                <componentUuid>ad4e3a83-7698-4961-90ee-e98d92ce0c11</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-02-22T15:18:23Z</lastModified>
                                                <versionUuid>61800c4a-f5ee-4db2-9806-06f2a0d6f767</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>ETL</machineWorkSettingType>
                                    <name>(Generic) Normalization</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;var-def name="enableDateConversion"&gt;{{enable_date_conversion}}&lt;/var-def&gt;
    &lt;var-def name="todayReference"&gt;{{convert_relative_dates_based_on}}&lt;/var-def&gt;
    &lt;var-def name="todayField"&gt;{{today_field}}&lt;/var-def&gt;
    &lt;var-def name="enableNumberConversion"&gt;{{enable_number_conversion}}&lt;/var-def&gt;
    &lt;var-def name="enablePercentConversion"&gt;{{enable_percent_conversion}}&lt;/var-def&gt;
    &lt;var-def name="enablePriceConversion"&gt;{{enable_price_conversion}}&lt;/var-def&gt;
    &lt;var-def name="enableDictionaryBasedConversion"&gt;{{enable_dictionary_based_conversion}}&lt;/var-def&gt;
    &lt;var-def name="date_format"&gt;{{date_format}}&lt;/var-def&gt;
    &lt;var-def name="enableJsonConversion"&gt;true&lt;/var-def&gt;

    &lt;script&gt;
        &lt;![CDATA[
            Boolean isIe =_sys_model_type.toString().equals("ie");
        ]]&gt;
    &lt;/script&gt;

    &lt;case&gt;
        &lt;if condition='${isIe}'&gt;
            &lt;script&gt;
                &lt;![CDATA[
                import com.freedomoss.crowdcontrol.webharvest.RunDto;
                import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
                import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
                import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;
                import java.text.SimpleDateFormat;
                import com.google.common.base.Joiner;
                import org.apache.commons.lang3.StringUtils;

                import org.slf4j.Logger;
                import org.slf4j.LoggerFactory;
                Logger logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");


                RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
                AutomationInfoDto automationInfo = run.automationInfo;
                boolean isAutomationInfoExists = automationInfo != null;
                String correctionsDS = !isAutomationInfoExists ? "" : "Corrections_" + automationInfo.originalCampaignUuid.replace("-", "_");

                ]]&gt;
            &lt;/script&gt;

            &lt;script&gt;
                &lt;![CDATA[

                List dateTagTypeList = new ArrayList();
                List numberTagTypeList = new ArrayList();
                List priceTagTypeList = new ArrayList();
                List selectTagTypeList = new ArrayList();
                List percentTagList = new ArrayList();
                List otherTagTypeList = new ArrayList();

                Map dictionaries = new HashMap();

                String groupAnswerCode = null;
                List jsonNumberFields = new ArrayList();
                List jsonDateFields = new ArrayList();
                List jsonPriceFields = new ArrayList();
                List jsonPercentFields = new ArrayList();

                if (isAutomationInfoExists) {
                    for (AnswerInfoDTO answer : run.automationInfo.answers) {
                        if ("INFO_EXTRACTION".equals(answer.getAnswerType())) {
                            for (AnswerInfoDTO subAnswer : answer.getSubAnswers()) {
                                String subAnswerType = subAnswer.getAnswerType();
                                String subAnswerCode = subAnswer.getAnswerCode();
                                if ("GROUP".equals(subAnswerType)) { // init data for json converter
                                    groupAnswerCode = subAnswerCode;
                                    for (AnswerInfoDTO groupSubAnswer : subAnswer.getSubAnswers()) {
                                        String groupSubAnswerType = groupSubAnswer.getAnswerType();
                                        String groupSubAnswerCode = groupSubAnswer.getAnswerCode();
                                        if ("DATE".equals(groupSubAnswerType) || "SELECT_DATE".equals(groupSubAnswerType)) {
                                            jsonDateFields.add(groupSubAnswerCode);
                                        } else if ("NUMBER".equals(groupSubAnswerType)) {
                                            jsonNumberFields.add(groupSubAnswerCode);
                                        } else if ("PERCENT".equals(groupSubAnswerType)) {
                                            jsonPercentFields.add(groupSubAnswerCode);
                                        } else if ("PRICE".equals(groupSubAnswerType)) {
                                            jsonPriceFields.add(groupSubAnswerCode);
                                        }

                                    }
                                    logger.info("number fields: " + jsonNumberFields);
                                    logger.info("date fields: " + jsonDateFields);
                                    logger.info("price fields: " + jsonPriceFields);
                                    logger.info("percent fields: " + jsonPercentFields);

                                } else if ("DATE".equals(subAnswerType) || "SELECT_DATE".equals(subAnswerType)) {
                                    dateTagTypeList.add(subAnswerCode);
                                } else if ("NUMBER".equals(subAnswerType)) {
                                    numberTagTypeList.add(subAnswerCode);
                                } else if ("PERCENT".equals(subAnswerType)) {
                                    percentTagList.add(subAnswerCode);
                                } else if ("PRICE".equals(subAnswerType)) {
                                    priceTagTypeList.add(subAnswerCode);
                                } else if("SELECT_ONE".equals(subAnswerType) || "CHECK_ONE".equals(subAnswerType)){
                                    selectTagTypeList.add(subAnswerCode);
                                    Map dictionary = subAnswer.getOptionsMap();
                                    dictionaries.put(subAnswerCode, dictionary);
                                } else {
                                    otherTagTypeList.add(subAnswerCode);
                                }
                            }
                            break;
                        }
                    }
                }
                String currentDate = null;
                if(enablePercentConversion.toBoolean()){
                     if ("field_value".equals(todayReference.toString())) {
                        if (sys.isVariableDefined(todayField.toString()) &amp;&amp; !sys.getVar(todayField.toString()).toString().trim().isEmpty()) {
                            currentDate = sys.getVar(todayField.toString()).toString();
                            if (currentDate.contains(" ")) {
                                currentDate = currentDate.split("\\s")[0];
                            }
                        }
                    } else {
                            SimpleDateFormat dateFormat = new SimpleDateFormat(sys.getVar("date_format").toString());
                            currentDate = dateFormat.format(new Date());
                    }
                }

                List tags = Arrays.asList(_sys_automation_ie_fields.toString().split(","));

                Map fieldsMap = new HashMap();

                for (int i = 0; i &lt; tags.size(); i++) {
                    String tagName = tags.get(i).toString();
                    if (sys.isVariableDefined(tagName) &amp;&amp; !sys.getVar(tagName).toString().isEmpty()) {
                        String extractedTagValue = sys.getVar(tagName).toString();
                        fieldsMap.put(tagName, extractedTagValue);
                    }
                }

                logger.info("Fields to normalize: " + fieldsMap);
                sys.defineVariable("extractedFieldNameListVar", new ArrayList(fieldsMap.keySet()));
                sys.defineVariable("tagNamesListVar", tags);


                boolean isFetchCorrections = isAutomationInfoExists &amp;&amp; !fieldsMap.isEmpty();

                String prepareCorrectionDsSql() {

                    String sql = "select * from @this ";
                    if (!fieldsMap.isEmpty()) {

                        sql += "where ";

                        int i = 0;
                        for (Object pairObj : fieldsMap.entrySet()) {

                            Map.Entry pair = (Map.Entry) pairObj;

                            String answerCode = pair.getKey().toString();
                            String currentValue = pair.getValue().toString();
                            currentValue = currentValue.replace("'", "''"); //escape

                            if (i &gt; 0) {
                                sql += " or ";
                            }

                            sql += "(answerCode='" + answerCode + "' and originalValue='" + currentValue + "')";
                            i++;
                        }
                    }
                    return sql + ";";
                }

                boolean hasConversionErrors = false;
                ]]&gt;
            &lt;/script&gt;


            &lt;case&gt;
                &lt;if condition='${isFetchCorrections}' &gt;

                    &lt;script&gt;
                        &lt;![CDATA[
                        boolean isCorrectDsProcessed = true;
                        String prepareCheckCorrectionDsExistSql() {
                            return "select * from @this LIMIT 1;";
                        }
                        ]]&gt;
                    &lt;/script&gt;

                    &lt;try&gt;
                        &lt;body&gt;
                            &lt;datastore name="${correctionsDS}"&gt;
                                &lt;script return="prepareCheckCorrectionDsExistSql()"/&gt;
                            &lt;/datastore&gt;
                        &lt;/body&gt;
                        &lt;catch&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                isCorrectDsProcessed = false;
                                logger.error("Could not process sql script on ds '" + correctionsDS + "'");
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/catch&gt;
                    &lt;/try&gt;

                    &lt;case&gt;
                        &lt;if condition="${isCorrectDsProcessed}"&gt;
                            &lt;loop item="row"&gt;
                                &lt;list&gt;
                                    &lt;datastore name="${correctionsDS}"&gt;
                                        &lt;script return="prepareCorrectionDsSql()"/&gt;
                                    &lt;/datastore&gt;
                                &lt;/list&gt;
                                &lt;body&gt;
                                    &lt;script&gt;
                                        &lt;![CDATA[
                                        String answerCode = row.get("answerCode").toString();
                                        String originalValue = row.get("originalValue").toString();
                                        String correctedValue = row.get("correctedValue").toString();

                                        String currentValue = fieldsMap.get(answerCode).toString();
                                        if (originalValue.equals(currentValue)) {
                                            fieldsMap.put(answerCode, correctedValue);
                                        }
                                        ]]&gt;
                                    &lt;/script&gt;
                                &lt;/body&gt;
                            &lt;/loop&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                &lt;/if&gt;
            &lt;/case&gt;

            &lt;loop item="extractedFieldName"&gt;
                &lt;list&gt;
                    &lt;var name="extractedFieldNameListVar"/&gt;
                &lt;/list&gt;
                &lt;body&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enablePercentConversion.toBoolean() &amp;amp;&amp;amp; percentTagList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="percent_converted"&gt;
                                &lt;convert-percent on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-percent&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String percentConverted = percent_converted.toString();
                                fieldsMap.put(fieldName, percentConverted);
                                if (percentConverted == null || percentConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableDateConversion.toBoolean() &amp;amp;&amp;amp; dateTagTypeList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="date_converted"&gt;
                                &lt;convert-date output-format="${date_format}" current-date='${"${" + "currentDate" + "}"}' on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-date&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String dateConverted = date_converted.toString();
                                fieldsMap.put(fieldName, dateConverted);
                                if (dateConverted == null || dateConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableNumberConversion.toBoolean() &amp;amp;&amp;amp; numberTagTypeList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="number_converted"&gt;
                                &lt;convert-number output-format="{{number_format}}" on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-number&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String numberConverted = number_converted.toString();
                                fieldsMap.put(fieldName, numberConverted);
                                if (numberConverted == null || numberConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enablePriceConversion.toBoolean() &amp;amp;&amp;amp; priceTagTypeList.contains(extractedFieldName.toString())" + "}"}'&gt;
                            &lt;var-def name="price_converted"&gt;
                                &lt;convert-price output-format="{{price_format}}" default-currency="{{default_currency}}" on-error="EMPTY_VALUE"&gt;
                                    &lt;template&gt;${"${" + "fieldsMap.get(extractedFieldName.toString())" + "}"}&lt;/template&gt;
                                &lt;/convert-price&gt;
                            &lt;/var-def&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String priceConverted = price_converted.toString();
                                String extractedValue = fieldsMap.get(fieldName);
                                if (priceConverted.contains(":")) {
                                    String[] splittedPrice = priceConverted.split(":");
                                    String priceCurrency = splittedPrice[0];
                                    String priceValue = splittedPrice[1];
                                    extractedValue = priceValue;
                                    if (priceCurrency != null &amp;&amp; !priceCurrency.isEmpty()) {
                                        // if amount contains currency -&gt; always replace 'currency' field by amount's currency
                                        fieldsMap.put("currency", priceCurrency);
                                    }
                                }
                                fieldsMap.put(fieldName, priceConverted);
                                if (priceConverted == null || priceConverted.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableDictionaryBasedConversion.toBoolean() &amp;amp;&amp;amp; selectTagTypeList.contains(extractedFieldName.toString())"+ "}"}'&gt;
                            &lt;script&gt;
                                &lt;![CDATA[
                                String fieldName = extractedFieldName.toString();
                                String extractedValue = fieldsMap.get(fieldName);
                                Map dictionary = dictionaries.get(fieldName);
                                if (dictionary != null) {
                                    String value = dictionary.get(extractedValue.trim().toLowerCase());
                                    extractedValue = value;
                                }
                                fieldsMap.put(fieldName, extractedValue);
                                if (extractedValue == null || extractedValue.isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                    &lt;case&gt;
                        &lt;if condition='${"${" + "enableJsonConversion.toBoolean() &amp;amp;&amp;amp; extractedFieldName.toString().equals(groupAnswerCode)" + "}"}'&gt;

                            &lt;var-def name="json_converted"&gt;

                                &lt;convert-json value='${"${" + "fieldsMap.get(groupAnswerCode)" + "}"}' on-error="EMPTY_VALUE"&gt;
                                    &lt;convert-number output-format="{{number_format}}" on-error="EMPTY_VALUE"
                                                    for='${"${" + "Joiner.on(\",\").join(jsonNumberFields)" + "}"}'/&gt;
                                    &lt;convert-date output-format="${date_format}" current-date='${"${" + "currentDate" + "}"}' on-error="EMPTY_VALUE"
                                                  for='${"${" + "Joiner.on(\",\").join(jsonDateFields)" + "}"}'/&gt;
                                    &lt;convert-price output-format="{{price_format}}" default-currency="{{default_currency}}"
                                                   for='${"${" + "Joiner.on(\",\").join(jsonPriceFields)" + "}"}'/&gt;
                                    &lt;convert-percent on-error="EMPTY_VALUE" for='${"${" + "Joiner.on(\",\").join(jsonPercentFields)" + "}"}'/&gt;
                                &lt;/convert-json&gt;

                            &lt;/var-def&gt;

                            &lt;script&gt;
                                &lt;![CDATA[
                                fieldsMap.put(groupAnswerCode, json_converted.toString());
                                if (json_converted.toString().isEmpty()) {
                                    hasConversionErrors = true;
                                }
                                ]]&gt;
                            &lt;/script&gt;
                        &lt;/if&gt;
                    &lt;/case&gt;
                &lt;/body&gt;
            &lt;/loop&gt;

            &lt;export include-original-data="true"&gt;
                &lt;loop item="extractedFieldNameVar"&gt;
                    &lt;list&gt;
                        &lt;var name="tagNamesListVar"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;single-column name='${"${" +"extractedFieldNameVar" + "}"}'
                                       value='${"${" + "fieldsMap.get(extractedFieldNameVar.toString())" + "}"}'/&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
                &lt;single-column name='_sys_has_conversion_errors' value='${"${" +"hasConversionErrors" + "}"}'/&gt;
            &lt;/export&gt;
        &lt;/if&gt;
        &lt;else&gt;
            &lt;export include-original-data="true"&gt;
                &lt;single-column name='_sys_has_conversion_errors' value='false'/&gt;
            &lt;/export&gt;
        &lt;/else&gt;
    &lt;/case&gt;
&lt;/config&gt;
</content>
                                        <name>(Generic) Normalization 8.4.4.1</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>MACHINE</type>
                                        <uuid>9662dcdc-7865-4ebe-9db6-305e108bff65</uuid>
                                        <version>
                                            <componentUuid>dfa42a8d-5fc4-450d-921f-c477f72a3218</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <versionUuid>20ce7a15-ddcf-4fc2-b417-86aa7ee674d3</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>e1e5511a-4549-4641-b746-9ea7f25970b6</uuid>
                                    <version>
                                        <componentUuid>caade058-fa0c-4c40-9fda-41a7147e021c</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>6462cd60-75d8-41c4-9d7d-966637b05957</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>(Generic) Normalization</title>
                                <type>SINGLE</type>
                                <uuid>fd784536-e9e2-46fd-8f5c-18d2d47e83c9</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>ea9431c3-9ba9-4bc1-9871-149d4c2b9581</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>040f7038-6c95-44df-8662-51e03669aaf6</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>77</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>ebdc27fd-f356-458b-96c1-8f844e94b72a</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params

rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end


rule "1. Send records to 'Batch accepted' when _sys_sqc_batch_status EQ 'ACCEPTED'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_batch_status", "EQ", "ACCEPTED"));
    then
        $ctx.sendResultTo("Batch accepted", $item);
end


rule "2. Send records to 'Batch rejected' when _sys_sqc_batch_status EQ 'REJECTED'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_batch_status", "EQ", "REJECTED"));
    then
        foreach (name : $item.getNotToCheckValue("_sys_automation_ie_fields").split(",")) {
           $ctx.renameAnswerItem($item, name, name + "_ml_extracted");
        }
        $ctx.sendResultTo("Batch rejected", $item);
end

rule "3. Send records to 'Batch expired' when _sys_sqc_batch_status EQ 'EXPIRED'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_batch_status", "EQ", "EXPIRED"));
    then
        foreach (name : $item.getNotToCheckValue("_sys_automation_ie_fields").split(",")) {
           $ctx.renameAnswerItem($item, name, name + "_ml_extracted");
        }
        $ctx.sendResultTo("Batch expired", $item);
end


rule "4. Send records to 'Additional sample required' when _sys_sqc_batch_status EQ 'ADDITIONAL_SAMPLE_REQUIRED'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("_sys_sqc_batch_status", "EQ", "ADDITIONAL_SAMPLE_REQUIRED"));
    then
		$ctx.renameAnswerItem($item, "_sys_sqc_inspection", "_sys_sqc_inspection_required");
        foreach (name : $item.getNotToCheckValue("_sys_automation_ie_fields").split(",")) {
           $ctx.renameAnswerItem($item, name, name + "_ml_extracted");
        }
        $ctx.sendResultTo("Additional sample required", $item);
end
</content>
                                <name>Check batch status</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>2923bdc9-fb64-4786-9d24-8af8050a9c0f</uuid>
                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;script&gt;
        &lt;![CDATA[
        import com.freedomoss.requester.service.sqc.SqcService;
        import com.freedomoss.spring.ApplicationContextProvider;

        String batchUuid = _sys_sqc_batch_uuid.toString();

        SqcService sqcService = ApplicationContextProvider.getContext().getBean(SqcService.class);

        String batchStatus = sqcService.getBatchStatus(batchUuid);
        if (batchStatus == null || "".equals(batchStatus)){
            throw new Exception("Batch status is invalid");
        }
        boolean tryAgainThisStep = "IN_PROGRESS".equals(batchStatus);
        ]]&gt;
    &lt;/script&gt;
    &lt;case&gt;
        &lt;if condition="${!tryAgainThisStep}"&gt;
            &lt;export include-original-data="true"&gt;
                &lt;single-column name="_sys_sqc_batch_status" value='${batchStatus}'/&gt;
            &lt;/export&gt;
        &lt;/if&gt;
    &lt;/case&gt;

&lt;/config&gt;
</content>
                                    <includedConfigs/>
                                    <inclusionCode>559f8c04-5603-4307-8df2-6230485eff33</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Wait for Inspection Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>559f8c04-5603-4307-8df2-6230485eff33</uuid>
                                    <version>
                                        <componentUuid>22de278e-5b5f-4622-b484-d3d8a3a7dd1e</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>dc6a99ea-e223-4c22-8bbc-6068027f00c3</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Wait for Inspection Results</title>
                                <type>SINGLE</type>
                                <uuid>a6270d1b-5132-4a6a-b930-777b0ab35be1</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>e2c78ce5-f3ea-4bee-82c9-ecf32ee58e15</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>693cdbae-9162-4b44-ad5e-04afce8b08d2</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>78</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>6796538f-b80c-4331-a870-0f4339c7724f</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>98e009cf-d772-44db-8e36-6b6ed4905daa</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"&gt;

    &lt;script language="groovy"&gt;&lt;![CDATA[
        import org.apache.commons.lang3.BooleanUtils;
        import org.webharvest.runtime.variables.NodeVariable;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;

        import org.apache.commons.codec.binary.Base64;
        import org.springframework.http.*;
        import org.springframework.web.client.*;
        import org.springframework.web.util.UriComponentsBuilder;
        import com.google.gson.*;
        import com.google.gson.reflect.TypeToken;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        import org.springframework.web.client.HttpClientErrorException;
        import org.springframework.http.HttpStatus;

        logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
        experimentId = item.wrappedObject.run.automationInfo.experimentId;
        experimentGroup = item.wrappedObject.run.automationInfo.experimentGroup;

        def addAuthorizationHeaders(HttpHeaders headers) {
            String plainCreds = "${wfbiUser}:${wfbiPassword}";
            byte[] plainCredsBytes = plainCreds.getBytes();
            byte[] base64CredsBytes = Base64.encodeBase64(plainCredsBytes);
            String base64Creds = new String(base64CredsBytes);
            headers.add("Authorization", "Basic " + base64Creds);
        }

        def HttpEntity&lt;?&gt; acceptJsonEntity(body) {
            HttpHeaders headers = new HttpHeaders();
            headers.set("Accept", MediaType.APPLICATION_JSON_VALUE);
            headers.set("Content-Type", MediaType.APPLICATION_JSON_VALUE);
            addAuthorizationHeaders(headers);
            if (body == null) {
                return new HttpEntity(headers);
            } else {
                return new HttpEntity(new Gson().toJson(body), headers);
            }
        }

        restTemplate = new RestTemplate();

        def checkNewPrAvailable(automationInfo) {
			log.error("checkNewPrAvailable method");
            def checkUrl = "${wfbiUrl}/tableau/new-curve/check";
            URI uri = UriComponentsBuilder.fromHttpUrl(checkUrl)
                    .queryParam("experiment_name", experimentId)
                    .queryParam("experiment_group", experimentGroup).build().toUri();
            logger.debug("Checking new PR API is avaialble via {}", uri);
            try {
                HttpEntity&lt;Boolean&gt; response = restTemplate.exchange(uri, HttpMethod.GET, acceptJsonEntity(), Boolean.class);
                def res = response.getBody();
                logger.debug("New PR available : {}", res);
                return res;
            } catch (HttpClientErrorException ex) {
				log.error("checkNewPrAvailable method failed");
                if (ex.getStatusCode() == HttpStatus.NOT_FOUND) {
                    logger.warn("WFBI PR check service is not available");
                    return false;
                } else {
                    throw ex;
                }
            }
        }

        def createAccuracyCheckRequestBody(automationInfo, tags) {
            def tagScores = [];
            for (Map tagInfo : tags) {
                String tag = tagInfo.get("tag");
                String score = tagInfo.get("score");
                tagScores &lt;&lt; [name: tag, score: score];
            }
            return [
                    experimentGroup: experimentGroup,
                    experimentName: experimentId,
                    perDocAccuracyLimit: automationInfo.getTargetQuality(),
                    fieldResults: tagScores
            ]
        }

        def callCheckAccuracyAPI(automationInfo, tags) {
			log.error("callCheckAccuracyAPI method");
            Map res = null;
            def calculateUrl = "${wfbiUrl}/pr/check-extraction";
            URI uri = UriComponentsBuilder.fromHttpUrl(calculateUrl).build().toUri();
            def bodyMap = createAccuracyCheckRequestBody(automationInfo, tags);
            logger.debug("Checking accuracy via {} with request {}", uri, bodyMap);
            HttpEntity&lt;Map&gt; response = restTemplate.exchange(uri, HttpMethod.POST, acceptJsonEntity(bodyMap), Map.class);
            return response.getBody();
        }

        //true - success, false - partial/failure, null - use previous classifier
        def checkExtractionAccuracy(automationInfo, tags) {
			log.error("checkExtractionAccuracy method");
            Boolean res = null;
            if (checkNewPrAvailable(automationInfo)) {
                def checkResults = callCheckAccuracyAPI(automationInfo, tags);
				log.error("callCheckAccuracyAPI finished");
                logger.debug("Check results {}", checkResults);
                if (checkResults != null) {
                    res = checkResults.get("passed");
                }
            } else {
                logger.debug("New PR is unavailable for experiment {}", experimentId);
            }
            return res;
        }

        accuracyChecker = {automationInfo, tags -&gt; checkExtractionAccuracy(automationInfo, tags)};

        ]]&gt;&lt;/script&gt;

    &lt;script language="groovy"&gt;&lt;![CDATA[
        import org.apache.commons.validator.routines.RegexValidator;
        import org.apache.commons.validator.routines.UrlValidator;
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.crowdcontrol.webharvest.nlp.AnswerCompareUtils;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;
        import com.freedomoss.workfusion.utils.gson.GsonUtils;
        import com.google.gson.Gson;
        import com.google.gson.GsonBuilder;
        import org.apache.commons.lang3.StringEscapeUtils;
        import org.apache.commons.math3.util.Precision;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        //for s3 private bucket
        import org.apache.http.client.methods.CloseableHttpResponse;
        import org.apache.http.client.methods.HttpHead;
        import org.apache.http.impl.client.CloseableHttpClient;
        import org.apache.http.impl.client.HttpClients;
        import org.apache.http.util.EntityUtils;
        import com.freedomoss.appliance.impl.S3SecuredDocumentsHandler;
        import com.freedomoss.spring.ApplicationContextProvider;
        // gold input data processing
		import com.freedomoss.requester.util.extraction.TextAggregationProcessor;
		import com.freedomoss.requester.util.extraction.TagRecord;

        logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
        GSON_WITHOUT_HTML_ESCAPING = new GsonBuilder().disableHtmlEscaping().create();
        run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        automationInfo = run.automationInfo;

        SUCCESS = "success";
        FAILURE = "failure";
        PARTIAL_SUCCESS = "partial_success";

        MODEL_TYPE_IE = "ie";
        MODEL_TYPE_CLASSIFICATION = "classification";

        MULTI_VALUE_SEPARATOR = "|";

        String getUrlContents(String urlToLoad, String boilerPipeExtractor) {
            StringBuilder content = new StringBuilder();
            if (checkIfS3PrivateBucket(urlToLoad)) {
                S3SecuredDocumentsHandler documentsHandler = ApplicationContextProvider.getContext().getBean(S3SecuredDocumentsHandler.class);
                urlToLoad = documentsHandler.generatePreSignedLink(urlToLoad, 60).toString();
            }
            try {
                String workfusionHost = applicationHost.toString();
                String workfusionUrl = applicationContextPath.toString();
                StringBuilder urlBuilder = new StringBuilder();
                urlBuilder
                        .append(workfusionHost)
                        .append(workfusionUrl)
                        .append("/public/getRemoteContent?extractor=")
                        .append(boilerPipeExtractor)
                        .append("&amp;url=")
                        .append(URLEncoder.encode(urlToLoad, "UTF-8").replaceAll("'", "%27").replaceAll("\"", "%22"));

                URL url = new URL(urlBuilder.toString());
                URLConnection urlConnection = url.openConnection();
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(urlConnection.getInputStream()));
                String line;
                while ((line = bufferedReader.readLine()) != null) {
                    content.append(line + "\n");
                }
                bufferedReader.close();
            }
            catch (Exception e) {
                e.printStackTrace();
            }
            return content.toString();
        }

        boolean checkIfS3PrivateBucket(String url) {
            CloseableHttpClient httpclient = null;
            CloseableHttpResponse response = null;
            try {
                httpclient = HttpClients.createDefault();
                HttpHead httpHead = new HttpHead(url.replaceAll("\\s+","%20"));
                response = httpclient.execute(httpHead);
                int statusCode = response.getStatusLine().getStatusCode();
                // do something useful with the response body
                // and ensure it is fully consumed
                EntityUtils.consume(response.getEntity());
                return statusCode == 403;
            } finally {
                if (response != null) {
                    response.close();
                }
                if (httpclient != null) {
                    httpclient.close();
                }
            }
        }

        String getDocumentVariableName(RunDto run) {
            // get name of variable with document content or url. Should be equals to nswer code if mapping not provided
            // check columns mapping in case when answer code mapped to another column
            String documentVariableName = null;

            String originalCampaignUuid = automationInfo.originalCampaignUuid;
            if (MODEL_TYPE_IE.equals(_sys_model_type.toString())) {
                documentVariableName = _sys_automation_ie_answer_code.toString();
            } else {
                documentVariableName = _sys_automation_text_answer_code.toString();
            }
            logger.info("documentVariableName =  " + documentVariableName + ". RunUUID: " + run.getUuid());
            try {
                Map mapping = run.getCampaignMapping(originalCampaignUuid).get(originalCampaignUuid);
                if (mapping != null) {
                    for (Map.Entry entry : mapping.entrySet()) {
                        if (documentVariableName.equals(entry.getValue())) {
                            documentVariableName = entry.getKey();
                            break;
                        }
                    }
                }
            } catch (Exception ignored) {
            }
            logger.info("new documentVariableName =  " + documentVariableName + ". RunUUID: " + run.getUuid());
            return documentVariableName;
        }

        boolean isUrlToDocument(String document) {
            String[] schemes = ["http", "https" ];
            RegexValidator authorityValidator = new RegexValidator("^([\\p{Alnum}\\-\\.]*)(:\\d*)?(.*)?");
            UrlValidator urlValidator = new UrlValidator(schemes, authorityValidator, UrlValidator.ALLOW_LOCAL_URLS);
            return urlValidator.isValid(document.replaceAll("\\s+","%20"));
        }

        String getBoilerpipeExtractorType(RunDto run) {
            AutomationInfoDto automationInfo = run.automationInfo;
            List answers = automationInfo.getAnswers();
            String IE_EXTRACTOR_TYPE_OPTION = "ieExtractorType";
            String extractor = "KEEP_EVERYTHING_EXTRACTOR";
            for (AnswerInfoDTO answerDto : answers) {
                if ("INFO_EXTRACTION".equals(answerDto.getAnswerType())) {
                    String options = answerDto.getOptions();
                    Map optionsMap = GSON_WITHOUT_HTML_ESCAPING.fromJson(options, Map.class);
                    extractor = optionsMap.get(IE_EXTRACTOR_TYPE_OPTION);
                    break;
                }
            }
            return extractor;
        }

        String getDocumentContent(RunDto run) {
            String documentVariableName = getDocumentVariableName(run);
            if(sys.getVar(documentVariableName)== null){
                logger.warn("Column with name: " + documentVariableName + " is not presenting in input data");
                throw new RuntimeException("Column with name: " + documentVariableName + " is not presenting in input data");
            }
            String document = sys.getVar(documentVariableName).getWrappedObject();
            //if the document behind the URL - fetch the content
            if (isUrlToDocument(document)) {
                logger.info("WFML Document loading from url : " + document);
                String extractor = getBoilerpipeExtractorType(run);
                logger.info("WFML boilerpipe extractor : " + extractor);
                document = getUrlContents(document, extractor);
                if (document.isEmpty()) {
                    logger.info("WFML Document is not loaded from url");
                } else {
                    logger.info("WFML Document loaded from url.");
                }
            }

            String documentUnescapeXml = StringEscapeUtils.unescapeXml(document);
            return documentUnescapeXml;
        }

        String createDocumentJson(String documentContent) {
            Map map2Json = new HashMap();
            List list2Json = new ArrayList();
            list2Json.add(documentContent);
            map2Json.put("textParts", list2Json);
            String documentJson = GSON_WITHOUT_HTML_ESCAPING.toJson(map2Json);
            return documentJson;
        }

/* -----------------------------------------------------------------------------------------------------
    BEGIN OF IE SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */

        def putOrConcatValueToMap(Map map, String key, String value) {
            if (map.containsKey(key)) {
                map.put(key, map.get(key) + MULTI_VALUE_SEPARATOR + value);
            } else {
                map.put(key, value);
            }
        }

        Map createTagValueMap(tagList) {
            Map res = new HashMap();
            for (Map tagInfo : tagList) {
                String tag = tagInfo.get("tag");
                String text = tagInfo.get("text");
                putOrConcatValueToMap(res, tag, text);
            }
            return res;
        }

        AnswerInfoDTO findIeAnswer(List answers) {
            for (AnswerInfoDTO answer : answers) {
                if (answer.answerType.equals("INFO_EXTRACTION")) {
                    return answer;
                }
                if (answer.subAnswers != null &amp;&amp; !answer.subAnswers.isEmpty()) {
                    AnswerInfoDTO ieAnswer = findIeAnswer(answer.subAnswers);
                    if (ieAnswer != null) {
                        return ieAnswer;
                    }
                }
            }
            return null;
        }

        List&lt;String&gt; getSubAnswerCodesForGroupAnswer(){
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            List&lt;String&gt; subGroupAnswersCodes = new ArrayList&lt;String&gt;();
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    ieAnswerCode = ieAnswer.answerCode;
                    for (AnswerInfoDTO subAnswer : ieAnswer.subAnswers) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            for (AnswerInfoDTO subAnswerForGroup : subAnswer.subAnswers) {
                                subGroupAnswersCodes.add(subAnswerForGroup.answerCode);
                            }
                        }
                    }
                }
            }
            logger.info("subGroupAnswersCodes: " + subGroupAnswersCodes);
            return subGroupAnswersCodes;
        }

        boolean processExtractionResultNoAdvancedCalibrationIE(Map resultMap, List requiredFieldList) {
            boolean res = true;
            List tagList = resultMap.get("tags");
            Map tagValues;
            String groupAnswerCode = _sys_automation_relations_subanswer_code.toString();
            boolean isAllGroupAnswersExtractedSuccessful = true;
            if (groupAnswerCode == null || groupAnswerCode.isEmpty()) {
                tagValues = createTagValueMap(tagList);
				log.error("processExtractionResultNoAdvancedCalibrationIE additionalLog in if clause")
            } else {
                tagValues = new HashMap&lt;String,String&gt;();
                Map&lt;String, Map&lt;String, String&gt;&gt; indexGroupMap = new HashMap&lt;String, Map&lt;String, String&gt;&gt;();
                for (Map tagInfo : tagList) {
                    String tag = tagInfo.get("tag");
                    String text = tagInfo.get("text");
                    String tabnumber = tagInfo.get("tabnumber");
                    if(tabnumber != null){
                        List&lt;String&gt; subGroupAnswersCodes = getSubAnswerCodesForGroupAnswer();
                        if (subGroupAnswersCodes.contains(tag)){
                            Map&lt;String, String&gt; groupAnswersMap = indexGroupMap.get(tabnumber);
                            if(groupAnswersMap != null){
                                groupAnswersMap.put(tag,text);
                            } else {
                                groupAnswersMap = new HashMap&lt;&gt;();
                                groupAnswersMap.put(tag,text);
                                groupAnswersMap.put("tabnumber", tabnumber);
                                indexGroupMap.put(tabnumber, groupAnswersMap);
                            }
                        } else {
                            putOrConcatValueToMap(tagValues, tag, text);
                        }
                    } else {
                        putOrConcatValueToMap(tagValues, tag, text);
                    }
                }
				log.error("processExtractionResultNoAdvancedCalibrationIE additionalLog in else clause")
                if (!indexGroupMap.isEmpty()){
                    List values  = new ArrayList(indexGroupMap.values());
                    Map wrappedTagJsonMap = new HashMap();
                    wrappedTagJsonMap.put(groupAnswerCode, values);
                    String wrappedTagJson = GSON_WITHOUT_HTML_ESCAPING.toJson(wrappedTagJsonMap);
                    tagValues.put(groupAnswerCode, wrappedTagJson);
                    
                    //check is all required fields extracted for group answer
                    log.error("check is all required fields extracted for group answer")
                    for (AnswerInfoDTO answer : automationInfo.answers) {
                        if (answer.answerType.equals("INFO_EXTRACTION")) {
                            for (AnswerInfoDTO subAnswer : answer.subAnswers) {
                                if ("GROUP".equals(subAnswer.answerType)) {
                                	log.error("subAnswer.getSubAnswers() = " + subAnswer.getSubAnswers())
                                	log.error("wrappedTagJson = " + wrappedTagJson)
                                    isAllGroupAnswersExtractedSuccessful = AnswerCompareUtils.isAllRequiredFieldsExtracted(wrappedTagJson, subAnswer);
                                    log.error("isAllGroupAnswersExtractedSuccessful = " + isAllGroupAnswersExtractedSuccessful)
                                    if (!isAllGroupAnswersExtractedSuccessful) {
                                    	resultMap.put("tagValueMap", tagValues);
                                        resultMap.get("automationExtractStatusReason").append(" isExtractSuccessful = false because not all required values extracted for group answer.");
                                        resultMap.put("automationExtractStatus", "partial_success");
                                        return false;
                                    }
                                }

                            }
                        }
                    }
                }
            }
            resultMap.put("tagValueMap", tagValues);
            String requiredFieldCheckMsg = checkRequiredFieldsAnswered(tagList, requiredFieldList);
            if (requiredFieldCheckMsg != null) {
                resultMap.get("automationExtractStatusReason").append(requiredFieldCheckMsg);
                resultMap.put("automationExtractStatus", "partial_success");
                return false;
            }
			log.error("call AccuracyChecker");
            Boolean checked = accuracyChecker(automationInfo, tagList);
            if (checked != null) {
                resultMap.get("automationExtractStatusReason").append(" Extraction accuracy check via WFBI API result : ").append(checked);
                if (checked) {
                    resultMap.put("automationExtractStatus", "success");
                } else {
                    resultMap.put("automationExtractStatus", "failure");
                }
                return checked;
            }
            Double estimatedAccuracy;
            if (resultMap.get("estimatedAccuracy") == null) {
                logger.info("VDS return estimatedAccuracy = null. Used default value = 0");
                estimatedAccuracy = 0;
            } else {
                estimatedAccuracy = resultMap.get("estimatedAccuracy");
            }
            Double automationThreadhold = Double.valueOf(automationInfo.targetQuality);
            String automationExtractStatus;
            if (estimatedAccuracy.compareTo(automationThreadhold) &lt; 0) {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &lt; Automation threadhold.");
                automationExtractStatus = "failure";
                res = false;
            } else {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &gt;= Automation threadhold.");
                automationExtractStatus = "success";
            }
            resultMap.put("automationExtractStatus", automationExtractStatus);
            return res;
        }

        void processAutomationExtractStatus(boolean isExtractSuccessful, List tagList, Map resultMap) {
            String automationExtractStatus;
            if (isExtractSuccessful) {
                automationExtractStatus = SUCCESS;
            } else {
                automationExtractStatus = PARTIAL_SUCCESS;
            }
            resultMap.get("automationExtractStatusReason").append(" Use '")
                    .append(automationExtractStatus)
                    .append("' as default value for automationExtractStatus.");
            for (Map tagInfo : tagList) {
                String tag = tagInfo.get("tag");
                Double estimatedAccuracy;
                if (tagInfo.get("estimatedAccuracy") == null) {
                    logger.info("VDS return estimatedAccuracy = null for tag '" + tag + "'. Used default value = 0");
                    estimatedAccuracy = 0;
                } else {
                    estimatedAccuracy = Double.valueOf(tagInfo.get("estimatedAccuracy"));
                }
                Double automationThreadhold = null;
                if (automationInfo.getSelectedTagPrecisions().containsKey(tag)) {
                    automationThreadhold = automationInfo.getSelectedTagPrecisions().get(tag);
                } else if (automationInfo.getUnselectedTagPrecisions().containsKey(tag)) {
                    resultMap.get("automationExtractStatusReason").append(" Precision for tag '")
                            .append(tag)
                            .append("' is unselected.");
                    automationExtractStatus = FAILURE;
                    break;
                }
                if (automationThreadhold != null &amp;&amp; Precision.equals(automationThreadhold, 0d, 0.00001)) {
                    continue;
                }
                if (automationThreadhold == null || estimatedAccuracy.compareTo(automationThreadhold) &lt; 0) {
                    resultMap.get("automationExtractStatusReason").append(" AutomationThreadhold '")
                            .append(automationThreadhold)
                            .append("' is null or ~0.");
                    automationExtractStatus = FAILURE;
                    break;
                }
            }
            resultMap.put("automationExtractStatus", automationExtractStatus);
        }

        String checkRequiredFieldsAnswered(List tagList, List requiredFieldList) {
            Map tagValues = createTagValueMap(tagList);
            String res = null;
            // check are all required values extracted
            for (int i = 0; i &lt; requiredFieldList.size(); i++) {
                String requiredField = requiredFieldList.get(i);
                if (!tagValues.containsKey(requiredField)) {
                    res = " isExtractSuccessful = false because not all required values extracted. First incorrect '" + requiredField + "'";
                    break;
                }
            }
            return res;
        }

        boolean processExtractionResultAdvancedCalibration(Map resultMap, List requiredFieldList) {
            String groupAnswerCode = _sys_automation_relations_subanswer_code.toString();
            boolean isExtractSuccessful = true;
            if (groupAnswerCode == null || groupAnswerCode.isEmpty()) {
                resultMap.get("automationExtractStatusReason").append(" Process case [groupAnswerCode == null || groupAnswerCode.isEmpty()].");
                List tagList = resultMap.get("tags");
                def tagValues = createTagValueMap(tagList);
                resultMap.put("tagValueMap", tagValues);
                String requiredFieldCheckMsg = checkRequiredFieldsAnswered(tagList, requiredFieldList);
                if (requiredFieldCheckMsg != null) {
                    resultMap.get("automationExtractStatusReason").append(requiredFieldCheckMsg);
                    isExtractSuccessful = false;
                }
                processAutomationExtractStatus(isExtractSuccessful, tagList, resultMap);
            } else {
                Map nonRelationTagMap = resultMap.get("nonRelations");
                resultMap.get("automationExtractStatusReason").append(" Process case [groupAnswerCode != null and !groupAnswerCode.isEmpty()].");
                if (nonRelationTagMap != null) {
                    List tagList = nonRelationTagMap.keySet();
                    tagValueMap = resultMap.get("tagValueMap");
                    for (String tag : tagList) {
                        String tagText = nonRelationTagMap.get(tag).get("text");
                        tagValueMap.put(tag, tagText);
                    }

                    List relationTagJson = GSON_WITHOUT_HTML_ESCAPING.fromJson(resultMap.get("relationJson"), List.class);
                    Map wrappedTagJsonMap = new HashMap();
                    wrappedTagJsonMap.put(groupAnswerCode, relationTagJson);
                    String wrappedTagJson = GSON_WITHOUT_HTML_ESCAPING.toJson(wrappedTagJsonMap);
                    tagValueMap.put(groupAnswerCode, wrappedTagJson);

                    resultMap.get("automationExtractStatusReason").append(" Process case [nonRelationTagMap != null].");
                    //check is all required fields extracted for group answer
                    for (AnswerInfoDTO answer : automationInfo.answers) {
                        if (answer.answerType.equals("INFO_EXTRACTION")) {
                            for (AnswerInfoDTO subAnswer : answer.subAnswers) {
                                if ("GROUP".equals(subAnswer.answerType)) {
                                    isExtractSuccessful = AnswerCompareUtils.isAllRequiredFieldsExtracted(wrappedTagJson, subAnswer);
                                    if (isExtractSuccessful) {
                                        resultMap.get("automationExtractStatusReason").append(" isExtractSuccessful = false because not all required values extracted for group answer.");
                                        break;
                                    }
                                }

                            }
                        }
                    }
                    processAutomationExtractStatus(isExtractSuccessful, tagList, resultMap);
                }
            }
            return isExtractSuccessful;
        }

        void preprocessIE(Map resultMap) {
            sys.defineVariable("fieldList", Arrays.asList(_sys_automation_ie_fields.toString().split(",")));
            resultMap.put("tagValueMap", new HashMap());
        }

        boolean processExtractionResultsIE(Map resultMap, List requiredFieldList) {
            if (automationInfo.isAdvancedCalibration()) {
                resultMap.get("automationExtractStatusReason").append(" Process with advanced calibration.");
                return processExtractionResultAdvancedCalibration(resultMap, requiredFieldList);
            } else {
                resultMap.get("automationExtractStatusReason").append(" Process without advanced calibration.");
                return processExtractionResultNoAdvancedCalibrationIE(resultMap, requiredFieldList);
            }
        }
/* ------------------------------------------------------------------------------------------------------
    END OF IE SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */

/* -----------------------------------------------------------------------------------------------------
    BEGIN OF CLASSIFICATION SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */
        boolean processERWACSelectedTag(String tag, Double estimatedAccuracy, Map resultMap) {
            resultMap.get("automationExtractStatusReason").append(" Category '" + tag + "' is selected.");
            automationThreadhold = automationInfo.getSelectedTagPrecisions().get(tag);
            if (automationThreadhold != null &amp;&amp; Precision.equals(automationThreadhold, 0d, 0.00001)) {
                resultMap.get("automationExtractStatusReason").append(" Automation threadhold is '0'");
                return true;
            } else if (automationThreadhold == null) {
                resultMap.get("automationExtractStatusReason").append(" Automation threadhold is null.");
                return false;
            } else if (estimatedAccuracy &lt; automationThreadhold) {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &lt; Automation threadhold.");
                return false;
            } else {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &gt;= Automation threadhold.");
                return true;
            }
        }

        boolean processExtractionResultWithAdvancedCalibration(String category, Double estimatedAccuracy, Map resultMap) {
            resultMap.get("automationExtractStatusReason").append(" Process extraction result with advanced calibration.");
            String tag = "S-" + category;
            if (automationInfo.getSelectedTagPrecisions().containsKey(tag)) {
                return processERWACSelectedTag(tag, estimatedAccuracy, resultMap);
            } else if (automationInfo.getUnselectedTagPrecisions().containsKey(tag)) {
                resultMap.get("automationExtractStatusReason").append(" Category '" + tag + "' is unselected.");
                return false;
            } else {
                resultMap.get("automationExtractStatusReason").append(" Category '" + tag + "' is unknown.");
                return false;
            }
        }

        boolean processExtractionResultClassification(Map resultMap) {
            String category = resultMap.get("category");
            Double estimatedAccuracy = resultMap.get("estimatedAccuracy");
            boolean extractionSuccessful;

            if (!(category == null || category.isEmpty())) {
                if (estimatedAccuracy == null) {
                    logger.info("VDS return estimatedAccuracy = null. Used default value = 0.");
                    estimatedAccuracy = 0;
                }
                if (automationInfo.isAdvancedCalibration()) {
                    resultMap.get("automationExtractStatusReason").append(" Process with advanced calibration.");
                    extractionSuccessful = processExtractionResultWithAdvancedCalibration(category, estimatedAccuracy, resultMap);
                } else {
                    resultMap.get("automationExtractStatusReason").append(" Process without advanced calibration.");
                    Double automationThreadhold = Double.valueOf(automationInfo.targetQuality);
                    if (estimatedAccuracy &lt; automationThreadhold) {
                        resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &lt; Automation threadhold");
                        extractionSuccessful = false;
                    } else {
                        resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &gt;= Automation threadhold");
                        extractionSuccessful = true;
                    }
                }
            } else {
                extractionSuccessful = false;
            }
            resultMap.put("automationExtractStatus", extractionSuccessful ? SUCCESS : FAILURE);
            return extractionSuccessful;
        }
/* -----------------------------------------------------------------------------------------------------
    END OF CLASSIFICATION SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */

/* -----------------------------------------------------------------------------------------------------
    BEGIN OF GOLD INPUT DATA PROCESSING
------------------------------------------------------------------------------------------------------ */

        Map getSubAnswerCodeMap(){
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            Map&lt;String, List&lt;String&gt;&gt; subGroupAnswersCodes = new HashMap&lt;&gt;();
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    for (AnswerInfoDTO subAnswer : ieAnswer.getSubAnswers()) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            List&lt;String&gt; subCodes = new ArrayList&lt;&gt;();
                            for (AnswerInfoDTO subAnswerForGroup : subAnswer.subAnswers) {
                                subCodes.add(subAnswerForGroup.answerCode);
                            }
                            subGroupAnswersCodes.put(subAnswer.answerCode, subCodes);
                        }
                    }
                }
            }
            return subGroupAnswersCodes;
        }

        String getTabNumber(TagRecord tagRecord) {
            Set&lt;Integer&gt; tabNumbers = tagRecord.getTabNumbers();
            if (tabNumbers == null || tabNumbers.size() == 0) {
                return null;
            }
            for (Integer tabNumber : tabNumbers) {
                return tabNumber.toString();
            }
            return null;
        }

        boolean processGoldInputData(String modelType, String documentContent) {
            boolean isGoldInputData = false;
            if (MODEL_TYPE_IE.equals(modelType)) {
                if(TextAggregationProcessor.isTextContainsTagsExcludeHtmlOcr(documentContent)){
                    isGoldInputData = true;
                    logger.info("Used gold data: Document content is tagged");
                    List&lt;TagRecord&gt; tagRecords = TextAggregationProcessor.collectDocumentTagsExcludeHtmlOcr(documentContent);

                    Map&lt;String, List&lt;String&gt;&gt; groups = getSubAnswerCodeMap();
                    List&lt;String&gt; subGroupAnswersCodes = new ArrayList&lt;&gt;();
                    for (List&lt;String&gt; value : groups.values()) {
                        subGroupAnswersCodes.addAll(value);
                    }
                    Map&lt;String, String&gt; goldAnswerMap = new HashMap();
                    Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; answerGroupMap = new HashMap&lt;&gt;();
                    for (TagRecord tagRecord: tagRecords) {
                        String tag = tagRecord.getTagName();
                        String text = tagRecord.getText();
                        String tabNumber = getTabNumber(tagRecord);
                        if(tabNumber != null){
                            if (subGroupAnswersCodes.contains(tag)){
                                for (Map.Entry&lt;String, List&lt;String&gt;&gt; groupSet : groups.entrySet()) {
                                    if (groupSet.getValue().contains(tag)) {
                                        Map&lt;String, Map&lt;String, String&gt;&gt; tabNumberGroupMap = answerGroupMap.get(groupSet.getKey());
                                        if (tabNumberGroupMap == null) {
                                            tabNumberGroupMap = new HashMap&lt;&gt;();
                                            answerGroupMap.put(groupSet.getKey(), tabNumberGroupMap);
                                        }
                                        Map&lt;String, String&gt; groupAnswersMap = tabNumberGroupMap.get(tabNumber);
                                        if(groupAnswersMap != null){
                                            groupAnswersMap.put(tag,text);
                                        } else {
                                            groupAnswersMap = new HashMap&lt;&gt;();
                                            groupAnswersMap.put(tag,text);
                                            groupAnswersMap.put("tabnumber", tabNumber);
                                            tabNumberGroupMap.put(tabNumber, groupAnswersMap);
                                        }
                                        break;
                                    }
                                }
                            } else {
                                putOrConcatValueToMap(goldAnswerMap, tag, text);
                            }
                        } else {
                            putOrConcatValueToMap(goldAnswerMap, tag, text);
                        }
                    }
                    if (!answerGroupMap.isEmpty()) {
                        for (Map.Entry&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; entry : answerGroupMap.entrySet()) {
                            List values  = new ArrayList(entry.getValue().values());
                            Map wrappedTagJsonMap = new HashMap();
                            wrappedTagJsonMap.put(entry.getKey(), values);
                            String wrappedTagJson = GsonUtils.GSON.toJson(wrappedTagJsonMap);
                            goldAnswerMap.put(entry.getKey(), wrappedTagJson);
                        }
                    }
                    sys.defineVariable("goldAnswer", GsonUtils.GSON.toJson(goldAnswerMap, GsonUtils.TYPE_MAP_STRING_STRING));
                }
			} else if (MODEL_TYPE_CLASSIFICATION.equals(modelType)) {
			    String categoryColumn = _sys_automation_ie_answer_code.toString();
			    if (sys.getVar(categoryColumn) != null &amp;&amp; sys.getVar(categoryColumn).getWrappedObject() != null) {
                    isGoldInputData = true;
                    logger.info("Used gold data: There is gold category");
                    String goldCategory = sys.getVar(categoryColumn).getWrappedObject();
                    Map&lt;String, String&gt; goldAnswerMap = new HashMap();
                    goldAnswerMap.put(categoryColumn, goldCategory);
                    sys.defineVariable("goldAnswer", GsonUtils.GSON.toJson(goldAnswerMap, GsonUtils.TYPE_MAP_STRING_STRING));
                }
			} else {
                logger.error("Unknown case for modelType '" + modelType + "'");
    		}
    		return isGoldInputData;
        }

/* -----------------------------------------------------------------------------------------------------
    END OF GOLD INPUT DATA PROCESSING
------------------------------------------------------------------------------------------------------ */

        boolean processExtractionResultGeneral(Map responseMap, Map resultMap, List requiredFieldList) {
            String modelType = _sys_model_type.toString();
            if (MODEL_TYPE_IE.equals(modelType)) {
                preprocessIE(resultMap);
            }
            int httpState = Integer.valueOf(responseMap.get("responseStatus"));
            if (httpState != 200 &amp;&amp; httpState != 500 &amp;&amp; httpState != 504) {
                throw new RuntimeException("Error!!! Automation extract service unavailable. Http code = " + httpState + "result=" + resultMap);
            }
            String responseBody = responseMap.get("responseBody");
            logger.debug("Status : {}, Response : {}", httpState, org.apache.commons.lang3.StringUtils.left(responseBody, 40));
            boolean isExtractSuccessful = true;
            resultMap.put("automationExtractStatusReason", new StringBuilder(""));
            if (httpState == 500 || httpState == 504) {
                errorMessage = responseBody;
                logger.error("Error was occurred during extract fields. " + errorMessage);
                isExtractSuccessful = false;
                resultMap.put("automationExtractStatus", FAILURE);
                resultMap.get("automationExtractStatusReason").append("Error was occurred during extract fields. ")
                        .append(errorMessage);
                sys.defineVariable("isExtractSystemError", true);
            }  else {
                Map result = GsonUtils.GSON.fromJson(responseBody, GsonUtils.TYPE_MAP_STRING_OBJECT);
                sys.defineVariable("result", responseBody);
                resultMap.putAll(result);
                if (MODEL_TYPE_IE.equals(modelType)) {
                    isExtractSuccessful = processExtractionResultsIE(resultMap, requiredFieldList);
                } else {
                    isExtractSuccessful = processExtractionResultClassification(resultMap);
                }
                sys.defineVariable("isExtractSystemError", false);
            }
            return isExtractSuccessful;
        }

//--------------------------------------------------------------------------------------------------------------
//------------------------------------- END OF METHODS DECLARATION ---------------------------------------------
//--------------------------------------------------------------------------------------------------------------

        logger.info("Begin process MT extract info with advanced calibration RunUUID: " + run.getUuid());
        String documentContent = getDocumentContent(run);
        sys.defineVariable("documentContent", documentContent);
        if (_sys_statistics_calculation_enabled.toString().equals("true")) {
            boolean isGoldInputData = processGoldInputData(_sys_model_type.toString(),documentContent);
            sys.defineVariable("isGoldInputData", isGoldInputData);
        } else {
            sys.defineVariable("isGoldInputData", false);
            sys.defineVariable("goldAnswer", "");
        }
        sys.defineVariable("documentJson", createDocumentJson(documentContent));
        String requiredFieldStr = _sys_automation_ie_required_fields.toString();
        List requiredFieldList;
        if ("".equals(requiredFieldStr)) {
            requiredFieldList = new ArrayList();
        } else {
            requiredFieldList = Arrays.asList(requiredFieldStr.split(","));
        }
        extractionResultProcessor = {responseMap, resultMap -&gt; processExtractionResultGeneral(responseMap, resultMap, requiredFieldList)};
        ]]&gt;&lt;/script&gt;

    &lt;var-def name='extractResult'&gt;
        &lt;automation-extract model-name='${item.wrappedObject.run.automationInfo.modelType}'
                            model-version='${item.wrappedObject.run.automationInfo.modelVersion}'
                            egid='${item.wrappedObject.run.automationInfo.experimentGroup}'
                            experiment-id='${item.wrappedObject.run.automationInfo.experimentId}' document='${documentJson}'/&gt;
    &lt;/var-def&gt;

    &lt;script language="groovy"&gt;
        &lt;![CDATA[
        import com.freedomoss.workfusion.utils.gson.GsonUtils;

        Map responseMap = GsonUtils.GSON.fromJson(extractResult.toString(), GsonUtils.TYPE_MAP_STRING_STRING);
        logger.info("responseMap: " + responseMap);
        Map resultMap = new HashMap();
        boolean isExtractSuccessful = extractionResultProcessor(responseMap, resultMap);
        logger.info("resultMap: " + resultMap);
        //if successfully extracted: increment number of automated records
        if (isExtractSuccessful) {
            automationInfo.automatedRecords++;
        }
        logger.info("isExtractSuccessful:  " + isExtractSuccessful);
        logger.info("automationExtractStatus:  " + resultMap.get("automationExtractStatus"));
        logger.info("automationExtractStatus reason: " + resultMap.get("automationExtractStatusReason").toString());
        sys.defineVariable("resultMap", resultMap);
        ]]&gt;
    &lt;/script&gt;

    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_extract_http_state" value="${httpState}"/&gt;
        &lt;single-column name="_sys_extract_error_message" value="${errorMessage}"/&gt;
        &lt;case&gt;
            &lt;if condition='${_sys_model_type.toString().equals("ie")}'&gt;
                &lt;single-column name="${_sys_automation_ie_answer_code}_tagged" value='${resultMap.getWrappedObject().get("taggedText")}'/&gt;
                &lt;single-column name="_sys_group_probability" value='${resultMap.getWrappedObject().get("finalScore")}'/&gt;
                &lt;single-column name="_sys_group" value='${resultMap.getWrappedObject().get("group")}'/&gt;
                &lt;loop item="fieldName"&gt;
                    &lt;list&gt;
                        &lt;var name="fieldList"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;single-column name="${fieldName}"
                                       value='${resultMap.getWrappedObject().get("tagValueMap").get(fieldName.toString())}'/&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
            &lt;/if&gt;

            &lt;else&gt;
                &lt;single-column name="_sys_group_probability" value='${resultMap.getWrappedObject().get("score")}'/&gt;
                &lt;single-column name="_sys_group" value='S-${resultMap.getWrappedObject().get("category")}'/&gt;
                &lt;single-column name="${_sys_automation_ie_answer_code}" value='${resultMap.getWrappedObject().get("category")}'/&gt;
            &lt;/else&gt;
        &lt;/case&gt;
        &lt;single-column name="_sys_model_result" value='${result}'/&gt;
        &lt;single-column name="_sys_automation_extract_status" value='${resultMap.getWrappedObject().get("automationExtractStatus")}'/&gt;
        &lt;single-column name="_sys_automation_extract_status_reason"
                       value='${resultMap.getWrappedObject().get("automationExtractStatusReason").toString()}'/&gt;
        &lt;single-column name="_sys_is_gold_input_data" value="${isGoldInputData}"/&gt;
        &lt;single-column name="_sys_gold_answer" value="${goldAnswer}"/&gt;
        &lt;single-column name="_sys_is_extract_system_error" value="${isExtractSystemError}"/&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>e1a2f36b-9e38-4443-9224-e9b7e2748388</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>(Generic) Extract Information 8.4.4.1</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"&gt;

    &lt;script language="groovy"&gt;&lt;![CDATA[
        import org.apache.commons.lang3.BooleanUtils;
        import org.webharvest.runtime.variables.NodeVariable;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;

        import org.apache.commons.codec.binary.Base64;
        import org.springframework.http.*;
        import org.springframework.web.client.*;
        import org.springframework.web.util.UriComponentsBuilder;
        import com.google.gson.*;
        import com.google.gson.reflect.TypeToken;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        import org.springframework.web.client.HttpClientErrorException;
        import org.springframework.http.HttpStatus;

        logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
        experimentId = item.wrappedObject.run.automationInfo.experimentId;
        experimentGroup = item.wrappedObject.run.automationInfo.experimentGroup;

        def addAuthorizationHeaders(HttpHeaders headers) {
            String plainCreds = "${wfbiUser}:${wfbiPassword}";
            byte[] plainCredsBytes = plainCreds.getBytes();
            byte[] base64CredsBytes = Base64.encodeBase64(plainCredsBytes);
            String base64Creds = new String(base64CredsBytes);
            headers.add("Authorization", "Basic " + base64Creds);
        }

        def HttpEntity&lt;?&gt; acceptJsonEntity(body) {
            HttpHeaders headers = new HttpHeaders();
            headers.set("Accept", MediaType.APPLICATION_JSON_VALUE);
            headers.set("Content-Type", MediaType.APPLICATION_JSON_VALUE);
            addAuthorizationHeaders(headers);
            if (body == null) {
                return new HttpEntity(headers);
            } else {
                return new HttpEntity(new Gson().toJson(body), headers);
            }
        }

        restTemplate = new RestTemplate();

        def checkNewPrAvailable(automationInfo) {
            def checkUrl = "${wfbiUrl}/tableau/new-curve/check";
            URI uri = UriComponentsBuilder.fromHttpUrl(checkUrl)
                    .queryParam("experiment_name", experimentId)
                    .queryParam("experiment_group", experimentGroup).build().toUri();
            logger.debug("Checking new PR API is avaialble via {}", uri);
            try {
                HttpEntity&lt;Boolean&gt; response = restTemplate.exchange(uri, HttpMethod.GET, acceptJsonEntity(), Boolean.class);
                def res = response.getBody();
                logger.debug("New PR available : {}", res);
                return res;
            } catch (HttpClientErrorException ex) {
                if (ex.getStatusCode() == HttpStatus.NOT_FOUND) {
                    logger.warn("WFBI PR check service is not available");
                    return false;
                } else {
                    throw ex;
                }
            }
        }

        def createAccuracyCheckRequestBody(automationInfo, tags) {
            def tagScores = [];
            for (Map tagInfo : tags) {
                String tag = tagInfo.get("tag");
                String score = tagInfo.get("score");
                tagScores &lt;&lt; [name: tag, score: score];
            }
            return [
                    experimentGroup: experimentGroup,
                    experimentName: experimentId,
                    perDocAccuracyLimit: automationInfo.getTargetQuality(),
                    fieldResults: tagScores
            ]
        }

        def callCheckAccuracyAPI(automationInfo, tags) {
            Map res = null;
            def calculateUrl = "${wfbiUrl}/pr/check-extraction";
            URI uri = UriComponentsBuilder.fromHttpUrl(calculateUrl).build().toUri();
            def bodyMap = createAccuracyCheckRequestBody(automationInfo, tags);
            logger.debug("Checking accuracy via {} with request {}", uri, bodyMap);
            HttpEntity&lt;Map&gt; response = restTemplate.exchange(uri, HttpMethod.POST, acceptJsonEntity(bodyMap), Map.class);
            return response.getBody();
        }

        //true - success, false - partial/failure, null - use previous classifier
        def checkExtractionAccuracy(automationInfo, tags) {
            Boolean res = null;
            if (checkNewPrAvailable(automationInfo)) {
                def checkResults = callCheckAccuracyAPI(automationInfo, tags);
                logger.debug("Check results {}", checkResults);
                if (checkResults != null) {
                    res = checkResults.get("passed");
                }
            } else {
                logger.debug("New PR is unavailable for experiment {}", experimentId);
            }
            return res;
        }

        accuracyChecker = {automationInfo, tags -&gt; checkExtractionAccuracy(automationInfo, tags)};

        ]]&gt;&lt;/script&gt;

    &lt;script language="groovy"&gt;&lt;![CDATA[
        import org.apache.commons.validator.routines.RegexValidator;
        import org.apache.commons.validator.routines.UrlValidator;
        import com.freedomoss.crowdcontrol.webharvest.RunDto;
        import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;
        import com.freedomoss.crowdcontrol.webharvest.nlp.AnswerCompareUtils;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AnswerInfoDTO;
        import com.freedomoss.crowdcontrol.webharvest.plugin.datastore.dto.AutomationInfoDto;
        import com.freedomoss.workfusion.utils.gson.GsonUtils;
        import com.google.gson.Gson;
        import com.google.gson.GsonBuilder;
        import org.apache.commons.lang3.StringEscapeUtils;
        import org.apache.commons.math3.util.Precision;
        import org.slf4j.Logger;
        import org.slf4j.LoggerFactory;
        //for s3 private bucket
        import org.apache.http.client.methods.CloseableHttpResponse;
        import org.apache.http.client.methods.HttpHead;
        import org.apache.http.impl.client.CloseableHttpClient;
        import org.apache.http.impl.client.HttpClients;
        import org.apache.http.util.EntityUtils;
        import com.freedomoss.appliance.impl.S3SecuredDocumentsHandler;
        import com.freedomoss.spring.ApplicationContextProvider;
        // gold input data processing
		import com.freedomoss.requester.util.extraction.TextAggregationProcessor;
		import com.freedomoss.requester.util.extraction.TagRecord;

        logger = LoggerFactory.getLogger("com.freedomoss.crowdcontrol.webharvest.AUTOMATION_LOG");
        GSON_WITHOUT_HTML_ESCAPING = new GsonBuilder().disableHtmlEscaping().create();
        run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
        automationInfo = run.automationInfo;

        SUCCESS = "success";
        FAILURE = "failure";
        PARTIAL_SUCCESS = "partial_success";

        MODEL_TYPE_IE = "ie";
        MODEL_TYPE_CLASSIFICATION = "classification";

        MULTI_VALUE_SEPARATOR = "|";

        String getUrlContents(String urlToLoad, String boilerPipeExtractor) {
            StringBuilder content = new StringBuilder();
            if (checkIfS3PrivateBucket(urlToLoad)) {
                S3SecuredDocumentsHandler documentsHandler = ApplicationContextProvider.getContext().getBean(S3SecuredDocumentsHandler.class);
                urlToLoad = documentsHandler.generatePreSignedLink(urlToLoad, 60).toString();
            }
            try {
                String workfusionHost = applicationHost.toString();
                String workfusionUrl = applicationContextPath.toString();
                StringBuilder urlBuilder = new StringBuilder();
                urlBuilder
                        .append(workfusionHost)
                        .append(workfusionUrl)
                        .append("/public/getRemoteContent?extractor=")
                        .append(boilerPipeExtractor)
                        .append("&amp;url=")
                        .append(URLEncoder.encode(urlToLoad, "UTF-8").replaceAll("'", "%27").replaceAll("\"", "%22"));

                URL url = new URL(urlBuilder.toString());
                URLConnection urlConnection = url.openConnection();
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(urlConnection.getInputStream()));
                String line;
                while ((line = bufferedReader.readLine()) != null) {
                    content.append(line + "\n");
                }
                bufferedReader.close();
            }
            catch (Exception e) {
                e.printStackTrace();
            }
            return content.toString();
        }

        boolean checkIfS3PrivateBucket(String url) {
            CloseableHttpClient httpclient = null;
            CloseableHttpResponse response = null;
            try {
                httpclient = HttpClients.createDefault();
                HttpHead httpHead = new HttpHead(url);
                response = httpclient.execute(httpHead);
                int statusCode = response.getStatusLine().getStatusCode();
                // do something useful with the response body
                // and ensure it is fully consumed
                EntityUtils.consume(response.getEntity());
                return statusCode == 403;
            } finally {
                if (response != null) {
                    response.close();
                }
                if (httpclient != null) {
                    httpclient.close();
                }
            }
        }

        String getDocumentVariableName(RunDto run) {
            // get name of variable with document content or url. Should be equals to nswer code if mapping not provided
            // check columns mapping in case when answer code mapped to another column
            String documentVariableName = null;

            String originalCampaignUuid = automationInfo.originalCampaignUuid;
            if (MODEL_TYPE_IE.equals(_sys_model_type.toString())) {
                documentVariableName = _sys_automation_ie_answer_code.toString();
            } else {
                documentVariableName = _sys_automation_text_answer_code.toString();
            }
            logger.info("documentVariableName =  " + documentVariableName + ". RunUUID: " + run.getUuid());
            try {
                Map mapping = run.getCampaignMapping(originalCampaignUuid).get(originalCampaignUuid);
                if (mapping != null) {
                    for (Map.Entry entry : mapping.entrySet()) {
                        if (documentVariableName.equals(entry.getValue())) {
                            documentVariableName = entry.getKey();
                            break;
                        }
                    }
                }
            } catch (Exception ignored) {
            }
            logger.info("new documentVariableName =  " + documentVariableName + ". RunUUID: " + run.getUuid());
            return documentVariableName;
        }

        boolean isUrlToDocument(String document) {
            String[] schemes = ["http", "https" ];
            RegexValidator authorityValidator = new RegexValidator("^([\\p{Alnum}\\-\\.]*)(:\\d*)?(.*)?");
            UrlValidator urlValidator = new UrlValidator(schemes, authorityValidator, UrlValidator.ALLOW_LOCAL_URLS);
            return urlValidator.isValid(document);
        }

        String getBoilerpipeExtractorType(RunDto run) {
            AutomationInfoDto automationInfo = run.automationInfo;
            List answers = automationInfo.getAnswers();
            String IE_EXTRACTOR_TYPE_OPTION = "ieExtractorType";
            String extractor = "KEEP_EVERYTHING_EXTRACTOR";
            for (AnswerInfoDTO answerDto : answers) {
                if ("INFO_EXTRACTION".equals(answerDto.getAnswerType())) {
                    String options = answerDto.getOptions();
                    Map optionsMap = GSON_WITHOUT_HTML_ESCAPING.fromJson(options, Map.class);
                    extractor = optionsMap.get(IE_EXTRACTOR_TYPE_OPTION);
                    break;
                }
            }
            return extractor;
        }

        String getDocumentContent(RunDto run) {
            String documentVariableName = getDocumentVariableName(run);
            if(sys.getVar(documentVariableName)== null){
                logger.warn("Column with name: " + documentVariableName + " is not presenting in input data");
                throw new RuntimeException("Column with name: " + documentVariableName + " is not presenting in input data");
            }
            String document = sys.getVar(documentVariableName).getWrappedObject();
            //if the document behind the URL - fetch the content
            if (isUrlToDocument(document)) {
                logger.info("WFML Document loading from url : " + document);
                String extractor = getBoilerpipeExtractorType(run);
                logger.info("WFML boilerpipe extractor : " + extractor);
                document = getUrlContents(document, extractor);
                if (document.isEmpty()) {
                    logger.info("WFML Document is not loaded from url");
                } else {
                    logger.info("WFML Document loaded from url.");
                }
            }

            String documentUnescapeXml = StringEscapeUtils.unescapeXml(document);
            return documentUnescapeXml;
        }

        String createDocumentJson(String documentContent) {
            Map map2Json = new HashMap();
            List list2Json = new ArrayList();
            list2Json.add(documentContent);
            map2Json.put("textParts", list2Json);
            String documentJson = GSON_WITHOUT_HTML_ESCAPING.toJson(map2Json);
            return documentJson;
        }

/* -----------------------------------------------------------------------------------------------------
    BEGIN OF IE SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */

        def putOrConcatValueToMap(Map map, String key, String value) {
            if (map.containsKey(key)) {
                map.put(key, map.get(key) + MULTI_VALUE_SEPARATOR + value);
            } else {
                map.put(key, value);
            }
        }

        Map createTagValueMap(tagList) {
            Map res = new HashMap();
            for (Map tagInfo : tagList) {
                String tag = tagInfo.get("tag");
                String text = tagInfo.get("text");
                putOrConcatValueToMap(res, tag, text);
            }
            return res;
        }

        AnswerInfoDTO findIeAnswer(List answers) {
            for (AnswerInfoDTO answer : answers) {
                if (answer.answerType.equals("INFO_EXTRACTION")) {
                    return answer;
                }
                if (answer.subAnswers != null &amp;&amp; !answer.subAnswers.isEmpty()) {
                    AnswerInfoDTO ieAnswer = findIeAnswer(answer.subAnswers);
                    if (ieAnswer != null) {
                        return ieAnswer;
                    }
                }
            }
            return null;
        }

        List&lt;String&gt; getSubAnswerCodesForGroupAnswer(){
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            List&lt;String&gt; subGroupAnswersCodes = new ArrayList&lt;String&gt;();
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    ieAnswerCode = ieAnswer.answerCode;
                    for (AnswerInfoDTO subAnswer : ieAnswer.subAnswers) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            for (AnswerInfoDTO subAnswerForGroup : subAnswer.subAnswers) {
                                subGroupAnswersCodes.add(subAnswerForGroup.answerCode);
                            }
                        }
                    }
                }
            }
            logger.info("subGroupAnswersCodes: " + subGroupAnswersCodes);
            return subGroupAnswersCodes;
        }

        boolean processExtractionResultNoAdvancedCalibrationIE(Map resultMap, List requiredFieldList) {
            boolean res = true;
            List tagList = resultMap.get("tags");
            Map tagValues;
            String groupAnswerCode = _sys_automation_relations_subanswer_code.toString();
            if (groupAnswerCode == null || groupAnswerCode.isEmpty()) {
                tagValues = createTagValueMap(tagList);
            } else {
                tagValues = new HashMap&lt;String,String&gt;();
                Map&lt;String, Map&lt;String, String&gt;&gt; indexGroupMap = new HashMap&lt;String, Map&lt;String, String&gt;&gt;();
                for (Map tagInfo : tagList) {
                    String tag = tagInfo.get("tag");
                    String text = tagInfo.get("text");
                    String tabnumber = tagInfo.get("tabnumber");
                    if(tabnumber != null){
                        List&lt;String&gt; subGroupAnswersCodes = getSubAnswerCodesForGroupAnswer();
                        if (subGroupAnswersCodes.contains(tag)){
                            Map&lt;String, String&gt; groupAnswersMap = indexGroupMap.get(tabnumber);
                            if(groupAnswersMap != null){
                                groupAnswersMap.put(tag,text);
                            } else {
                                groupAnswersMap = new HashMap&lt;&gt;();
                                groupAnswersMap.put(tag,text);
                                groupAnswersMap.put("tabnumber", tabnumber);
                                indexGroupMap.put(tabnumber, groupAnswersMap);
                            }
                        } else {
                            putOrConcatValueToMap(tagValues, tag, text);
                        }
                    } else {
                        putOrConcatValueToMap(tagValues, tag, text);
                    }
                }
                if (!indexGroupMap.isEmpty()){
                    List values  = new ArrayList(indexGroupMap.values());
                    Map wrappedTagJsonMap = new HashMap();
                    wrappedTagJsonMap.put(groupAnswerCode, values);
                    String wrappedTagJson = GSON_WITHOUT_HTML_ESCAPING.toJson(wrappedTagJsonMap);
                    tagValues.put(groupAnswerCode, wrappedTagJson);
                }
            }
            resultMap.put("tagValueMap", tagValues);
            String requiredFieldCheckMsg = checkRequiredFieldsAnswered(tagList, requiredFieldList);
            if (requiredFieldCheckMsg != null) {
                resultMap.get("automationExtractStatusReason").append(requiredFieldCheckMsg);
                resultMap.put("automationExtractStatus", "partial_success");
                return false;
            }
            Boolean checked = accuracyChecker(automationInfo, tagList);
            if (checked != null) {
                resultMap.get("automationExtractStatusReason").append(" Extraction accuracy check via WFBI API result : ").append(checked);
                if (checked) {
                    resultMap.put("automationExtractStatus", "success");
                } else {
                    resultMap.put("automationExtractStatus", "failure");
                }
                return checked;
            }
            Double estimatedAccuracy;
            if (resultMap.get("estimatedAccuracy") == null) {
                logger.info("VDS return estimatedAccuracy = null. Used default value = 0");
                estimatedAccuracy = 0;
            } else {
                estimatedAccuracy = resultMap.get("estimatedAccuracy");
            }
            Double automationThreadhold = Double.valueOf(automationInfo.targetQuality);
            String automationExtractStatus;
            if (estimatedAccuracy.compareTo(automationThreadhold) &lt; 0) {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &lt; Automation threadhold.");
                automationExtractStatus = "failure";
                res = false;
            } else {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &gt;= Automation threadhold.");
                automationExtractStatus = "success";
            }
            resultMap.put("automationExtractStatus", automationExtractStatus);
            return res;
        }

        void processAutomationExtractStatus(boolean isExtractSuccessful, List tagList, Map resultMap) {
            String automationExtractStatus;
            if (isExtractSuccessful) {
                automationExtractStatus = SUCCESS;
            } else {
                automationExtractStatus = PARTIAL_SUCCESS;
            }
            resultMap.get("automationExtractStatusReason").append(" Use '")
                    .append(automationExtractStatus)
                    .append("' as default value for automationExtractStatus.");
            for (Map tagInfo : tagList) {
                String tag = tagInfo.get("tag");
                Double estimatedAccuracy;
                if (tagInfo.get("estimatedAccuracy") == null) {
                    logger.info("VDS return estimatedAccuracy = null for tag '" + tag + "'. Used default value = 0");
                    estimatedAccuracy = 0;
                } else {
                    estimatedAccuracy = Double.valueOf(tagInfo.get("estimatedAccuracy"));
                }
                Double automationThreadhold = null;
                if (automationInfo.getSelectedTagPrecisions().containsKey(tag)) {
                    automationThreadhold = automationInfo.getSelectedTagPrecisions().get(tag);
                } else if (automationInfo.getUnselectedTagPrecisions().containsKey(tag)) {
                    resultMap.get("automationExtractStatusReason").append(" Precision for tag '")
                            .append(tag)
                            .append("' is unselected.");
                    automationExtractStatus = FAILURE;
                    break;
                }
                if (automationThreadhold != null &amp;&amp; Precision.equals(automationThreadhold, 0d, 0.00001)) {
                    continue;
                }
                if (automationThreadhold == null || estimatedAccuracy.compareTo(automationThreadhold) &lt; 0) {
                    resultMap.get("automationExtractStatusReason").append(" AutomationThreadhold '")
                            .append(automationThreadhold)
                            .append("' is null or ~0.");
                    automationExtractStatus = FAILURE;
                    break;
                }
            }
            resultMap.put("automationExtractStatus", automationExtractStatus);
        }

        String checkRequiredFieldsAnswered(List tagList, List requiredFieldList) {
            Map tagValues = createTagValueMap(tagList);
            String res = null;
            // check are all required values extracted
            for (int i = 0; i &lt; requiredFieldList.size(); i++) {
                String requiredField = requiredFieldList.get(i);
                if (!tagValues.containsKey(requiredField)) {
                    res = " isExtractSuccessful = false because not all required values extracted. First incorrect '" + requiredField + "'";
                    break;
                }
            }
            return res;
        }

        boolean processExtractionResultAdvancedCalibration(Map resultMap, List requiredFieldList) {
            String groupAnswerCode = _sys_automation_relations_subanswer_code.toString();
            boolean isExtractSuccessful = true;
            if (groupAnswerCode == null || groupAnswerCode.isEmpty()) {
                resultMap.get("automationExtractStatusReason").append(" Process case [groupAnswerCode == null || groupAnswerCode.isEmpty()].");
                List tagList = resultMap.get("tags");
                def tagValues = createTagValueMap(tagList);
                resultMap.put("tagValueMap", tagValues);
                String requiredFieldCheckMsg = checkRequiredFieldsAnswered(tagList, requiredFieldList);
                if (requiredFieldCheckMsg != null) {
                    resultMap.get("automationExtractStatusReason").append(requiredFieldCheckMsg);
                    isExtractSuccessful = false;
                }
                processAutomationExtractStatus(isExtractSuccessful, tagList, resultMap);
            } else {
                Map nonRelationTagMap = resultMap.get("nonRelations");
                resultMap.get("automationExtractStatusReason").append(" Process case [groupAnswerCode != null and !groupAnswerCode.isEmpty()].");
                if (nonRelationTagMap != null) {
                    List tagList = nonRelationTagMap.keySet();
                    tagValueMap = resultMap.get("tagValueMap");
                    for (String tag : tagList) {
                        String tagText = nonRelationTagMap.get(tag).get("text");
                        tagValueMap.put(tag, tagText);
                    }

                    List relationTagJson = GSON_WITHOUT_HTML_ESCAPING.fromJson(resultMap.get("relationJson"), List.class);
                    Map wrappedTagJsonMap = new HashMap();
                    wrappedTagJsonMap.put(groupAnswerCode, relationTagJson);
                    String wrappedTagJson = GSON_WITHOUT_HTML_ESCAPING.toJson(wrappedTagJsonMap);
                    tagValueMap.put(groupAnswerCode, wrappedTagJson);

                    resultMap.get("automationExtractStatusReason").append(" Process case [nonRelationTagMap != null].");
                    //check is all required fields extracted for group answer
                    for (AnswerInfoDTO answer : automationInfo.answers) {
                        if (answer.answerType.equals("INFO_EXTRACTION")) {
                            for (AnswerInfoDTO subAnswer : answer.subAnswers) {
                                if ("GROUP".equals(subAnswer.answerType)) {
                                    isExtractSuccessful = AnswerCompareUtils.isAllRequiredFieldsExtracted(wrappedTagJson, subAnswer);
                                    if (isExtractSuccessful) {
                                        resultMap.get("automationExtractStatusReason").append(" isExtractSuccessful = false because not all required values extracted for group answer.");
                                        break;
                                    }
                                }

                            }
                        }
                    }
                    processAutomationExtractStatus(isExtractSuccessful, tagList, resultMap);
                }
            }
            return isExtractSuccessful;
        }

        void preprocessIE(Map resultMap) {
            sys.defineVariable("fieldList", Arrays.asList(_sys_automation_ie_fields.toString().split(",")));
            resultMap.put("tagValueMap", new HashMap());
        }

        boolean processExtractionResultsIE(Map resultMap, List requiredFieldList) {
            if (automationInfo.isAdvancedCalibration()) {
                resultMap.get("automationExtractStatusReason").append(" Process with advanced calibration.");
                return processExtractionResultAdvancedCalibration(resultMap, requiredFieldList);
            } else {
                resultMap.get("automationExtractStatusReason").append(" Process without advanced calibration.");
                return processExtractionResultNoAdvancedCalibrationIE(resultMap, requiredFieldList);
            }
        }
/* ------------------------------------------------------------------------------------------------------
    END OF IE SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */

/* -----------------------------------------------------------------------------------------------------
    BEGIN OF CLASSIFICATION SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */
        boolean processERWACSelectedTag(String tag, Double estimatedAccuracy, Map resultMap) {
            resultMap.get("automationExtractStatusReason").append(" Category '" + tag + "' is selected.");
            automationThreadhold = automationInfo.getSelectedTagPrecisions().get(tag);
            if (automationThreadhold != null &amp;&amp; Precision.equals(automationThreadhold, 0d, 0.00001)) {
                resultMap.get("automationExtractStatusReason").append(" Automation threadhold is '0'");
                return true;
            } else if (automationThreadhold == null) {
                resultMap.get("automationExtractStatusReason").append(" Automation threadhold is null.");
                return false;
            } else if (estimatedAccuracy &lt; automationThreadhold) {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &lt; Automation threadhold.");
                return false;
            } else {
                resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &gt;= Automation threadhold.");
                return true;
            }
        }

        boolean processExtractionResultWithAdvancedCalibration(String category, Double estimatedAccuracy, Map resultMap) {
            resultMap.get("automationExtractStatusReason").append(" Process extraction result with advanced calibration.");
            String tag = "S-" + category;
            if (automationInfo.getSelectedTagPrecisions().containsKey(tag)) {
                return processERWACSelectedTag(tag, estimatedAccuracy, resultMap);
            } else if (automationInfo.getUnselectedTagPrecisions().containsKey(tag)) {
                resultMap.get("automationExtractStatusReason").append(" Category '" + tag + "' is unselected.");
                return false;
            } else {
                resultMap.get("automationExtractStatusReason").append(" Category '" + tag + "' is unknown.");
                return false;
            }
        }

        boolean processExtractionResultClassification(Map resultMap) {
            String category = resultMap.get("category");
            Double estimatedAccuracy = resultMap.get("estimatedAccuracy");
            boolean extractionSuccessful;

            if (!(category == null || category.isEmpty())) {
                if (estimatedAccuracy == null) {
                    logger.info("VDS return estimatedAccuracy = null. Used default value = 0.");
                    estimatedAccuracy = 0;
                }
                if (automationInfo.isAdvancedCalibration()) {
                    resultMap.get("automationExtractStatusReason").append(" Process with advanced calibration.");
                    extractionSuccessful = processExtractionResultWithAdvancedCalibration(category, estimatedAccuracy, resultMap);
                } else {
                    resultMap.get("automationExtractStatusReason").append(" Process without advanced calibration.");
                    Double automationThreadhold = Double.valueOf(automationInfo.targetQuality);
                    if (estimatedAccuracy &lt; automationThreadhold) {
                        resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &lt; Automation threadhold");
                        extractionSuccessful = false;
                    } else {
                        resultMap.get("automationExtractStatusReason").append(" Estimated accuracy &gt;= Automation threadhold");
                        extractionSuccessful = true;
                    }
                }
            } else {
                extractionSuccessful = false;
            }
            resultMap.put("automationExtractStatus", extractionSuccessful ? SUCCESS : FAILURE);
            return extractionSuccessful;
        }
/* -----------------------------------------------------------------------------------------------------
    END OF CLASSIFICATION SPECIFIC EXTRACTION METHODS
------------------------------------------------------------------------------------------------------ */

/* -----------------------------------------------------------------------------------------------------
    BEGIN OF GOLD INPUT DATA PROCESSING
------------------------------------------------------------------------------------------------------ */

        Map getSubAnswerCodeMap(){
            AnswerInfoDTO ieAnswer = findIeAnswer(run.automationInfo.answers);
            Map&lt;String, List&lt;String&gt;&gt; subGroupAnswersCodes = new HashMap&lt;&gt;();
            if (ieAnswer != null) {
                if (!ieAnswer.getSubAnswers().isEmpty()) {
                    for (AnswerInfoDTO subAnswer : ieAnswer.getSubAnswers()) {
                        if ("GROUP".equals(subAnswer.answerType)) {
                            List&lt;String&gt; subCodes = new ArrayList&lt;&gt;();
                            for (AnswerInfoDTO subAnswerForGroup : subAnswer.subAnswers) {
                                subCodes.add(subAnswerForGroup.answerCode);
                            }
                            subGroupAnswersCodes.put(subAnswer.answerCode, subCodes);
                        }
                    }
                }
            }
            return subGroupAnswersCodes;
        }

        String getTabNumber(TagRecord tagRecord) {
            Set&lt;Integer&gt; tabNumbers = tagRecord.getTabNumbers();
            if (tabNumbers == null || tabNumbers.size() == 0) {
                return null;
            }
            for (Integer tabNumber : tabNumbers) {
                return tabNumber.toString();
            }
            return null;
        }

        boolean processGoldInputData(String modelType, String documentContent) {
            boolean isGoldInputData = false;
            if (MODEL_TYPE_IE.equals(modelType)) {
                if(TextAggregationProcessor.isTextContainsTagsExcludeHtmlOcr(documentContent)){
                    isGoldInputData = true;
                    logger.info("Used gold data: Document content is tagged");
                    List&lt;TagRecord&gt; tagRecords = TextAggregationProcessor.collectDocumentTagsExcludeHtmlOcr(documentContent);

                    Map&lt;String, List&lt;String&gt;&gt; groups = getSubAnswerCodeMap();
                    List&lt;String&gt; subGroupAnswersCodes = new ArrayList&lt;&gt;();
                    for (List&lt;String&gt; value : groups.values()) {
                        subGroupAnswersCodes.addAll(value);
                    }
                    Map&lt;String, String&gt; goldAnswerMap = new HashMap();
                    Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; answerGroupMap = new HashMap&lt;&gt;();
                    for (TagRecord tagRecord: tagRecords) {
                        String tag = tagRecord.getTagName();
                        String text = tagRecord.getText();
                        String tabNumber = getTabNumber(tagRecord);
                        if(tabNumber != null){
                            if (subGroupAnswersCodes.contains(tag)){
                                for (Map.Entry&lt;String, List&lt;String&gt;&gt; groupSet : groups.entrySet()) {
                                    if (groupSet.getValue().contains(tag)) {
                                        Map&lt;String, Map&lt;String, String&gt;&gt; tabNumberGroupMap = answerGroupMap.get(groupSet.getKey());
                                        if (tabNumberGroupMap == null) {
                                            tabNumberGroupMap = new HashMap&lt;&gt;();
                                            answerGroupMap.put(groupSet.getKey(), tabNumberGroupMap);
                                        }
                                        Map&lt;String, String&gt; groupAnswersMap = tabNumberGroupMap.get(tabNumber);
                                        if(groupAnswersMap != null){
                                            groupAnswersMap.put(tag,text);
                                        } else {
                                            groupAnswersMap = new HashMap&lt;&gt;();
                                            groupAnswersMap.put(tag,text);
                                            groupAnswersMap.put("tabnumber", tabNumber);
                                            tabNumberGroupMap.put(tabNumber, groupAnswersMap);
                                        }
                                        break;
                                    }
                                }
                            } else {
                                putOrConcatValueToMap(goldAnswerMap, tag, text);
                            }
                        } else {
                            putOrConcatValueToMap(goldAnswerMap, tag, text);
                        }
                    }
                    if (!answerGroupMap.isEmpty()) {
                        for (Map.Entry&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; entry : answerGroupMap.entrySet()) {
                            List values  = new ArrayList(entry.getValue().values());
                            Map wrappedTagJsonMap = new HashMap();
                            wrappedTagJsonMap.put(entry.getKey(), values);
                            String wrappedTagJson = GsonUtils.GSON.toJson(wrappedTagJsonMap);
                            goldAnswerMap.put(entry.getKey(), wrappedTagJson);
                        }
                    }
                    sys.defineVariable("goldAnswer", GsonUtils.GSON.toJson(goldAnswerMap, GsonUtils.TYPE_MAP_STRING_STRING));
                }
			} else if (MODEL_TYPE_CLASSIFICATION.equals(modelType)) {
			    String categoryColumn = _sys_automation_ie_answer_code.toString();
			    if (sys.getVar(categoryColumn) != null &amp;&amp; sys.getVar(categoryColumn).getWrappedObject() != null) {
                    isGoldInputData = true;
                    logger.info("Used gold data: There is gold category");
                    String goldCategory = sys.getVar(categoryColumn).getWrappedObject();
                    Map&lt;String, String&gt; goldAnswerMap = new HashMap();
                    goldAnswerMap.put(categoryColumn, goldCategory);
                    sys.defineVariable("goldAnswer", GsonUtils.GSON.toJson(goldAnswerMap, GsonUtils.TYPE_MAP_STRING_STRING));
                }
			} else {
                logger.error("Unknown case for modelType '" + modelType + "'");
    		}
    		return isGoldInputData;
        }

/* -----------------------------------------------------------------------------------------------------
    END OF GOLD INPUT DATA PROCESSING
------------------------------------------------------------------------------------------------------ */

        boolean processExtractionResultGeneral(Map responseMap, Map resultMap, List requiredFieldList) {
            String modelType = _sys_model_type.toString();
            if (MODEL_TYPE_IE.equals(modelType)) {
                preprocessIE(resultMap);
            }
            int httpState = Integer.valueOf(responseMap.get("responseStatus"));
            if (httpState != 200 &amp;&amp; httpState != 500 &amp;&amp; httpState != 504) {
                throw new RuntimeException("Error!!! Automation extract service unavailable. Http code = " + httpState + "result=" + resultMap);
            }
            String responseBody = responseMap.get("responseBody");
            logger.debug("Status : {}, Response : {}", httpState, org.apache.commons.lang3.StringUtils.left(responseBody, 40));
            boolean isExtractSuccessful = true;
            resultMap.put("automationExtractStatusReason", new StringBuilder(""));
            if (httpState == 500 || httpState == 504) {
                errorMessage = responseBody;
                logger.error("Error was occurred during extract fields. " + errorMessage);
                isExtractSuccessful = false;
                resultMap.put("automationExtractStatus", FAILURE);
                resultMap.get("automationExtractStatusReason").append("Error was occurred during extract fields. ")
                        .append(errorMessage);
                sys.defineVariable("isExtractSystemError", true);
            }  else {
                Map result = GsonUtils.GSON.fromJson(responseBody, GsonUtils.TYPE_MAP_STRING_OBJECT);
                sys.defineVariable("result", responseBody);
                resultMap.putAll(result);
                if (MODEL_TYPE_IE.equals(modelType)) {
                    isExtractSuccessful = processExtractionResultsIE(resultMap, requiredFieldList);
                } else {
                    isExtractSuccessful = processExtractionResultClassification(resultMap);
                }
                sys.defineVariable("isExtractSystemError", false);
            }
            return isExtractSuccessful;
        }

//--------------------------------------------------------------------------------------------------------------
//------------------------------------- END OF METHODS DECLARATION ---------------------------------------------
//--------------------------------------------------------------------------------------------------------------

        logger.info("Begin process MT extract info with advanced calibration RunUUID: " + run.getUuid());
        String documentContent = getDocumentContent(run);
        sys.defineVariable("documentContent", documentContent);
        if (_sys_statistics_calculation_enabled.toString().equals("true")) {
            boolean isGoldInputData = processGoldInputData(_sys_model_type.toString(),documentContent);
            sys.defineVariable("isGoldInputData", isGoldInputData);
        } else {
            sys.defineVariable("isGoldInputData", false);
            sys.defineVariable("goldAnswer", "");
        }
        sys.defineVariable("documentJson", createDocumentJson(documentContent));
        String requiredFieldStr = _sys_automation_ie_required_fields.toString();
        List requiredFieldList;
        if ("".equals(requiredFieldStr)) {
            requiredFieldList = new ArrayList();
        } else {
            requiredFieldList = Arrays.asList(requiredFieldStr.split(","));
        }
        extractionResultProcessor = {responseMap, resultMap -&gt; processExtractionResultGeneral(responseMap, resultMap, requiredFieldList)};
        ]]&gt;&lt;/script&gt;

    &lt;var-def name='extractResult'&gt;
        &lt;automation-extract model-name='${item.wrappedObject.run.automationInfo.modelType}'
                            model-version='${item.wrappedObject.run.automationInfo.modelVersion}'
                            egid='${item.wrappedObject.run.automationInfo.experimentGroup}'
                            experiment-id='${item.wrappedObject.run.automationInfo.experimentId}' document='${documentJson}'/&gt;
    &lt;/var-def&gt;

    &lt;script language="groovy"&gt;
        &lt;![CDATA[
        import com.freedomoss.workfusion.utils.gson.GsonUtils;

        Map responseMap = GsonUtils.GSON.fromJson(extractResult.toString(), GsonUtils.TYPE_MAP_STRING_STRING);
        logger.info("responseMap: " + responseMap);
        Map resultMap = new HashMap();
        boolean isExtractSuccessful = extractionResultProcessor(responseMap, resultMap);
        logger.info("resultMap: " + resultMap);
        //if successfully extracted: increment number of automated records
        if (isExtractSuccessful) {
            automationInfo.automatedRecords++;
        }
        logger.info("isExtractSuccessful:  " + isExtractSuccessful);
        logger.info("automationExtractStatus:  " + resultMap.get("automationExtractStatus"));
        logger.info("automationExtractStatus reason: " + resultMap.get("automationExtractStatusReason").toString());
        sys.defineVariable("resultMap", resultMap);
        ]]&gt;
    &lt;/script&gt;

    &lt;export include-original-data="true"&gt;
        &lt;single-column name="_sys_extract_http_state" value="${httpState}"/&gt;
        &lt;single-column name="_sys_extract_error_message" value="${errorMessage}"/&gt;
        &lt;case&gt;
            &lt;if condition='${_sys_model_type.toString().equals("ie")}'&gt;
                &lt;single-column name="${_sys_automation_ie_answer_code}_tagged" value='${resultMap.getWrappedObject().get("taggedText")}'/&gt;
                &lt;single-column name="_sys_group_probability" value='${resultMap.getWrappedObject().get("finalScore")}'/&gt;
                &lt;single-column name="_sys_group" value='${resultMap.getWrappedObject().get("group")}'/&gt;
                &lt;loop item="fieldName"&gt;
                    &lt;list&gt;
                        &lt;var name="fieldList"/&gt;
                    &lt;/list&gt;
                    &lt;body&gt;
                        &lt;single-column name="${fieldName}"
                                       value='${resultMap.getWrappedObject().get("tagValueMap").get(fieldName.toString())}'/&gt;
                    &lt;/body&gt;
                &lt;/loop&gt;
            &lt;/if&gt;

            &lt;else&gt;
                &lt;single-column name="_sys_group_probability" value='${resultMap.getWrappedObject().get("score")}'/&gt;
                &lt;single-column name="_sys_group" value='S-${resultMap.getWrappedObject().get("category")}'/&gt;
                &lt;single-column name="${_sys_automation_ie_answer_code}" value='${resultMap.getWrappedObject().get("category")}'/&gt;
            &lt;/else&gt;
        &lt;/case&gt;
        &lt;single-column name="_sys_model_result" value='${result}'/&gt;
        &lt;single-column name="_sys_automation_extract_status" value='${resultMap.getWrappedObject().get("automationExtractStatus")}'/&gt;
        &lt;single-column name="_sys_automation_extract_status_reason"
                       value='${resultMap.getWrappedObject().get("automationExtractStatusReason").toString()}'/&gt;
        &lt;single-column name="_sys_is_gold_input_data" value="${isGoldInputData}"/&gt;
        &lt;single-column name="_sys_gold_answer" value="${goldAnswer}"/&gt;
        &lt;single-column name="_sys_is_extract_system_error" value="${isExtractSystemError}"/&gt;
    &lt;/export&gt;
&lt;/config&gt;
</content>
                                        <name>(Generic) Extract Information 8.4.4.1</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>MACHINE</type>
                                        <uuid>7bffcefb-8dd1-495a-b608-6557262ffccc</uuid>
                                        <version>
                                            <componentUuid>4b0e2274-6467-4a6b-8263-2300067d37a0</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-09-02T14:41:29Z</lastModified>
                                            <versionUuid>bd0cf737-34d7-4403-a124-e23b9b7b6c6b</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>e1a2f36b-9e38-4443-9224-e9b7e2748388</uuid>
                                    <version>
                                        <componentUuid>c8297fee-c314-4977-b1ef-ec2ee294da44</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:29Z</lastModified>
                                        <versionUuid>9e5b0097-d8a2-4794-969c-5d9a3fd6b069</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>(Generic) Extract Information 8.4.4.1</title>
                                <type>SINGLE</type>
                                <uuid>92ee47f9-c2ba-4818-bc4a-3232cda898f2</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>12cbec6a-ea69-415e-94f0-3df8b9e7fa4b</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:29Z</lastModified>
                                    <versionUuid>69e9bb65-a1f6-45eb-bc9e-9dd32234bf73</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>79</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>a12027b1-aa9e-4872-8183-221fb003a0c3</uuid>
                        </campaignMap>
                        <campaignMap>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"canceled_manual_task","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'YES' when canceled_manual_task EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("canceled_manual_task", "EQ", "YES"));

    then
        $ctx.sendResultTo("YES", $item);
end

# RuleOutcome.Definition={"outcomeId":"NO","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"canceled_manual_task","value":"NO","operator":"EQ"}],"customConditions":[]}
rule "2. Send records to 'NO' when canceled_manual_task EQ 'NO'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("canceled_manual_task", "EQ", "NO"));

    then
        $ctx.sendResultTo("NO", $item);
end



rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>canceled</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>d8c254e9-d5bf-444c-99cb-13a39afeb248</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;var-def name="exportType"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_type")}'&gt;
                &lt;template&gt;${_sys_export_type}&lt;/template&gt;
            &lt;/if&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="exportColumns"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_columns")}'&gt;
                &lt;template&gt;${_sys_export_columns}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="columnNameCase"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_column_name_case")}'&gt;
                &lt;template&gt;${_sys_column_name_case}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;keep&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="dataOnly"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_data_only")}'&gt;
                &lt;template&gt;${_sys_data_only}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;true&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="datastoreName"&gt;
        &lt;script return="item.getWrappedObject().getRun().getDatastoreName()" /&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!datastoreName.isEmpty()}"&gt;
            &lt;insert-datastore   datastore-name="${datastoreName}" create="true"&gt;
                &lt;script return="hit_submission_data_item.getWrappedObject().getItemValueMap()"/&gt;
            &lt;/insert-datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"
            export-type="${exportType}"
            export-columns="${exportColumns}"
            column-name-case="${columnNameCase}"
            data-only="${dataOnly}"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>Default machine campaign for end step.</description>
                                    <includedConfigs/>
                                    <inclusionCode>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</inclusionCode>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <name>Final Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</uuid>
                                    <version>
                                        <componentUuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-08-21T10:54:19Z</lastModified>
                                        <versionUuid>71976d1d-a48f-4ce5-ae4d-10203991bf95</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>100</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Percents</streamValueType>
                                <title>Final Results</title>
                                <type>SINGLE</type>
                                <uuid>af4c8905-26dd-4120-b208-39ad3530ffc6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>a7c3c527-28fb-11e8-bf41-000d3a0302a9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>false</lastInChain>
                                    <lastModified>2018-08-21T10:54:19Z</lastModified>
                                    <versionUuid>56d0500e-1f1a-4755-9c95-600a8de71b5e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>80</stepIndex>
                            <stepPosition>SUBEND</stepPosition>
                            <uuid>320a7aa1-c3cc-4945-82ca-9aa1984424d4</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>fa6e35fe-83b9-4be8-97e3-4fa3135e837d</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	
	&lt;var-def name="ocr_document_url_additional_processing_tagged"&gt;
   		&lt;template&gt;${ocr_document_url_additional_processing_tagged}&lt;/template&gt;
    &lt;/var-def&gt;
	
	&lt;var-def name="group_field"&gt;
   		&lt;template&gt;product_information&lt;/template&gt;
    &lt;/var-def&gt;
    
    &lt;var-def name="single_fields"&gt;
   		&lt;template&gt;client_name,customer_delivery_address,customer_delivery_city,customer_delivery_zip_code,rdd,rdd_time,po,net_total_price&lt;/template&gt;
    &lt;/var-def&gt;
    
	   	
	&lt;script&gt;&lt;![CDATA[
		import org.jsoup.Jsoup;
		import org.jsoup.nodes.Document
		import org.jsoup.nodes.Element
		import org.jsoup.select.Elements
		import com.google.gson.Gson
		import org.jsoup.nodes.Attributes
		import org.jsoup.parser.Tag
		
		class Tagger {
	
			def group_fields = [:]
			def single_fields = [:]
			def group_field;
			
			Tagger(group_field) {
				this.group_field = group_field;
			}
			
			def export(doc) {
				doc.select('[tabnumber]:not(meta-manual-answer)').each { tag -&gt;
					tag.attributes().get('tabnumber').tokenize('|').each {
						int tab = Integer.parseInt(it);
						def dataValue = tag.attributes().get('data-value');
						addToDataRows tab, tag.nodeName(), dataValue;
						addToDataRows tab, "tabnumber", tag.attributes().get('tabnumber');
					}
				}
				doc.select('.extraction-tag:not([tabnumber])').each { tag -&gt;
					single_fields[tag.nodeName()] = tag.attributes().get('data-value');	
				}
			}
			
			def addToDataRows(index, tag, value) {
				if(group_fields[index] == null) {
					 group_fields[index] = [:]
				}
				group_fields[index][tag] = value;
			}
			
			def dataRowsToJson() {
		    	"{${group_field}: ${groovy.json.JsonOutput.toJson(group_fields.sort().values())}}"
		    }
			
		}
		tagger = new Tagger(group_field);	
		doc = Jsoup.parse(ocr_document_url_additional_processing_tagged.toString());
		tagger.export(doc);
		columns = single_fields.toString().split(",");
	]]&gt;&lt;/script&gt;

	
	&lt;export include-original-data="true"&gt;
		&lt;single-column name="${group_field}" value="${tagger.dataRowsToJson()}"&gt;&lt;/single-column&gt;
		&lt;single-column name="ocr_document_url_additional_processing_tagged" value="${doc.toString()}"&gt;&lt;/single-column&gt;
		
		&lt;loop item="single_field_key"&gt;
			&lt;list&gt; &lt;script return="columns"/&gt; &lt;/list&gt;
			
			&lt;body&gt;
				&lt;single-column name="${single_field_key}" value='${tagger.single_fields.get(single_field_key.toString())}'&gt;&lt;/single-column&gt; 
			&lt;/body&gt;
	    	
	    &lt;/loop&gt; 

	&lt;/export&gt;
	
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>a08dd0b4-3212-4f76-8bfd-5e0f57cd9bb1</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Update fields after post-processing</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>a08dd0b4-3212-4f76-8bfd-5e0f57cd9bb1</uuid>
                                    <version>
                                        <componentUuid>b5776d10-4629-4c8e-82e2-4e7bb98880d5</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>1bbdbd2a-7488-44b7-b93e-606e5fee3bc6</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Update fields after post-processing</title>
                                <type>SINGLE</type>
                                <uuid>79b982fa-c71e-4f3b-84f3-74168f05fac9</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>47295557-1a0e-44fc-979a-7fa682d09c7f</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>453a2b43-fdfc-4a2b-9b6d-4b27f35ea4d6</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>81</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>d159a45f-77cc-4f2a-86d4-b710c5618da2</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>fea6c5eb-39b5-4bab-a056-ee3db9d94918</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
     	&lt;single-column name="customer_name" value="${client_name}"/&gt;
		&lt;single-column name="street_address" value="${customer_delivery_address}"/&gt;
		&lt;single-column name="city" value="${customer_delivery_city}"/&gt;
		&lt;single-column name="zip_code" value="${customer_delivery_zip_code}"/&gt;
		&lt;single-column name="request_delivery_date" value="${rdd}"/&gt;
		&lt;single-column name="purchase_order" value="${po}"/&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>0d508db4-1298-4013-b2fc-000fd9142046</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>translation</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>0d508db4-1298-4013-b2fc-000fd9142046</uuid>
                                    <version>
                                        <componentUuid>4b1eef05-686f-4c3f-81e6-5b499fef6a0b</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>ce8645ef-6ac4-458b-9838-536c46b5cca5</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>translation</title>
                                <type>SINGLE</type>
                                <uuid>6b90904e-3ae1-4fad-9533-49a750fad9fc</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>7cab6509-91e7-4214-8aba-4e1bba719936</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>0745879f-7f41-4b75-8385-c93e085a5722</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>82</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>c702ab9d-2623-4049-94b4-f8ec9619c3b4</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>3600147e-21d8-47fa-b668-d8920a1fa729</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
	&lt;script&gt;&lt;![CDATA[
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
		import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

		def poNum = null;
		if (po_number.toString() != null) {
			if (!po_number.toString().equals("")) {
				poNum = po_number.toString();
			}
		}

		def shipToName = null;
		if (ship_to_name.toString() != null) {
			if (!ship_to_name.toString().equals("")) {
				shipToName = ship_to_name.toString();
			}
		}

		id = "[${uuid}-${mail_id}]";

		RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		sandbox = run.isSandbox()?"Sandbox":"Production";

		emailFrom = confirmation_email_from.toString();
		emailTo = confirmation_email_recipient.toString();

  		emailSubject = "[RPA][NE][action required] " +
            "RPA &gt; Manual tagging task for " + 
			(poNum?("purchase order " + poNum):"order") +
			" from " +
			((shipToName?:"unknown customer")).replaceAll("[\n\r]+", "");

		emailBody = """
			Dear team,&lt;br/&gt;
			&lt;br/&gt;
   			There was a &lt;b&gt;NE_Training_task_v8v1&lt;/b&gt; manual tagging task generated for you.&lt;/br&gt;
   			Please navigate to &lt;a href="https://wfapp-dev.workfusion.pg.com/workspace/"&gt;Workfusion Workspace&lt;/a&gt;&lt;br/&gt;
			Should you have any questions or comments, please contact &lt;a href="mailto:dachrpa@hpe.com"&gt;DevOps team&lt;/a&gt; referring following details
			&lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order pickup server datetime&lt;/td&gt;&lt;td&gt;${creation_sorting_dttm}&lt;/td&gt;&lt;/tr&gt;
    			&lt;tr&gt;&lt;td&gt;environment&lt;/td&gt;&lt;td&gt;${sandbox}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
		""";
	]]&gt;&lt;/script&gt;

	&lt;mail smtp-host="${smtp_server_host}" type="html" smtp-port="${smtp_server_port}" from="${emailFrom}"
		to="${emailTo}" subject="${emailSubject}"&gt;
		&lt;template&gt;&lt;![CDATA[
			${emailBody}
		]]&gt;&lt;/template&gt;
	&lt;/mail&gt;

	&lt;export include-original-data="true"&gt;
       &lt;single-column name="customer_name_ocr" value="${client_name}"/&gt;
       &lt;single-column name="city_ocr" value="${customer_delivery_city}"/&gt;
       &lt;single-column name="zip_code_ocr" value="${customer_delivery_zip_code}"/&gt;
       &lt;single-column name="street_address_ocr" value="${customer_delivery_address}"/&gt;
      &lt;single-column name="request_delivery_date_ocr" value="${rdd}"/&gt;
       &lt;single-column name="purchase_order_ocr" value="${po}"/&gt;
      &lt;single-column name="ship_to_name_ocr" value="${ship_to_name}"/&gt;     
      &lt;single-column name="product_information_ocr" value="${product_information}"/&gt;  
      &lt;single-column name="rdd_time_ocr" value="${rdd_time}"/&gt; 
      &lt;single-column name="net_total_price_ocr" value="${net_total_price}"/&gt; 
	&lt;/export&gt;
&lt;/config&gt;
</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>6d91bd04-10a2-434b-b74d-0c17c0259ee8</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>mail notification</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>6d91bd04-10a2-434b-b74d-0c17c0259ee8</uuid>
                                    <version>
                                        <componentUuid>8be3cab2-b1ea-4afc-b843-73fcf9420771</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-05T09:28:28Z</lastModified>
                                        <versionUuid>828aed32-b9ce-480e-9fea-ee497e0392e0</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>mail notification</title>
                                <type>SINGLE</type>
                                <uuid>af41ca29-369f-444b-a057-a5e22e39f3d7</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>be95e8ca-0abd-4ad7-a5fb-bd09bf62b42d</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-05T09:28:32Z</lastModified>
                                    <versionUuid>6b21e7a8-d961-4495-9c16-4f5cf3a130fd</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>83</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>ed74c1d7-49ad-4a34-b623-e19c773605d6</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"yes","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"goto_soldto_selection","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'yes' when goto_soldto_selection EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("goto_soldto_selection", "EQ", "YES"));

    then
        $ctx.sendResultTo("yes", $item);
end



# RuleOutcome.Definition={"outcomeId":"No","conditional":false,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[],"customConditions":[]}
rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>goto SoldTo selection</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>b282ddf7-2689-4ca7-9468-58870e9c355b</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>c2da3acd-ce17-42b1-8d9b-47a5b544b9fb</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>empty task  1</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>c2da3acd-ce17-42b1-8d9b-47a5b544b9fb</uuid>
                                    <version>
                                        <componentUuid>5d645020-a87f-4180-91b2-6a9624772fe6</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>32199dc6-fee9-4355-933e-baa78d4ab27c</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>empty task  1</title>
                                <type>SINGLE</type>
                                <uuid>6786a960-9a69-4fb5-a05f-6032df76f8bc</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>e16c09bb-7586-4e8b-a2fd-d2e243052217</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>12b0d3a0-9383-4338-9b23-b765ea5d5f05</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>84</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>c8098f19-c43d-4f2a-b259-5e11a991cba9</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>3dc83531-5043-4bd1-a4d8-bc9e9facc56e</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>HUMAN</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <question>
                                    <answers>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Select correct Sold To</answer>
                                            <answerCode>soldtos_json</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                <code>GRID</code>
                                                <description>Grid</description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>false</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>false</showForMachineConfig>
                                                <title>Grid</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>${question.data['soldtos_json']}</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>1</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Sold-To</answer>
                                            <answerCode>soldto</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>readonly</htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Select correct Sold To</answer>
                                                <answerCode>soldtos_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['soldtos_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>true</required>
                                            <sequenceNumber>2</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Name</answer>
                                            <answerCode>name</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                <code>FREE_TEXT</code>
                                                <description></description>
                                                <optionsAvailable>false</optionsAvailable>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Free Text</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue></defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses>readonly</htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Select correct Sold To</answer>
                                                <answerCode>soldtos_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['soldtos_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>3</sequenceNumber>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Select</answer>
                                            <answerCode>selected</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>SELECT_FROM_LIST</answerTypeGroup>
                                                <code>SELECT_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Select One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>NO</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=YES|No=NO</options>
                                            <parentAnswer>
                                                <allowNA>false</allowNA>
                                                <answer>Select correct Sold To</answer>
                                                <answerCode>soldtos_json</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                                    <code>GRID</code>
                                                    <description>Grid</description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>false</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>false</showForMachineConfig>
                                                    <title>Grid</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <category></category>
                                                <constantable>false</constantable>
                                                <defaultValue>${question.data['soldtos_json']}</defaultValue>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <htmlClasses></htmlClasses>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </parentAnswer>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>4</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                        <answer>
                                            <allowNA>false</allowNA>
                                            <answer>Quit processing this order</answer>
                                            <answerCode>cancel_soldto</answerCode>
                                            <answerHtml></answerHtml>
                                            <answerTypeObject>
                                                <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                                <code>CHECK_ONE</code>
                                                <description></description>
                                                <optionsAvailable>true</optionsAvailable>
                                                <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                                <showDefaultValue>true</showDefaultValue>
                                                <showForFieldScheme>true</showForFieldScheme>
                                                <showForHumanTask>true</showForHumanTask>
                                                <showForMachineConfig>true</showForMachineConfig>
                                                <title>Check One</title>
                                                <valueType>SINGLEVALUE</valueType>
                                            </answerTypeObject>
                                            <appendDataStoreOptions>false</appendDataStoreOptions>
                                            <autocompleteField>false</autocompleteField>
                                            <category></category>
                                            <constantable>false</constantable>
                                            <defaultValue>NO</defaultValue>
                                            <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                            <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                            <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                            <htmlClasses></htmlClasses>
                                            <lastModified>2018-09-02T14:41:30Z</lastModified>
                                            <letCustomValues>false</letCustomValues>
                                            <manualField>false</manualField>
                                            <multiValue>false</multiValue>
                                            <options>Yes=YES|No=NO</options>
                                            <percentRequired>false</percentRequired>
                                            <range>false</range>
                                            <required>false</required>
                                            <sequenceNumber>5</sequenceNumber>
                                            <shuffle>false</shuffle>
                                            <useBlocks>false</useBlocks>
                                            <useEmptyCell>false</useEmptyCell>
                                        </answer>
                                    </answers>
                                    <assignmentDuration>1800000</assignmentDuration>
                                    <assignmentLimit>1</assignmentLimit>
                                    <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                                    <autoApprovalDelay>432000000</autoApprovalDelay>
                                    <automaticallyProcessed>0</automaticallyProcessed>
                                    <blockSize>1</blockSize>
                                    <constQualifiedWorkers>false</constQualifiedWorkers>
                                    <currency>USD</currency>
                                    <description>Miscellaneous Tasks</description>
                                    <dynamicTaskRenderingDisabled>true</dynamicTaskRenderingDisabled>
                                    <expiredTime>2592000000</expiredTime>
                                    <faqItems/>
                                    <frameHeight>2500</frameHeight>
                                    <geolocationEnabled>false</geolocationEnabled>
                                    <instructionItems/>
                                    <keywords>Miscellaneous Tasks</keywords>
                                    <maxAssignments>1</maxAssignments>
                                    <moderation>false</moderation>
                                    <moderationFlag>false</moderationFlag>
                                    <origination>CREATED_MANUALLY</origination>
                                    <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                                    <qualificationInstruction></qualificationInstruction>
                                    <qualificationRequirements/>
                                    <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                                    <qualificationTasks>20</qualificationTasks>
                                    <qualificationTraining>false</qualificationTraining>
                                    <questionRuleMaps>
                                        <questionRuleMap>
                                            <businessRule>
                                                <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                <name>Start with one assignment 1+0 pay all</name>
                                                <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                                <ruleType>DROOLS</ruleType>
                                                <ruleTypeUI>Adjudication</ruleTypeUI>
                                                <template>
                                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                                    <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                                    <name>Start with 1 assignment X+0 rule (pay all)</name>
                                                    <params>
                                                        <param>
                                                            <code>MAJORITY_VALUE</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Number of correct answers</description>
                                                            <name>Majority value</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>70</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                            <name>Worst accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                            <name>Worst accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>95</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                            <name>Super accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                            <defaultValue>80</defaultValue>
                                                            <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                            <name>Normal accuracy level score</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAX_ASSIGNMENT_LIMIT</code>
                                                            <defaultValue>1</defaultValue>
                                                            <description>Maximum number of assignments</description>
                                                            <name>Max assignments limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                            <name>Super accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                            <defaultValue>75</defaultValue>
                                                            <description>Normal accuracy level lower limit in percents inclusive</description>
                                                            <name>Normal accuracy level lower limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>CHECK_EVERY</code>
                                                            <defaultValue>5</defaultValue>
                                                            <description>Check every i-th gold question when evaluating qualification score</description>
                                                            <name>Check every i-th gold question</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>MAJORITY_HIT_THRESHOLD</code>
                                                            <defaultValue>100</defaultValue>
                                                            <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                            <name>Percent of correct answers</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                        <param>
                                                            <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                            <defaultValue>90</defaultValue>
                                                            <description>Normal accuracy level upper limit in percents exclusive</description>
                                                            <name>Normal accuracy level upper limit</name>
                                                            <type>INPUT_NUMBER</type>
                                                        </param>
                                                    </params>
                                                </template>
                                                <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                                            </businessRule>
                                        </questionRuleMap>
                                    </questionRuleMaps>
                                    <radiusSelector>ExactLocation</radiusSelector>
                                    <randomizeAnswers>false</randomizeAnswers>
                                    <recursiveThreshold>1</recursiveThreshold>
                                    <restrictedCountries/>
                                    <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                                    <templates>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
 
&lt;@instructions title="&lt;h2&gt;Select SoldTo1&lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;&lt;strong&gt;Document link:&amp;nbsp;&lt;a href="https://wfapp-dev.workfusion.pg.com/workfusion/secure/business-process/edit/$%7Bquestion.data['document_link']%7D" target="_blank" data-mce-href="$%7Bquestion.data['document_link']%7D"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;&lt;/strong&gt;&lt;table style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;" border="2" width="604" data-mce-style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;" data-mce-selected="1"&gt;&lt;caption&gt;&amp;nbsp;&lt;/caption&gt;&lt;tbody&gt;&lt;tr style="height: 17.6px;" data-mce-style="height: 17.6px;"&gt;&lt;td style="width: 146.8px; text-align: center; height: 17.6px;" data-mce-style="width: 146.8px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Customer name&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Address&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;City&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Zip code&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 17px;" data-mce-style="height: 17px;"&gt;&lt;td style="width: 146.8px; height: 17px;" data-mce-style="width: 146.8px; height: 17px;"&gt;${question.data['ship_to_name']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_street_name']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_location']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_postal_code']}&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div id="mceResizeHandlenw" data-mce-bogus="all" class="mce-resizehandle" unselectable="true" data-mce-style="cursor: nw-resize; margin: 0px; padding: 0px; left: 34.6111px; top: 13.2778px;" style="cursor: nw-resize; margin: 0px; padding: 0px; left: 34.6111px; top: 13.2778px;"&gt;&lt;/div&gt;&lt;div id="mceResizeHandlene" data-mce-bogus="all" class="mce-resizehandle" unselectable="true" data-mce-style="cursor: ne-resize; margin: 0px; padding: 0px; left: 899.5px; top: 13.2778px;" style="cursor: ne-resize; margin: 0px; padding: 0px; left: 899.5px; top: 13.2778px;"&gt;&lt;/div&gt;&lt;div id="mceResizeHandlese" data-mce-bogus="all" class="mce-resizehandle" unselectable="true" data-mce-style="cursor: se-resize; margin: 0px; padding: 0px; left: 899.5px; top: 74.6111px;" style="cursor: se-resize; margin: 0px; padding: 0px; left: 899.5px; top: 74.6111px;"&gt;&lt;/div&gt;&lt;div id="mceResizeHandlesw" data-mce-bogus="all" class="mce-resizehandle" unselectable="true" data-mce-style="cursor: sw-resize; margin: 0px; padding: 0px; left: 34.6111px; top: 74.6111px;" style="cursor: sw-resize; margin: 0px; padding: 0px; left: 34.6111px; top: 74.6111px;"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 39.11111068725586px; top: 54.88888931274414px; height: 4px; width: 865px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 39.11111068725586px; top: 54.88888931274414px; height: 4px; width: 865px; " data-row="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 39.11111068725586px; top: 75.88888931274414px; height: 4px; width: 865px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 39.11111068725586px; top: 75.88888931274414px; height: 4px; width: 865px; " data-row="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 231.7777862548828px; top: 17.77777862548828px; height: 61px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 231.7777862548828px; top: 17.77777862548828px; height: 61px; width: 4px; " data-col="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 464.6666564941406px; top: 17.77777862548828px; height: 61px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 464.6666564941406px; top: 17.77777862548828px; height: 61px; width: 4px; " data-col="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 670.888916015625px; top: 17.77777862548828px; height: 61px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 670.888916015625px; top: 17.77777862548828px; height: 61px; width: 4px; " data-col="2"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 900.888916015625px; top: 17.77777862548828px; height: 61px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 900.888916015625px; top: 17.77777862548828px; height: 61px; width: 4px; " data-col="3"&gt;&lt;/div&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;
  &lt;script&gt;
  $(document).ready(function(){
    
     $("input[id$='rdd']").addClass( "rddDateFormat" ); 
  });
    
 $(".disabledField input").prop(&#160;"disabled",&#160;true&#160;);

 $.validator.addMethod(
    "rddDateFormat",
    function(value, element) {
        var re = /^\d{1,2}.\d{1,2}.\d{4}$/;

      if(value.trim().toLowerCase()==='asap' || value.trim().toLowerCase()==='a.s.a.p.') return true;
      if((this.optional(element) &amp;&amp; value=="") || !re.test(value) ) return false;
    });
  }
  
  var rules = {};
$(".htCore td").each(function(v,i) {
   rules[v.name] = {
        required: $('input[name*="cancel_soldto_toCheck"]:checked').val() == "YES"] ? true : false,
        maxlength: 1,
           messages: {
            required: "Required input",
            minlength: jQuery.format("At least {0} characters are necessary")
        }
   };
});    
    
$('#mainform').validate({
  rules: rules
});   
  &lt;/script&gt;</content>
                                            <name>Select SoldTo1</name>
                                            <origination>CREATED_AUTOMATICALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>TASK</type>
                                            <uuid>63d33cf9-a7cc-4b57-b94a-3dfeb8bf0e5f</uuid>
                                            <version>
                                                <componentUuid>53a223f1-63f5-4fca-bdec-476989d315fc</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                                <versionUuid>1ea88d2e-390e-4281-b164-517b4f518cc8</versionUuid>
                                            </version>
                                        </template>
                                    </templates>
                                    <title>Select SoldTo1</title>
                                    <useCommonHitCoordinates>false</useCommonHitCoordinates>
                                    <uuid>276096a5-f1d6-448d-aaa4-f1da17e136c3</uuid>
                                    <version>
                                        <componentUuid>9885d5a1-62fc-4538-8e9a-57fb92f1df3f</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>223541ac-a73f-4827-a1da-31a7ad1eae35</versionUuid>
                                    </version>
                                    <workSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>HUMAN</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1104</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac8</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac8</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:00Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac8</versionUuid>
                                        </version>
                                        <answers/>
                                        <businessRules/>
                                        <isPrivate>false</isPrivate>
                                        <items>
                                            <item>
                                                <type>RECOMMENDATION_TAGS</type>
                                                <value>["information_extraction"]</value>
                                            </item>
                                            <item>
                                                <type>AUTOMATICALLY_APPROVED</type>
                                                <value>432000000</value>
                                            </item>
                                            <item>
                                                <type>TIME_PER_ASSIGNMENT</type>
                                                <value>1800000</value>
                                            </item>
                                            <item>
                                                <type>TITLE</type>
                                                <value>Miscellaneous Tasks</value>
                                            </item>
                                            <item>
                                                <type>HIT_EXPIRES_IN</type>
                                                <value>2592000000</value>
                                            </item>
                                            <item>
                                                <type>ADJUDICATION_RULE</type>
                                                <value>3</value>
                                            </item>
                                        </items>
                                        <template>
                                            <code></code>
                                            <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="&lt;h2&gt;BLANK&lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;${question.data.blank} &lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc3</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc3</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc3</versionUuid>
                                            </version>
                                        </template>
                                    </workSetting>
                                    <workSpacePreviewData>[{"name":"created","value":"${question.data['creation_sorting_dttm']}"},{"name":"customer","value":"${question.data['ship_to_name']}"},{"name":"city","value":"${question.data['ship_to_location']}"},{"name":"rdd","value":"${question.data['order_sorting_date']}"},{"name":"po_number","value":"${question.data['po_number']}"},{"name":"id","value":"${question.data['uuid']}-${question.data['mail_id']}"}]</workSpacePreviewData>
                                    <workSpacePreviewScheme>
                                        <answers>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Created</answer>
                                                <answerCode>created</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:48Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>1</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Customer</answer>
                                                <answerCode>customer</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:05Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>2</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>City</answer>
                                                <answerCode>city</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:14:26Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>3</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>RDD</answer>
                                                <answerCode>rdd</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:20Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>4</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>PO number</answer>
                                                <answerCode>po_number</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:15:47Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>5</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                            <answer>
                                                <allowNA>false</allowNA>
                                                <answer>Id</answer>
                                                <answerCode>id</answerCode>
                                                <answerHtml></answerHtml>
                                                <answerTypeObject>
                                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                                    <code>FREE_TEXT</code>
                                                    <description></description>
                                                    <optionsAvailable>false</optionsAvailable>
                                                    <showDefaultValue>true</showDefaultValue>
                                                    <showForFieldScheme>true</showForFieldScheme>
                                                    <showForHumanTask>true</showForHumanTask>
                                                    <showForMachineConfig>true</showForMachineConfig>
                                                    <title>Free Text</title>
                                                    <valueType>SINGLEVALUE</valueType>
                                                </answerTypeObject>
                                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                                <autocompleteField>false</autocompleteField>
                                                <constantable>false</constantable>
                                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                                <lastModified>2018-04-19T09:13:01Z</lastModified>
                                                <letCustomValues>false</letCustomValues>
                                                <manualField>false</manualField>
                                                <multiValue>false</multiValue>
                                                <percentRequired>false</percentRequired>
                                                <range>false</range>
                                                <required>false</required>
                                                <sequenceNumber>6</sequenceNumber>
                                                <useBlocks>false</useBlocks>
                                                <useEmptyCell>false</useEmptyCell>
                                            </answer>
                                        </answers>
                                        <description></description>
                                        <id>176</id>
                                        <name>DACH - manual task sorting for RPA fix 0.5 v.2</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <uuid>4a666baf-f4a4-4b50-b84e-235a736b6d8f</uuid>
                                    </workSpacePreviewScheme>
                                </question>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Select SoldTo1</title>
                                <type>SINGLE</type>
                                <uuid>86153326-4ab7-44cf-9ae2-1da86875f6e8</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>90de3a66-c34e-422c-bbca-0a766ca6a60e</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>2d4f7689-1203-4b31-a10f-da630c0cf116</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>85</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>588631aa-f494-4836-9c37-31c6dedb5f9d</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content># Rule.Definition={"moderationRule":false,"approveAllRule":false,"splitData":false,"splitRule":false,"splitRuleSuffix":"","joinRule":false,"joinRuleSuffix":"","streamingRule":false,"streamingRuleSuffix":"","namedRule":false,"namedRuleName":""}
package com.freedomoss.requester;

# list any import classes here.
import java.util.Map;
import java.util.ArrayList;
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import org.slf4j.Logger;


# declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
agenda-group "initialization-group"
    when
        $ctx:CompositeRuleContext(initialized == false);
    then
        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end

# RuleOutcome.Definition={"outcomeId":"YES","conditional":true,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[{"fieldName":"cancel_soldto","value":"YES","operator":"EQ"}],"customConditions":[]}
rule "1. Send records to 'YES' when cancel_soldto EQ 'YES'"
agenda-group "calculation"
dialect "mvel"
salience 100
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
        eval($item.checkValue("cancel_soldto", "EQ", "YES"));

    then
        $ctx.sendResultTo("YES", $item);
end



# RuleOutcome.Definition={"outcomeId":"NO","conditional":false,"reworkBySameWorker":false,"assignToSameWorker":false,"anableLogging":false,"sendRejectNotification":false,"assignToAnyWorker":false,"approveRelatedAssignments":false,"rejectRelatedAssignments":false,"renameAutomationAnswerItem":false,"conditions":[],"customConditions":[]}
rule "Send unprocessed result to unconditional outcome(s)"
agenda-group "calculation"
dialect "mvel"
salience 80
    when
        $ctx:CompositeRuleContext(initialized == true);
        $item:CompositeRuleDataItemContext();
    then
        $ctx.sendResultToUnconditionalOutcomes($item, true);
end</content>
                                <name>Cancel selection</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>71f038d6-012c-40ce-a7e2-26c0b03bc2f6</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	&lt;script&gt;&lt;![CDATA[
      import groovy.json.JsonSlurper;

	sold_to2 = "";
      def json = "${soldtos_json}".toString();

      def jsonSlurper = new JsonSlurper();
      def soldtos = jsonSlurper.parseText(json).soldtos_json;

	log.warn("soldtos=" + soldtos);
      log.warn("s size=" + soldtos.size());
      for(s in soldtos){
        log.warn("s '" + s + "' selected='" + s.selected.toUpperCase());
		if (s.selected.toUpperCase().equals("YES")){
			sold_to2 = s.soldto;
			log.warn("sold_to2 " + sold_to2);
			break;
        }
	}
	]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
      &lt;single-column name="sold_to" value="${sold_to2}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>d58437dc-ca73-43c8-8a97-38ddd4e1ac6e</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[192] soldTos flatenization1</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>d58437dc-ca73-43c8-8a97-38ddd4e1ac6e</uuid>
                                    <version>
                                        <componentUuid>7aa80293-fb23-4d1a-9a2a-46e31e89ab8e</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>deaa1f0e-1977-4acd-9953-6494fe26aad8</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[192] soldTos flatenization1</title>
                                <type>SINGLE</type>
                                <uuid>7c319b17-0dfd-4896-841a-066306ad64e2</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>4c2c4c94-3d17-4210-9160-75c252fbf426</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>1e1bc643-de8f-42de-b2d6-46a86640b0ec</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>86</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>34021dcb-741c-45b9-a705-916df08d95ee</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>de562a45-68ed-450a-9041-051035a3b157</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
	&lt;script&gt;&lt;![CDATA[
import groovy.json.JsonOutput;

//String error_data_list = "2001503000;MAGMAPOOL SALES &amp; MARKETING|2002823829;MAGMAPOOL SALES &amp; MARKETING|"

def soldtosArray = [];
def errorDatas = Arrays.asList("${error_data}".toString().split("\\|"));
for (int i = 0; i &lt; errorDatas.size(); i++) {
	def errorDetails = errorDatas[i].toString().split("\\;");
			def obj = [
				selected: "NO",
				soldto: errorDetails[0],
				name: errorDetails[1],
			]
			soldtosArray.add(obj);
		}

soldtos_json = JsonOutput.toJson([soldtos_json: soldtosArray]);

//println("soldtos_json=" + soldtos_json);
log.warn("soldtos_json=" + soldtos_json);
]]&gt;&lt;/script&gt;

	&lt;export include-original-data="true"&gt;
		&lt;single-column name="soldtos_json" value="${soldtos_json}" /&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>2912f304-36f5-4aa9-a443-5847f8a2428b</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>[191] create SoldTos JSON1</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>2912f304-36f5-4aa9-a443-5847f8a2428b</uuid>
                                    <version>
                                        <componentUuid>98b53a6a-409b-46bc-836c-5444c1c101d2</componentUuid>
                                        <incrementalVersion>1.0</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-02T14:41:30Z</lastModified>
                                        <versionUuid>d6ed0e92-1a33-41a4-8995-cd9c0f07792a</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>[191] create SoldTos JSON1</title>
                                <type>SINGLE</type>
                                <uuid>a734b510-86cb-4c17-8d67-8b8f4355bc5f</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>df4ca215-efc7-439f-9260-8f6143f34d62</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>46a152fe-e8c9-4741-b65b-92ed2d382c0b</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>87</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>2b13d105-f59a-49a6-829b-926bc59e21ba</uuid>
                        </campaignMap>
                        <campaignMap>
                            <blockSize>1</blockSize>
                            <businessRule>
                                <content>#RuleContext.APPROVE_ALL_RULE</content>
                                <name>Approve All</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <ruleTypeUI>Composite</ruleTypeUI>
                                <uuid>7bab313a-c94a-44e1-b3ea-274c8895c3d2</uuid>
                                <workflowRuleMode>SIMPLE</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config"
	scriptlang="groovy"&gt;
  
	&lt;script&gt;&lt;![CDATA[
		import com.freedomoss.crowdcontrol.webharvest.RunDto;
		import com.freedomoss.crowdcontrol.webharvest.WebHarvestTaskItem;

		def poNum = null;
		if (po_number.toString() != null) {
			if (!po_number.toString().equals("")) {
				poNum = po_number.toString();
			}
		}

		def shipToName = null;
		if (ship_to_name.toString() != null) {
			if (!ship_to_name.toString().equals("")) {
				shipToName = ship_to_name.toString();
			}
		}

		id = "[${uuid}-${mail_id}]";

		RunDto run = (RunDto) ((WebHarvestTaskItem) item.getWrappedObject()).getRun();
		sandbox = run.isSandbox()?"Sandbox":"Production";

		emailFrom = confirmation_email_from.toString();
		emailTo = confirmation_email_recipient.toString();

  		emailSubject = "[RPA][NE][action required] " +
            "RPA &gt; Derivation fix task for " + 
			(poNum?("purchase order " + poNum):"order") +
			" from " +
			((shipToName?:"unknown customer")).replaceAll("[\n\r]+", "");

		emailBody = """
			Dear team,&lt;br/&gt;
			&lt;br/&gt;
   			There was a &lt;b&gt;Sold to selection&lt;/b&gt; manual task generated for you.&lt;/br&gt;
   			Please navigate to &lt;a href="https://wfapp-dev.workfusion.pg.com/workspace/"&gt;Workfusion Workspace&lt;/a&gt;&lt;br/&gt;
			Should you have any questions or comments, please contact &lt;a href="mailto:dachrpa@hpe.com"&gt;DevOps team&lt;/a&gt; referring following details
			&lt;table border="1"&gt;
				&lt;tr&gt;&lt;td&gt;debug mode&lt;/td&gt;&lt;td&gt;${debug_mode}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order pickup server datetime&lt;/td&gt;&lt;td&gt;${creation_sorting_dttm}&lt;/td&gt;&lt;/tr&gt;
    			&lt;tr&gt;&lt;td&gt;environment&lt;/td&gt;&lt;td&gt;${sandbox}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;identifier&lt;/td&gt;&lt;td&gt;${id}&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;order document&lt;/td&gt;&lt;td&gt;${document_link}&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
		""";
	]]&gt;&lt;/script&gt;

	&lt;mail smtp-host="${smtp_server_host}" type="html" smtp-port="${smtp_server_port}" from="${emailFrom}"
		to="${emailTo}" subject="${emailSubject}"&gt;
		&lt;template&gt;&lt;![CDATA[
			${emailBody}
		]]&gt;&lt;/template&gt;
	&lt;/mail&gt;

	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                    <description></description>
                                    <includedConfigs/>
                                    <inclusionCode>f20a9588-66d9-443b-9350-86d7fa17a784</inclusionCode>
                                    <jsonParams>{"configXMLModified":"true"}</jsonParams>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <machineWorkSettingType>BASIC</machineWorkSettingType>
                                    <name>Sold to selection notification</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>f20a9588-66d9-443b-9350-86d7fa17a784</uuid>
                                    <version>
                                        <componentUuid>93335d9b-d1b1-4579-b0f9-6f6633c9c5b8</componentUuid>
                                        <incrementalVersion>1.3</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-09-05T09:28:28Z</lastModified>
                                        <versionUuid>0709a296-b664-4f65-9513-545d5b248e2d</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>1</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Tasks</streamValueType>
                                <title>Sold to selection notification</title>
                                <type>SINGLE</type>
                                <uuid>6eec009b-aeac-487b-e7ea-ca8a3f99bbad</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>0d3910df-8fff-4d39-a9d7-cfa60402b52a</componentUuid>
                                    <incrementalVersion>1.2</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-05T09:28:32Z</lastModified>
                                    <versionUuid>40b1781e-97ce-4658-96d4-4c2b02c938cb</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>88</stepIndex>
                            <stepPosition>INTERMEDIATE</stepPosition>
                            <uuid>6b722687-1296-480b-e2f5-cb82b09d6a28</uuid>
                        </campaignMap>
                        <campaignMap>
                            <businessRule>
                                <content>package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.CompositeRuleContext;
import com.freedomoss.objective.model.CompositeRuleDataItemContext;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;
import org.slf4j.Logger;
import java.util.Map;
import java.util.Iterator;
import java.util.List;
import java.util.Set;
import java.util.ArrayList;
import com.freedomoss.requester.dto.SubmissionResultDTO;

#declare any global variables here
global CompositeRuleContext source
global Logger log
global Map params



rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:CompositeRuleContext(initialized == false);
	then
		$ctx.updateWorkingMemory();
		# move to business rules
		$ctx.logExecutedRule(kcontext.getRule().getName());
		kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
end</content>
                                <name>Business Process: End Rule</name>
                                <ruleType>WORKFLOW_RULE</ruleType>
                                <uuid>6225dc20-e283-4408-a78d-8ec70f48eee5</uuid>
                                <workflowRuleMode>ADVANCED</workflowRuleMode>
                            </businessRule>
                            <campaign>
                                <active>false</active>
                                <businessRules/>
                                <campaignMaps/>
                                <campaigns/>
                                <executingType>MACHINE</executingType>
                                <goldBucketBlockSize>0</goldBucketBlockSize>
                                <goldRatio>0</goldRatio>
                                <goldSource>Empty</goldSource>
                                <goldType>Percentage</goldType>
                                <machineConfig>
                                    <answers/>
                                    <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;

    &lt;var-def name="exportType"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_type")}'&gt;
                &lt;template&gt;${_sys_export_type}&lt;/template&gt;
            &lt;/if&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="exportColumns"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_export_columns")}'&gt;
                &lt;template&gt;${_sys_export_columns}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="columnNameCase"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_column_name_case")}'&gt;
                &lt;template&gt;${_sys_column_name_case}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;keep&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="dataOnly"&gt;
        &lt;case&gt;
            &lt;if condition='${sys.isVariableDefined("_sys_data_only")}'&gt;
                &lt;template&gt;${_sys_data_only}&lt;/template&gt;
            &lt;/if&gt;
            &lt;else&gt;true&lt;/else&gt;
        &lt;/case&gt;
    &lt;/var-def&gt;

    &lt;var-def name="datastoreName"&gt;
        &lt;script return="item.getWrappedObject().getRun().getDatastoreName()" /&gt;
    &lt;/var-def&gt;
    &lt;case&gt;
        &lt;if condition="${!datastoreName.isEmpty()}"&gt;
            &lt;insert-datastore   datastore-name="${datastoreName}" create="true"&gt;
                &lt;script return="hit_submission_data_item.getWrappedObject().getItemValueMap()"/&gt;
            &lt;/insert-datastore&gt;
        &lt;/if&gt;
    &lt;/case&gt;

    &lt;export include-original-data="true"
            export-type="${exportType}"
            export-columns="${exportColumns}"
            column-name-case="${columnNameCase}"
            data-only="${dataOnly}"&gt;
    &lt;/export&gt;
&lt;/config&gt;</content>
                                    <description>Default machine campaign for end step.</description>
                                    <includedConfigs/>
                                    <inclusionCode>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</inclusionCode>
                                    <machineWorkSetting>
                                        <category>
                                            <automation>false</automation>
                                            <description></description>
                                            <enabled>true</enabled>
                                            <executingType>MACHINE</executingType>
                                            <name>Other</name>
                                            <private>false</private>
                                            <publicId>dd92f240-144b-4fef-8476-4ec0acbc1105</publicId>
                                        </category>
                                        <contentType>BLANK</contentType>
                                        <description></description>
                                        <enabled>true</enabled>
                                        <name>Miscellaneous Tasks</name>
                                        <publicId>26e6e095-00bb-43fa-8c34-af0b18e71ac9</publicId>
                                        <version>
                                            <componentUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2018-03-16T09:22:21Z</lastModified>
                                            <versionUuid>26e6e095-00bb-43fa-8c34-af0b18e71ac9</versionUuid>
                                        </version>
                                        <answers/>
                                        <machineWorkSettingType>BASIC</machineWorkSettingType>
                                        <template>
                                            <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                            <name>Blank</name>
                                            <origination>CREATED_MANUALLY</origination>
                                            <status>ACTIVE</status>
                                            <type>BASE_MACHINE</type>
                                            <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                            <version>
                                                <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                                <incrementalVersion>1.0</incrementalVersion>
                                                <lastInChain>true</lastInChain>
                                                <lastModified>2012-12-27T00:00:00Z</lastModified>
                                                <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                            </version>
                                        </template>
                                    </machineWorkSetting>
                                    <name>Final Results</name>
                                    <machineConfigOptions/>
                                    <sourceType>MANUAL</sourceType>
                                    <template>
                                        <content>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config charset="UTF-8"&gt;
	&lt;export include-original-data="true"&gt;
	&lt;/export&gt;
&lt;/config&gt;</content>
                                        <name>Blank</name>
                                        <origination>CREATED_MANUALLY</origination>
                                        <status>ACTIVE</status>
                                        <type>BASE_MACHINE</type>
                                        <uuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</uuid>
                                        <version>
                                            <componentUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</componentUuid>
                                            <incrementalVersion>1.0</incrementalVersion>
                                            <lastInChain>true</lastInChain>
                                            <lastModified>2012-12-27T00:00:00Z</lastModified>
                                            <versionUuid>8f04bd99-7f51-4796-a528-d1a7c9ccfbc4</versionUuid>
                                        </version>
                                    </template>
                                    <uuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</uuid>
                                    <version>
                                        <componentUuid>9e5000e3-c243-42d3-b5ad-c6ac90dec35e</componentUuid>
                                        <incrementalVersion>1.1</incrementalVersion>
                                        <lastInChain>true</lastInChain>
                                        <lastModified>2018-08-21T10:54:19Z</lastModified>
                                        <versionUuid>71976d1d-a48f-4ce5-ae4d-10203991bf95</versionUuid>
                                    </version>
                                </machineConfig>
                                <moderation>false</moderation>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <requiresData>true</requiresData>
                                <status>ACTIVE</status>
                                <streamComplexRunThreshold>100</streamComplexRunThreshold>
                                <streamTimeInterval>Immediately</streamTimeInterval>
                                <streamTimeIntervalValue>0</streamTimeIntervalValue>
                                <streamValueType>Percents</streamValueType>
                                <title>Final Results</title>
                                <type>SINGLE</type>
                                <uuid>af4c8905-26dd-4120-b208-39ad3530ffc6</uuid>
                                <validWorkflow>false</validWorkflow>
                                <version>
                                    <componentUuid>a7c3c527-28fb-11e8-bf41-000d3a0302a9</componentUuid>
                                    <incrementalVersion>1.1</incrementalVersion>
                                    <lastInChain>false</lastInChain>
                                    <lastModified>2018-08-21T10:54:19Z</lastModified>
                                    <versionUuid>56d0500e-1f1a-4755-9c95-600a8de71b5e</versionUuid>
                                </version>
                                <workSettingBase>false</workSettingBase>
                            </campaign>
                            <deleted>false</deleted>
                            <stepIndex>89</stepIndex>
                            <stepPosition>END</stepPosition>
                            <uuid>465145fd-8c41-4369-bbc3-4b5041baff7a</uuid>
                        </campaignMap>
                    </campaignMaps>
                    <campaigns/>
                    <compositeCampaignVersion>NEW_WORKFLOW</compositeCampaignVersion>
                    <compositeStructureXml>&lt;mxGraphModel&gt;&lt;root&gt;&lt;mxCell id="0"/&gt;&lt;mxCell id="1" parent="0"/&gt;&lt;Start id="2" name="Start" type="start"&gt;&lt;mxCell parent="1" style="start" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="-510.0" y="510.0"/&gt;&lt;/mxCell&gt;&lt;/Start&gt;&lt;End campaignMapUUID="465145fd-8c41-4369-bbc3-4b5041baff7a" id="3" name="End" type="end"&gt;&lt;mxCell parent="1" style="end" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="2070.0" y="1223.0"/&gt;&lt;/mxCell&gt;&lt;/End&gt;&lt;MachineTask campaignMapUUID="0674b08b-6cf4-4ffd-8c4a-9eee698f28c7" id="4" name="[100] Load testcases      32 [2018-08-09 10:22:56]                                             " taskUUID="1739a8e1-fa38-47ab-a328-5f64ddd76136" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-374.0" y="102.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="2876b9fe-3bfe-43f1-b3a6-8b6e847b26cc" id="5" name="[110] OCR transliteration fix (prod_cod_list_fix_cnt)      32 [2018-08-09 10:22:56]                                             " taskUUID="76ad96b3-ced2-4226-94c5-8547f7e63e88" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-134.0" y="790.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="6" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="2" style="link" target="205"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="-494.0" y="-270.0"/&gt;&lt;mxPoint x="-494.0" y="-270.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="7" name="" outcomeId="ApproveAll" ruleUUID="ccf30806-1c26-48c6-8171-6eaa2d5c7734" type="link"&gt;&lt;mxCell edge="1" parent="1" source="4" style="link" target="66"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="dc9cc266-73da-4ca2-bdd6-6ede6106bdc1" id="8" name="[120] BW report download      32 [2018-08-09 10:22:56]                                             " taskUUID="e9a01195-152e-4fb7-b76b-83a292e7e2ea" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="150.0" x="-414.0" y="977.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="f7b32e18-f4fe-42e2-9a86-9cde24f61d03" id="10" name="[130] shipTo derivation      32 [2018-08-09 10:22:56]                                             " taskUUID="8d79794f-eaad-41e9-938b-517addfc3b20" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-134.0" y="1080.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="e17d25d9-177b-40b5-abfe-2a7a9dd1a7dc" id="20" name="[140] GTIN format fix (from 6)      32 [2018-08-09 10:22:56]                                             " taskUUID="1d129388-5865-41d0-b388-c02a6aff6aa4" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="990.0" y="639.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="177e305b-bb16-497b-8d46-c5d6b6db885b" id="21" name="[160] RDD format fix      32 [2018-08-09 10:22:56]                                             " taskUUID="9b92ad53-00d4-4e92-979b-7c367c2d2b7c" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1170.0" y="1080.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="06b49056-7b3d-45e9-86af-0f355cc660e5" id="25" name="[170] validation      32 [2018-08-09 10:22:56]                                             " taskUUID="74501339-b44c-409b-8fb9-ad8954ed0b9b" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1390.0" y="929.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule id="27" name="isValid" ruleUUID="05e085ff-ba24-4663-ab57-4547309d8d61" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="1590.0" y="943.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="28" label="yes" name="" outcomeId="yes" ruleUUID="05e085ff-ba24-4663-ab57-4547309d8d61" type="link"&gt;&lt;mxCell edge="1" parent="1" source="27" style="link" target="31"&gt;&lt;mxGeometry as="geometry" y="63.0"&gt;&lt;mxPoint as="targetPoint" x="890.0" y="363.0"/&gt;&lt;mxPoint as="offset" x="-1.0" y="10.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="30" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="25" style="link" target="27"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="dba8e761-0ff8-432b-a97f-dd7b4d9d67f1" id="31" name="[180] wite to SAP" taskUUID="bb3adf79-5921-4e26-857e-6deca025829d" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1660.0" y="929.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="32" name="" outcomeId="ApproveAll" ruleUUID="45127273-f9b2-441f-bf3f-f876272526d6" type="link"&gt;&lt;mxCell edge="1" parent="1" source="31" style="link" target="213"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1740.0" y="1000.0"/&gt;&lt;mxPoint x="2226.0" y="1000.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="8f898522-bab8-4615-bee8-da8238617533" id="33" name="[200] Archiving      32 [2018-08-09 10:22:56]                                             " taskUUID="a162d27c-19a2-4ab6-8302-bbe140ffd1e8" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1860.0" y="1113.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="34" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="bd15ed1a-c872-4813-b7d7-f3f100dee68e" type="link"&gt;&lt;mxCell edge="1" parent="1" source="33" style="link" target="37"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="targetPoint" x="1140.0" y="313.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="38" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="ba7196b4-e90c-44dd-a208-b9df2d2522ef" type="link"&gt;&lt;mxCell edge="1" parent="1" source="37" style="link" target="3"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="d4c28020-7eeb-4393-b0a2-6a4e840d9080" id="39" name="[150] GTIN format fix (from 4,11)      32 [2018-08-09 10:22:56]                                             " taskUUID="de17bf2e-5419-4e45-b26d-0eea5509a0d4" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="990.0" y="820.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link conditional="true" id="43" label="no and no hope" name="" outcomeId="no and no hope" ruleUUID="05e085ff-ba24-4663-ab57-4547309d8d61" type="link"&gt;&lt;mxCell edge="1" parent="1" source="27" style="link" target="37"&gt;&lt;mxGeometry as="geometry" y="63.0"&gt;&lt;mxPoint as="targetPoint" x="650.0" y="283.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1606.0" y="1300.0"/&gt;&lt;mxPoint x="1940.0" y="1300.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-83.0" y="123.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="a8a05f57-0ba0-42ee-a61d-2dbd56df18a6" id="44" name="[010] mailbox reader" taskUUID="47949834-71f3-4c55-8562-0285273bbc8e" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="780.0" y="2.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="b1ec2644-3add-476a-ba86-57cb2e064130" id="47" name="[174] create products JSON and  error_list JSON      32 [2018-08-09 10:22:56]                                             " taskUUID="4df9a2dd-84b8-4247-87c8-0648cf37b252" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1390.0" y="527.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="afd376bf-8596-4916-96cd-0bb1275d3042" id="50" name="[176] product JSON flatenization      32 [2018-08-09 10:22:56]                                             " taskUUID="bddcfa22-d64a-42d4-9bbc-ecb23f3125c7" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1390.0" y="829.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="52" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="bf692641-bf66-47e2-a50e-694868b98c56" type="link"&gt;&lt;mxCell edge="1" parent="1" source="50" style="link" target="25"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="2931c8d1-6e9c-455e-b6ca-767ee7fc68e0" id="37" name="[210] summary email      32 [2018-08-09 10:22:56]                                             " taskUUID="79646ecf-537c-44cb-8aef-6c8ffc28eeb9" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1860.0" y="1209.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link conditional="true" id="55" label="no but hope" name="" outcomeId="no but hope" ruleUUID="05e085ff-ba24-4663-ab57-4547309d8d61" type="link"&gt;&lt;mxCell edge="1" parent="1" source="27" style="link" target="47"&gt;&lt;mxGeometry as="geometry" relative="1" x="-0.7803030303030303" y="-30.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1606.0" y="490.0"/&gt;&lt;mxPoint x="1470.0" y="490.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="4593bf94-197d-4b61-ae08-2a87b1212c96" id="56" name="[190] post-SAP validation  32 [2018-08-09 10:22:56]                                             " taskUUID="3bcc8647-8549-4d60-9c98-d873fa15931c" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1660.0" y="1030.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule id="57" name="[190] post-SAP validation " ruleUUID="20b2fdda-0b6e-45d7-96f0-601bbe02ad55" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="1724.0" y="1127.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link id="58" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="56" style="link" target="57"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="59" label="yes" name="" outcomeId="yes" ruleUUID="20b2fdda-0b6e-45d7-96f0-601bbe02ad55" type="link"&gt;&lt;mxCell edge="1" parent="1" source="57" style="link" target="33"&gt;&lt;mxGeometry as="geometry" y="63.0"&gt;&lt;mxPoint as="targetPoint" x="1174.0" y="672.0"/&gt;&lt;mxPoint as="offset" x="2.0" y="16.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="60" label="no" name="" outcomeId="no" ruleUUID="20b2fdda-0b6e-45d7-96f0-601bbe02ad55" type="link"&gt;&lt;mxCell edge="1" parent="1" source="57" style="link" target="465"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1174.0" y="672.0"/&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-81.0" y="45.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="61" name="[000] initialize        " ruleUUID="4ab28451-3ee8-4bbb-aba1-36ec7dd1c952" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="-310.0" y="16.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="62" label="YES" name="" outcomeId="YES" ruleUUID="4ab28451-3ee8-4bbb-aba1-36ec7dd1c952" type="link"&gt;&lt;mxCell edge="1" parent="1" source="61" style="link" target="4"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="500.0" y="51.0"/&gt;&lt;mxPoint as="offset" x="19.999999999999993" y="7.000000000000023"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="63" label="NO" name="" outcomeId="NO" ruleUUID="4ab28451-3ee8-4bbb-aba1-36ec7dd1c952" type="link"&gt;&lt;mxCell edge="1" parent="1" source="61" style="link" target="44"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="500.0" y="81.0"/&gt;&lt;mxPoint as="offset" x="-77.9999999999999" y="-45.000000000000036"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="b6fce3d7-9ff9-4157-adf4-e57db4e3d201" id="64" name="[000] initialize      32 [2018-08-09 10:22:56]                                             " taskUUID="974b05b9-5021-4b03-b0d2-00a8de240f51" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-574.0" y="2.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="65" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="64" style="link" target="61"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="66" name="OCR needed?" ruleUUID="4a6f9a79-634a-4b28-b0ec-5184c4d94312" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="-310.0" y="294.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="67" label="YES" name="" outcomeId="YES" ruleUUID="4a6f9a79-634a-4b28-b0ec-5184c4d94312" type="link"&gt;&lt;mxCell edge="1" parent="1" source="66" style="link" target="326"&gt;&lt;mxGeometry as="geometry" y="63.0"&gt;&lt;mxPoint as="targetPoint" x="690.0" y="295.0"/&gt;&lt;mxPoint as="offset" x="-38.00000000000005" y="-12.000000000000004"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="68" label="NO" name="" outcomeId="NO" ruleUUID="4a6f9a79-634a-4b28-b0ec-5184c4d94312" type="link"&gt;&lt;mxCell edge="1" parent="1" source="66" style="link" target="72"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="630.0" y="423.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="-294.0" y="720.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-100.0" y="-142.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="46f87e09-a9b7-4109-b97a-bd228a208013" id="72" name="export vector alignment      32 [2018-08-09 10:22:56]                                             " taskUUID="5118dd5a-201f-405a-8c7c-060f0972a0b7" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-134.0" y="690.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="9b645492-be31-4032-a3ae-8ee154d69b76" id="74" name="[115] Check S3 BW Report Cache      32 [2018-08-09 10:22:56]                                             " taskUUID="fcbcd118-ae9a-4de9-a04a-28938e6c9f08" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-134.0" y="891.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule id="75" name="Should download BW report" ruleUUID="dbcdd926-c14c-4f75-ac8a-844c063e1c20" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="814.0" y="991.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link id="76" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="91e57685-7550-4a39-9f7a-c9a9e8921e38" type="link"&gt;&lt;mxCell edge="1" parent="1" source="5" style="link" target="74"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="sourcePoint" x="1015.0" y="603.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="77" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="74" style="link" target="75"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="78" label="YES" name="" outcomeId="YES" ruleUUID="dbcdd926-c14c-4f75-ac8a-844c063e1c20" type="link"&gt;&lt;mxCell edge="1" parent="1" source="75" style="link" target="8"&gt;&lt;mxGeometry as="geometry" y="63.0"&gt;&lt;mxPoint as="targetPoint" x="650.0" y="683.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="79" label="NO" name="" outcomeId="NO" ruleUUID="dbcdd926-c14c-4f75-ac8a-844c063e1c20" type="link"&gt;&lt;mxCell edge="1" parent="1" source="75" style="link" target="10"&gt;&lt;mxGeometry as="geometry" y="63.0"&gt;&lt;mxPoint as="targetPoint" x="610.0" y="653.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="80" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="be9fa62b-fcc2-4fc6-964f-6c411fc15bcf" type="link"&gt;&lt;mxCell edge="1" parent="1" source="8" style="link" target="10"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="-334.0" y="1033.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;BusinessProcess id="81" label="" name="NE OCR v1" type="business_process"&gt;&lt;mxCell collapsed="1" parent="1" style="business_process_purple" vertex="1"&gt;&lt;mxGeometry as="geometry" height="80.0" width="180.0" x="826.0" y="270.0"&gt;&lt;mxRectangle as="alternateBounds" height="1646.0" width="1284.0" x="826.0" y="270.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/BusinessProcess&gt;&lt;MachineTask campaignMapUUID="063b40c4-bab2-4da3-88b3-65e258550c87" id="325" name="NorthernEurope_OCR_settings" taskUUID="000b27a8-7f8d-41ee-ace8-4db1e8010d96" type="machine_task"&gt;&lt;mxCell parent="81" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="917.2173913043478" y="132.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;SubStart campaignMapUUID="59e8a9bb-0339-465e-8787-8a576797316c" id="326" name="Start" type="sub_start"&gt;&lt;mxCell parent="81" style="start" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="981.2173913043478" y="40.0"/&gt;&lt;/mxCell&gt;&lt;/SubStart&gt;&lt;Link id="327" name="" type="link"&gt;&lt;mxCell edge="1" parent="81" source="326" style="link" target="325"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="308d5b02-2908-47d0-8f39-63d4e922d14c" id="328" name="NE PDF_to_TIFF" taskUUID="c0d6671a-fa5b-43d6-9d28-8a173d77207c" type="machine_task"&gt;&lt;mxCell parent="81" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="917.2173913043478" y="232.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="329" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="ddef76be-8800-40e8-abc7-b569675ecaff" type="link"&gt;&lt;mxCell edge="1" parent="81" source="325" style="link" target="328"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;BusinessProcess id="369" name="NE OCR Use Case" type="business_process"&gt;&lt;mxCell parent="81" style="business_process" vertex="1"&gt;&lt;mxGeometry as="geometry" height="834.0" width="896.0" x="191.2173913043478" y="340.0"&gt;&lt;mxRectangle as="alternateBounds" height="80.0" width="180.0" x="191.2173913043478" y="340.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/BusinessProcess&gt;&lt;SubEnd campaignMapUUID="49336325-6369-48f2-b990-3c8c397b7812" id="370" name="End" type="sub_end"&gt;&lt;mxCell collapsed="1" parent="369" style="end" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="546.0" y="544.0"/&gt;&lt;/mxCell&gt;&lt;/SubEnd&gt;&lt;SubStart campaignMapUUID="c30eb1df-39a3-4688-9acb-b4171ccf13b0" id="371" name="Start" type="sub_start"&gt;&lt;mxCell collapsed="1" parent="369" style="start" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="36.0" y="54.0"/&gt;&lt;/mxCell&gt;&lt;/SubStart&gt;&lt;MachineTask campaignMapUUID="c5fc08f5-d84c-4683-adf5-834b5f80eabb" id="372" name="NE Input data processing" taskUUID="76d2b75b-836c-4497-9840-90e1a5451455" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="156.0" y="40.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="df83d52b-87eb-4dc1-9609-b8f3c355f797" id="373" name="NE Look for OCR cache" taskUUID="2c055696-e4aa-49d1-b889-f9acbdd9f08c" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="446.0" y="40.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="374" name="" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="371" style="link" target="372"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="375" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="d46c316a-edf2-483a-9dfc-e6f64fc01c83" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="372" style="link" target="373"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="376" name="Cache hit?" ruleUUID="83a9df55-1f0a-40f1-9e27-f51bc9c7b01c" type="rule"&gt;&lt;mxCell collapsed="1" parent="369" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="720.0" y="168.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="377" label="Yes" name="" outcomeId="Yes" ruleUUID="83a9df55-1f0a-40f1-9e27-f51bc9c7b01c" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="376" style="link" target="401"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="470.0" y="391.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="736.0" y="274.0"/&gt;&lt;mxPoint x="736.0" y="274.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="false" id="378" label="No" name="" outcomeId="No" ruleUUID="83a9df55-1f0a-40f1-9e27-f51bc9c7b01c" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="376" style="link" target="380"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="470.0" y="421.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="379" name="" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="373" style="link" target="376"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="e1d5f929-6541-4082-935f-47ca3b2f3bf8" id="380" name="NE GoTo OCR" taskUUID="97dc9f56-8be7-4520-9cf3-59329895832b" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="406.0" y="154.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule id="381" name="OCR Type" ruleUUID="29462494-6859-41f6-b92c-689625a8bf97" type="rule"&gt;&lt;mxCell collapsed="1" parent="369" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="290.0" y="168.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="382" label="TOOD" name="" outcomeId="TOOD" ruleUUID="29462494-6859-41f6-b92c-689625a8bf97" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="381" style="link" target="388"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="660.0" y="411.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="306.0" y="224.0"/&gt;&lt;mxPoint x="156.0" y="224.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="383" label="Standard" name="" outcomeId="Standard" ruleUUID="29462494-6859-41f6-b92c-689625a8bf97" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="381" style="link" target="385"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="660.0" y="441.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="306.0" y="304.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="384" name="" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="380" style="link" target="381"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="f75500bf-85bd-4ea8-aecd-6852e25b9f1c" id="385" name="NE [Standard] OCR" taskUUID="170e140c-5a95-44c8-a750-c5270ac71145" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="396.0" y="274.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="386" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="736a344c-5cb9-468b-a575-388a9269bdc1" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="385" style="link" target="387"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="586.0" y="304.0"/&gt;&lt;mxPoint x="586.0" y="444.0"/&gt;&lt;mxPoint x="306.0" y="444.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="aa04bcac-01f2-4bd8-97c9-95dd112489c9" id="387" name="NE Response from OCR" taskUUID="8ffa204d-6884-41a2-9e56-306867ff76a6" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="226.0" y="474.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="c2d5663b-75d6-410c-835d-5e5b38f54cdc" id="388" name="NE [TOOD] Split document into PNG pages" taskUUID="b2851eb8-ea88-4a6d-b865-63bd197eeaa2" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="76.0" y="254.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="bc29876f-88f4-44f7-83fa-f9e82550a766" id="389" name="NE [TOOD] OCR" taskUUID="451f8589-6091-4d6e-987a-5df82f41202a" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="76.0" y="364.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="390" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="2e313db3-5d0f-4941-a1c7-49463649e0f0" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="388" style="link" target="389"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="391" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="dec58616-fda5-4c84-936c-e7a9822fae6e" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="389" style="link" target="387"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="f70bdcc2-651b-4296-871f-c3a736ae8a06" id="392" name="NE XSLT Cut off Raw OCR XML tags" taskUUID="6a17d1fb-fc55-48a6-b4d8-90ed2c7bbbbb" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="196.0" y="624.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="393" name="" outcomeId="ApproveAll" ruleUUID="f2055385-e272-45ee-9920-c724363deabf" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="392" style="link" target="405"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="394" name="" outcomeId="ApproveAll" ruleUUID="0b00b741-8ae4-4c2d-cbb0-77a46f356193" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="387" style="link" target="395"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="395" name="OCR Router" ruleUUID="a4212d99-92e3-46cc-8662-1c3d98a2ec93" type="rule"&gt;&lt;mxCell collapsed="1" parent="369" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="20.0" y="570.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="396" label="OCR Failed" name="" outcomeId="OCR Failed" ruleUUID="a4212d99-92e3-46cc-8662-1c3d98a2ec93" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="395" style="link" target="370"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="140.0" y="571.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="397" label="TOOD" name="" outcomeId="TOOD" ruleUUID="a4212d99-92e3-46cc-8662-1c3d98a2ec93" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="395" style="link" target="392"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="140.0" y="571.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="398" label="Standard" name="" outcomeId="Standard" ruleUUID="a4212d99-92e3-46cc-8662-1c3d98a2ec93" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="395" style="link" target="392"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="140.0" y="571.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="36.0" y="644.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="399" label="Standard (without xml export format)" name="" outcomeId="Standard (without xml export format)" ruleUUID="a4212d99-92e3-46cc-8662-1c3d98a2ec93" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="395" style="link" target="400"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="180.0" y="790.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="36.0" y="794.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-5.0" y="86.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="ffb67f05-8ebc-4e8d-8a74-e9cda1f31cf4" id="400" name="NE Cache OCR results" taskUUID="bbf487ab-aa33-4d82-a4b1-b325e0984234" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="566.0" y="754.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="1ef47732-2504-40a5-8d37-3bd16d62b4bd" id="401" name="NE Result JSON processing" taskUUID="ca363c0e-f18f-431a-a8e5-7342e2fb087d" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="716.0" y="530.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="402" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="6a38c147-2900-4ce8-bd8e-b5e80edec98f" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="401" style="link" target="370"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="403" label="Standard" name="" outcomeId="Standard" ruleUUID="8f99729a-5bbd-494f-b1bc-bce889b4a9ad" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="405" style="link" target="400"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="480.0" y="321.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="466.0" y="764.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="404" label="TOOD" name="" outcomeId="TOOD" ruleUUID="8f99729a-5bbd-494f-b1bc-bce889b4a9ad" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="405" style="link" target="406"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="480.0" y="321.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="405" name="OCR Type" ruleUUID="8f99729a-5bbd-494f-b1bc-bce889b4a9ad" type="rule"&gt;&lt;mxCell collapsed="1" parent="369" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="436.0" y="638.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;MachineTask campaignMapUUID="ba0f919d-e88a-484c-815b-4b9d2b33b6b9" id="406" name="NE [TOOD] XSLT XML Enrichment with WORD and DIV tags" taskUUID="e447d790-357a-4052-b77b-755c3025bb79" type="machine_task"&gt;&lt;mxCell collapsed="1" parent="369" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="566.0" y="624.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="407" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="32a0d590-11ca-4f22-9d31-79ef27cac551" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="406" style="link" target="400"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="408" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="c603cbcb-ca8d-4ce9-a313-768c80a154bd" type="link"&gt;&lt;mxCell collapsed="1" edge="1" parent="369" source="400" style="link" target="401"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="796.0" y="794.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="409" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="041233f8-c450-4d68-9fff-371e7e602fc9" type="link"&gt;&lt;mxCell edge="1" parent="81" source="328" style="link" target="371"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;SubEnd campaignMapUUID="317fc74f-33f6-4de9-8b0b-fa9180318366" id="410" name="End" type="sub_end"&gt;&lt;mxCell parent="81" style="end" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="960.2173913043478" y="1594.0"/&gt;&lt;/mxCell&gt;&lt;/SubEnd&gt;&lt;Rule id="411" name="OCR Type" ruleUUID="f433264b-fdca-4208-9fa1-3347543407e7" type="rule"&gt;&lt;mxCell parent="81" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="981.2173913043478" y="1224.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link id="412" name="" type="link"&gt;&lt;mxCell edge="1" parent="81" source="370" style="link" target="411"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="413" label="TOOD" name="" outcomeId="TOOD" ruleUUID="f433264b-fdca-4208-9fa1-3347543407e7" type="link"&gt;&lt;mxCell edge="1" parent="81" source="411" style="link" target="418"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="585.0" y="501.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="414" label="Standard" name="" outcomeId="Standard" ruleUUID="f433264b-fdca-4208-9fa1-3347543407e7" type="link"&gt;&lt;mxCell edge="1" parent="81" source="411" style="link" target="415"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="585.0" y="501.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="30df4372-1bfb-48c0-9f8f-aaaa42a7fbbe" id="415" name="[Standard] Prepare URL- ATROCR_" taskUUID="ea22e111-d9d3-412d-824e-c8ebc3362cb1" type="machine_task"&gt;&lt;mxCell parent="81" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1104.0" y="1209.8333333333335"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="7057a37f-ff0d-4793-84b9-6727495c246c" id="416" name="Additional XML processing" taskUUID="4dd6b3b3-6b2f-47cf-9b63-645770ac9abb" type="machine_task"&gt;&lt;mxCell parent="81" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1104.0" y="1320.8333333333335"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="417" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="9f3df3c3-99b9-4fde-b966-5fbedc8f5f83" type="link"&gt;&lt;mxCell edge="1" parent="81" source="415" style="link" target="416"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="9aab8df9-b254-414a-a149-68fb47f15ec6" id="418" name="[TOOD] Prepare URL- ATROCR_" taskUUID="0a632e79-6225-4972-92f3-7e0457d6f98e" type="machine_task"&gt;&lt;mxCell parent="81" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="20.0" y="1209.8333333333335"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;HumanTask campaignMapUUID="8e6681f8-ff9d-4c2c-ba77-6b5fab40abf5" id="419" name="[TOOD][MT][BASE] NE test set" taskUUID="e5a64d4d-b9ac-497b-b992-d2b0b55ae328" type="human_task"&gt;&lt;mxCell parent="81" style="human_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="20.0" y="1320.8333333333335"/&gt;&lt;/mxCell&gt;&lt;/HumanTask&gt;&lt;Link id="420" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="fa4cd5f0-a041-436a-9136-3159a6293226" type="link"&gt;&lt;mxCell edge="1" parent="81" source="418" style="link" target="419"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="67dced35-1df4-4a2c-8101-49f46ca6af33" id="421" name="empty_ocr" taskUUID="15172c0f-e470-48c8-aedf-da4abec93076" type="machine_task"&gt;&lt;mxCell parent="81" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="180.0" y="1443.8333333333335"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="422" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="8a607658-7955-483b-9824-7064f5e24ff3" type="link"&gt;&lt;mxCell edge="1" parent="81" source="416" style="link" target="425"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="423" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="5020b52c-1c21-483e-aa71-7ac31696b93a" type="link"&gt;&lt;mxCell edge="1" parent="81" source="419" style="link" target="421"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="424" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="5ec8ec1d-7232-44ee-bde4-2ee16d9ef6f5" type="link"&gt;&lt;mxCell edge="1" parent="81" source="421" style="link" target="410"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="sourcePoint" x="459.0" y="900.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="0382b978-1d37-447c-843c-b89b180b6a42" id="425" name="Umlauts replacement" taskUUID="5435720b-a7e6-4813-ad51-4d093234c291" type="machine_task"&gt;&lt;mxCell parent="81" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1103.2173913043478" y="1444.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="426" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="3f2721de-2e1b-42f4-9d92-1f689da52b6d" type="link"&gt;&lt;mxCell edge="1" parent="81" source="425" style="link" target="421"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="98" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="8538601b-d1c4-4ef6-a79a-2db5e5c478a1" type="link"&gt;&lt;mxCell edge="1" parent="1" source="72" style="link" target="5"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="b3d51958-d38f-4e28-8b7f-10c4b7570f9b" id="99" name="Customer Codes cache      32 [2018-08-09 10:22:56]                                             " taskUUID="1d9edabe-202e-4ad5-a249-326b570b6d0f" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="990.0" y="915.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="100" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="bd9ebab9-bdad-4a9e-bd57-3791f937247f" type="link"&gt;&lt;mxCell edge="1" parent="1" source="99" style="link" target="39"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="105" label="no and no hope 2" name="" outcomeId="no and no hope 2" ruleUUID="05e085ff-ba24-4663-ab57-4547309d8d61" type="link"&gt;&lt;mxCell edge="1" parent="1" source="27" style="link" target="37"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1630.0" y="772.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1606.0" y="1250.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-121.0" y="152.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;HumanTask campaignMapUUID="cd12c91b-c505-4831-b1d5-d760197b7429" id="106" name="RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             " taskUUID="777a0cbb-40c3-4cb0-b5b4-00ad1cc843fa" type="human_task"&gt;&lt;mxCell parent="1" style="human_task_blue" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1390.0" y="730.0"/&gt;&lt;/mxCell&gt;&lt;/HumanTask&gt;&lt;Link id="107" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="bc1dbf97-f64c-4b18-9463-19548323c2a8" type="link"&gt;&lt;mxCell edge="1" parent="1" source="106" style="link" target="50"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="108" name="e-mails to process" ruleUUID="35499b53-e1ac-48cc-b1af-e56f6de6a258" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="1038.0" y="16.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="109" label="NO" name="" outcomeId="NO" ruleUUID="35499b53-e1ac-48cc-b1af-e56f6de6a258" type="link"&gt;&lt;mxCell edge="1" parent="1" source="108" style="link" target="3"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1130.0" y="91.0"/&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-561.0" y="-480.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="38e0dda0-a2a9-40d6-bbd0-eadf752c006a" id="111" name="[175] Notify on manual task      32 [2018-08-09 10:22:56]                                             " taskUUID="6312de5d-46f2-4bd3-bf27-52d116c59c43" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1390.0" y="639.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="112" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="6da90d7c-8d4e-47f7-b36e-9e5f56747c25" type="link"&gt;&lt;mxCell edge="1" parent="1" source="111" style="link" target="106"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="113" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="2e2714cc-9a52-4c50-9062-d44d4dea628d" type="link"&gt;&lt;mxCell edge="1" parent="1" source="47" style="link" target="111"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="123" name="canceled" ruleUUID="d8c254e9-d5bf-444c-99cb-13a39afeb248" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="814.0" y="600.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="124" label="YES" name="" outcomeId="YES" ruleUUID="d8c254e9-d5bf-444c-99cb-13a39afeb248" type="link"&gt;&lt;mxCell edge="1" parent="1" source="123" style="link" target="37"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="894.0" y="541.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="2050.0" y="616.0"/&gt;&lt;mxPoint x="2050.0" y="1190.0"/&gt;&lt;mxPoint x="1940.0" y="1190.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="125" label="NO" name="" outcomeId="NO" ruleUUID="d8c254e9-d5bf-444c-99cb-13a39afeb248" type="link"&gt;&lt;mxCell edge="1" parent="1" source="123" style="link" target="457"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="930.0" y="610.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="0985e6f5-ce26-41a8-9db3-472a900da2dd" id="126" name="[011] info notification      32 [2018-08-09 10:22:56]                                             " taskUUID="7ccbda1f-f4c1-4f1b-9205-0d7c7809089c" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-194.0" y="148.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="127" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="b0fb810d-def9-4252-8838-66cd873530a3" type="link"&gt;&lt;mxCell edge="1" parent="1" source="126" style="link" target="326"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="760.0" y="290.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="defb0e3c-324a-4c45-87ab-06721e7a6dc0" id="130" name="Validate email      32 [2018-08-09 10:22:56]                                             " taskUUID="b77d4466-fed1-4e26-b7a6-87ef4e0d040d" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="975.0" y="83.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="43191204-e7bc-4eb7-a1db-cb14ccc3cdb1" id="133" name="error notification      32 [2018-08-09 10:22:56]                                             " taskUUID="46cb7cd6-b82c-4e1a-ad9d-a4eb9728e60a" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="156.0" x="1200.0" y="148.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule id="134" name="email valid?" ruleUUID="30fb75f7-1821-42b2-9488-7542b65c468d" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="900.0" y="162.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="136" label="NO" name="" outcomeId="NO" ruleUUID="30fb75f7-1821-42b2-9488-7542b65c468d" type="link"&gt;&lt;mxCell edge="1" parent="1" source="134" style="link" target="133"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="980.0" y="240.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="137" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="44" style="link" target="108"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="139" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="130" style="link" target="134"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="140" label="YES" name="" outcomeId="YES" ruleUUID="35499b53-e1ac-48cc-b1af-e56f6de6a258" type="link"&gt;&lt;mxCell edge="1" parent="1" source="108" style="link" target="130"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1120.0" y="1.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="141" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="fa8008d1-0e95-461c-b8ef-d535eba3a74c" type="link"&gt;&lt;mxCell edge="1" parent="1" source="133" style="link" target="3"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="targetPoint" x="2120.0" y="880.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="142" label="YES(MSG)" name="" outcomeId="YES(MSG)" ruleUUID="30fb75f7-1821-42b2-9488-7542b65c468d" type="link"&gt;&lt;mxCell edge="1" parent="1" source="134" style="link" target="126"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="960.0" y="163.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="143" label="YES" name="" outcomeId="YES" ruleUUID="30fb75f7-1821-42b2-9488-7542b65c468d" type="link"&gt;&lt;mxCell edge="1" parent="1" source="134" style="link" target="326"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="960.0" y="148.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="916.0" y="260.0"/&gt;&lt;mxPoint x="850.0" y="260.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="146" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="2efe7d6d-ee80-4efd-9c99-03043fd557ba" type="link"&gt;&lt;mxCell edge="1" parent="1" source="410" style="link" target="0.125.22"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="targetPoint" x="810.0" y="427.1999816894531"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="147" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="0.125.23" style="link" target="123"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="sourcePoint" x="810.0000305175781" y="507.1999816894531"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="9db529ed-81cf-4e8e-bc27-b091fff65a36" id="151" name="Notify on manual task - shipTo      32 [2018-08-09 10:22:56]                                             " taskUUID="386af1fd-31f1-459f-a7a2-4620e2a50536" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-419.0" y="1390.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="153" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="b4de2232-abbe-4cae-ba38-b5c28b6bd968" type="link"&gt;&lt;mxCell edge="1" parent="1" source="151" style="link" target="155"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="targetPoint" x="810.0" y="1350.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;HumanTask campaignMapUUID="959d8bc5-9e9c-4770-adb1-cb4ad178c870" id="155" name="Ship to data fix      32 [2018-08-09 10:22:56]                                             " taskUUID="141516f7-51a9-4983-ab17-5cdfed8142ae" type="human_task"&gt;&lt;mxCell parent="1" style="human_task_blue" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-134.0" y="1390.0"/&gt;&lt;/mxCell&gt;&lt;/HumanTask&gt;&lt;Link conditional="true" id="157" label="YES" name="" outcomeId="YES" ruleUUID="68efbed7-37be-4595-81b3-8e6e138889a8" type="link"&gt;&lt;mxCell edge="1" parent="1" source="156" style="link" target="188"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="810.0" y="1270.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1060.0" y="1216.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="false" id="158" label="NO" name="" outcomeId="NO" ruleUUID="68efbed7-37be-4595-81b3-8e6e138889a8" type="link"&gt;&lt;mxCell edge="1" parent="1" source="156" style="link" target="151"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1075.0" y="1471.0"/&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-50.0" y="-93.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="156" name="is shipTo Valid" ruleUUID="68efbed7-37be-4595-81b3-8e6e138889a8" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="814.0" y="1200.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link id="159" name="" outcomeId="ApproveAll" ruleUUID="79bab61d-c529-4c9c-b3bd-4bbf2aeff539" type="link"&gt;&lt;mxCell edge="1" parent="1" source="10" style="link" target="156"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="sourcePoint" x="809.8000183105469" y="1120.0"/&gt;&lt;mxPoint as="targetPoint" x="799.8000183105469" y="1310.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="173" label="logging issues" name="" outcomeId="logging issues" ruleUUID="20b2fdda-0b6e-45d7-96f0-601bbe02ad55" type="link"&gt;&lt;mxCell edge="1" parent="1" source="57" style="link" target="174"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1824.0" y="1108.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1840.0" y="1140.0"/&gt;&lt;mxPoint x="1840.0" y="1050.0"/&gt;&lt;mxPoint x="1940.0" y="1050.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="2486884b-6a29-4d31-9fe8-b460348ce290" id="174" name="sapAttemptsCnt decrement  32 [2018-08-09 10:22:56]                                             " taskUUID="d0015e91-2274-47a4-9a25-bd0ea27f1693" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1860.0" y="929.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="175" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="a95aaeda-2eda-4778-8998-4be1269be3ff" type="link"&gt;&lt;mxCell edge="1" parent="1" source="174" style="link" target="31"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="176" label="another no" name="" outcomeId="another no" ruleUUID="20b2fdda-0b6e-45d7-96f0-601bbe02ad55" type="link"&gt;&lt;mxCell edge="1" parent="1" source="57" style="link" target="37"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1824.0" y="1093.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1740.0" y="1240.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="178" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="3c4a5b00-1007-4903-9820-02c2f0d5326d" type="link"&gt;&lt;mxCell edge="1" parent="1" source="21" style="link" target="25"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="ba013cb9-a726-4179-a59e-293090859c28" id="179" name="Validate gtins  32 [2018-08-09 10:22:56]                                             " taskUUID="c163e910-7aee-4938-a9f0-bb85f9b10afe" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1170.0" y="921.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="180" name="" outcomeId="ApproveAll" ruleUUID="be1b3450-3f32-4f70-86aa-1ed248e153a3" type="link"&gt;&lt;mxCell edge="1" parent="1" source="39" style="link" target="476"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="183" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="d62b6441-97d8-420d-89ba-f7cfb6f206d9" type="link"&gt;&lt;mxCell edge="1" parent="1" source="179" style="link" target="21"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="792993dd-0633-4a9c-aa5b-619c651048e0" id="185" name="Update data 32 [2018-08-09 10:22:56]                                             " taskUUID="18ee5075-8b43-4df6-88eb-4231a3410456" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="990.0" y="1390.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="186" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="3061b6e1-8249-4448-987d-c3eb84278fc5" type="link"&gt;&lt;mxCell edge="1" parent="1" source="155" style="link" target="185"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="187" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="97a11dff-92c6-4c90-8356-6fc6c9a50f64" type="link"&gt;&lt;mxCell edge="1" parent="1" source="185" style="link" target="188"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1070.0" y="1350.0"/&gt;&lt;mxPoint x="1070.0" y="1350.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="f1af2d98-736d-4057-af8e-a5b96620efcb" id="188" name="[135] generate PO if empty32 [2018-08-09 10:22:56]                                             " taskUUID="06adc65d-80c4-4146-96ea-1a1226323eb5" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_purple" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="990.0" y="1080.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="189" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="f1e4c909-2888-4e8b-9c08-bee0034b17d6" type="link"&gt;&lt;mxCell edge="1" parent="1" source="188" style="link" target="99"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="66486812-72da-4266-97ef-ce07bd1852b3" id="190" name="[181] Split fixable errors32 [2018-08-09 10:22:56]                                             " taskUUID="ab5d929e-4b73-4e0a-b155-62acdff40beb" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="2300.0" y="1127.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="4e80c45c-d5a5-44cf-a7f1-1a4ef24478a1" id="191" name="[182] Get values32 [2018-08-09 10:22:56]                                             " taskUUID="fa6810ce-1e14-4a47-b581-1a341c10b27e" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="2486.0" y="1240.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;HumanTask campaignMapUUID="7c6165de-83ca-4b16-bdbd-db70bde2babb" id="192" name="Fix SAP-106 32 [2018-08-09 10:22:56]                                             " taskUUID="59feef8c-68dd-4545-bbed-9c6a8a9bfbf1" type="human_task"&gt;&lt;mxCell parent="1" style="human_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="2486.0" y="1360.0"/&gt;&lt;/mxCell&gt;&lt;/HumanTask&gt;&lt;Link id="194" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="60643efd-cfeb-4625-bbdc-788bbd965ee2" type="link"&gt;&lt;mxCell edge="1" parent="1" source="191" style="link" target="192"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="2c21c409-e4e3-44ed-9707-ae7247167547" id="195" name="[183] Wait for all records32 [2018-08-09 10:22:56]                                             " taskUUID="cfc851b9-34b5-470f-9258-b81e9152d1fa" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="2290.0" y="1566.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="49dfb6c0-4ff4-4101-bf8b-220ea50df27d" id="196" name="[184] Merge data32 [2018-08-09 10:22:56]                                             " taskUUID="f06b4009-f80e-4718-986e-a2d6d91b5457" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="2060.0" y="1566.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="197" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="9f098db7-119c-49ce-adb7-1c8fc23ee288" type="link"&gt;&lt;mxCell edge="1" parent="1" source="195" style="link" target="196"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="8c810f0a-d380-476d-acc2-d81b20a1eab4" id="198" name="[182.5] Save to DS32 [2018-08-09 10:22:56]                                             " taskUUID="40e30452-d791-4b73-b57b-2d939bfcc2ba" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="2486.0" y="1480.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="199" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="d79dfc5a-8c79-4b76-af52-9e714e59f4e5" type="link"&gt;&lt;mxCell edge="1" parent="1" source="192" style="link" target="198"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="200" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="7f89ba69-6254-4b41-bca2-726880c53e1b" type="link"&gt;&lt;mxCell edge="1" parent="1" source="196" style="link" target="31"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="2140.0" y="860.0"/&gt;&lt;mxPoint x="1740.0" y="860.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="201" name="choose manual task" ruleUUID="4967a979-1630-4789-b086-b521b0c385a2" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="2550.0" y="1140.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link id="202" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="190" style="link" target="201"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="203" label="SAP-106" name="" outcomeId="SAP-106" ruleUUID="4967a979-1630-4789-b086-b521b0c385a2" type="link"&gt;&lt;mxCell edge="1" parent="1" source="201" style="link" target="191"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="2650.0" y="1121.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="2566.0" y="1200.0"/&gt;&lt;mxPoint x="2570.0" y="1200.0"/&gt;&lt;mxPoint x="2570.0" y="1210.0"/&gt;&lt;mxPoint x="2566.0" y="1210.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="false" id="204" label="rerun SAP" name="" outcomeId="rerun SAP" ruleUUID="4967a979-1630-4789-b086-b521b0c385a2" type="link"&gt;&lt;mxCell edge="1" parent="1" source="201" style="link" target="31"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="2520.0" y="950.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="2566.0" y="840.0"/&gt;&lt;mxPoint x="1740.0" y="840.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="a1f1a040-d994-460f-99da-68b61bc0e909" id="205" name="[001] Read configs32 [2018-08-09 10:22:56]                                             " taskUUID="6b07f215-9b64-447c-aa06-34f99281a717" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_purple" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-574.0" y="350.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule id="207" name="Config validity" ruleUUID="4a2ec5c8-b57b-4142-9eb9-fa5cc9eab99b" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="-510.0" y="230.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="208" label="corrupted config" name="" outcomeId="corrupted config" ruleUUID="4a2ec5c8-b57b-4142-9eb9-fa5cc9eab99b" type="link"&gt;&lt;mxCell edge="1" parent="1" source="207" style="link" target="3"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="480.0" y="366.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="false" id="209" label="valid config" name="" outcomeId="valid config" ruleUUID="4a2ec5c8-b57b-4142-9eb9-fa5cc9eab99b" type="link"&gt;&lt;mxCell edge="1" parent="1" source="207" style="link" target="64"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="410.0" y="190.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="210" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="205" style="link" target="207"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="targetPoint" x="340.0" y="230.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="213" name="Has fixable errors?" ruleUUID="b283dd45-06c4-41ec-a633-575115621c30" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="2210.0" y="1140.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="214" label="No" name="" outcomeId="No" ruleUUID="b283dd45-06c4-41ec-a633-575115621c30" type="link"&gt;&lt;mxCell edge="1" parent="1" source="213" style="link" target="56"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="2310.0" y="1136.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="2180.0" y="1156.0"/&gt;&lt;mxPoint x="2180.0" y="1010.0"/&gt;&lt;mxPoint x="1740.0" y="1010.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="215" label="Yes" name="" outcomeId="Yes" ruleUUID="b283dd45-06c4-41ec-a633-575115621c30" type="link"&gt;&lt;mxCell edge="1" parent="1" source="213" style="link" target="190"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="2270.0" y="960.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="216" name="Is first item?" ruleUUID="d43df0ff-c022-4dfb-9230-6c76ddf74d68" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="2550.0" y="1580.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="217" label="first_item" name="" outcomeId="first_item" ruleUUID="d43df0ff-c022-4dfb-9230-6c76ddf74d68" type="link"&gt;&lt;mxCell edge="1" parent="1" source="216" style="link" target="195"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="2820.0" y="1416.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="218" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="198" style="link" target="216"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="d97b5a1e-7a50-41ac-87b5-f6fbb0724a9f" id="219" name="Display GTINs matching                        " taskUUID="d89ad653-bbcb-4621-b0bc-271036ffeea1" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task_green" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1170.0" y="820.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="220" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="1108a40b-b5f2-46fd-8e90-cb4f78227a35" type="link"&gt;&lt;mxCell edge="1" parent="1" source="20" style="link" target="219"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="221" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="559c8527-b9a5-43bc-8b2e-0f96dc6efe00" type="link"&gt;&lt;mxCell edge="1" parent="1" source="219" style="link" target="179"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;BusinessProcess id="427" isCognitive="true" name="Automation Process: NE_Training_task_v8v1" type="business_process"&gt;&lt;mxCell collapsed="1" parent="1" style="business_process_cognitive" vertex="1"&gt;&lt;mxGeometry as="geometry" height="80.0" width="180.0" x="128.0" y="380.0"&gt;&lt;mxRectangle as="alternateBounds" height="780.0" width="1044.0" x="128.0" y="380.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/BusinessProcess&gt;&lt;Link id="0.125.0" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="73ee77f5-2446-4c50-b90a-729a9355bb45" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.15.1" style="link" target="0.125.23"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="0.125.1" label="Partial success" name="" outcomeId="Partial success" ruleUUID="6ef80a7c-09e6-4e09-ab71-1ca8cb6cf863" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.4" style="link" target="460"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="562.0" y="224.0"/&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-5.0" y="-10.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="0.125.2" label="Failure" name="" outcomeId="Failure" ruleUUID="6ef80a7c-09e6-4e09-ab71-1ca8cb6cf863" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.4" style="link" target="460"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="482.0" y="194.0"/&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-57.0" y="-47.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="0.125.3" label="Success" name="" outcomeId="Success" ruleUUID="6ef80a7c-09e6-4e09-ab71-1ca8cb6cf863" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.4" style="link" target="460"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="420.0" y="580.0"/&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-68.0" y="28.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="0.125.4" name="Skip manual steps or is data extracted automatically?" ruleUUID="6ef80a7c-09e6-4e09-ab71-1ca8cb6cf863" type="rule"&gt;&lt;mxCell parent="427" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="554.0" y="613.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="a13d149f-2a7e-4228-9ab5-4b79009ae7c2" id="0.125.5" name="(Generic) Automation Settings 8.4.4.1" taskUUID="9a6c2d8e-d5db-4b00-8cc2-95b8d09e9178" type="machine_task"&gt;&lt;mxCell parent="427" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="122.0" x="90.0" y="60.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="a12027b1-aa9e-4872-8183-221fb003a0c3" id="0.125.6" name="(Generic) Extract Information 8.4.4.1" taskUUID="92ee47f9-c2ba-4818-bc4a-3232cda898f2" type="machine_task"&gt;&lt;mxCell parent="427" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="56.0" width="170.0" x="377.0" y="157.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="0.125.7" name="" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.5" style="link" target="0.125.21"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="0.125.8" name="" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.22" style="link" target="0.125.5"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;BusinessProcess id="0.125.9" name="Apply Statistical Quality Control (SQC)" type="business_process"&gt;&lt;mxCell collapsed="1" parent="427" style="business_process" vertex="1"&gt;&lt;mxGeometry as="geometry" height="80.0" width="180.0" x="844.0" y="680.0"&gt;&lt;mxRectangle as="alternateBounds" height="459.0" width="1010.0" x="750.0" y="505.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/BusinessProcess&gt;&lt;SubStart automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="8f108ddc-93a9-49c4-99e4-afe7ce077d21" id="0.125.9.0" name="Start" type="sub_start"&gt;&lt;mxCell parent="0.125.9" style="start" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="20.0" y="69.0"/&gt;&lt;/mxCell&gt;&lt;/SubStart&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="9b544d52-3b67-4610-b017-7e27385f6b44" id="0.125.9.1" name="Start SQC" taskUUID="5c83d789-2f8e-4f9d-ac57-4da4f6efea2b" type="machine_task"&gt;&lt;mxCell parent="0.125.9" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="45.0" width="150.0" x="80.0" y="62.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="8981cf90-aeba-4ca6-92b7-03be49f463ee" id="0.125.9.2" name="End SQC" taskUUID="7bd479b6-1ed0-4a33-837a-0e641966d707" type="machine_task"&gt;&lt;mxCell parent="0.125.9" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="45.0" width="150.0" x="743.0" y="62.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.3" name="" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.0" style="link" target="0.125.9.1"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.4" name="Is SQC enabled?" ruleUUID="dad97c09-457e-4e14-b97b-afd452ff1480" type="rule"&gt;&lt;mxCell parent="0.125.9" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="276.0" y="69.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="true" id="0.125.9.5" label="Yes" name="" outcomeId="Yes" ruleUUID="dad97c09-457e-4e14-b97b-afd452ff1480" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.4" style="link" target="0.125.9.10"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="280.0" y="240.0"/&gt;&lt;mxPoint as="offset" x="-2.0" y="8.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="true" id="0.125.9.6" label="No" name="" outcomeId="No" ruleUUID="dad97c09-457e-4e14-b97b-afd452ff1480" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.4" style="link" target="0.125.9.2"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="390.0" y="61.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="292.0" y="40.0"/&gt;&lt;mxPoint x="820.0" y="40.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-236.0" y="-40.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.7" name="" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.1" style="link" target="0.125.9.4"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;SubEnd automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="3c74cf71-dd7d-4b8e-a9e1-69c376de0b68" id="0.125.9.8" name="End" type="sub_end"&gt;&lt;mxCell parent="0.125.9" style="end" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="958.0" y="69.0"/&gt;&lt;/mxCell&gt;&lt;/SubEnd&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.9" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="7d3b7cd3-03c5-426a-9fe1-2c6a0a0be006" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.2" style="link" target="0.125.9.8"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="21790ecc-e04d-4f6c-a1c4-8c6bd068ea12" id="0.125.9.10" name="Assemble Batch" taskUUID="a38f99cb-b10b-4403-9c4a-4fe8897b84de" type="machine_task"&gt;&lt;mxCell parent="0.125.9" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="45.0" width="148.0" x="217.0" y="173.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.11" name="Is inspection required?" ruleUUID="62aea292-531d-43b2-b386-174017ce88de" type="rule"&gt;&lt;mxCell parent="0.125.9" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="34.0" width="32.0" x="275.0" y="285.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.12" label="Yes" name="" outcomeId="Yes" ruleUUID="62aea292-531d-43b2-b386-174017ce88de" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.11" style="link" target="0.125.9.29"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1246.0" y="774.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="400.0" y="410.0"/&gt;&lt;mxPoint x="400.0" y="410.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-131.0" y="21.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.13" label="No" name="" outcomeId="No" ruleUUID="62aea292-531d-43b2-b386-174017ce88de" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.11" style="link" target="0.125.9.15"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="540.0" y="171.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="380.0" y="305.0"/&gt;&lt;mxPoint x="380.0" y="78.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="3.0" y="104.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.14" name="" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.10" style="link" target="0.125.9.11"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="290.0" y="265.0"/&gt;&lt;mxPoint x="290.0" y="265.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="6796538f-b80c-4331-a870-0f4339c7724f" id="0.125.9.15" name="Wait for Inspection Results" taskUUID="a6270d1b-5132-4a6a-b930-777b0ab35be1" type="machine_task"&gt;&lt;mxCell parent="0.125.9" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="45.0" width="150.0" x="390.0" y="63.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.16" name="Check batch status" ruleUUID="2923bdc9-fb64-4786-9d24-8af8050a9c0f" type="rule"&gt;&lt;mxCell parent="0.125.9" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="516.0" y="157.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.17" label="Additional sample required" name="" outcomeId="Additional sample required" ruleUUID="2923bdc9-fb64-4786-9d24-8af8050a9c0f" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.16" style="link" target="0.125.9.29"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="sourcePoint" x="550.0" y="195.0"/&gt;&lt;mxPoint as="targetPoint" x="1270.0" y="744.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="532.0" y="325.0"/&gt;&lt;mxPoint x="560.0" y="325.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-26.0" y="31.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.18" label="Batch expired" name="" outcomeId="Batch expired" ruleUUID="2923bdc9-fb64-4786-9d24-8af8050a9c0f" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.16" style="link" target="0.125.9.29"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1326.0" y="744.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="532.0" y="275.0"/&gt;&lt;mxPoint x="620.0" y="275.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="4.0" y="-19.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.19" label="Batch accepted" name="" outcomeId="Batch accepted" ruleUUID="2923bdc9-fb64-4786-9d24-8af8050a9c0f" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.16" style="link" target="0.125.9.2"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="850.0" y="240.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="670.0" y="175.0"/&gt;&lt;mxPoint x="670.0" y="90.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-34.0" y="33.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.20" label="Batch rejected" name="" outcomeId="Batch rejected" ruleUUID="2923bdc9-fb64-4786-9d24-8af8050a9c0f" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.16" style="link" target="0.125.9.29"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="1370.0" y="744.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="532.0" y="235.0"/&gt;&lt;mxPoint x="680.0" y="235.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="24.0" y="-59.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.21" name="" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.15" style="link" target="0.125.9.16"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="570.0" y="86.0"/&gt;&lt;mxPoint x="570.0" y="125.0"/&gt;&lt;mxPoint x="532.0" y="125.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="5e50dca4-ab1f-4ed9-9379-be72d59a10b6" id="0.125.9.22" name="Check Inspection Results" taskUUID="4c4a0f73-f31f-4531-85ce-6a98339766e1" type="machine_task"&gt;&lt;mxCell parent="0.125.9" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="45.0" width="150.0" x="840.0" y="279.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.23" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="2a63b868-18ab-4116-9390-3ee3ac546a7f" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.29" style="link" target="0.125.9.22"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="sourcePoint" x="1406.0" y="774.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="970.0" y="409.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.24" name="Is inspection successful?" ruleUUID="7b4b131b-20d2-4deb-be5e-6ea9658674ec" type="rule"&gt;&lt;mxCell parent="0.125.9" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="893.0" y="187.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.25" label="There was no inspection" name="" outcomeId="There was no inspection" ruleUUID="7b4b131b-20d2-4deb-be5e-6ea9658674ec" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.24" style="link" target="0.125.9.2"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="930.0" y="176.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="810.0" y="215.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-81.0" y="50.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.26" label="Yes" name="" outcomeId="Yes" ruleUUID="7b4b131b-20d2-4deb-be5e-6ea9658674ec" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.24" style="link" target="0.125.9.2"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="930.0" y="206.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="860.0" y="200.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-28.0" y="22.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" conditional="false" id="0.125.9.27" label="No" name="" outcomeId="No" ruleUUID="7b4b131b-20d2-4deb-be5e-6ea9658674ec" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.24" style="link" target="0.125.9.2"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="930.0" y="236.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="910.0" y="170.0"/&gt;&lt;mxPoint x="890.0" y="170.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" y="8.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.9.28" name="" type="link"&gt;&lt;mxCell edge="1" parent="0.125.9" source="0.125.9.22" style="link" target="0.125.9.24"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="970.0" y="203.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;HumanTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="8f9ba61e-60ff-4c1b-bc15-ebe1ec08724a" id="0.125.9.29" name="NE_Training_task_v8v1" taskUUID="4347818c-d555-434c-9c32-5140240a6d3f" type="human_task"&gt;&lt;mxCell parent="0.125.9" style="human_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="532.0" y="379.0"/&gt;&lt;/mxCell&gt;&lt;/HumanTask&gt;&lt;Link id="0.125.10" name="" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.14" style="link" target="0.125.4"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="464.0" y="629.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="0.125.11" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="9a04accb-dc15-4714-9432-03630b1def0e" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.16.1" style="link" target="0.125.14"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-5.0" y="-10.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="0.125.12" label="Statistics calculation with gold input data" name="" outcomeId="Statistics calculation with gold input data" ruleUUID="6ef80a7c-09e6-4e09-ab71-1ca8cb6cf863" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.4" style="link" target="0.125.24"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="520.0" y="441.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="570.0" y="500.0"/&gt;&lt;mxPoint x="934.0" y="500.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-38.0" y="-10.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="0.125.13" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="98e009cf-d772-44db-8e36-6b6ed4905daa" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.6" style="link" target="0.125.16.0"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-5.0" y="-10.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="a102eff0-a3cf-4f48-9c14-7a2a6e128df6" id="0.125.14" name="Prepare Data" taskUUID="1c2f327c-0073-49bf-8cbe-3bc7cf6a3ca3" type="machine_task"&gt;&lt;mxCell parent="427" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="56.0" width="173.0" x="375.0" y="552.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;BusinessProcess id="0.125.15" name="Train and Evaluate ML Models" type="business_process"&gt;&lt;mxCell collapsed="1" parent="427" style="business_process" vertex="1"&gt;&lt;mxGeometry as="geometry" height="80.0" width="180.0" x="564.0" y="50.0"&gt;&lt;mxRectangle as="alternateBounds" height="201.0" width="682.0" x="410.0" y="50.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/BusinessProcess&gt;&lt;SubStart automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="15830421-8c37-4375-a08f-12ed32e1b856" id="0.125.15.0" name="Start" type="sub_start"&gt;&lt;mxCell parent="0.125.15" style="start" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="20.0" y="54.0"/&gt;&lt;/mxCell&gt;&lt;/SubStart&gt;&lt;SubEnd automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="e2e85455-ed09-422a-bad8-d9d0da126df3" id="0.125.15.1" name="End" type="sub_end"&gt;&lt;mxCell parent="0.125.15" style="end" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="630.0" y="135.0"/&gt;&lt;/mxCell&gt;&lt;/SubEnd&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.15.2" name="" type="link"&gt;&lt;mxCell edge="1" parent="0.125.15" source="0.125.15.0" style="link" target="0.125.15.7"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.15.3" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="55419266-7cc9-4443-a820-5c285dbbdadb" type="link"&gt;&lt;mxCell edge="1" parent="0.125.15" source="0.125.15.10" style="link" target="0.125.15.1"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.15.4" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="92f43494-3910-4cdd-8863-8598495ac264" type="link"&gt;&lt;mxCell edge="1" parent="0.125.15" source="0.125.15.9" style="link" target="0.125.15.10"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="550.0" y="72.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.15.5" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="92f43494-3910-4cdd-8863-8598495ac264" type="link"&gt;&lt;mxCell edge="1" parent="0.125.15" source="0.125.15.7" style="link" target="0.125.15.8"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="280.0" y="72.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.15.6" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="73ee77f5-2446-4c50-b90a-729a9355bb45" type="link"&gt;&lt;mxCell edge="1" parent="0.125.15" source="0.125.15.8" style="link" target="0.125.15.9"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="400.0" y="162.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="d01622ad-b32a-4bbd-9543-33056fe60d98" id="0.125.15.7" name="(Generic) Upload Training Set" taskUUID="5e1c4d31-434c-421a-9016-509dcd8b0c84" type="machine_task"&gt;&lt;mxCell parent="0.125.15" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="158.0" x="90.0" y="40.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="e42d79b8-9ce0-49e1-bdde-1e495249e3db" id="0.125.15.8" name="(Generic) Upload Dictionaries" taskUUID="8e9ad0ca-71d9-4f9b-8866-ed81dfada2de" type="machine_task"&gt;&lt;mxCell parent="0.125.15" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="150.0" y="121.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="99315d75-b78f-42ef-88d5-1becd696a042" id="0.125.15.9" name="(Generic) Start Train&amp;amp;Evaluation" taskUUID="7935e054-546b-407d-959f-dc3e22183df1" type="machine_task"&gt;&lt;mxCell parent="0.125.15" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="330.0" y="40.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="a243cdfa-1305-47ea-8c5f-c971a465c8e4" id="0.125.15.10" name="(Generic) Get Train&amp;amp;Evaluation Results" taskUUID="f4939aab-bf62-42b3-99f6-2df215586fae" type="machine_task"&gt;&lt;mxCell parent="0.125.15" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="151.0" x="440.0" y="121.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;BusinessProcess id="0.125.16" name="Post Extract" type="business_process"&gt;&lt;mxCell parent="427" style="business_process" vertex="1"&gt;&lt;mxGeometry as="geometry" height="270.0" width="334.0" x="218.0" y="247.0"&gt;&lt;mxRectangle as="alternateBounds" height="80.0" width="180.0" x="218.0" y="247.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/BusinessProcess&gt;&lt;SubStart automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="25fcf829-ad34-4852-a8bc-4713ed841266" id="0.125.16.0" name="Start" type="sub_start"&gt;&lt;mxCell parent="0.125.16" style="start" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="20.0" y="52.0"/&gt;&lt;/mxCell&gt;&lt;/SubStart&gt;&lt;SubEnd automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="573fdae4-7cc9-4374-8dbc-1a6dc82cd48e" id="0.125.16.1" name="End" type="sub_end"&gt;&lt;mxCell parent="0.125.16" style="end" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="282.0" y="218.0"/&gt;&lt;/mxCell&gt;&lt;/SubEnd&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="ebdc27fd-f356-458b-96c1-8f844e94b72a" id="0.125.16.2" name="(Generic) Normalization" taskUUID="fd784536-e9e2-46fd-8f5c-18d2d47e83c9" type="machine_task"&gt;&lt;mxCell parent="0.125.16" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="56.0" width="160.0" x="68.0" y="183.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="37b85299-8757-47bc-879b-dc8530577aaa" id="0.125.16.3" name="Post Processing 8.4.4.1v1 NE" taskUUID="a2bcd145-438f-48e6-9320-356c6f09565c" type="machine_task"&gt;&lt;mxCell parent="0.125.16" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="56.0" width="160.0" x="87.0" y="28.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.16.4" name="" type="link"&gt;&lt;mxCell edge="1" parent="0.125.16" source="0.125.16.0" style="link" target="0.125.16.3"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.16.5" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="f2ecdf58-f104-4432-add1-e29a546d8dec" type="link"&gt;&lt;mxCell edge="1" parent="0.125.16" source="0.125.16.3" style="link" target="428"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;mxPoint as="offset" x="-5.0" y="-10.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" id="0.125.16.6" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="0e30b888-b776-4f44-adbd-d10839eeccb3" type="link"&gt;&lt;mxCell edge="1" parent="0.125.16" source="0.125.16.2" style="link" target="0.125.16.1"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="d159a45f-77cc-4f2a-86d4-b710c5618da2" id="428" name="Update fields after post-processing" taskUUID="79b982fa-c71e-4f3b-84f3-74168f05fac9" type="machine_task"&gt;&lt;mxCell parent="0.125.16" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="92.0" y="105.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="429" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="fa6e35fe-83b9-4be8-97e3-4fa3135e837d" type="link"&gt;&lt;mxCell edge="1" parent="0.125.16" source="428" style="link" target="0.125.16.2"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="0.125.17" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="6a82e873-fa22-41b0-ba39-c1414a709c9d" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.24" style="link" target="0.125.23"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="964.0" y="90.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="0.125.18" label="Production" name="" outcomeId="Production" ruleUUID="1b10d4f1-116a-406e-8df9-7242160339a8" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.21" style="link" target="0.125.6"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="300.0" y="170.0"/&gt;&lt;mxPoint as="offset" x="-2.0" y="14.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="0.125.19" label="Training" name="" outcomeId="Training" ruleUUID="1b10d4f1-116a-406e-8df9-7242160339a8" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.21" style="link" target="0.125.15.0"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="370.0" y="130.0"/&gt;&lt;mxPoint as="offset" x="-7.0" y="-10.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="0.125.20" label="None" name="" outcomeId="None" ruleUUID="1b10d4f1-116a-406e-8df9-7242160339a8" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.21" style="link" target="0.125.23"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="406.0" y="16.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="462.0" y="40.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="-167.0" y="-44.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="0.125.21" name="Check mode" ruleUUID="1b10d4f1-116a-406e-8df9-7242160339a8" type="rule"&gt;&lt;mxCell parent="427" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="446.0" y="74.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;SubStart id="0.125.22" name="Start" type="sub_start"&gt;&lt;mxCell parent="427" style="sub_start" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="20.0" y="74.0"/&gt;&lt;/mxCell&gt;&lt;/SubStart&gt;&lt;SubEnd automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="320a7aa1-c3cc-4945-82ca-9aa1984424d4" id="0.125.23" name="End" type="sub_end"&gt;&lt;mxCell parent="427" style="sub_end" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="844.0" y="74.0"/&gt;&lt;/mxCell&gt;&lt;/SubEnd&gt;&lt;MachineTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="c02a8e89-6c0d-4d4d-8aa9-ad173bcf33b9" id="0.125.24" name="Statistics Calculation" taskUUID="ba501459-e071-40ad-8bfd-f8db17918023" type="machine_task"&gt;&lt;mxCell parent="427" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="854.0" y="137.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;HumanTask automatedCampaignUUID="cd41bb33-935c-4034-91a4-09903f02d530" automatedUseCaseId="21" campaignMapUUID="5db91635-c450-499d-a0da-163dbf08e444" id="0.125.25" name="MT- OTC-OM-EU-Manual Order Creation&#160;NE OCR Tagging task_v8v1" taskUUID="4347818c-d555-434c-9c32-5140240a6d3f" type="human_task"&gt;&lt;mxCell parent="427" style="human_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="640.0" y="694.0"/&gt;&lt;/mxCell&gt;&lt;/HumanTask&gt;&lt;Link id="0.125.26" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="c6c5ffa8-2f41-4862-b4ba-86b01f69429f" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.9.8" style="link" target="0.125.24"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="994.0" y="540.0"/&gt;&lt;mxPoint x="994.0" y="540.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="456" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="12da46cb-e680-40df-a09d-8ee79afb56d8" type="link"&gt;&lt;mxCell edge="1" parent="427" source="0.125.25" style="link" target="0.125.9.0"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="ed74c1d7-49ad-4a34-b623-e19c773605d6" id="460" name="mail notification" taskUUID="af41ca29-369f-444b-a057-a5e22e39f3d7" type="machine_task"&gt;&lt;mxCell parent="427" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="640.0" y="599.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="461" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="3600147e-21d8-47fa-b668-d8920a1fa729" type="link"&gt;&lt;mxCell edge="1" parent="427" source="460" style="link" target="0.125.25"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="c702ab9d-2623-4049-94b4-f8ec9619c3b4" id="457" name="translation" taskUUID="6b90904e-3ae1-4fad-9533-49a750fad9fc" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="-224.0" y="557.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="458" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="fea6c5eb-39b5-4bab-a056-ee3db9d94918" type="link"&gt;&lt;mxCell edge="1" parent="1" source="457" style="link" target="72"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;mxPoint as="targetPoint" x="800.0" y="2950.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="2b13d105-f59a-49a6-829b-926bc59e21ba" id="462" name="[191] create SoldTos JSON1" taskUUID="a734b510-86cb-4c17-8d67-8b8f4355bc5f" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1871.6650853048864" y="749.8347414258578"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;HumanTask campaignMapUUID="588631aa-f494-4836-9c37-31c6dedb5f9d" id="463" name="Select SoldTo1" taskUUID="86153326-4ab7-44cf-9ae2-1da86875f6e8" type="human_task"&gt;&lt;mxCell parent="1" style="human_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1863.0594515020694" y="645.1446005807875"/&gt;&lt;/mxCell&gt;&lt;/HumanTask&gt;&lt;MachineTask campaignMapUUID="34021dcb-741c-45b9-a705-916df08d95ee" id="464" name="[192] soldTos flatenization1" taskUUID="7c319b17-0dfd-4896-841a-066306ad64e2" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1872.0735360091116" y="514.5812202990974"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;MachineTask campaignMapUUID="c8098f19-c43d-4f2a-b259-5e11a991cba9" id="465" name="empty task  1" taskUUID="6786a960-9a69-4fb5-a05f-6032df76f8bc" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="1462.0453669950275" y="1335.7361498765622"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Rule id="466" name="goto SoldTo selection" ruleUUID="b282ddf7-2689-4ca7-9468-58870e9c355b" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="1756.0" y="1344.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="467" label="yes" name="" outcomeId="yes" ruleUUID="b282ddf7-2689-4ca7-9468-58870e9c355b" type="link"&gt;&lt;mxCell edge="1" parent="1" source="466" style="link" target="462"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="3844.0" y="3611.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1772.0" y="1434.0"/&gt;&lt;mxPoint x="2252.0" y="1434.0"/&gt;&lt;mxPoint x="2252.0" y="780.0"/&gt;&lt;/Array&gt;&lt;mxPoint as="offset" x="150.0" y="326.0"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="false" id="468" label="No" name="" outcomeId="No" ruleUUID="b282ddf7-2689-4ca7-9468-58870e9c355b" type="link"&gt;&lt;mxCell edge="1" parent="1" source="466" style="link" target="37"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="3840.0" y="3690.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="469" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="465" style="link" target="466"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="470" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="de562a45-68ed-450a-9041-051035a3b157" type="link"&gt;&lt;mxCell edge="1" parent="1" source="462" style="link" target="479"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link id="471" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="3dc83531-5043-4bd1-a4d8-bc9e9facc56e" type="link"&gt;&lt;mxCell edge="1" parent="1" source="463" style="link" target="464"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="472" name="Cancel selection" ruleUUID="71f038d6-012c-40ce-a7e2-26c0b03bc2f6" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="1732.0" y="654.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link id="473" name="" type="link"&gt;&lt;mxCell edge="1" parent="1" source="464" style="link" target="472"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1862.0" y="545.0"/&gt;&lt;mxPoint x="1862.0" y="673.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="474" label="YES" name="" outcomeId="YES" ruleUUID="71f038d6-012c-40ce-a7e2-26c0b03bc2f6" type="link"&gt;&lt;mxCell edge="1" parent="1" source="472" style="link" target="3"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="3820.0" y="2921.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1748.0" y="463.0"/&gt;&lt;mxPoint x="2122.0" y="463.0"/&gt;&lt;mxPoint x="2122.0" y="1240.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="false" id="475" label="NO" name="" outcomeId="NO" ruleUUID="71f038d6-012c-40ce-a7e2-26c0b03bc2f6" type="link"&gt;&lt;mxCell edge="1" parent="1" source="472" style="link" target="31"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="3690.0" y="3060.0"/&gt;&lt;Array as="points"&gt;&lt;mxPoint x="1722.0" y="670.0"/&gt;&lt;mxPoint x="1722.0" y="807.0"/&gt;&lt;mxPoint x="1712.0" y="807.0"/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Rule id="476" name="ean conversion" ruleUUID="7f94d88b-4064-4b8b-9e2b-0e7d79ac3b02" type="rule"&gt;&lt;mxCell parent="1" style="rule" vertex="1"&gt;&lt;mxGeometry as="geometry" height="32.0" width="32.0" x="1054.0" y="748.0"/&gt;&lt;/mxCell&gt;&lt;/Rule&gt;&lt;Link conditional="true" id="477" label="convert" name="" outcomeId="convert" ruleUUID="7f94d88b-4064-4b8b-9e2b-0e7d79ac3b02" type="link"&gt;&lt;mxCell edge="1" parent="1" source="476" style="link" target="20"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="2177.0" y="2326.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;Link conditional="true" id="478" label="skip conversion" name="" outcomeId="skip conversion" ruleUUID="7f94d88b-4064-4b8b-9e2b-0e7d79ac3b02" type="link"&gt;&lt;mxCell edge="1" parent="1" source="476" style="link" target="219"&gt;&lt;mxGeometry as="geometry"&gt;&lt;mxPoint as="targetPoint" x="2278.0" y="2330.0"/&gt;&lt;Array as="points"/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;MachineTask campaignMapUUID="6b722687-1296-480b-e2f5-cb82b09d6a28" id="479" name="Sold to selection notification" taskUUID="6eec009b-aeac-487b-e7ea-ca8a3f99bbad" type="machine_task"&gt;&lt;mxCell parent="1" style="machine_task" vertex="1"&gt;&lt;mxGeometry as="geometry" height="60.0" width="160.0" x="2130.0" y="669.0"/&gt;&lt;/mxCell&gt;&lt;/MachineTask&gt;&lt;Link id="480" name="" outcome="ApproveAll" outcomeId="ApproveAll" ruleUUID="7bab313a-c94a-44e1-b3ea-274c8895c3d2" type="link"&gt;&lt;mxCell edge="1" parent="1" source="479" style="link" target="463"&gt;&lt;mxGeometry as="geometry" relative="1" x="0.5" y="10.0"/&gt;&lt;/mxCell&gt;&lt;/Link&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;</compositeStructureXml>
                    <description>Business Process description</description>
                    <executingType>COMPOSITE</executingType>
                    <goldBucketBlockSize>0</goldBucketBlockSize>
                    <goldRatio>0</goldRatio>
                    <goldSource>Empty</goldSource>
                    <goldType>Percentage</goldType>
                    <moderation>false</moderation>
                    <origination>CREATED_AUTOMATICALLY</origination>
                    <question>
                        <answers>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Sales Organization</answer>
                                <answerCode>sales_area_id</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['sales_area_id']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>1</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Distribution channel ID:</answer>
                                <answerCode>distribution_channel_id</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['distribution_channel_id']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>2</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Ship to ID</answer>
                                <answerCode>ship_to_id</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['ship_to_id']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>3</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Products:</answer>
                                <answerCode>products_json</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                    <code>GRID</code>
                                    <description>Grid</description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>false</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>false</showForMachineConfig>
                                    <title>Grid</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['products_json']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses>products</htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>4</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Product code 1</answer>
                                <answerCode>product_code1</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue></defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <parentAnswer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </parentAnswer>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>5</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Product code 2</answer>
                                <answerCode>product_code2</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <constantable>false</constantable>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <parentAnswer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </parentAnswer>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>6</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>gtin</answer>
                                <answerCode>gtin</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue></defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-04T00:13:22Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <parentAnswer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </parentAnswer>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>7</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>quantity</answer>
                                <answerCode>quantity</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue></defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <parentAnswer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </parentAnswer>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>8</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>GTIN correction</answer>
                                <answerCode>gtin_correction</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <constantable>false</constantable>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <parentAnswer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </parentAnswer>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>9</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Quantity correction</answer>
                                <answerCode>quantity_correction</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <constantable>false</constantable>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <parentAnswer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </parentAnswer>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>10</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Comment</answer>
                                <answerCode>display_gtin</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <constantable>false</constantable>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <parentAnswer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </parentAnswer>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>11</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Request delivery date (OCR-ed)</answer>
                                <answerCode>rdd_orig</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['rdd_orig']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses>disabledField</htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>12</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Request delivery date (final, to be used for SAP entry):</answer>
                                <answerCode>rdd</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['rdd']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>13</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                <answerCode>beyond_repair_flag</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                    <code>CHECK_ONE</code>
                                    <description></description>
                                    <optionsAvailable>true</optionsAvailable>
                                    <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Check One</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>NO</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses></htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <options>no=NO|yes=YES</options>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>14</sequenceNumber>
                                <shuffle>false</shuffle>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>daysinfuture</answer>
                                <answerCode>daysinfuture</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['cfg_rdd_days_after_range']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses>hide</htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>15</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                            <answer>
                                <allowNA>false</allowNA>
                                <answer>daysinpast</answer>
                                <answerCode>daysinpast</answerCode>
                                <answerHtml></answerHtml>
                                <answerTypeObject>
                                    <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                    <code>FREE_TEXT</code>
                                    <description></description>
                                    <optionsAvailable>false</optionsAvailable>
                                    <showDefaultValue>true</showDefaultValue>
                                    <showForFieldScheme>true</showForFieldScheme>
                                    <showForHumanTask>true</showForHumanTask>
                                    <showForMachineConfig>true</showForMachineConfig>
                                    <title>Free Text</title>
                                    <valueType>SINGLEVALUE</valueType>
                                </answerTypeObject>
                                <appendDataStoreOptions>false</appendDataStoreOptions>
                                <autocompleteField>false</autocompleteField>
                                <category></category>
                                <constantable>false</constantable>
                                <defaultValue>${question.data['cfg_rdd_days_before_range']}</defaultValue>
                                <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                <htmlClasses>hide</htmlClasses>
                                <lastModified>2018-09-02T14:41:30Z</lastModified>
                                <letCustomValues>false</letCustomValues>
                                <manualField>false</manualField>
                                <multiValue>false</multiValue>
                                <percentRequired>false</percentRequired>
                                <range>false</range>
                                <required>false</required>
                                <sequenceNumber>16</sequenceNumber>
                                <useBlocks>false</useBlocks>
                                <useEmptyCell>false</useEmptyCell>
                            </answer>
                        </answers>
                        <assignmentDuration>1800000</assignmentDuration>
                        <assignmentLimit>1</assignmentLimit>
                        <attrs>{"lnaa":"Run","lnam":"Tasks","lna":"0"}</attrs>
                        <autoApprovalDelay>432000000</autoApprovalDelay>
                        <automaticallyProcessed>0</automaticallyProcessed>
                        <blockSize>1</blockSize>
                        <constQualifiedWorkers>false</constQualifiedWorkers>
                        <currency>USD</currency>
                        <description>Miscellaneous Tasks</description>
                        <dynamicTaskRenderingDisabled>false</dynamicTaskRenderingDisabled>
                        <expiredTime>2592000000</expiredTime>
                        <faqItems/>
                        <frameHeight>2500</frameHeight>
                        <geolocationEnabled>false</geolocationEnabled>
                        <instructionItems/>
                        <keywords>Miscellaneous Tasks</keywords>
                        <maxAssignments>1</maxAssignments>
                        <moderation>false</moderation>
                        <moderationFlag>false</moderationFlag>
                        <origination>CREATED_MANUALLY</origination>
                        <pendingAssignmentsLimit>10</pendingAssignmentsLimit>
                        <qualificationInstruction></qualificationInstruction>
                        <qualificationRequirements/>
                        <qualificationRequirementsRequiredForPreview>false</qualificationRequirementsRequiredForPreview>
                        <qualificationTasks>20</qualificationTasks>
                        <qualificationTraining>false</qualificationTraining>
                        <questionRuleMaps>
                            <questionRuleMap>
                                <businessRule>
                                    <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer(1);

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer(1);
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double(100/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 70 if gold accuracy goes up &lt; 75 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; (75/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 70);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 80 if gold accuracy goes up &gt;= 75 percents and &lt; 90"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (75/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; (90 / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 80);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every 5 gold question and set Accuracy based qualification score to 95 if gold accuracy goes up &gt;= 90 percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  5) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= (90 / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, 95);
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                    <name>Start with one assignment 1+0 pay all</name>
                                    <paramValues>{"NORMAL_ACCURACY_LEVEL_SCORE":"80","NORMAL_ACCURACY_LEVEL_UPPER_LIMIT":"90","WORST_ACCURACY_LEVEL_SCORE":"70","MAJORITY_HIT_THRESHOLD":"100","SUPER_ACCURACY_LEVEL_LOWER_LIMIT":"90","WORST_ACCURACY_LEVEL_UPPER_LIMIT":"75","SUPER_ACCURACY_LEVEL_SCORE":"95","NORMAL_ACCURACY_LEVEL_LOWER_LIMIT":"75","MAJORITY_VALUE":"1","CHECK_EVERY":"5","MAX_ASSIGNMENT_LIMIT":"1"}</paramValues>
                                    <ruleType>DROOLS</ruleType>
                                    <ruleTypeUI>Adjudication</ruleTypeUI>
                                    <template>
                                        <content>

package com.freedomoss.requester;

#list any import classes here.
import com.freedomoss.objective.model.RuleContext;
import com.freedomoss.objective.model.RuleContext.MajorityType;
import com.freedomoss.objective.model.RuleAssigmentContext;
import com.freedomoss.objective.model.RuleQuestionContext;
import com.freedomoss.requester.model.AwsHitQuestion;
import com.freedomoss.requester.model.AwsHitQuestionItem;
import com.freedomoss.requester.model.AwsHitQuestionAnswerItem;

import org.slf4j.Logger;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.Map;
import java.util.Iterator;

#declare any global variables here
global RuleContext source
global Logger log
global Map params


rule "Rule context initialization"
auto-focus true
no-loop
dialect "mvel"
agenda-group "initialization-group"
	when
		$ctx:RuleContext(initialized == false);
	then
	    # set parameters

        $ctx.properties[RuleContext.MAJORITY_TYPE] =  RuleContext.MajorityType.COUNT;
        $ctx.properties[RuleContext.MAJORITY_VALUE] = new Integer({{MAJORITY_VALUE}});

        #$ctx.properties[RuleContext.MAX_ASSIGNMENT_LIMIT] = new Integer({{MAX_ASSIGNMENT_LIMIT}});
        $ctx.properties[RuleContext.MAJORITY_HIT_THRESHOLD] = new Double({{MAJORITY_HIT_THRESHOLD}}/100);
        $ctx.properties[RuleContext.ASSIGNMENT_APPROVE_THRESHOLD] = new Double(0.5);

        # insert processed facts into memory
        $ctx.updateWorkingMemory();
        # move to business rules
        kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup("calculation").setFocus();
        $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Worst accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{WORST_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &lt; {{WORST_ACCURACY_LEVEL_UPPER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{WORST_ACCURACY_LEVEL_UPPER_LIMIT}}/100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{WORST_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Normal accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{NORMAL_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}} percents and &lt; {{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}}"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{NORMAL_ACCURACY_LEVEL_LOWER_LIMIT}}/ 100) &amp;&amp; $campaignStatistic.goldAccuracy &lt; ({{NORMAL_ACCURACY_LEVEL_UPPER_LIMIT}} / 100))
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{NORMAL_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "Super accuracy rule-Evaluate every {{CHECK_EVERY}} gold question and set Accuracy based qualification score to {{SUPER_ACCURACY_LEVEL_SCORE}} if gold accuracy goes up &gt;= {{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} percents"
agenda-group "calculation"
dialect "mvel"
salience 250
no-loop
 when
     $ctx:RuleContext(initialized == true)
     $rac:RuleAssigmentContext($campaignStatistic:campaignStatistic, runStatistic.totalGoldQuestions &gt; 0)
     #evaluate run average response time
     eval($campaignStatistic.totalGoldQuestions  &gt;  0 &amp;&amp;
         ($campaignStatistic.totalGoldQuestions  %  {{CHECK_EVERY}}) == 0 &amp;&amp;
          $campaignStatistic.goldAccuracy &gt;= ({{SUPER_ACCURACY_LEVEL_LOWER_LIMIT}} / 100) )
 then
     $rac.grandQualification(RuleContext.ACCURACY_BASED_QUALIFICATION, {{SUPER_ACCURACY_LEVEL_SCORE}});
     $ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "0. Check, if exist majority"
agenda-group "calculation"
dialect "mvel"
salience 100
no-loop
	when
	    $ctx:RuleContext (initialized == true, $gold:gold, $threshold:properties.MAJORITY_HIT_THRESHOLD)
        eval($ctx.majorityWithoutGold().size() &gt;= ($ctx.questions.size() - $gold.size()) *  $threshold)
	then
		insert(new String("MAJORITY_FOUND"));
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

rule "1. Approve question by majority"
agenda-group "calculation"
dialect "mvel"
salience 90
no-loop
	when
		((String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true))
		or
		(not String(toString == "MAJORITY_FOUND") and  $ctx:RuleContext (initialized == true, assignments.size == properties.MAX_ASSIGNMENT_LIMIT)))
		$rqc:RuleQuestionContext()
	then
		$rqc.approveQuestion($ctx.majority());
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rqc);
end

rule "3. Approve assignment (always)"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		$ctx:RuleContext(initialized == true, $threshold:properties.ASSIGNMENT_APPROVE_THRESHOLD)
		$rac:RuleAssigmentContext()
	then
	    insert(new String("ASSIGNMENT_PROCESSED"));
		$ctx.addApproved($rac);
		$ctx.logExecutedRule(kcontext.getRule().getName(), $rac);
end

rule "5. Extend HIT"
agenda-group "calculation"
dialect "mvel"
salience 50
no-loop
	when
		not String(toString == "MAJORITY_FOUND")
		$ctx:RuleContext(initialized == true, assignments.size &lt; properties.MAX_ASSIGNMENT_LIMIT);
	then
		$ctx.setExtendHit(true);
		$ctx.logExecutedRule(kcontext.getRule().getName());
end

</content>
                                        <description>Get qualified workers: pay if ${MAJORITY_VALUE} correct answers, start with 1 assignment, extend to maximum of ${MAX_ASSIGNMENT_LIMIT} assignments. Set qualification scores depending on gold accuracy.</description>
                                        <name>Start with 1 assignment X+0 rule (pay all)</name>
                                        <params>
                                            <param>
                                                <code>MAJORITY_VALUE</code>
                                                <defaultValue>1</defaultValue>
                                                <description>Number of correct answers</description>
                                                <name>Majority value</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>WORST_ACCURACY_LEVEL_SCORE</code>
                                                <defaultValue>70</defaultValue>
                                                <description>Qualification score will be given to a worker who has demonstrated a low accuracy</description>
                                                <name>Worst accuracy level score</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>WORST_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                <defaultValue>75</defaultValue>
                                                <description>Worst accuracy level upper limit in percents exclusive, lower limit is considered as 0</description>
                                                <name>Worst accuracy level upper limit</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>SUPER_ACCURACY_LEVEL_SCORE</code>
                                                <defaultValue>95</defaultValue>
                                                <description>Qualification score will be given to a worker who has demonstrated a super accuracy</description>
                                                <name>Super accuracy level score</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>NORMAL_ACCURACY_LEVEL_SCORE</code>
                                                <defaultValue>80</defaultValue>
                                                <description>Qualification score will be given to a worker who has demonstrated a normal accuracy</description>
                                                <name>Normal accuracy level score</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>MAX_ASSIGNMENT_LIMIT</code>
                                                <defaultValue>1</defaultValue>
                                                <description>Maximum number of assignments</description>
                                                <name>Max assignments limit</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>SUPER_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                <defaultValue>90</defaultValue>
                                                <description>Super accuracy level lower limit in percents inclusive, upper limit is considered as 100</description>
                                                <name>Super accuracy level lower limit</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>NORMAL_ACCURACY_LEVEL_LOWER_LIMIT</code>
                                                <defaultValue>75</defaultValue>
                                                <description>Normal accuracy level lower limit in percents inclusive</description>
                                                <name>Normal accuracy level lower limit</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>CHECK_EVERY</code>
                                                <defaultValue>5</defaultValue>
                                                <description>Check every i-th gold question when evaluating qualification score</description>
                                                <name>Check every i-th gold question</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>MAJORITY_HIT_THRESHOLD</code>
                                                <defaultValue>100</defaultValue>
                                                <description>Percent (from 0 to 100) of correct answers when  majority is found</description>
                                                <name>Percent of correct answers</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                            <param>
                                                <code>NORMAL_ACCURACY_LEVEL_UPPER_LIMIT</code>
                                                <defaultValue>90</defaultValue>
                                                <description>Normal accuracy level upper limit in percents exclusive</description>
                                                <name>Normal accuracy level upper limit</name>
                                                <type>INPUT_NUMBER</type>
                                            </param>
                                        </params>
                                    </template>
                                    <uuid>8521f103-28fb-11e8-bf41-000d3a0302a9</uuid>
                                    <workflowRuleMode>ADVANCED</workflowRuleMode>
                                </businessRule>
                            </questionRuleMap>
                        </questionRuleMaps>
                        <radiusSelector>ExactLocation</radiusSelector>
                        <randomizeAnswers>false</randomizeAnswers>
                        <recursiveThreshold>1</recursiveThreshold>
                        <restrictedCountries/>
                        <taskNotificationSchedule>IMMEDIATE</taskNotificationSchedule>
                        <templates>
                            <template>
                                <code></code>
                                <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  
  &lt;style&gt;
      .valid {
        font-weight: bold;
        color: green;
    }

    .not-valid {
        font-weight: bold;
        color: red;
    }
    
    /*.products td:first-child {
      cursor: not-allowed;
      background-color:#eeeeee;
      pointer-events:none;
    }*/
    
    td input {
      background-color: red; 
    }
    
    #err_placeholder table {
    border-collapse: collapse;
}

#err_placeholder table,#err_placeholder th,#err_placeholder td {
    border: 1px solid black;
}
    
  &lt;/style&gt;
  
&lt;@instructions title="&lt;h2&gt;RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             &lt;/h2&gt;"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;               
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;&lt;br&gt;&lt;strong&gt;Document link:&amp;nbsp;&lt;a href="https://wfapp-dev.workfusion.pg.com/workfusion/secure/business-process/edit/$%7Bquestion.data['document_link']%7D" target="_blank" data-mce-href="$%7Bquestion.data['document_link']%7D"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;&lt;/strong&gt;&lt;table style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;" border="2" width="604" data-mce-style="height: 31px; background-color: #f2f2f2; margin-left: auto; margin-right: auto;"&gt;&lt;caption&gt;&amp;nbsp;&lt;/caption&gt;&lt;tbody&gt;&lt;tr style="height: 17.6px;" data-mce-style="height: 17.6px;"&gt;&lt;td style="width: 146.8px; text-align: center; height: 17.6px;" data-mce-style="width: 146.8px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Customer name&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Address&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;City&lt;/strong&gt;&lt;/td&gt;&lt;td style="width: 148.4px; text-align: center; height: 17.6px;" data-mce-style="width: 148.4px; text-align: center; height: 17.6px;"&gt;&lt;strong&gt;Zip code&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 17px;" data-mce-style="height: 17px;"&gt;&lt;td style="width: 146.8px; height: 17px;" data-mce-style="width: 146.8px; height: 17px;"&gt;${question.data['ship_to_name']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_street_name']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_location']}&lt;/td&gt;&lt;td style="width: 148.4px; height: 17px;" data-mce-style="width: 148.4px; height: 17px;"&gt;${question.data['ship_to_postal_code']}&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 71.5999984741211px; height: 4px; width: 864px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 71.5999984741211px; height: 4px; width: 864px; " data-row="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-row" unselectable="on" data-mce-resize="false" data-mce-style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 92.5999984741211px; height: 4px; width: 864px; " style="cursor: row-resize; margin: 0; padding: 0; position: absolute; left: 1px; top: 92.5999984741211px; height: 4px; width: 864px; " data-row="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 193.40000915527344px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 193.40000915527344px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="0"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 426.20001220703125px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 426.20001220703125px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="1"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 632.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 632.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="2"&gt;&lt;/div&gt;&lt;div data-mce-bogus="all" class="mce-resize-bar mce-resize-bar-col" unselectable="on" data-mce-resize="false" data-mce-style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 862.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " style="cursor: col-resize; margin: 0; padding: 0; position: absolute; left: 862.6000366210938px; top: 35.20000076293945px; height: 60px; width: 4px; " data-col="3"&gt;&lt;/div&gt;&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;!--div id="err_placeholder"&gt;&lt;/div--&gt;
                  &lt;div id="error_div"&gt; ${question.data['error_table']}&lt;/div&gt;
                 &lt;br&gt;&lt;br&gt;
                 &lt;@answers question=question/&gt;
                 &lt;script&gt;
                   $(document).ready(function() {

                     $('input[name*="beyond_repair_flag"]').change(function()&#160;{
&#160;&#160;&#160;					&#160;if&#160;(this.value&#160;==&#160;'YES')&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;			
						for (var i = 0; i &lt; GRID.Main.originalColumnConfiguration().length; i++) {
						var item = GRID.Main.originalColumnConfiguration()[i];
						if (item["required"] == "true") {
							GRID.Main.originalColumnConfiguration()[i]["required"] = "false";
						}
					}

&#160;&#160;&#160;&#160;			}
&#160;&#160;&#160;&#160;			else&#160;if&#160;(this.value&#160;==&#160;'NO')&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;				for (var i = 0; i &lt; GRID.Main.originalColumnConfiguration().length; i++) {
						   var item = GRID.Main.originalColumnConfiguration()[i];
						   if (item["required"] == "false") {
							  GRID.Main.originalColumnConfiguration()[i]["required"] = "true";
						   }
					   }&#160;
				&#160;&#160;&#160;&#160;}
				});
                  
                      function _getTable(tableId) {
                           const tableDivParent = $("[id*='" + tableId + "']");
                           
                           return tableDivParent.find("table");
                      }
                      
                      function _makeReadOnly(obj) {
                          obj.css('cursor', "not-allowed");
                          obj.css('background-color', "#eeeeee");
                          obj.css('pointer-events', 'none');
                      }
                      
                      // index of n is 0-based
                      function makeNthColumnReadOnly(tableId, n) {
                          const table = _getTable(tableId);
                  		  
                          return () =&gt; {
                            console.log("nth read only " + tableId + " " + n);
                          	table.find("tr").each(function() {
                              	const cell = $(this).find("td:eq(" + n + ")");
                              	//to get the innerText: cell.context.innerText 
                              	_makeReadOnly(cell);
                          	});
                      	  };
                      }
                  
                      window.setInterval(makeNthColumnReadOnly("products", 0), 1500);
                      window.setInterval(makeNthColumnReadOnly("products", 1), 1500);
                      window.setInterval(makeNthColumnReadOnly("products", 2), 1500);
                      window.setInterval(makeNthColumnReadOnly("products", 5), 1500);
                     
                      //window.setInterval(makeNthColumnReadOnly("error", 0), 1500);
                   
                      $(".disabledField input").prop(&#160;"disabled",&#160;true&#160;);
                     
                      //makeTitle();
                    /* var jsonErr =  ${question.data['error_list_json']}.error_list_json;
                     var tabl = '&lt;table&gt;&lt;tr&gt;&lt;th&gt;Error row&lt;/th&gt;&lt;th&gt;Error description&lt;/th&gt;&lt;/tr&gt;';
                     
                     for(var i = 0; i&lt; jsonErr.length;i++){
                       var rowErr = jsonErr[i];
                       tabl += '&lt;tr&gt;&lt;td&gt;'+i+'&lt;/td&gt;&lt;td&gt;'+jsonErr[i].error+'&lt;/td&gt;&lt;/tr&gt;';
                     }
                     
                     tabl += '&lt;/table&gt;';
                     
                     $("#err_placeholder").html(tabl);*/
                     
                  });
                 &lt;/script&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;
  
   &lt;script&gt;
  $(document).ready(function(){

  $("input[id$='rdd']").addClass( "rddDateFormat" ); 
  });
    
 $(".disabledField input").prop(&#160;"disabled",&#160;true&#160;);

 $.validator.addMethod(
    "rddDateFormat",
    function(value, element) {
        var re = /^\d{1,2}.\d{1,2}.\d{4}$/;

      if(value.trim().toLowerCase()==='asap' || value.trim().toLowerCase()==='a.s.a.p.') return true;
      if((this.optional(element) &amp;&amp; value=="") || !re.test(value) ) return false;
      
var past=$("input[id*='daysinpast']").val();    
var future=$("input[id*='daysinfuture']").val();
 


      var today = new Date();
      var dateInFuture = new Date();
dateInFuture.setDate(today.getDate()+parseInt(future));

 
 var dateInPast = new Date();
 dateInPast.setDate(today.getDate()-parseInt(past));
      
     
var parts = value.split(".");
var testDate = new Date(parseInt(parts[2], 10),
                  parseInt(parts[1], 10) - 1,
                  parseInt(parts[0], 10));

      if(testDate &gt;= dateInPast &amp;&amp; testDate&lt;=dateInFuture ){
        return true
}    else{
    return false
}
      
   // },"Please provide valid RDD in given range or ASAP value. Proper format dd.MM.YYYY not earlier then "+ future+ " days and not later then "+ past+" days"
    }, function(param, element) {
     
      var past=$("input[id*='daysinpast']").val();
	 var future=$("input[id*='daysinfuture']").val();
      
      

      
       var today = new Date();
      var dateInFuture = new Date();
dateInFuture.setDate(today.getDate()+parseInt(future));

 
 var dateInPast = new Date();
 dateInPast.setDate(today.getDate()-parseInt(past));  
      
      return "Please provide date in format dd.MM.YYYY, after "+ dateInPast.getDate()+"."+(dateInPast.getMonth()+1)+"."+dateInPast.getFullYear()+ " and till "+ dateInFuture.getDate()+"."+(dateInFuture.getMonth()+1)+"."+dateInFuture.getFullYear()+ " or asap";
     }
);
   
    
    
var rules = {};
$("input[name*='rdd']").each(function(v,i) {
   rules[v.name] = {
        required: true,
        maxlength: 1,
           messages: {
            required: "Required input",
            minlength: jQuery.format("At least {0} characters are necessary")
        }
   };
});    
    
$('#mainform').validate({
  rules: rules
});   
    
&lt;/script&gt;</content>
                                <name>RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             </name>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <status>ACTIVE</status>
                                <type>TASK</type>
                                <uuid>57922775-31ac-4a87-9fa7-585d68d68c18</uuid>
                                <version>
                                    <componentUuid>7eb5ead5-8db3-4067-8336-d9fd6811226c</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2018-09-02T14:41:30Z</lastModified>
                                    <versionUuid>26abde49-d996-48ed-abb9-8ac9d140a33a</versionUuid>
                                </version>
                            </template>
                        </templates>
                        <title>RPA Deriviation Fix 0.5      32 [2018-08-09 10:22:56]                                             </title>
                        <useCommonHitCoordinates>false</useCommonHitCoordinates>
                        <uuid>c3d05721-7dc1-48a3-8b2d-d921936c692b</uuid>
                        <version>
                            <componentUuid>020e56e3-0b86-41ed-a919-e140c6302214</componentUuid>
                            <incrementalVersion>1.3</incrementalVersion>
                            <lastInChain>true</lastInChain>
                            <lastModified>2018-09-04T00:13:24Z</lastModified>
                            <versionUuid>aaa444ba-9529-45a7-9f18-1ab0c2ca4920</versionUuid>
                        </version>
                        <workSetting>
                            <category>
                                <automation>false</automation>
                                <description></description>
                                <enabled>true</enabled>
                                <executingType>HUMAN</executingType>
                                <name>RPA</name>
                                <private>false</private>
                                <publicId>87f6ce2c-9f18-43ca-a652-e7e038dfd6cd</publicId>
                            </category>
                            <contentType>NORMAL</contentType>
                            <description></description>
                            <enabled>true</enabled>
                            <name>Deriviation fix</name>
                            <publicId>4685dd2b-82ca-4cae-99be-14cf2aea9489</publicId>
                            <version>
                                <componentUuid>d7d96182-424e-4644-833a-e8358203131a</componentUuid>
                                <incrementalVersion>1.1</incrementalVersion>
                                <lastInChain>false</lastInChain>
                                <lastModified>2018-05-15T07:01:14Z</lastModified>
                                <versionUuid>c01e4dbb-1604-491f-a38c-1772be368782</versionUuid>
                            </version>
                            <answers>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Ship to name</answer>
                                    <answerCode>ship_to_name</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['ship_to_name']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>disabledField</htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>1</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Ship to location</answer>
                                    <answerCode>ship_to_location</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['ship_to_location']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>disabledField</htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>2</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Ship to postal code</answer>
                                    <answerCode>ship_to_postal_code</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['ship_to_postal_code']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>disabledField</htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>3</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Ship to street name</answer>
                                    <answerCode>ship_to_street_name</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['ship_to_street_name']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>disabledField</htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Sales area ID</answer>
                                    <answerCode>sales_area_id</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['sales_area_id']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>5</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Distribution channel ID:</answer>
                                    <answerCode>distribution_channel_id</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['distribution_channel_id']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>6</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Ship to ID</answer>
                                    <answerCode>ship_to_id</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['ship_to_id']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>7</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Products:</answer>
                                    <answerCode>products_json</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                        <code>GRID</code>
                                        <description>Grid</description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>false</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>false</showForMachineConfig>
                                        <title>Grid</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['products_json']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>products</htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>8</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Product code</answer>
                                    <answerCode>product_code</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue></defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <parentAnswer>
                                        <allowNA>false</allowNA>
                                        <answer>Products:</answer>
                                        <answerCode>products_json</answerCode>
                                        <answerHtml></answerHtml>
                                        <answerTypeObject>
                                            <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                            <code>GRID</code>
                                            <description>Grid</description>
                                            <optionsAvailable>false</optionsAvailable>
                                            <showDefaultValue>true</showDefaultValue>
                                            <showForFieldScheme>false</showForFieldScheme>
                                            <showForHumanTask>true</showForHumanTask>
                                            <showForMachineConfig>false</showForMachineConfig>
                                            <title>Grid</title>
                                            <valueType>SINGLEVALUE</valueType>
                                        </answerTypeObject>
                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                        <autocompleteField>false</autocompleteField>
                                        <category></category>
                                        <constantable>false</constantable>
                                        <defaultValue>${question.data['products_json']}</defaultValue>
                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                        <htmlClasses>products</htmlClasses>
                                        <lastModified>2018-05-07T13:28:42Z</lastModified>
                                        <letCustomValues>false</letCustomValues>
                                        <manualField>false</manualField>
                                        <multiValue>false</multiValue>
                                        <percentRequired>false</percentRequired>
                                        <range>false</range>
                                        <required>false</required>
                                        <sequenceNumber>8</sequenceNumber>
                                        <useBlocks>false</useBlocks>
                                        <useEmptyCell>false</useEmptyCell>
                                    </parentAnswer>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>9</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>gtin</answer>
                                    <answerCode>gtin</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue></defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <parentAnswer>
                                        <allowNA>false</allowNA>
                                        <answer>Products:</answer>
                                        <answerCode>products_json</answerCode>
                                        <answerHtml></answerHtml>
                                        <answerTypeObject>
                                            <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                            <code>GRID</code>
                                            <description>Grid</description>
                                            <optionsAvailable>false</optionsAvailable>
                                            <showDefaultValue>true</showDefaultValue>
                                            <showForFieldScheme>false</showForFieldScheme>
                                            <showForHumanTask>true</showForHumanTask>
                                            <showForMachineConfig>false</showForMachineConfig>
                                            <title>Grid</title>
                                            <valueType>SINGLEVALUE</valueType>
                                        </answerTypeObject>
                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                        <autocompleteField>false</autocompleteField>
                                        <category></category>
                                        <constantable>false</constantable>
                                        <defaultValue>${question.data['products_json']}</defaultValue>
                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                        <htmlClasses>products</htmlClasses>
                                        <lastModified>2018-05-07T13:28:42Z</lastModified>
                                        <letCustomValues>false</letCustomValues>
                                        <manualField>false</manualField>
                                        <multiValue>false</multiValue>
                                        <percentRequired>false</percentRequired>
                                        <range>false</range>
                                        <required>false</required>
                                        <sequenceNumber>8</sequenceNumber>
                                        <useBlocks>false</useBlocks>
                                        <useEmptyCell>false</useEmptyCell>
                                    </parentAnswer>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>true</required>
                                    <sequenceNumber>10</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>quantity</answer>
                                    <answerCode>quantity</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue></defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <parentAnswer>
                                        <allowNA>false</allowNA>
                                        <answer>Products:</answer>
                                        <answerCode>products_json</answerCode>
                                        <answerHtml></answerHtml>
                                        <answerTypeObject>
                                            <answerTypeGroup>FORM_STRUCTURE</answerTypeGroup>
                                            <code>GRID</code>
                                            <description>Grid</description>
                                            <optionsAvailable>false</optionsAvailable>
                                            <showDefaultValue>true</showDefaultValue>
                                            <showForFieldScheme>false</showForFieldScheme>
                                            <showForHumanTask>true</showForHumanTask>
                                            <showForMachineConfig>false</showForMachineConfig>
                                            <title>Grid</title>
                                            <valueType>SINGLEVALUE</valueType>
                                        </answerTypeObject>
                                        <appendDataStoreOptions>false</appendDataStoreOptions>
                                        <autocompleteField>false</autocompleteField>
                                        <category></category>
                                        <constantable>false</constantable>
                                        <defaultValue>${question.data['products_json']}</defaultValue>
                                        <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                        <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                        <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                        <htmlClasses>products</htmlClasses>
                                        <lastModified>2018-05-07T13:28:42Z</lastModified>
                                        <letCustomValues>false</letCustomValues>
                                        <manualField>false</manualField>
                                        <multiValue>false</multiValue>
                                        <percentRequired>false</percentRequired>
                                        <range>false</range>
                                        <required>false</required>
                                        <sequenceNumber>8</sequenceNumber>
                                        <useBlocks>false</useBlocks>
                                        <useEmptyCell>false</useEmptyCell>
                                    </parentAnswer>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>11</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Request delivery date (OCR-ed)</answer>
                                    <answerCode>rdd_orig</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['rdd_orig']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses>disabledField</htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>12</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Request delivery date (manually-fixed):</answer>
                                    <answerCode>rdd</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>${question.data['rdd']}</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>13</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Quit processing this order in WorkFusion and return to user for manual processing?</answer>
                                    <answerCode>beyond_repair_flag</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>MULTIPLE_CHOICE</answerTypeGroup>
                                        <code>CHECK_ONE</code>
                                        <description></description>
                                        <optionsAvailable>true</optionsAvailable>
                                        <optionsDescription>Provide options for the answer using key=value format. For example, Option Name1=value1 or Option Name2=value2.</optionsDescription>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Check One</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <category></category>
                                    <constantable>false</constantable>
                                    <defaultValue>NO</defaultValue>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <htmlClasses></htmlClasses>
                                    <lastModified>2018-05-07T13:28:42Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <options>no=NO|yes=YES</options>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>14</sequenceNumber>
                                    <shuffle>false</shuffle>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                            </answers>
                            <businessRules/>
                            <isPrivate>false</isPrivate>
                            <items>
                                <item>
                                    <type>AUTOMATICALLY_APPROVED</type>
                                    <value>2592000000</value>
                                </item>
                                <item>
                                    <type>HIT_EXPIRES_IN</type>
                                    <value>31536000000</value>
                                </item>
                                <item>
                                    <type>RECURSIVE_THRESHOLD</type>
                                    <value>1</value>
                                </item>
                                <item>
                                    <type>FRAME_HEIGHT</type>
                                    <value>2500</value>
                                </item>
                                <item>
                                    <type>KEYWORDS</type>
                                    <value>Miscellaneous Tasks</value>
                                </item>
                                <item>
                                    <type>TIME_PER_ASSIGNMENT</type>
                                    <value>900000</value>
                                </item>
                                <item>
                                    <type>LIMIT_NUMBER_ASSIGNMENTS</type>
                                    <value>0</value>
                                </item>
                                <item>
                                    <type>AUTOMATICALLY_PROCESSED</type>
                                    <value>0</value>
                                </item>
                                <item>
                                    <type>PENDING_ASSIGNMENTS_LIMIT</type>
                                    <value>10</value>
                                </item>
                                <item>
                                    <type>ASSIGNMENTS_PER_HIT</type>
                                    <value>1</value>
                                </item>
                                <item>
                                    <type>BLOCK_SIZE</type>
                                    <value>1</value>
                                </item>
                                <item>
                                    <type>ASSIGNMENT_LIMIT</type>
                                    <value>1</value>
                                </item>
                                <item>
                                    <type>DESCRIPTION</type>
                                    <value>Miscellaneous Tasks</value>
                                </item>
                                <item>
                                    <type>QUALIFICATION_REQUIREMENTS</type>
                                    <value>[]</value>
                                </item>
                                <item>
                                    <type>EXTERNAL_URL</type>
                                    <value>https://wfapp.workfusion.pg.com/workfusion/public/HTMLRenderer</value>
                                </item>
                                <item>
                                    <type>RESTRICTED_COUNTRIES</type>
                                    <value>[]</value>
                                </item>
                                <item>
                                    <type>REQUIRED_FOR_PREVIEW</type>
                                    <value>false</value>
                                </item>
                                <item>
                                    <type>ADJUDICATION_RULE</type>
                                    <value>3</value>
                                </item>
                            </items>
                            <template>
                                <code></code>
                                <content>&lt;#include "extras.ftl" parse=true/&gt;
&lt;#include "html.ftl" parse=true/&gt;
&lt;#include "answers.ftl" parse=true/&gt;
&lt;#assign FEEDBACK_ENABLED = true&gt;

&lt;@hit contentCss="${applicationResourceUrl}/workfusion-resources/saas/ms/ms.bootstrap.min.css"&gt;
&lt;@script src="${applicationResourceUrl}/workfusion-resources/bootstrap/js/bootstrap-tab.js"/&gt;  
  

  
&lt;@instructions title="Extract data from Excel"&gt;
  &lt;!--- editable content --&gt;
  &lt;@editable id="__INSTRUCTIONS__"&gt;&lt;br&gt;&lt;br&gt;&lt;/@editable&gt;
&lt;/@instructions&gt;
&lt;@form&gt;
&lt;#if questions??&gt;
    &lt;div class="thumbnail"&gt;
    &lt;#list questions as question&gt;
      &lt;@report question=question includeAll=true/&gt;
      &lt;div style="position:relative;margin:2px 0px" class="block question"&gt;
           &lt;div style="position:absolute;top:0px;right:0px;background-color:#e0e0e0;padding:1px 4px;border: 1px solid #C0C0C0;border-radius: 0px" class="number"&gt;
                &lt;b&gt;${question_index + 1}&lt;/b&gt;
           &lt;/div&gt;
           &lt;div&gt;
               &lt;div class="place bg-dark"&gt;
                 &lt;@editable id="__DATA__"&gt;Email:&amp;nbsp;&lt;a href="${question.data['eml_file_location']}" data-mce-href="${question.data['eml_file_location']}"&gt;${question.data['eml_file_location']}&lt;br&gt;&lt;/a&gt;Order:&amp;nbsp;&lt;a href="${question.data['document_link']}" data-mce-href="${question.data['document_link']}"&gt;${question.data['document_link']}&lt;br&gt;&lt;/a&gt;Error message/List of multi-sheet order:&amp;nbsp;${question.data['error_message']}&lt;/@editable&gt;
               &lt;/div&gt;
               &lt;div class="place"&gt;
                 &lt;@answers question=question/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
      &lt;/div&gt;
    &lt;/#list&gt;
    &lt;/div&gt;
&lt;/#if&gt;
&lt;@submit text="Submit" /&gt;
&lt;/@form&gt;
&lt;/@hit&gt;</content>
                                <name>Miscellaneous Tasks (Blank)</name>
                                <origination>CREATED_AUTOMATICALLY</origination>
                                <status>ACTIVE</status>
                                <type>BASE</type>
                                <uuid>6778197e-5123-4587-9bfd-0fe361b1ac23</uuid>
                                <version>
                                    <componentUuid>b440737a-1966-46d2-953d-e1fef74fd055</componentUuid>
                                    <incrementalVersion>1.0</incrementalVersion>
                                    <lastInChain>true</lastInChain>
                                    <lastModified>2017-09-13T22:42:01Z</lastModified>
                                    <versionUuid>a26c02b9-0130-4b3c-9f8e-0bddd14f8819</versionUuid>
                                </version>
                            </template>
                        </workSetting>
                        <workSpacePreviewData>[{"name":"created","value":"${question.data['creation_sorting_dttm']}"},{"name":"customer","value":"${question.data['ship_to_name']}"},{"name":"city","value":"${question.data['ship_to_location']}"},{"name":"rdd","value":"${question.data['order_sorting_date']}"},{"name":"po_number","value":"${question.data['po_number']}"},{"name":"id","value":"${question.data['uuid']}-${question.data['mail_id']}"}]</workSpacePreviewData>
                        <workSpacePreviewScheme>
                            <answers>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Created</answer>
                                    <answerCode>created</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <constantable>false</constantable>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <lastModified>2018-04-19T09:13:48Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>1</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Customer</answer>
                                    <answerCode>customer</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <constantable>false</constantable>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <lastModified>2018-04-19T09:14:05Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>2</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>City</answer>
                                    <answerCode>city</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <constantable>false</constantable>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <lastModified>2018-04-19T09:14:26Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>3</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>RDD</answer>
                                    <answerCode>rdd</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <constantable>false</constantable>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <lastModified>2018-04-19T09:15:20Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>4</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>PO number</answer>
                                    <answerCode>po_number</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <constantable>false</constantable>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <lastModified>2018-04-19T09:15:47Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>5</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                                <answer>
                                    <allowNA>false</allowNA>
                                    <answer>Id</answer>
                                    <answerCode>id</answerCode>
                                    <answerHtml></answerHtml>
                                    <answerTypeObject>
                                        <answerTypeGroup>UNCONSTRAINED_TEXT</answerTypeGroup>
                                        <code>FREE_TEXT</code>
                                        <description></description>
                                        <optionsAvailable>false</optionsAvailable>
                                        <showDefaultValue>true</showDefaultValue>
                                        <showForFieldScheme>true</showForFieldScheme>
                                        <showForHumanTask>true</showForHumanTask>
                                        <showForMachineConfig>true</showForMachineConfig>
                                        <title>Free Text</title>
                                        <valueType>SINGLEVALUE</valueType>
                                    </answerTypeObject>
                                    <appendDataStoreOptions>false</appendDataStoreOptions>
                                    <autocompleteField>false</autocompleteField>
                                    <constantable>false</constantable>
                                    <doNotNormalizeTaggedText>false</doNotNormalizeTaggedText>
                                    <doNotUseInAdjudication>false</doNotUseInAdjudication>
                                    <findMajorityForAllAtomicValues>false</findMajorityForAllAtomicValues>
                                    <lastModified>2018-04-19T09:13:01Z</lastModified>
                                    <letCustomValues>false</letCustomValues>
                                    <manualField>false</manualField>
                                    <multiValue>false</multiValue>
                                    <percentRequired>false</percentRequired>
                                    <range>false</range>
                                    <required>false</required>
                                    <sequenceNumber>6</sequenceNumber>
                                    <useBlocks>false</useBlocks>
                                    <useEmptyCell>false</useEmptyCell>
                                </answer>
                            </answers>
                            <description></description>
                            <id>144</id>
                            <name>DACH - manual task sorting for RPA fix 0.5 v.2</name>
                            <origination>CREATED_MANUALLY</origination>
                            <status>ACTIVE</status>
                            <uuid>6d272ab0-6c38-4a67-8d36-ed159e8773e8</uuid>
                        </workSpacePreviewScheme>
                    </question>
                    <requiresData>true</requiresData>
                    <status>ACTIVE</status>
                    <streamComplexRunThreshold>1</streamComplexRunThreshold>
                    <streamTimeInterval>Immediately</streamTimeInterval>
                    <streamTimeIntervalValue>0</streamTimeIntervalValue>
                    <streamValueType>Tasks</streamValueType>
                    <title>MIAMOR RPA NORDICS v3.2 MASTER</title>
                    <type>COMPOSITE</type>
                    <uuid>5b550ea0-9292-4b27-9abe-4f3ac89225b1</uuid>
                    <validWorkflow>true</validWorkflow>
                    <version>
                        <componentUuid>af528d88-9214-48de-96b2-f463d6572cee</componentUuid>
                        <incrementalVersion>1.134</incrementalVersion>
                        <lastInChain>true</lastInChain>
                        <lastModified>2018-09-05T09:28:33Z</lastModified>
                        <versionUuid>da1705be-387a-4404-a0dd-59e4228d83ae</versionUuid>
                    </version>
                    <workSettingBase>false</workSettingBase>
                </campaign>
                <description>
                    <dynamicTaskRenderingDisabled>false</dynamicTaskRenderingDisabled>
                    <goldRun>false</goldRun>
                    <maximumProcessingCount>3</maximumProcessingCount>
                    <qualificationTraining>false</qualificationTraining>
                    <stepDescription>{"4347818c-d555-434c-9c32-5140240a6d3f":{"campaignUUID":"4347818c-d555-434c-9c32-5140240a6d3f","scheduleDateType":"DATE","workforceUUID":"8e68c08c-28fb-11e8-bf41-000d3a0302a9","taskPriority":16,"includeOriginalData":false,"automationUseCaseConfigs":[{"automationUseCaseId":21,"automationUseCaseUuid":"94f11384-eb1b-4084-aee6-c9467fca1789","modelType":"Other","modelCode":"generic-invoice-information-extraction"}],"automationRecall":0.0,"crowdPrices":[{"crowdId":1,"price":0.0}],"workSpacePreviewSchemeId":346,"workSpacePreviewData":"[{\"name\":\"client_name\",\"value\":\"${question.data[\u0027customer_name_ocr\u0027]}\"},{\"name\":\"customer_delivery_zip_code\",\"value\":\"${question.data[\u0027zip_code_ocr\u0027]}\"},{\"name\":\"po\",\"value\":\"${question.data[\u0027purchase_order_ocr\u0027]}\"},{\"name\":\"net_total_price\",\"value\":\"${question.data[\u0027net_total_price_ocr\u0027]}\"}]"},"777a0cbb-40c3-4cb0-b5b4-00ad1cc843fa":{"campaignUUID":"777a0cbb-40c3-4cb0-b5b4-00ad1cc843fa","scheduleDateType":"DATE","workforceUUID":"8e68c08c-28fb-11e8-bf41-000d3a0302a9","taskPriority":16,"includeOriginalData":false,"automationUseCaseConfigs":[],"automationRecall":0.0,"crowdPrices":[{"crowdId":1,"price":0.0}],"workSpacePreviewSchemeId":144,"workSpacePreviewData":"[{\"name\":\"created\",\"value\":\"${question.data[\u0027creation_sorting_dttm\u0027]}\"},{\"name\":\"customer\",\"value\":\"${question.data[\u0027ship_to_name\u0027]}\"},{\"name\":\"city\",\"value\":\"${question.data[\u0027ship_to_location\u0027]}\"},{\"name\":\"rdd\",\"value\":\"${question.data[\u0027order_sorting_date\u0027]}\"},{\"name\":\"po_number\",\"value\":\"${question.data[\u0027po_number\u0027]}\"},{\"name\":\"id\",\"value\":\"${question.data[\u0027uuid\u0027]}-${question.data[\u0027mail_id\u0027]}\"}]"},"141516f7-51a9-4983-ab17-5cdfed8142ae":{"campaignUUID":"141516f7-51a9-4983-ab17-5cdfed8142ae","scheduleDateType":"DATE","workforceUUID":"8e68c08c-28fb-11e8-bf41-000d3a0302a9","taskPriority":16,"includeOriginalData":false,"automationUseCaseConfigs":[],"automationRecall":0.0,"crowdPrices":[{"crowdId":1,"price":0.0}],"workSpacePreviewSchemeId":176,"workSpacePreviewData":"[{\"name\":\"created\",\"value\":\"${question.data[\u0027creation_sorting_dttm\u0027]}\"},{\"name\":\"customer\",\"value\":\"${question.data[\u0027ship_to_name\u0027]}\"},{\"name\":\"city\",\"value\":\"${question.data[\u0027ship_to_location\u0027]}\"},{\"name\":\"rdd\",\"value\":\"${question.data[\u0027rdd_orig\u0027]}\"},{\"name\":\"po_number\",\"value\":\"${question.data[\u0027po_number\u0027]}\"},{\"name\":\"id\",\"value\":\"${question.data[\u0027uuid\u0027]}-${question.data[\u0027mail_id\u0027]}\"}]"},"e5a64d4d-b9ac-497b-b992-d2b0b55ae328":{"campaignUUID":"e5a64d4d-b9ac-497b-b992-d2b0b55ae328","workforceUUID":"8e68c08c-28fb-11e8-bf41-000d3a0302a9","includeOriginalData":false,"crowdPrices":[{"crowdId":1,"price":0.0}]},"86153326-4ab7-44cf-9ae2-1da86875f6e8":{"campaignUUID":"86153326-4ab7-44cf-9ae2-1da86875f6e8","workforceUUID":"8e68c08c-28fb-11e8-bf41-000d3a0302a9","includeOriginalData":false,"crowdPrices":[{"crowdId":1,"price":0.0}],"workSpacePreviewSchemeId":176,"workSpacePreviewData":"[{\"name\":\"created\",\"value\":\"${question.data[\u0027creation_sorting_dttm\u0027]}\"},{\"name\":\"customer\",\"value\":\"${question.data[\u0027ship_to_name\u0027]}\"},{\"name\":\"city\",\"value\":\"${question.data[\u0027ship_to_location\u0027]}\"},{\"name\":\"rdd\",\"value\":\"${question.data[\u0027order_sorting_date\u0027]}\"},{\"name\":\"po_number\",\"value\":\"${question.data[\u0027po_number\u0027]}\"},{\"name\":\"id\",\"value\":\"${question.data[\u0027uuid\u0027]}-${question.data[\u0027mail_id\u0027]}\"}]"},"59feef8c-68dd-4545-bbed-9c6a8a9bfbf1":{"campaignUUID":"59feef8c-68dd-4545-bbed-9c6a8a9bfbf1","workforceUUID":"8e68c08c-28fb-11e8-bf41-000d3a0302a9","includeOriginalData":false,"crowdPrices":[{"crowdId":1,"price":0.0}],"workSpacePreviewSchemeId":144,"workSpacePreviewData":"[{\"name\":\"created\",\"value\":\"${question.data[\u0027creation_sorting_dttm\u0027]}\"},{\"name\":\"customer\",\"value\":\"${question.data[\u0027ship_to_name\u0027]}\"},{\"name\":\"city\",\"value\":\"${question.data[\u0027ship_to_location\u0027]}\"},{\"name\":\"rdd\",\"value\":\"${question.data[\u0027order_sorting_date\u0027]}\"},{\"name\":\"po_number\",\"value\":\"${question.data[\u0027po_number\u0027]}\"},{\"name\":\"id\",\"value\":\"${question.data[\u0027uuid\u0027]}-${question.data[\u0027mail_id\u0027]}\"}]"}}</stepDescription>
                    <streamingValue>1</streamingValue>
                    <streamingValueType>Tasks</streamingValueType>
                    <taskParams>{"values":{"DESCRIPTION":"","NAME":"[001] Read configs32 [2018-08-09 10:22:56]                                             "}}</taskParams>
                    <uploadResults>false</uploadResults>
                    <uploadResultsType>CREATE</uploadResultsType>
                </description>
                <executingType>COMPOSITE</executingType>
                <forceComplete>false</forceComplete>
                <forceCompleteIdleTime>0</forceCompleteIdleTime>
                <forceCompletePercent>100</forceCompletePercent>
                <mixStrategy>
                    <additionalRows>0</additionalRows>
                    <blockSize>1</blockSize>
                    <goldItemSize>0</goldItemSize>
                    <goldPercentage>0</goldPercentage>
                    <goldRatio>true</goldRatio>
                    <mainRows>1</mainRows>
                    <repeated>false</repeated>
                </mixStrategy>
                <purged>false</purged>
                <recordProcessingStatus>NOT_STARTED</recordProcessingStatus>
                <runType>SIMPLE</runType>
                <tags></tags>
                <title>MIAMOR RPA NORDICS v3.2 MASTER</title>
                <uuid>79699bb9-ebd4-4b36-bac9-c80d7d68ce06</uuid>
            </run>
            <hashCode>1093937172</hashCode>
        </objectContainer>
    </objects>
</objectListWrapper>
